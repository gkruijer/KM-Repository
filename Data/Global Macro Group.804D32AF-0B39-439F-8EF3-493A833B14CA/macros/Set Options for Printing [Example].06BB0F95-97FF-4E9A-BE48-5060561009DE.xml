<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<array>
	<dict>
		<key>Actions</key>
		<array>
			<dict>
				<key>ActionColor</key>
				<string>Green</string>
				<key>ActionName</key>
				<string>~~~ ReleaseNotes for  VER: 1.0    2019-10-23 ~~~</string>
				<key>ActionUID</key>
				<integer>15408033</integer>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>Comment</string>
				<key>StyledText</key>
				<data>
							cnRmZAAAAAADAAAAAgAA
							AAcAAABUWFQucnRmAQAA
							AC47DAAAKwAAAAEAAAAz
							DAAAe1xydGYxXGFuc2lc
							YW5zaWNwZzEyNTJcY29j
							b2FydGYxNjcxXGNvY29h
							c3VicnRmNjAwCntcZm9u
							dHRibFxmMFxmbmlsXGZj
							aGFyc2V0MCBWZXJkYW5h
							O1xmMVxmbmlsXGZjaGFy
							c2V0MCBWZXJkYW5hLUJv
							bGQ7XGYyXGZuaWxcZmNo
							YXJzZXQwIFZlcmRhbmEt
							SXRhbGljOwpcZjNcZnN3
							aXNzXGZjaGFyc2V0MCBI
							ZWx2ZXRpY2E7fQp7XGNv
							bG9ydGJsO1xyZWQyNTVc
							Z3JlZW4yNTVcYmx1ZTI1
							NTtccmVkMjVcZ3JlZW4y
							NVxibHVlMjU7XHJlZDIy
							MFxncmVlbjhcYmx1ZTY7
							XHJlZDIwNFxncmVlbjEw
							MlxibHVlMjU1Owp9Cntc
							KlxleHBhbmRlZGNvbG9y
							dGJsOztcY3NnZW5lcmlj
							cmdiXGM5ODA0XGM5ODA0
							XGM5ODA0O1xjc2dlbmVy
							aWNyZ2JcYzg2Mjc1XGMz
							MTM3XGMyMzUzO1xjc2dl
							bmVyaWNyZ2JcYzgwMDAw
							XGM0MDAwMFxjMTAwMDAw
							Owp9ClxkZWZ0YWI3MjAK
							XHBhcmRcdHg3NDJcdHg4
							MjRcdHgxMTgxXHR4MTY4
							MFx0eDIyNDBcdHgyODAw
							XHR4MzM2MFx0eDM5MjBc
							dHg0NDgwXHR4NTA0MFx0
							eDU2MDBcdHg2MTYwXHR4
							NjcyMFxwYXJkZWZ0YWI3
							MjBcbGk3ODBcZmktNzgx
							XHJpLTM5MDVccGFydGln
							aHRlbmZhY3RvcjAKClxm
							MFxmczI4IFxjZjAgQXV0
							aG9yLkBKTWljaGFlbFRY
							IFwKXAoqKgpcZjFcYiBQ
							VVJQT1NFClxmMFxiMCA6
							KipcClwKKiAqKgpcZjFc
							YiBTZXQgUHJlc2V0IFZh
							bHVlIGluIFByaW50IERp
							YWxvZwpcZjBcYjAgKipc
							CiAgICogU2hvdWxkIHdv
							cmsgd2l0aCBhbGwgQXBw
							cyB0aGF0IHVzZSBhIG1h
							Y09TIHN0YW5kYXJkIFBy
							aW50IERpYWxvZ1wKXAoq
							KgpcZjFcYiBcY2YyIEhP
							VyBUTyBVU0UqKlwKXAoK
							XGYwXGIwIDEuIEZpcnN0
							LCBtYWtlIHN1cmUgeW91
							IGhhdmUgZm9sbG93ZWQg
							aW5zdHJ1Y3Rpb25zIGlu
							IHRoZSBfClxmMlxpIE1h
							Y3JvIFNldHVwClxmMFxp
							MCBfIGJlbG93LlwKMi4g
							TWFrZSBBcHAgV2luZG93
							IEZyb250TW9zdCB0aGF0
							IHlvdSB3YW50IHRvIFBy
							aW50XAozLiBUcmlnZ2Vy
							IHRoaXMgbWFjcm8uXAog
							ICogTWFjcm8gd2lsbCBQ
							YXVzZSBVbnRpbCBQcmlu
							dCBEaWFsb2cgaXMgU2hv
							d25cCjQuIElmIHlvdSBn
							ZXQgYW4gZXJyb3IgTm90
							aWZpY2F0aW9uLCBDb3B5
							IGZ1bGwgTm90aWZpY2F0
							aW9uLCBhbmQgcG9zdCBp
							biByZXBseSBiZWxvdyBN
							YWNybyBUb3BpYy5cClxj
							ZjAgXAoqKgpcZjFcYiBN
							QUNSTyBTRVRVUApcZjBc
							YjAgKipcClwKKiAqKkNh
							cmVmdWxseSByZXZpZXcg
							dGhlIFJlbGVhc2UgTm90
							ZXMgYW5kIHRoZSBNYWNy
							byBBY3Rpb25zKipcCiAg
							KiBNYWtlIHN1cmUgeW91
							IHVuZGVyc3RhbmQgd2hh
							dCB0aGUgTWFjcm8gd2ls
							bCBkby4gIFwKICAqIFlv
							dSBhcmUgcmVzcG9uc2li
							bGUgZm9yIHJ1bm5pbmcg
							dGhlIE1hY3JvLCBub3Qg
							bWUuICAKXGYzXGZzMjQg
							Pz8KXGYwXGZzMjggXAou
							XAoqKgpcZjFcYiBNYWtl
							IFRoZXNlIENoYW5nZXMg
							dG8gdGhpcyBNYWNybwpc
							ZjBcYjAgKipcCjEuIEFz
							c2lnbiBhIFRyaWdnZXIg
							dG8gdGhpcyBtYWNyby5c
							CjIuIE1vdmUgdGhpcyBt
							YWNybyB0byBhIE1hY3Jv
							IEdyb3VwIHRoYXQgaXMg
							b25seSBBY3RpdmUgd2hl
							biB5b3UgbmVlZCB0aGlz
							IE1hY3JvLlwKMy4gRU5B
							QkxFIHRoaXMgTWFjcm8s
							IGFuZCB0aGUgTWFjcm8g
							R3JvdXAgaXQgaXMgaW4u
							XAouXAoqICoqClxmMVxi
							IFxjZjMgUkVWSUVXL0NI
							QU5HRSBUSEUgRk9MTE9X
							SU5HIE1BQ1JPIEFDVElP
							TlMKXGYwXGIwIFxjZjAg
							OioqXAooYWxsIHNob3du
							IGluIHRoZSBtYWdlbnRh
							IGNvbG9yKVwKICAgKiAK
							XGYxXGIgXGNmNCBFTlRF
							UiBZb3VyIFByaW50ZXIg
							UHJlc2V0IE5hbWUKXGYw
							XGIwIFxjZjAgIFwKXAoq
							KgpcZjFcYiBSRVFVSVJF
							UwpcZjBcYjAgOioqXApc
							CjEuICoqS00gOC4yLjQr
							KyoqIFwKMi4gKiptYWNP
							UyAxMC4xMS42IChFbCBD
							YXBpdGFuKSsqKlwKXAoK
							XGYxXGIgVEFHUwpcZjBc
							YjAgOiAgQFByaW50ZXIg
							QEFwcGxlU2NyaXB0IEBV
							SVNjcmlwdFwKXAoKXGYx
							XGIgVVNFUiBTRVRUSU5H
							UzpcCgpcZjBcYjAgXAoq
							XCdhMEFueSBBY3Rpb24g
							aW4gXwpcZjFcYiBcY2Y0
							IG1hZ2VudGEgY29sb3IK
							XGYwXGIwIFxjZjAgXyBp
							cyBkZXNpZ25lZCB0byBi
							ZSBjaGFuZ2VkIGJ5IGVu
							ZC11c2VyXApcCgpcZjFc
							YiBBQ1RJT04gQ09MT1Ig
							Q09ERVNcCgpcZjBcYjAg
							XAoqXCdhMFRvIGZhY2ls
							aXRhdGUgdGhlIHJlYWRp
							bmcsIGN1c3RvbWl6aW5n
							LCBhbmQgbWFpbnRlbmFu
							Y2Ugb2YgdGhpcyBtYWNy
							byxcClwnYTBcJ2EwXCdh
							MFwnYTBcJ2EwXCdhMGtl
							eSBBY3Rpb25zIGFyZSBj
							b2xvcmVkIGFzIGZvbGxv
							d3M6XAoqXCdhMEdSRUVO
							XCdhMFwnYTBcJ2EwLS0g
							S2V5IENvbW1lbnRzIGRl
							c2lnbmVkIHRvIGhpZ2hs
							aWdodCBtYWluIHNlY3Rp
							b25zIG9mIG1hY3JvXAoq
							XCdhME1BR0VOVEEgLS0g
							QWN0aW9ucyBkZXNpZ25l
							ZCB0byBiZSBjdXN0b21p
							emVkIGJ5IHVzZXJcCipc
							J2EwWUVMTE9XXCdhMFwn
							YTAtLSBQcmltYXJ5IEFj
							dGlvbnMgKHVzdWFsbHkg
							dGhlIG1haW4gcHVycG9z
							ZSBvZiB0aGUgbWFjcm8p
							XAoqXCdhME9SQU5HRVwn
							YTBcJ2EwLS0gQWN0aW9u
							cyB0aGF0IHBlcm1hbmVu
							dGx5IGRlc3Ryb3kgVmFy
							aWFibGVzIG9yIENsaXBi
							b2FyZHMsXApPUiBJRi9U
							SEVOIGFuZCBQQVVTRSBB
							Y3Rpb25zXApcClwKKio9
							PQpcZjFcYiBcY2YzIFVT
							RSBBVCBZT1VSIE9XTiBS
							SVNLPT0KXGYwXGIwIFxj
							ZjAgKipcClwKKiBXaGls
							ZSBJIGhhdmUgZ2l2ZW4g
							dGhpcyBhIG1vZGVzdCBh
							bW91bnQgb2YgdGVzdGlu
							ZywgYW5kIHRvIHRoZSBi
							ZXN0IG9mIG15IGtub3ds
							ZWRnZSB3aWxsIGRvIG5v
							IGhhcm0sIEkgY2Fubm90
							IGd1YXJhbnRlZSBpdC5c
							CiogSWYgeW91IGhhdmUg
							YW55IGRvdWJ0cyBvciBx
							dWVzdGlvbnM6XAogICog
							KipBc2sgZmlyc3QqKlwK
							ICAqIFR1cm4gb24gdGhl
							IEtNIERlYnVnZ2VyIGZy
							b20gdGhlIEtNIFN0YXR1
							cyBNZW51LCBhbmQgc3Rl
							cCB0aHJvdWdoIHRoZSBt
							YWNybywgbWFraW5nIHN1
							cmUgeW91IHVuZGVyc3Rh
							bmQgd2hhdCBpdCBpcyBk
							b2luZyB3aXRoIGVhY2gg
							QWN0aW9uLlwKXHBhcmRc
							dHg3NDJcdHg4MjRcdHgx
							MTgxXHR4MTY4MFx0eDIy
							NDBcdHgyODAwXHR4MzM2
							MFx0eDM5MjBcdHg0NDgw
							XHR4NTA0MFx0eDU2MDBc
							dHg2MTYwXHR4NjcyMFxw
							YXJkZWZ0YWI3MjBcbGk3
							ODBcZmktNzgxXHJpLTM5
							MDVccGFydGlnaHRlbmZh
							Y3RvcjAKClxmczI0IFxj
							ZjAgXAp9AQAAACMAAAAB
							AAAABwAAAFRYVC5ydGYQ
							AAAA8/SwXbYBAAAAAAAA
							AAAAAA==
							</data>
				<key>Title</key>
				<string>Set Options for Printing [Example]</string>
			</dict>
			<dict>
				<key>ActionColor</key>
				<string>Magenta</string>
				<key>ActionName</key>
				<string>ENTER Your Printer Preset Name</string>
				<key>ActionUID</key>
				<integer>15408034</integer>
				<key>MacroActionType</key>
				<string>SetVariableToText</string>
				<key>Text</key>
				<string>REPLACE WITH YOUR PRESET NAME</string>
				<key>Variable</key>
				<string>Local__PrinterPresetName</string>
			</dict>
			<dict>
				<key>ActionUID</key>
				<integer>15408035</integer>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>Notification</string>
				<key>SoundName</key>
				<string>Hero</string>
				<key>Subtitle</key>
				<string>Display PRINT Dialog</string>
				<key>Text</key>
				<string></string>
				<key>Title</key>
				<string>%ExecutingMacro%</string>
			</dict>
			<dict>
				<key>ActionColor</key>
				<string>Orange</string>
				<key>ActionName</key>
				<string>PAUSE UNTIL:  Print Dialog is Shown</string>
				<key>ActionUID</key>
				<integer>15408036</integer>
				<key>Conditions</key>
				<dict>
					<key>ConditionList</key>
					<array>
						<dict>
							<key>ButtonConditionSelectionType</key>
							<string>Is</string>
							<key>ButtonConditionType</key>
							<string>IsEnabled</string>
							<key>ButtonTitle</key>
							<string>Print</string>
							<key>ConditionType</key>
							<string>Button</string>
						</dict>
					</array>
					<key>ConditionListMatch</key>
					<string>All</string>
				</dict>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>PauseUntil</string>
				<key>TimeOutAbortsMacro</key>
				<true/>
			</dict>
			<dict>
				<key>ActionColor</key>
				<string>Teal</string>
				<key>ActionName</key>
				<string>SCRIPT:  Change Printer Preset Value (AS)</string>
				<key>ActionUID</key>
				<integer>15408037</integer>
				<key>DisplayKind</key>
				<string>None</string>
				<key>HonourFailureSettings</key>
				<true/>
				<key>IncludeStdErr</key>
				<false/>
				<key>IncludedVariables</key>
				<array>
					<string>9999</string>
				</array>
				<key>MacroActionType</key>
				<string>ExecuteAppleScript</string>
				<key>NotifyOnFailure</key>
				<false/>
				<key>Path</key>
				<string></string>
				<key>Text</key>
				<string>property ptyScriptName : "Change Printer Preset Value"
property ptyScriptVer : "2.0"
property ptyScriptDate : "2019-10-23"
property ptyScriptAuthor : "JMichaelTX"

global gCurrentApp

tell application "System Events"
	set gCurrentApp to name of first application process whose frontmost is true
end tell

try
	--»	TRY ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	
	### Requires Keyboard Maestro 8.0.3+ ###
	
	set kmInst to system attribute "KMINSTANCE"
	
	tell application "Keyboard Maestro Engine"
		set presetName to getvariable "Local__PrinterPresetName" instance kmInst
	end tell
	
	### Uncomment next line to test in Script Debugger
	--tell application "BBEdit" to activate
	--set presetName to "Fast Print"
	
	tell application "System Events"
		
		set processName to name of first process whose frontmost is true
		
		tell application process processName
			
			#		set oWin to front window		### for testing
			tell front window
				
				try -- works for most apps
					set oPresetsBtn to pop up button 2 of sheet 1
				on error -- needed for some apps like Chrome
					set oPresetsBtn to pop up button 2
				end try
				
				tell oPresetsBtn
					perform action "AXShowMenu"
					# set oUIElem to UI elements	### for testing
					set oPresetToSelect to menu item presetName of menu 1
					tell oPresetToSelect
						perform action "AXPress"
					end tell
				end tell
				
			end tell
		end tell
	end tell
	
	--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	--»													ON ERROR
	--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
on error errMsg number errNum
	
	if errNum = -128 then ## User Canceled
		set errMsg to "[USER_CANCELED]"
	end if
	
	set scriptResults to "[ERROR] [MACRO CANCELLED] " &amp; errMsg
	
	tell application gCurrentApp
		display notification errMsg ¬
			with title ("SCRIPT:  " &amp; ptyScriptName &amp; " " &amp; ptyScriptVer) ¬
			subtitle "[ERROR] MACRO CANCELLED " sound name "glass"
	end tell
	
	--»	THROW ERROR ~~~~~~~
	error scriptResults
	
end try --~~~~~~~~~~~~~~ END TRY ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</string>
				<key>TimeOutAbortsMacro</key>
				<true/>
				<key>TimeOutPeriod</key>
				<real>300</real>
				<key>TrimResults</key>
				<false/>
				<key>TrimResultsNew</key>
				<false/>
				<key>UseText</key>
				<true/>
			</dict>
			<dict>
				<key>ActionUID</key>
				<integer>15408038</integer>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>Notification</string>
				<key>SoundName</key>
				<string>Tink</string>
				<key>Subtitle</key>
				<string>Printer Preset was Set</string>
				<key>Text</key>
				<string></string>
				<key>Title</key>
				<string>%ExecutingMacro%</string>
			</dict>
		</array>
		<key>CreationDate</key>
		<real>593560279.15456903</real>
		<key>ModificationDate</key>
		<real>759492061.79772794</real>
		<key>Name</key>
		<string>Set Options for Printing [Example]</string>
		<key>Triggers</key>
		<array/>
		<key>UID</key>
		<string>06BB0F95-97FF-4E9A-BE48-5060561009DE</string>
	</dict>
</array>
</plist>
