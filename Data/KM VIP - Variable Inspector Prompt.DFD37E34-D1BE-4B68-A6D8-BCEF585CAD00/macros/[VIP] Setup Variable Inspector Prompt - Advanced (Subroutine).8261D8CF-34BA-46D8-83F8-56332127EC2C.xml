<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<array>
	<dict>
		<key>Actions</key>
		<array>
			<dict>
				<key>ActionColor</key>
				<string>Yellow</string>
				<key>ActionUID</key>
				<integer>16032939</integer>
				<key>MacroActionType</key>
				<string>Comment</string>
				<key>StyledText</key>
				<data>
							cnRmZAAAAAADAAAAAgAA
							AAcAAABUWFQucnRmAQAA
							AC52CwAAKwAAAAEAAABu
							CwAAe1xydGYxXGFuc2lc
							YW5zaWNwZzEyNTJcY29j
							b2FydGYyNTEzClxjb2Nv
							YXRleHRzY2FsaW5nMFxj
							b2NvYXBsYXRmb3JtMHtc
							Zm9udHRibFxmMFxmc3dp
							c3NcZmNoYXJzZXQwIEhl
							bHZldGljYS1Cb2xkO1xm
							MVxmc3dpc3NcZmNoYXJz
							ZXQwIEhlbHZldGljYTt9
							CntcY29sb3J0Ymw7XHJl
							ZDI1NVxncmVlbjI1NVxi
							bHVlMjU1O30Ke1wqXGV4
							cGFuZGVkY29sb3J0Ymw7
							O30KXHBhcmRcdHg1NjBc
							dHgxMTIwXHR4MTY4MFx0
							eDIyNDBcdHgyODAwXHR4
							MzM2MFx0eDM5MjBcdHg0
							NDgwXHR4NTA0MFx0eDU2
							MDBcdHg2MTYwXHR4Njcy
							MFxwYXJkaXJuYXR1cmFs
							XHBhcnRpZ2h0ZW5mYWN0
							b3IwCgpcZjBcYlxmczI4
							IFxjZjAgTmFtZQpcZjFc
							YjAgOiBTZXR1cCBWYXJp
							YWJsZSBJbnNwZWN0b3Ig
							UHJvbXB0IC0gQWR2YW5j
							ZWRcCgpcZjBcYiBWZXJz
							aW9uClxmMVxiMCA6IDMu
							MlwKClxmMFxiIFVwZGF0
							ZWQKXGYxXGIwIDogMjAy
							Mi8wMi8xNCAxNDowMiBQ
							VFwKClxmMFxiIEJ5Clxm
							MVxiMCA6IERhbiBUaG9t
							YXNcClwKClxmMFxiIFBV
							UlBPU0UKXGYxXGIwIDpc
							ClwKU2V0cyB1cCB0aGUg
							YWR2YW5jZWQgVmFyaWFi
							bGUgSW5zcGVjdG9yIFBy
							b21wdCB2YWx1ZXMuIFRo
							ZSByZXN1bHQgaXMgcmV0
							dXJuZWQgaW4gClxmMFxi
							IEluc3RhbmNlX1ZpcFBh
							cmFtZXRlcnMKXGYxXGIw
							IC5cClwKClxmMFxiIFVT
							QUdFClxmMVxiMCA6XApc
							ClRoaXMgaXMgdGhlIHNh
							bWUgYXMge1xmaWVsZHtc
							KlxmbGRpbnN0e0hZUEVS
							TElOSyAia2V5Ym9hcmRt
							YWVzdHJvOi8vbT1FNUFB
							OUQ5Ri0wREMxLTQ2Rjgt
							QkFDQS1ERURBRUFFQzJB
							OTgifX17XGZsZHJzbHQg
							U2V0dXAgVmFyaWFibGUg
							SW5zcGVjdG9yIFByb21w
							dH19ClxmMFxiICwKXGYx
							XGIwICB3aXRoIHNvbWUg
							YWRkaXRpb25hbCBwYXJh
							bWV0ZXJzOlwKXAoKXGYw
							XGIgUEFSQU1FVEVSUwpc
							ZjFcYjAgOlwKXApccGFy
							ZFx0eDQ2NzhcdHg1MDQw
							XHR4NTYwMFx0eDYxNjBc
							dHg2NzIwXGxpNDY3Nlxm
							aS00Mzg1XHBhcmRpcm5h
							dHVyYWxccGFydGlnaHRl
							bmZhY3RvcjAKClxmMFxi
							IFxjZjAgQXN5bmMgXyAx
							IGZvciB5ZXMKXGYxXGIw
							IAlOb3JtYWxseSB0aGUg
							SW5zcGVjdG9yIHdpbGwg
							YWN0IGp1c3QgbGlrZSBh
							bnkgb3RoZXIgUHJvbXB0
							IC0gaXQgc3RvcHMgbWFj
							cm8gZXhlY3V0aW9uIGFu
							ZCB3YWl0cyBmb3IgdGhl
							IHVzZXIgdG8gY2xpY2sg
							T0sgb3IgQ2FuY2VsLiBC
							dXQgaWYgeW91IGVudGVy
							ICIxIiBoZXJlLCB0aGUg
							SW5zcGVjdG9yIHdpbGwg
							cnVuIGFzeW5jaHJvbm91
							c2x5LCB3aGljaCBtZWFu
							cyBLZXlib2FyZCBNYWVz
							dHJvIHdvbid0IHdhaXQg
							Zm9yIGl0IHRvIGZpbmlz
							aC5cClwKCVlvdSBtaWdo
							dCB3YW50IHRvIHVzZSBB
							c3luYyBhbG9uZyB3aXRo
							ICJhbGwiIGluIHRoZSBW
							YXJpYWJsZSBOYW1lcyBw
							YXJhbWV0ZXIsIHdoaWxl
							IHlvdSdyZSB3b3JraW5n
							IG9uIGNsZWFuaW5nIHVw
							IHNvbWUgZ2xvYmFsIHZh
							cmlhYmxlcy5cClwKCU5P
							VEU6IFlvdSBjYW4ndCBj
							aGFuZ2UgdGhlIHZhbHVl
							cyBvZiBMb2NhbCBhbmQg
							SW5zdGFuY2UgdmFyaWFi
							bGVzIHdoZW4gcnVubmlu
							ZyBhc3luY2hyb25vdXNs
							eSwgYWx0aG91Z2ggeW91
							IGNhbiBzZWUgdGhlaXIg
							aW5pdGlhbCB2YWx1ZXMu
							XApcCgpcZjBcYiBTaG93
							IFJlbG9hZCBCdXR0b24g
							XyAxIGZvciB5ZXMKXGYx
							XGIwIAlFbnRlciAiMSIg
							dG8gc2hvdyB0aGUgIlJl
							bG9hZCIgYnV0dG9uLlwK
							XAoKXGYwXGIgQ2FuIEhp
							ZGUgVmFyaWFibGVzIF8g
							MSBmb3IgeWVzClxmMVxi
							MCAJRW50ZXIgIjEiIHRv
							IHR1cm4gb24gdGhlIG9w
							dGlvbiB0aGF0IGFsbG93
							cyB5b3UgdG8gaGlkZSAm
							IHVuaGlkZSB2YXJpYWJs
							ZXMuXApcClxwYXJkXHR4
							MzkyMFx0eDQ0ODBcdHg1
							MDQwXHR4NTYwMFx0eDYx
							NjBcdHg2NzIwXGxpMzk2
							MlxmaS0zODkwXHBhcmRp
							cm5hdHVyYWxccGFydGln
							aHRlbmZhY3RvcjAKXGNm
							MCBcClxwYXJkXHR4NTYw
							XHR4MTEyMFx0eDE2ODBc
							dHgyMjQwXHR4MjgwMFx0
							eDMzNjBcdHgzOTIwXHR4
							NDQ4MFx0eDUwNDBcdHg1
							NjAwXHR4NjE2MFx0eDY3
							MjBccGFyZGlybmF0dXJh
							bFxwYXJ0aWdodGVuZmFj
							dG9yMAoKXGYwXGIgXGNm
							MCBWRVJTSU9OIEhJU1RP
							UlkKXGYxXGIwIDpcCjMu
							MiAtICJQaW5nIiAKXGYw
							XGIgSW50ZXJuYWwgSW5z
							cGVjdG9yIFRhc2tzClxm
							MVxiMCAgbWFjcm8gdG8g
							dmVyaWZ5IGdyb3VwIGFu
							ZCBtYWNybyBhcmUgZW5h
							YmxlZC4gQWRkZWQgbnVt
							ZXJvdXMgb3B0aW9ucy4g
							Q2hhbmdlZCBzb21lIHZp
							c3VhbCBlbGVtZW50cyBm
							b3IgYmV0dGVyIGZlZWRi
							YWNrLlwKMy4xIC0gTWpv
							YXZlIGZpeGVzLCBjb25z
							b2xpZGF0ZWQgaW50ZXJu
							YWwgbWFjcm9zLlwKMy4w
							LjIgLSBSZW1vdmVkICJu
							YXZpZ2F0b3IuY2xpcGJv
							YXJkLndyaXRlVGV4dCIg
							YW5kIHJlcGxhY2VkIGl0
							IHdpdGggYSBLTSBNYWNy
							bywgYmVjYXVzZSBvZiBs
							YWNrIG9mIHN1cHBvcnQg
							dW5kZXIgTW9qYXZlLlwK
							My4wLjEgLSBSZW1vdmVk
							IHVzaW5nIHRoZSBSZXNp
							emVPYnNlcnZlciwgYmVj
							YXVzZSBpdCdzIG5vdCBz
							dXBwb3J0ZWQgdW5kZXIg
							TW9qYXZlLlwKMy4wIC0g
							QWRkZWQgYW4gb3B0aW9u
							IHRvIGJlIGFibGUgdG8g
							aGlkZSAmIHVuaGlkZSB2
							YXJpYWJsZXMgKGluIApc
							ZjBcYiBTZXR1cCBWYXJp
							YWJsZSBJbnNwZWN0b3Ig
							UHJvbXB0IC0gQWR2YW5j
							ZWQKXGYxXGIwICksIGFu
							ZCBhIGJ1bmNoIG9mIG90
							aGVyIHN0dWZmLlwKMi4w
							LjIgLSBGaXhlZCBhIGJ1
							ZyB3aGljaCBjYXVzZWQg
							c2Nyb2xsaW5nIG5vdCB0
							byB3b3JrIHJpZ2h0IChz
							b21ldGltZXMpIHVuZGVy
							IE1vbnRlcmV5LCBhbmQg
							YWxzbyBoYWQgYSBtb3Jl
							IHN1YnRsZSBlZmZlY3Qg
							dW5kZXIgcHJpb3IgdmVy
							c2lvbnMgb2YgbWFjT1Mu
							XAoyLjAuMSAtIEZpeGVk
							IGEgYnVnIHdpdGggc29t
							ZSBrZXlib2FyZCBzaG9y
							dGN1dHMuXAoyLjAgLSBG
							dWxseSBpbXBsZW1lbnRl
							ZCB0aGUgRGljdGlvbmFy
							eSBFZGl0b3IuXAoxLjAg
							LSBJbml0aWFsIHZlcnNp
							b24ufQEAAAAjAAAAAQAA
							AAcAAABUWFQucnRmEAAA
							AJjRCmK2AQAAAAAAAAAA
							AAA=
							</data>
				<key>Title</key>
				<string>Setup Variable Inspector Prompt - Advanced v3.2</string>
			</dict>
			<dict>
				<key>ActionColor</key>
				<string>Yellow</string>
				<key>ActionUID</key>
				<integer>16032940</integer>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>Comment</string>
				<key>StyledText</key>
				<data>
							cnRmZAAAAAADAAAAAgAA
							AAcAAABUWFQucnRmAQAA
							AC5KBAAAKwAAAAEAAABC
							BAAAe1xydGYxXGFuc2lc
							YW5zaWNwZzEyNTJcY29j
							b2FydGYyNTEzClxjb2Nv
							YXRleHRzY2FsaW5nMFxj
							b2NvYXBsYXRmb3JtMHtc
							Zm9udHRibFxmMFxmbmls
							XGZjaGFyc2V0MCBUYWhv
							bWEtQm9sZDtcZjFcZm5p
							bFxmY2hhcnNldDAgVGFo
							b21hO30Ke1xjb2xvcnRi
							bDtccmVkMjU1XGdyZWVu
							MjU1XGJsdWUyNTU7fQp7
							XCpcZXhwYW5kZWRjb2xv
							cnRibDs7fQpccGFyZFx0
							eDcyMFx0eDE0NDBcdHgy
							MTYwXHR4Mjg4MFx0eDM2
							MDBcdHg0MzIwXHR4NTA0
							MFx0eDU3NjBcdHg2NDgw
							XHR4NzIwMFx0eDc5MjBc
							dHg4NjQwXHBhcmRpcm5h
							dHVyYWxccGFydGlnaHRl
							bmZhY3RvcjAKClxmMFxi
							XGZzMzIgXGNmMCBTaG9y
							dCBWZXJzaW9uClxmMVxi
							MCA6IERvIHdoYXRldmVy
							IHlvdSB3YW50IHdpdGgg
							dGhpcy4gSnVzdCBkb25c
							JzkydCBibGFtZSBtZSBp
							ZiBhbnl0aGluZyBiYWQg
							aGFwcGVucy5cClwKClxm
							MFxiXGZzMjQgTG9uZyBW
							ZXJzaW9uClxmMVxiMCA6
							XApcClBlcm1pc3Npb24g
							dG8gdXNlLCBjb3B5LCBt
							b2RpZnksIGFuZC9vciBk
							aXN0cmlidXRlIHRoaXMg
							c29mdHdhcmUgZm9yIGFu
							eSBwdXJwb3NlIHdpdGgg
							b3Igd2l0aG91dCBmZWUg
							aXMgaGVyZWJ5IGdyYW50
							ZWQuXApcClRIRSBTT0ZU
							V0FSRSBJUyBQUk9WSURF
							RCAiQVMgSVMiIEFORCBU
							SEUgQVVUSE9SIERJU0NM
							QUlNUyBBTEwgV0FSUkFO
							VElFUyBXSVRIIFJFR0FS
							RCBUTyBUSElTIFNPRlRX
							QVJFIElOQ0xVRElORyBB
							TEwgSU1QTElFRCBXQVJS
							QU5USUVTIE9GIE1FUkNI
							QU5UQUJJTElUWSBBTkQg
							RklUTkVTUy4gSU4gTk8g
							RVZFTlQgU0hBTEwgVEhF
							IEFVVEhPUiBCRSBMSUFC
							TEUgRk9SIEFOWSBTUEVD
							SUFMLCBESVJFQ1QsIElO
							RElSRUNULCBPUiBDT05T
							RVFVRU5USUFMIERBTUFH
							RVMgT1IgQU5ZIERBTUFH
							RVMgV0hBVFNPRVZFUiBS
							RVNVTFRJTkcgRlJPTSBM
							T1NTIE9GIFVTRSwgREFU
							QSBPUiBQUk9GSVRTLCBX
							SEVUSEVSIElOIEFOIEFD
							VElPTiBPRiBDT05UUkFD
							VCwgTkVHTElHRU5DRSBP
							UiBPVEhFUiBUT1JUSU9V
							UyBBQ1RJT04sIEFSSVNJ
							TkcgT1VUIE9GIE9SIElO
							IENPTk5FQ1RJT04gV0lU
							SCBUSEUgVVNFIE9SIFBF
							UkZPUk1BTkNFIE9GIFRI
							SVMgU09GVFdBUkUufQEA
							AAAjAAAAAQAAAAcAAABU
							WFQucnRmEAAAAIidy2G2
							AQAAAAAAAAAAAAA=
							</data>
				<key>Title</key>
				<string>License Agreement / Disclaimer</string>
			</dict>
			<dict>
				<key>ActionUID</key>
				<integer>16032941</integer>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>SetVariableToText</string>
				<key>Text</key>
				<string>{}</string>
				<key>Variable</key>
				<string>Instance_VipParameters</string>
			</dict>
			<dict>
				<key>ActionName</key>
				<string>searchFilterMode (default "contains")</string>
				<key>ActionUID</key>
				<integer>16032942</integer>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>SetJSONValue</string>
				<key>Target</key>
				<string>Instance_VipParameters.searchFilterMode</string>
				<key>Text</key>
				<string>contains</string>
			</dict>
			<dict>
				<key>ActionName</key>
				<string>internalTasksMacroUUID</string>
				<key>ActionUID</key>
				<integer>16032943</integer>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>SetJSONValue</string>
				<key>Target</key>
				<string>Instance_VipParameters.internalTasksMacroUUID</string>
				<key>Text</key>
				<string>51FDED47-65E6-4172-84B5-EECE5F774E0D</string>
			</dict>
			<dict>
				<key>ActionName</key>
				<string>macroGroupName</string>
				<key>ActionUID</key>
				<integer>16032944</integer>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>SetJSONValue</string>
				<key>Target</key>
				<string>Instance_VipParameters.macroGroupName</string>
				<key>Text</key>
				<string>%ExecutingThisMacroGroup%</string>
			</dict>
			<dict>
				<key>ActionName</key>
				<string>appDataVariableName</string>
				<key>ActionUID</key>
				<integer>16032945</integer>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>SetJSONValue</string>
				<key>Target</key>
				<string>Instance_VipParameters.appDataVariableName</string>
				<key>Text</key>
				<string>DND__VipAppData</string>
			</dict>
			<dict>
				<key>ActionName</key>
				<string>showParameters (for testing)</string>
				<key>ActionUID</key>
				<integer>16032946</integer>
				<key>Conditions</key>
				<dict>
					<key>ConditionList</key>
					<array>
						<dict>
							<key>ConditionType</key>
							<string>Variable</string>
							<key>Variable</key>
							<string>VIP TESTING Show Parameters</string>
							<key>VariableConditionType</key>
							<string>IsNotEmpty</string>
							<key>VariableValue</key>
							<string>1</string>
						</dict>
					</array>
					<key>ConditionListMatch</key>
					<string>All</string>
				</dict>
				<key>ElseActionListDisclosed</key>
				<false/>
				<key>ElseActions</key>
				<array/>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>IfThenElse</string>
				<key>ThenActions</key>
				<array>
					<dict>
						<key>ActionUID</key>
						<integer>16032947</integer>
						<key>MacroActionType</key>
						<string>SetJSONValue</string>
						<key>Target</key>
						<string>Instance_VipParameters.showParameters</string>
						<key>Text</key>
						<string>%Variable%VIP TESTING Show Parameters%</string>
					</dict>
				</array>
				<key>TimeOutAbortsMacro</key>
				<true/>
			</dict>
			<dict>
				<key>ActionName</key>
				<string>showReloadButton, if specified</string>
				<key>ActionUID</key>
				<integer>16032948</integer>
				<key>Conditions</key>
				<dict>
					<key>ConditionList</key>
					<array>
						<dict>
							<key>ConditionType</key>
							<string>Variable</string>
							<key>Variable</key>
							<string>Local__Show Reload Button _ 1 for yes</string>
							<key>VariableConditionType</key>
							<string>Is</string>
							<key>VariableValue</key>
							<string>1</string>
						</dict>
					</array>
					<key>ConditionListMatch</key>
					<string>All</string>
				</dict>
				<key>ElseActionListDisclosed</key>
				<false/>
				<key>ElseActions</key>
				<array/>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>IfThenElse</string>
				<key>ThenActions</key>
				<array>
					<dict>
						<key>ActionName</key>
						<string>reloadMacroUUID</string>
						<key>ActionUID</key>
						<integer>16032949</integer>
						<key>MacroActionType</key>
						<string>SetJSONValue</string>
						<key>Target</key>
						<string>Instance_VipParameters.showReloadButton</string>
						<key>Text</key>
						<string>1</string>
					</dict>
				</array>
				<key>TimeOutAbortsMacro</key>
				<true/>
			</dict>
			<dict>
				<key>ActionName</key>
				<string>openConsoleMacroUUID (for testing)</string>
				<key>ActionUID</key>
				<integer>16032950</integer>
				<key>Conditions</key>
				<dict>
					<key>ConditionList</key>
					<array>
						<dict>
							<key>ConditionType</key>
							<string>Variable</string>
							<key>Variable</key>
							<string>VIP TESTING Open Console Macro UUID</string>
							<key>VariableConditionType</key>
							<string>IsNotEmpty</string>
							<key>VariableValue</key>
							<string>value</string>
						</dict>
					</array>
					<key>ConditionListMatch</key>
					<string>All</string>
				</dict>
				<key>ElseActionListDisclosed</key>
				<false/>
				<key>ElseActions</key>
				<array/>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>IfThenElse</string>
				<key>ThenActions</key>
				<array>
					<dict>
						<key>ActionUID</key>
						<integer>16032951</integer>
						<key>MacroActionType</key>
						<string>SetJSONValue</string>
						<key>Target</key>
						<string>Instance_VipParameters.openConsoleMacroUUID</string>
						<key>Text</key>
						<string>%Variable%VIP TESTING Open Console Macro UUID%</string>
					</dict>
				</array>
				<key>TimeOutAbortsMacro</key>
				<true/>
			</dict>
			<dict>
				<key>ActionName</key>
				<string>includeAccessedVariables</string>
				<key>ActionUID</key>
				<integer>16032952</integer>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>SetJSONValue</string>
				<key>Target</key>
				<string>Instance_VipParameters.includeAccessedVariables</string>
				<key>Text</key>
				<string>%Variable%Local__Accessed Variables _ 1 for yes%</string>
			</dict>
			<dict>
				<key>ActionName</key>
				<string>allDictionaryNames and dictionaryNames</string>
				<key>ActionUID</key>
				<integer>16032953</integer>
				<key>Conditions</key>
				<dict>
					<key>ConditionList</key>
					<array>
						<dict>
							<key>ConditionType</key>
							<string>Variable</string>
							<key>Variable</key>
							<string>Local__Dictionary Names _ or all</string>
							<key>VariableConditionType</key>
							<string>Is</string>
							<key>VariableValue</key>
							<string>all</string>
						</dict>
					</array>
					<key>ConditionListMatch</key>
					<string>All</string>
				</dict>
				<key>ElseActions</key>
				<array>
					<dict>
						<key>ActionColor</key>
						<string>Green</string>
						<key>ActionName</key>
						<string>dictionaryNames</string>
						<key>ActionUID</key>
						<integer>16032957</integer>
						<key>MacroActionType</key>
						<string>SetJSONValue</string>
						<key>Target</key>
						<string>Instance_VipParameters.dictionaryNames</string>
						<key>Text</key>
						<string>%Variable%Local__Dictionary Names _ or all%</string>
					</dict>
				</array>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>IfThenElse</string>
				<key>ThenActions</key>
				<array>
					<dict>
						<key>ActionColor</key>
						<string>Green</string>
						<key>ActionName</key>
						<string>allDictionaryNames</string>
						<key>ActionUID</key>
						<integer>16032954</integer>
						<key>Actions</key>
						<array>
							<dict>
								<key>ActionUID</key>
								<integer>16032955</integer>
								<key>DisplayKind</key>
								<string>Variable</string>
								<key>HonourFailureSettings</key>
								<true/>
								<key>IncludeStdErr</key>
								<true/>
								<key>IncludedVariables</key>
								<array>
									<string>9999</string>
								</array>
								<key>MacroActionType</key>
								<string>ExecuteAppleScript</string>
								<key>NotifyOnFailure</key>
								<false/>
								<key>Path</key>
								<string></string>
								<key>StopOnFailure</key>
								<false/>
								<key>Text</key>
								<string>tell application "Keyboard Maestro Engine"
	get name of dictionaries
end tell</string>
								<key>TimeOutAbortsMacro</key>
								<true/>
								<key>TrimResults</key>
								<true/>
								<key>TrimResultsNew</key>
								<true/>
								<key>UseText</key>
								<true/>
								<key>Variable</key>
								<string>Local_AllDictionaryNames</string>
							</dict>
							<dict>
								<key>ActionUID</key>
								<integer>16032956</integer>
								<key>MacroActionType</key>
								<string>SetJSONValue</string>
								<key>Target</key>
								<string>Instance_VipParameters.allDictionaryNames</string>
								<key>Text</key>
								<string>%Variable%Local_AllDictionaryNames%</string>
							</dict>
						</array>
						<key>MacroActionType</key>
						<string>Group</string>
						<key>TimeOutAbortsMacro</key>
						<true/>
					</dict>
				</array>
				<key>TimeOutAbortsMacro</key>
				<true/>
			</dict>
			<dict>
				<key>ActionName</key>
				<string>allGlobalVariableNames and variableNames</string>
				<key>ActionUID</key>
				<integer>16032958</integer>
				<key>Conditions</key>
				<dict>
					<key>ConditionList</key>
					<array>
						<dict>
							<key>ConditionType</key>
							<string>Text</string>
							<key>Text</key>
							<string>%Variable%Local__Variable Names _ or ALL%</string>
							<key>TextConditionType</key>
							<string>Is</string>
							<key>TextValue</key>
							<string>all</string>
						</dict>
					</array>
					<key>ConditionListMatch</key>
					<string>All</string>
				</dict>
				<key>ElseActions</key>
				<array>
					<dict>
						<key>ActionColor</key>
						<string>Green</string>
						<key>ActionName</key>
						<string>variableNames</string>
						<key>ActionUID</key>
						<integer>16032963</integer>
						<key>MacroActionType</key>
						<string>SetJSONValue</string>
						<key>Target</key>
						<string>Instance_VipParameters.variableNames</string>
						<key>Text</key>
						<string>%Variable%Local__Variable Names _ or ALL%</string>
					</dict>
				</array>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>IfThenElse</string>
				<key>ThenActions</key>
				<array>
					<dict>
						<key>ActionColor</key>
						<string>Green</string>
						<key>ActionName</key>
						<string>allGlobalVariableNames, no variableNames</string>
						<key>ActionUID</key>
						<integer>16032959</integer>
						<key>Actions</key>
						<array>
							<dict>
								<key>ActionName</key>
								<string>Fill Local_GlobalVariableNames</string>
								<key>ActionUID</key>
								<integer>16032960</integer>
								<key>DisplayKind</key>
								<string>AppendVar</string>
								<key>HonourFailureSettings</key>
								<true/>
								<key>IncludeStdErr</key>
								<true/>
								<key>IncludedVariables</key>
								<array>
									<string>9999</string>
								</array>
								<key>IsDisclosed</key>
								<false/>
								<key>MacroActionType</key>
								<string>ExecuteAppleScript</string>
								<key>NotifyOnFailure</key>
								<false/>
								<key>Path</key>
								<string></string>
								<key>StopOnFailure</key>
								<false/>
								<key>Text</key>
								<string>tell application "Keyboard Maestro Engine"
	get name of variables
end tell</string>
								<key>TimeOutAbortsMacro</key>
								<true/>
								<key>TrimResults</key>
								<true/>
								<key>TrimResultsNew</key>
								<true/>
								<key>UseText</key>
								<true/>
								<key>Variable</key>
								<string>Local_GlobalVariableNames</string>
							</dict>
							<dict>
								<key>ActionName</key>
								<string>allGlobalVariableNames</string>
								<key>ActionUID</key>
								<integer>16032961</integer>
								<key>IsDisclosed</key>
								<false/>
								<key>MacroActionType</key>
								<string>SetJSONValue</string>
								<key>Target</key>
								<string>Instance_VipParameters.allGlobalVariableNames</string>
								<key>Text</key>
								<string>%Variable%Local_GlobalVariableNames%</string>
							</dict>
						</array>
						<key>MacroActionType</key>
						<string>Group</string>
						<key>TimeOutAbortsMacro</key>
						<true/>
					</dict>
					<dict>
						<key>ActionColor</key>
						<string>Green</string>
						<key>ActionName</key>
						<string>variableNames (needs to be initialized to an empty string)</string>
						<key>ActionUID</key>
						<integer>16032962</integer>
						<key>MacroActionType</key>
						<string>SetJSONValue</string>
						<key>Target</key>
						<string>Instance_VipParameters.variableNames</string>
						<key>Text</key>
						<string></string>
					</dict>
				</array>
				<key>TimeOutAbortsMacro</key>
				<true/>
			</dict>
			<dict>
				<key>ActionName</key>
				<string>isAsync</string>
				<key>ActionUID</key>
				<integer>16032964</integer>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>SetJSONValue</string>
				<key>Target</key>
				<string>Instance_VipParameters.isAsync</string>
				<key>Text</key>
				<string>%Variable%Local__Async _ 1 for yes%</string>
			</dict>
			<dict>
				<key>ActionName</key>
				<string>canHideVariables</string>
				<key>ActionUID</key>
				<integer>16032965</integer>
				<key>Conditions</key>
				<dict>
					<key>ConditionList</key>
					<array>
						<dict>
							<key>ConditionType</key>
							<string>Variable</string>
							<key>Variable</key>
							<string>Local__Can Hide Variables _ 1 for yes</string>
							<key>VariableConditionType</key>
							<string>Is</string>
							<key>VariableValue</key>
							<string>1</string>
						</dict>
					</array>
					<key>ConditionListMatch</key>
					<string>All</string>
				</dict>
				<key>ElseActionListDisclosed</key>
				<false/>
				<key>ElseActions</key>
				<array/>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>IfThenElse</string>
				<key>ThenActions</key>
				<array>
					<dict>
						<key>ActionUID</key>
						<integer>16032966</integer>
						<key>MacroActionType</key>
						<string>SetJSONValue</string>
						<key>Target</key>
						<string>Instance_VipParameters.canHideVariables</string>
						<key>Text</key>
						<string>1</string>
					</dict>
				</array>
				<key>TimeOutAbortsMacro</key>
				<true/>
			</dict>
			<dict>
				<key>ActionName</key>
				<string>htmlFilePath, deleteTempHtmlFile</string>
				<key>ActionUID</key>
				<integer>16032967</integer>
				<key>Actions</key>
				<array>
					<dict>
						<key>ActionName</key>
						<string>Use either the Production or Development HTML file.</string>
						<key>ActionUID</key>
						<integer>16032968</integer>
						<key>Conditions</key>
						<dict>
							<key>ConditionList</key>
							<array>
								<dict>
									<key>ConditionType</key>
									<string>Variable</string>
									<key>Variable</key>
									<string>VIP TESTING Variable Inspector Prompt Path</string>
									<key>VariableConditionType</key>
									<string>IsNotEmpty</string>
									<key>VariableValue</key>
									<string>value</string>
								</dict>
							</array>
							<key>ConditionListMatch</key>
							<string>All</string>
						</dict>
						<key>ElseActions</key>
						<array>
							<dict>
								<key>ActionColor</key>
								<string>Green</string>
								<key>ActionName</key>
								<string>Save HTML file to temp file delete it when done</string>
								<key>ActionUID</key>
								<integer>16032971</integer>
								<key>Actions</key>
								<array>
									<dict>
										<key>ActionUID</key>
										<integer>16032972</integer>
										<key>IsDisclosed</key>
										<false/>
										<key>MacroActionType</key>
										<string>SetJSONValue</string>
										<key>Target</key>
										<string>Instance_VipParameters.htmlFilePath</string>
										<key>Text</key>
										<string>/tmp/VariableInspectorPrompt.html</string>
									</dict>
									<dict>
										<key>ActionUID</key>
										<integer>16032973</integer>
										<key>IsDisclosed</key>
										<false/>
										<key>MacroActionType</key>
										<string>SetVariableToText</string>
										<key>ProcessingMode</key>
										<string>Nothing</string>
										<key>Text</key>
										<string>&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;title&gt;Variable Inspector Prompt&lt;/title&gt;
		&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;

&lt;style type="text/css"&gt;
/* #region ======== Content Styles ========================== */
html,
body,
.page {
	height: 100%;
}

body {
	overflow: hidden;
	margin: 0;
	font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
	font-size: 14px;
	width: 100%;
	height: 100%;
}

#optionsMenu {
	position:absolute;
	top:5px;
	left:8px;
	font-size: 0.85em;
}

.optionsMenuDisabled {
	cursor: not-allowed !important;
	pointer-events: none !important;
	color: #cbcbcb !important;
}

#openConsole {
	position:absolute;
	top:5px;
	right:10px;
	font-size: 0.75em;
}

#version {
	position:absolute;
	bottom:10px;
	left:10px;
	font-size: 0.75em;
	text-align: right;
}

.page {
	display: flex;
	flex-direction: column;
}

header, footer {
	background: #ececec;
	color: black;
}

header {
	flex: 0 0 auto;
	min-height: 70px;
	padding-right: 58px; /* width of icon cell */
}

#divHeader {
	font-size: 14px;
	display: flex;
	flex-direction: row;
	justify-content: center;
}

#imgIcon {
	flex: 0 0 auto;
	width: 48px;
	height: 48px;
	transform: translate(13px, 12px);
}

#hHeader {
	flex: 0 0 auto;
}

#content {
	flex: 1 1 auto;
	display: flex;
	flex-direction: row;
	padding-left: 20px;
	padding-right: 20px;
	background: #ececec;
}

#divVariables {
	flex: 1 1 auto;
	display: flex;
	flex-direction: column;
	width: 333px;
	min-width: 333px;
	/* margin-right: 15px; */
	box-sizing: border-box;
}

input:disabled {
	background: #dddddd;
}

#divVariables input {
	font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
	font-size: 1em;
	flex: 0 0 auto;
	margin-bottom: 5px;
}

#divSelVariables {
	flex: 1 1 auto;
	/* border: 1px solid red; */
	display: block;
	padding: 2px;
	overflow: hidden;
}

#selVariables {
	flex: 1 1 auto;
	font-weight: 400;
	color: black;
	font-size: 1em;
	width: 100%;
	height: 1px;
}

#selVariables option[data-hidden-variable] {
	background-color: #FEEFB3;
}

#divValue {
	flex: 1 1 auto;
	display: flex;
	flex-direction: column;
	width: 200px;
	box-sizing: border-box;
	min-height: 0;
	min-width: 200px;
}

#divDictionary {
	flex: 1 1 auto;
	overflow-y: auto;
	overflow-x:hidden;
	height: 1px;
}

textarea {
	flex: 1 1 auto;
	font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
	font-size: 1em;
}

textArea:read-only {
	background-color: #ececec;
}

.fixedFont {
	font-family: monospace !important;
}

.errorMessage {
	color: red;
}

footer {
	flex: 0 0 auto;
	min-height: 50px;
	padding-top: 10px;
	padding-right: 20px;
	padding-left: 20px;
}

footer a {
	float: right;
	margin-left: 5px;
	width: 3.5em;
	text-align: center;
}

.invisible {
	visibility: hidden !important;
}

.hidden {
	display: none !important;
}

.disabled {
	cursor: not-allowed !important;
	pointer-events: none !important;
	color: #cbcbcb !important;
	background-color: #cbcbcb !important;
	border:2px solid #cbcbcb !important;
}

.pseudoDisabled {
	/* color: #cbcbcb !important; */
	color: gray !important;
	/* background-color: #dcdcdc !important; */
	background: #dcdcdc !important;
	/* border:3px solid #cbcbcb !important; */
}

.divUIBusy {
	position: fixed;
	top: 0;
	right: 0;
	bottom: 0;
	left: 0;
	background: rgba(0, 0, 0, 0.4);
	z-index: 90000;
	animation: divUIBusyFadeIn ease 900ms;	
}

@keyframes divUIBusyFadeIn {
	0% {
	  opacity:0;
	}
	80% {
		opacity:0;
	}
	100% {
	  opacity:1;
	}
  }

.divUIBusyHidden {
	visibility: hidden;
	opacity: 0;
}

.divUIBusyVisible {
	visibility: visible;
	opacity: 1;
}

/* #endregion */

/* #region ======== Status Line ============================= */

.statusLine {
	flex: 0 0;
	display: flex;
	flex-direction: row;
	/* flex-basis: 25px; */
	flex-basis: 2em;
	border: 1px solid #84bbf3;
	margin-left: 2px;
	margin-right: 2px;
}

.statusPanel {
	margin-top: 0.35em;
	margin-left: 5px;
	vertical-align: middle;
	transform-origin: 1em;
}

.statusPanelContainer {
	flex: 0 1 auto;
	display: flex;
	flex-direction: row;
	margin-left: 3px;
}

.statusPanelContainer table {
	border-collapse: collapse;
	border-spacing: 1px;
	margin-right: 7px;
	height: 100%
}

.statusPanelContainer td {
	vertical-align: middle;
}

.statusText {
	padding-left: 2px;
	padding-top: 3px;
}

.statusCountSVG {
	padding-left: 2px;
	display: block;
	position: relative;
	top: 0px;
	height: 18px;
}

.statusFilterSVG {
	padding-left: 2px;
	display: block;
	position: relative;
	top: 0px;
	height: 16px;
}

.statusHiddenSVG {
	padding-left: 2px;
	display: block;
	position: relative;
	top: 0px;
	height: 16px;
}

.statusSelectedSVG {
	padding-left: 2px;
	display: block;
	position: relative;
	top: 0px;
	height: 16px;
}

#spanStatusMessage {
	color: blue;
}

/* #endregion */

/* #region ======== Info Boxes ============================== */

div.info, div.success, div.warning, div.error {
border: 1px solid;
margin-bottom: 3px;
margin-left: 2px;
margin-right: 2px;
padding-left: 8px;
padding-bottom: 2px;
border-radius: 2px;
flex: 0 0 auto;
}

.infoText {

}

.infoBoxIcon {
display: inline-block;
position: relative;
bottom: -2px;
font-size: 18px;
}

div.info {
color: #00529b;
background-color: #bde5f8;
}

div.success {
color: #4f8a10;
background-color: #dff2bf;
}

div.warning {
color: black;
background-color: #FEEFB3;
}

div.error {
color: #D8000C;
background-color: #FFBABA;
}

#divFloatingWarningContainer {
	position: fixed;
	top: 18px;
	left: 18px;
	height: 50px;
	display: flex;
	flex-direction: column;
	align-items: left;
	justify-content: center;
	z-index: 1;
}

#divFloatingWarning {
	flex: 0;
	border: 1px solid;
	padding-left: 5px;
	padding-right: 4px;
	padding-bottom: 0px;
	border-radius: 5px;
	color: black;
	background-color: #FEEFB3;
	position: fixed;
}

#divFloatingWarning td {
	vertical-align: top;
}

#divFloatingWarning td:first-child {
	font-size: 18px;
	padding-right: 3px;
}

#divFloatingWarning td:nth-child(2) {
	padding-top: 3px;
}

#divFloatingWarning td:last-child {
	padding-left: 6px;
	font-size: 0.9em;
}

#divFloatingWarning td:last-child a {
	text-decoration: none;
}

/* #endregion */

/* #region ======== Animations ============================== */

.scale-in-center {
	opacity: 1;
	animation: scale-in-center 0.35s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;	
}

.popup-in-center {
	opacity: 1;
	animation: popup-in-center 0.5s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;	
}

.fade-out {
	opacity: 0;
	animation: fade-out 0.35s ease-out both;
}

/* ----------------------------------------------
 * Generated by Animista on 2022-1-11 12:7:7
 * Licensed under FreeBSD License.
 * See http://animista.net/license for more info. 
 * w: http://animista.net, t: @cssanimista
 * ---------------------------------------------- */

/**
 * ----------------------------------------
 * animation scale-in-center
 * ----------------------------------------
 */
  @keyframes scale-in-center {
	0% {
		transform: scale(0);
		opacity: 1;
	}
	100% {
		transform: scale(1);
	  	opacity: 1;
	}
  }

/**
 * ----------------------------------------
 * animation popup-in-center
 * ----------------------------------------
 */
 @keyframes popup-in-center {
	0% {
		transform: scale(0);
		opacity: 1;
	}
	75% {
		transform: scale(1.1);
		opacity: 1;
	}
	80% {
		transform: scale(1.1);
		opacity: 1;
	}
	100% {
		transform: scale(1);
		opacity: 1;
	}
  }

  /* ----------------------------------------------
 * Generated by Animista on 2022-1-11 12:10:8
 * Licensed under FreeBSD License.
 * See http://animista.net/license for more info. 
 * w: http://animista.net, t: @cssanimista
 * ---------------------------------------------- */

/**
 * ----------------------------------------
 * animation fade-out
 * ----------------------------------------
 */
  @keyframes fade-out {
	0% {
	  opacity: 1;
	}
	100% {
	  opacity: 0;
	}
  }
  
/* #endregion */

/* #region ======== Splitter Styles ========================= */

.splitter {
width: 20px;
padding: 0;
cursor: ew-resize;
flex: 0 0 auto;
}

.splitter::before {
content: '';
display: block;
width: 6px;
height: 100%;
background: #d1d1d1;
margin-top: 38px;
margin-bottom: 2px;
margin-left: auto;
margin-right: auto;
}
		
/* #endregion */

/* #region ======== Dictionary Table Styles ================= */

table.tblDictionary {
	border:1px solid #84bbf3;
	width: 100%;
	text-align: left;
	border-collapse: collapse;
	table-layout:fixed;
}

table.tblDictionary td, table.tblDictionary th {
	border: 1px solid #AAAAAA;
	padding: 5px 4px;
	word-wrap:break-word;
	vertical-align: top;
}

table.tblDictionary thead {
	border-top-left-radius: 6px;
	background-color:#79bbff;
	background:linear-gradient(to bottom, #79bbff 5%, #378de5 100%);
	border-bottom: 1px solid #444444;
}

table.tblDictionary thead th {
	font-size: 14px;
	/* font-weight: bold; */
	color: #FFFFFF;
	border-left: 2px solid #D0E4F5;
	cursor:pointer;
	position: relative;
}

table.tblDictionary thead th:hover:not([data-resizing]):not(:first-child) {
	background:linear-gradient(to bottom, #378de5 5%, #79bbff 100%);
}

table.tblDictionary thead th:active {
	position:relative;
	top:1px;
}

table.tblDictionary thead th:first-child {
	border-left: none;
	border-right: none;
	max-width: 25px;
	width: 25px;
}

table.tblDictionary thead th:nth-child(2) {
	border-left: none;
	width: 150px;
	min-width: 80px;
	padding-right: 20px !important;
}

.resize-handle {
	position: absolute;
	top: 0;
	right: 0;
	bottom: 0;
	background: black;
	opacity: 0;
	width: 5px;
	cursor: col-resize;
}
   
.resize-handle:hover,
.resize-handle:active {
	opacity: 0.5;
}

.selectableRow {
	transition: all 0.4s linear;
}

.selectedRow {
	background-color: yellow !important;
	/* transition: none; */
}

table.tblDictionary tbody td {
	font-size: 1em;
}

table.tblDictionary tbody td:first-child {
	border-right: none !important;
}

table.tblDictionary tbody td:first-child a {
	text-decoration: none;
}

table.tblDictionary tbody td:nth-child(2) {
	border-left: none !important;
}

.dictCell {
	padding-top: 7px !important;
}

.dictDeleteCell {
}

.trashCan {
}

.trashCanEnabled::before {
	content: url('data:image/svg+xml; utf8, &lt;svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16"&gt; &lt;path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/&gt; &lt;path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/&gt; &lt;/svg&gt;');
	fill: red;
	width: 16px;
	height: 16px;
	display: block;
	margin: 2px;
}

.trashCanDisabled::before {
	content: url('data:image/svg+xml; utf8, &lt;svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#a7a7a7" class="bi bi-trash" viewBox="0 0 16 16"&gt; &lt;path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/&gt; &lt;path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/&gt; &lt;/svg&gt;');
	width: 16px;
	height: 16px;
	display: block;
	margin: 2px;
}

.trashCanDisabled {
	cursor: not-allowed !important;
	pointer-events: none !important;
}

.dictKeyCell {
	transition: background-color 0.4s linear;
}

.dictValueCell {
	transition: background-color 0.4s linear;
}

.selectedCell {
	background-color: yellow !important;
}

.dictCellContent {
}

.dictCellContentUndeleted {
/* 
	max-height: 100px;
	transition: max-height 0.6s, padding 0.6s;
*/
}

.dictCellEdit {
	background-color: white;
}

.dictCellError {
	border-radius: 3px;
	margin-top: 7px;
	padding: 5px;
	padding-left: 10px;
	background-color: red;
	color: white;
}

table.tblDictionary tr:nth-child(even) {
	background: #D0E4F5;
}
/* #endregion */

/* #region ======== Tool Tip Styles ========================= */
.tooltip {
	position: relative;
	display: inline-block;
}

/* 
I'm sure theres a way to have the left, right, and center classes
without repeating the entire class each time, but I couldn't figure it out.
*/

.tooltipText {
	font-size: 0.9em;
	visibility: hidden;
	width: 9em;
	background-color: #636363;
	color: #fff;
	text-align: center;
	border-radius: 6px;
	padding: 0.3em 0.3em;
	position: absolute;
	z-index: 1;
	bottom: 140%;
}

.tooltip .tooltipTextCenter {
	left: 50%;
	margin-left: -5em; /* -60px */
}

.tooltip .tooltipTextCenter::after {
	content: "";
	position: absolute;
	top: 100%;
	left: 50%;
	margin-left: -5px;
	border-width: 5px;
	border-style: solid;
	border-color: #636363 transparent transparent transparent;
}

.tooltip .tooltipTextRight {
	left: 100%;
	margin-left: -2.5em; /* -30px; */
}

.tooltip .tooltipTextRight::after {
	content: "";
	position: absolute;
	top: 100%;
	right: 90%;
	margin-right: -5px;
	border-width: 5px;
	border-style: solid;
	border-color: #636363 transparent transparent transparent;
}

.tooltip .tooltipTextLeft {
	right: 100%;
	margin-right: -2.5em; /* -30px; */
}

.tooltip .tooltipTextLeft::after {
	content: "";
	position: absolute;
	top: 100%;
	left: 85%;
	margin-right: -5px;
	border-width: 5px;
	border-style: solid;
	border-color: #636363 transparent transparent transparent;
}

/* NOTE: If you're NOT using my "TooltipFadeInAnimator", then un-comment this: */
/*
.tooltip:hover .tooltipTextCenter {
	visibility: visible;
}
*/
/* #endregion */

/* #region ======== Button Styles =========================== */
.divToolButtonsWrap {
	flex: 0 0;
	display: inline-block;
	flex-direction: row;
	flex-basis: 32px;
	margin-bottom: 5px;
	align-items: center;
}

.divToolButtons {
	flex: 0 0;
	display: flex;
	flex-direction: row;
	flex-basis: 32px;
	margin-bottom: 5px;
	align-items: center;
}

.btnToolSeparator {
	margin-top: 3px;
	flex: 0;
	height: 28px;
	border-radius:6px;
	/* width: 13px; */
}

.btnToolSeparator svg {
	display: inline-block;
	transform: translateX(1px);
	padding-left: 2px;
	padding-right: 1px;
	width: 4px;
	height: 28px;
	color: #84bbf3;
}

.btnTool {
	margin-top: 3px;
	margin-left: 1px;
	margin-right: 1px;
	flex: 0;
	height: 28px;
	background-color:#ffffff;
	border-radius:6px;
	border:2px solid #84bbf3;
}

.divToolButtonsWrap .btnTool {
	margin-right: -3px !important;
}

#btnDeleteVariables {
	width: 27px;
	height: 28px;
}

#btnSort[data-sort-by-name=true] #imgSortByName {
	display:inline;
}
#btnSort[data-sort-by-name=true] #imgSortBySize {
	display: none;
}
#btnSort[data-sort-by-name=false] #imgSortByName {
	display: none;
}
#btnSort[data-sort-by-name=false] #imgSortBySize {
	display: inline;
}

.btnToolHelp {
	flex: 0 1 auto !important;
	font-size: 14px;
	padding-right: 10px;
	color: black;
	text-decoration:none;
}

.btnToolHelp svg {
	vertical-align: middle;
}

.btnToolHover:hover {
	border:2px solid #84bbf3;
	box-shadow: 0px 1px 5px 0px #8C1F13;
}

.btnToolHover:active {
	position:relative;
	top:1px;
}

.btnToolLeft {
	/* margin-right: 1px; */
}

.btnToolLeft:hover {
	/* margin-right: 5px !important;
	margin-left: 3px !important */
}

.btnToolRight {
	margin-left: 1px;
}

.btnToolRight:hover {
	/* margin-right: 3px !important;
	margin-left: 5px !important */
}

.btnTool svg {
	padding: 3px;
	width: 22px;
	height: 22px;
}

/* .svgFontSize {
	transform: translateY(-1px);
} */

.btnTool #imgDeleteVariables {
	padding-left: 2px;
	padding-right: 4px;
	padding-top: 3px;
	padding-bottom: 3px;
	width: 22px;
	height: 22px;
}

.btnToolSpacer {
	flex: 1 1 auto;
}

/*.btnToolDown:not(.disabled):not(:hover) {*/
 .btnToolDown {
	border:2px solid rgb(82, 85, 251) !important;
	background-color:#00ff00 !important;
}

.okButton {
	box-shadow:inset 0px 1px 0px 0px #bbdaf7;
	background:linear-gradient(to bottom, #79bbff 5%, #378de5 100%);
	background-color:#79bbff;
	border-radius:6px;
	border:1px solid #84bbf3;
	display:inline-block;
	cursor:pointer;
	color:#ffffff;
	font-family:Arial;
	font-size:1.1em;
	font-weight:bold;
	padding:6px 24px;
	text-decoration:none;
	text-shadow:0px 1px 0px #528ecc;
}
.okButton:hover {
	background:linear-gradient(to bottom, #378de5 5%, #79bbff 100%);
	background-color:#378de5;
}
.okButton:active {
	position:relative;
	top:1px;
}

.cancelButton {
	box-shadow:inset 0px 1px 0px 0px #ffffff;
	background:linear-gradient(to bottom, #ffffff 5%, #f6f6f6 100%);
	background-color:#ffffff;
	border-radius:6px;
	border:1px solid #dcdcdc;
	display:inline-block;
	cursor:pointer;
	color:#666666;
	font-family:Arial;
	font-size: 1.1em;
	font-weight:bold;
	padding:6px 24px;
	text-decoration:none;
	text-shadow:0px 1px 0px #ffffff;
}
.cancelButton:hover {
	background:linear-gradient(to bottom, #f6f6f6 5%, #ffffff 100%);
	background-color:#f6f6f6;
}
.cancelButton:active {
	position:relative;
	top:1px;
}

.reloadButton {
	box-shadow:inset 0px 1px 0px 0px #caefab;
	background:linear-gradient(to bottom, #77d42a 5%, #5cb811 100%);
	background-color:#77d42a;
	border-radius:6px;
	border:1px solid #268a16;
	display:inline-block;
	cursor:pointer;
	color:#306108;
	font-family:Arial;
	font-size:1.1em;
	font-weight:bold;
	padding:6px 24px;
	text-decoration:none;
	text-shadow:0px 1px 0px #aade7c;
}
.reloadButton:hover {
	background:linear-gradient(to bottom, #5cb811 5%, #77d42a 100%);
	background-color:#5cb811;
}
.reloadButton:active {
	position:relative;
	top:1px;
}
		
/* #endregion */

/* #region ======== modalDialogBox Styles =================== */
.modalDialog {
	position: fixed;
	font-family: Arial, Helvetica, sans-serif;
	font-size: 14px;
	top: 0;
	right: 0;
	bottom: 0;
	left: 0;
	background: rgba(0, 0, 0, 0.8);
	z-index: 99999;
	transition: opacity 100ms ease-in, background 200ms ease-in;
	/* transition: background 200ms ease-in; */
}
/* 
.modalOptionsDialog {
	background: rgba(0, 0, 0, 0.4) !important;
}
 */
.modalOptionsDialogTransparent {
	background: rgba(0, 0, 0, 0.1) !important;
}

.modalDialogHidden {
	opacity: 0;
	pointer-events: none;
}

.modalDialogVisible {
	opacity: 1;
	pointer-events: auto;
}

.modalDialogBox {
	width: 405px;
	position: fixed;
	left: 50%;
	top: 50%;
	transform: translate(-50%, -50%);
	padding: 0;
	padding-top: 15px;
	padding-bottom: 15px;
	padding-left: 0;
	padding-right: 0;
	border-radius: 10px;
	background: #ececec;
	border: 1px solid darkgray;
	box-shadow: 2px 2px 5px 0px #696775;
	/*background:linear-gradient(to bottom, #ececec 5%, #999 90%);*/
}

.modalDialogHeader span {
	font-size: 1.2em;
	font-weight: bold;
	margin-left: 20px;
}

.modalDialogBody {
	font-size: 1em;
	margin-top: 0;
	margin-left: 15px;
	margin-right: 15px;
	margin-bottom: 15px;
	overflow: auto;
}

.modalDialogBody h2 {
	text-align: center;
	margin-top: 0;
}

.modalDialogInputTable {
	width: 100%;
}

.modalDialogInputTable input {
	font-size: 1em;
	width: 98%; /* I don't know why 100% doesn't work right, but this is good enough.   */
}

.modalDialogIconTable td:first-child {
	padding-right: 10px;
}

.modalDialogFooter {
	margin-right: 15px;
}

.modalDialogBox .dialogBottomButton {
	float: right;
	width: 70px;
	margin-left: 5px;
	text-align: center;
}

#editBoxDialogCheckboxCell{
	width: 20px;
}

.divOptionsTable {
	border: 1px solid red;
	/* display: block; */
	height: 100%;
	width: 100%
}

table.tblOptions {
	border:1px solid #84bbf3;
	width: 100%;
	text-align: left;
	border-collapse: collapse;
	table-layout:fixed;
}

table.tblOptions tr:nth-child(even) {
	background: #f5f5f5;
}

table.tblOptions td {
	border: 1px solid #AAAAAA;
	padding: 5px 4px;
	word-wrap:break-word;
	vertical-align: middle;
}
table.tblOptions td:first-child {
	/* width: fit-content; */
}
table.tblOptions td:last-child {
	width: 7em;
}

.tblOptionsButtonSmall {
	box-shadow:inset 0px 1px 0px 0px #bbdaf7;
	background:linear-gradient(to bottom, #79bbff 5%, #378de5 100%);
	background-color:#79bbff;
	border:1px solid #84bbf3;
	color:#ffffff;
	border-radius:4px;
	margin-right: -6px;
	margin-top: 3px;
	margin-bottom: 3px;
	display:inline-block;
	cursor:pointer;
	font-family:Arial;
	font-size:16px;
	width: 19px;
	height: 19px;
	text-align: center;
	vertical-align: middle;
	text-decoration:none;
}
.tblOptionsButtonSmall svg {
	padding-left: 1px;
}
.tblOptionsButtonSmallPlus {
	padding-top: 2px;
}
.tblOptionsButtonSmall:hover {
	background:linear-gradient(to bottom, #378de5 5%, #79bbff 100%);
	background-color:#378de5;
}
.tblOptionsButtonSmall:active {
	position:relative;
	top:1px;
}

.tblOptionsButton {
	box-shadow:inset 0px 1px 0px 0px #bbdaf7;
	background:linear-gradient(to bottom, #79bbff 5%, #378de5 100%);
	background-color:#79bbff;
	border:1px solid #84bbf3;
	color:#ffffff;
	border-radius:4px;
	margin-right: -6px;
	margin-top: 3px;
	margin-bottom: 3px;
	display:inline-block;
	cursor:pointer;
	font-family:Arial;
	font-size:13px;
	/* font-weight:bold; */
	padding:3px 7px;
	text-decoration:none;
}
.tblOptionsButton:hover {
	background:linear-gradient(to bottom, #378de5 5%, #79bbff 100%);
	background-color:#378de5;
}
.tblOptionsButton:active {
	position:relative;
	top:1px;
}
       
.dialogOkButton {
	box-shadow:inset 0px 1px 0px 0px #bbdaf7;
	background:linear-gradient(to bottom, #79bbff 5%, #378de5 100%);
	background-color:#79bbff;
	border-radius:6px;
	border:1px solid #84bbf3;
	display:inline-block;
	cursor:pointer;
	color:#ffffff;
	font-family:Arial;
	font-size:1em;
	font-weight:bold;
	padding:6px 0px;
	text-decoration:none;
	text-shadow:0px 1px 0px #528ecc;
}
.dialogOkButton:hover {
	background:linear-gradient(to bottom, #378de5 5%, #79bbff 100%);
	background-color:#378de5;
}
.dialogOkButton:active {
	position:relative;
	top:1px;
}

.dialogCancelButton {
	box-shadow:inset 0px 1px 0px 0px #ffffff;
	background:linear-gradient(to bottom, #ffffff 5%, #f6f6f6 100%);
	background-color:#ffffff;
	border-radius:6px;
	border:1px solid #dcdcdc;
	display:inline-block;
	cursor:pointer;
	color:#666666;
	font-family:Arial;
	font-size:1em;
	font-weight:bold;
	padding:6px 0px;
	text-decoration:none;
	text-shadow:0px 1px 0px #ffffff;
}
.dialogCancelButton:hover {
	background:linear-gradient(to bottom, #f6f6f6 5%, #ffffff 100%);
	background-color:#f6f6f6;
}
.dialogCancelButton:active {
	position:relative;
	top:1px;
}
/* #endregion */

/* #region ======== Sliders (Checkboxes) ==================== */
.switch {
	position: relative;
	display: inline-block;
	width: 30px;
	height: 17px;
	margin-top: 6px;
	margin-bottom: 6px;
  }
  
  .switch input { 
	opacity: 0;
	width: 0;
	height: 0;
  }
  
  .slider {
	position: absolute;
	cursor: pointer;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background-color: #ccc;
  }

  .slider:hover {
	transition: .2s;
  }
  
  .slider:before {
	position: absolute;
	content: "";
	height: 13px;
	width: 13px;
	left: 2px;
	bottom: 2px;
	background-color: white;
  }

  .slider:before:hover {
	transition: .2s;
}
  
  input:checked + .slider {
	background-color: #2196F3;
  }
  
  input:focus + .slider {
	box-shadow: 0 0 1px #2196F3;
  }
  
  input:checked + .slider:before {
	transform: translateX(13px);
  }
  
  /* Rounded sliders */
  .slider.round {
	border-radius: 17px;
  }
  
  .slider.round:before {
	border-radius: 50%;
  }
			  
/* #endregion */
&lt;/style&gt;
&lt;script type="text/javascript"&gt;
'use strict'

/*
	Version History 
	---------------
	3.2 - 	Ping "Internal" macro at startup
			Togglable Buttons remember their state
			Separate JSON states for variables vs. dictionaries.
			UserOptions
				optionsFocusFilterOnStartup
				sortBySizeSelectsFirstVariable option.
				Escape in empty filter closes prompt.
				Hover over font size buttons changes background.
				FontSize stored in UserOptions
			Dialogs can scroll if needed.

	3.1 - Consolidate "Internal" macros into one macro.
	3.0 - Hide Variables and a bunch of other stuff.
	2.0 - Dictionary Editor
	1.0 - Initial Release
*/
const _version = "3.2";

// #region ======== Prototypes ==============================
	if (!String.prototype.startsWith) {
		String.prototype.startsWith = function (searchString, position) {
			position = position || 0;
			return this.substr(position, searchString.length) === searchString;
		};
	}

	String.prototype.trimTrailingNewlines = function() {
		return this.replace(/\n*$/, "");
	}

	Object.prototype.clone = function() {
		return JSON.parse(JSON.stringify(this));
	}

	Array.prototype.removeDups = function() {
		return this.reduce((prev, curr) =&gt; {
			if (curr &amp;&amp; prev.indexOf(curr) &lt; 0)
				prev.push(curr);
			return prev;
		}, []);
	}

	Node.prototype.hasClass = function(className) {
		return this.classList.contains(className);
	};

	Node.prototype.toggleClass = function(className, add) {
		if (add) {
			if (!this.classList.contains(className))
				this.classList.add(className);
			return true;
		}

		this.classList.remove(className);
		return false;
	};

	Node.prototype.swapClasses = function(className1, className2, useClassName1) {
		if (useClassName1 === undefined || useClassName1) {
			this.classList.remove(className2);
			if (!this.classList.contains(className1))
				this.classList.add(className1);
		} else {
			this.classList.remove(className1);
			if (!this.classList.contains(className2))
				this.classList.add(className2);
		}
	};

	Node.prototype.setVisible = function(showElement) {
		return !this.toggleClass("hidden", !showElement);
	}

	Node.prototype.isVisible = function () {
		return !this.hasClass("hidden");
	}

	Node.prototype.isEnabled = function(value) {
		return !this.hasClass("disabled");
	}

	Node.prototype.setEnabled = function(value) {
		return !this.toggleClass("disabled", !value);
	}

	Node.prototype.isButtonDown = function() {
		return this.hasClass("btnToolDown");
	}

	Node.prototype.toggleButtonDown = function() {
		return this.toggleClass("btnToolDown", !this.isButtonDown());
	}

	Node.prototype.setButtonDown = function(value) {
		return this.toggleClass("btnToolDown", value);
	}

	HTMLSelectElement.prototype.isEnabled = function() {
		return !this.disabled;
	}

	HTMLSelectElement.prototype.setEnabled = function(value) {
		this.disabled = !value;
		return value;
	}

	HTMLInputElement.prototype.isEnabled = function() {
		return !this.disabled;
	}

	HTMLInputElement.prototype.setEnabled = function(value) {
		this.disabled = !value;
		return value;
	}
// #endregion

// #region ======== AppStateDataController ==================

	var AppStateDataController = (function(variableName, hasTitleBar, isResizable, debugLogFunc) {
		var _variableName = variableName;
		var _hasTitleBar = hasTitleBar != null ? hasTitleBar : true;
		var _isResizable = isResizable != null ? isResizable : false;
		var _debugLogFunc = debugLogFunc;
		var _preSaveCallbacks = null;
		var _additionalData = null;
		var _deserializedData = _deserialize();
		if (_deserializedData.additionalData)
			_additionalData = _deserializedData.additionalData;

		function _log(msg) {
			try {
				if (_debugLogFunc) {
					_debugLogFunc(msg);
				}
			} catch (err) {
				console.log(`Error in _log("${msg}"): ${error.message}`);
			}
		}

		function _logError(error, location) {
			try {
				var msg = "Error";
				if (location)
					msg += ` in ${location}`;
				msg += ` on line: ${error.line}: ${error.message}`;
				_log(msg);
			} catch (err) {
				_log(error);
			}
		}

		function _calculateInt(formula) { return parseInt(window.KeyboardMaestro.Calculate(formula)); }
		function _getWindowLeft() { return _calculateInt("WINDOW(Left)"); }
		function _getWindowTop() { return _calculateInt("WINDOW(Top)"); }
		function _getWindowWidth() { return _calculateInt("WINDOW(Width)"); }
		function _getWindowHeight() { return _calculateInt("WINDOW(Height)"); }
		function _getScreenLeft() { return _calculateInt("SCREENVISIBLE(Main, Left)"); }
		function _getScreenTop() { return _calculateInt("SCREENVISIBLE(Main, Top)"); }
		function _getScreenWidth() { return _calculateInt("SCREENVISIBLE(Main, Width)"); }
		function _getScreenHeight() { return _calculateInt("SCREENVISIBLE(Main, Height)"); }

		function _deserialize() {
			
			function getNextParam() {
				index++;
				if (index &gt;= a.length)
					return null;
				var result = parseInt(a[index]);
				return isNaN(result) ? null : result;
			}

			try {
				if (!_variableName)
					return {};

				var dataString = window.KeyboardMaestro.GetVariable(_variableName);
				if (!dataString)
					return {};

				if (dataString.startsWith("{")) {
					try {
						return JSON.parse(dataString);
					} catch (e) {
						return {};
					}
				}

				// left, top, width, height]
				var a = dataString.split(/,\s*/);
				var index = -1;
				return {
					left: getNextParam(),
					top: getNextParam(),
					width: getNextParam(),
					height: getNextParam()
				};
			} catch (err) {
				_logError(err, "_deserialize");
			}
		}

		function _getAdditionalData(key) {
			if (_additionalData == null)
				return null;
			return _additionalData[key];
		}

		function _registerPreSaveCallback(callback) {
			if (_preSaveCallbacks == null)
				_preSaveCallbacks = [];
			_preSaveCallbacks.push(callback);
		}

		function _serialize(self) {
			try {
				if (!_variableName)
					return;

				if (_preSaveCallbacks) {
					_preSaveCallbacks.forEach(callback =&gt; callback(self));
				}

				var data = {
					left: _getWindowLeft(),
					top: _getWindowTop()
				}
				if (_isResizable) {
					data.width = _getWindowWidth(),
					data.height = _getWindowHeight()
				}
				if (_additionalData != null)
					data.additionalData = _additionalData;

				window.KeyboardMaestro.SetVariable(_variableName, JSON.stringify(data));
			} catch (err) {
				_logError(err, "_serialize");
			}
		}

		function _setAdditionalData(key, value) {
			try {
				if (!value) {
					if (_additionalData != null) {
						delete _additionalData[key];
						if (Object.keys(_additionalData).length == 0)
							_additionalData = null;
					}
				} else {
					if (_additionalData == null)
						_additionalData = {};
					_additionalData[key] = value;
				}
			} catch (err) {
				_logError(err, "_setAdditionalData");
			}
		}

		function _getKMWindowResult(defaultWidth, defaultHeight, defaultHeightIncludesTitleBarHeight) {
			try {
				if (defaultHeight != null &amp;&amp; _hasTitleBar &amp;&amp; !defaultHeightIncludesTitleBarHeight)
					defaultHeight += 16;
			
				var width = _deserializedData.width != null ? _deserializedData.width : defaultWidth != null ? defaultWidth : _getWindowWidth();
				var height = _deserializedData.height != null ? _deserializedData.height : defaultHeight != null ? defaultHeight : _getWindowHeight();
				var left = _deserializedData.left != null ? _deserializedData.left : _getScreenLeft() + Math.max(Math.floor((_getScreenWidth() - width) / 2), 0);
				var top = _deserializedData.top != null ? _deserializedData.top : _getScreenTop() + Math.max(Math.floor((_getScreenHeight() - height) / 2), 0);
	
				return `${left}, ${top + (_hasTitleBar ? 16 : 0)}, ${width}, ${height - (_hasTitleBar ? 16 : 0)}`;
			} catch (err) {
				_logError(err, "_getKMWindowResult");
			}
		}

		return {
			getAdditionalData: function(key) {
				return _getAdditionalData(key);
			},

			getKMWindowResult: function(defaultWidth, defaultHeight, defaultHeightIncludesTitleBarHeight) { 
				return _getKMWindowResult(defaultWidth, defaultHeight, defaultHeightIncludesTitleBarHeight);
			},

			registerPreSaveCallback: function(callback) {
				_registerPreSaveCallback(callback);
			},

			save: function() {
				_serialize(this);
			},

			setDebugLogFunction: function(debugLogFunc) {
				_debugLogFunc = debugLogFunc;
			},

			setAdditionalData: function(key, value) {
				_setAdditionalData(key, value);
			}
		};
	});

	/**
	 * @type AppStateDataController
	 */
	var _appStateDataController;

// #endregion

// #region ======== logDebugMessage and ErrorHandler ========
	var _logDebugMessageEnabled = false;
	var _firstDebugMessage = true;
	function logDebugMessage(message) {
		if (!_logDebugMessageEnabled)
			return;
		try {
			if (_firstDebugMessage) {
				_firstDebugMessage = false;
				window.KeyboardMaestro.Trigger("LogDebugMessage", "=====================================================");
			}
			window.KeyboardMaestro.Trigger("LogDebugMessage", message);
		} catch (e) {
		}
	}

	function dump(obj, desc) {
		logDebugMessage((desc ? desc + ": " : "") + JSON.stringify(obj, null, "\t"));
	}

	var ErrorHandler = (function() {
		return {
			handle: function(error) {
				this.log(this.format(error));
			},

			getErrorLocation: function(error) {
				try {
					var result = [];
					var errorStack = error.stack.split("\n");
					errorStack.forEach(s =&gt; {
						s = decodeURIComponent(s);
						var matches = /^([^@]*).*:(\d*:\d*)$/.exec(s);
						if (matches.length === 3) {
							if (result.length === 1)
								result.push("\nStack Trace:");
							result.push(`${matches[1]} at ${matches[2]}`);
						}
					});
					return result.join("\n");
				} catch {
					return "";
				}
			},

			format: function(error) {
				var at = this.getErrorLocation(error);
				if (at)
					return `${error.message}\nin ${at}`;
				return error.message;
			},

			log: function(str) {
				logDebugMessage(str);
				document.write(str.split("\n").join("&lt;br /&gt;") + "&lt;br / /&gt;");
			}
		};
	})();
	
	function getStackTrace() {
		var result = [];
		var error = new Error("test");
		var errorStack = error.stack.split("\n");
		errorStack.forEach(s =&gt; {
			s = decodeURIComponent(s);
			var matches = /^([^@]*).*:(\d*:\d*)$/.exec(s);
			if (matches.length === 3) {
				result.push(`${matches[1]} at ${matches[2]}`);
			}
		});
		result.splice(0,1);
		return result.join("\n");
	}

	function fname() {
		return (new Error("test")).stack.match(/\n[^@]*/)[0].substring(1);
	}
// #endregion

// #region ======== Modal Dialogs ===========================
		
	// #region ======== SimpleDialogController ==============
		class SimpleDialogController {
			constructor() {
				this._dialog = null;
				this._dialogBox = null;
				this._dialogBody = null;
				this._iconTable = null;
				this._infoIcon = null;
				this._warningIcon = null;
				this._message = null;
				this._dictionaryHelp = null;
				this._options = null;
				this._optionsEscapeInEmptyFilterClosesPromptCheckbox = null;
				this._optionsFocusFilterOnStartupCheckbox = null;
				this._optionsFontSizeButtons = null;
				this._optionsLocalVariables = null;
				this._optionsSortBySizeSelectsFirstVariableCheckbox = null;
				this._btnOptionsFontSizeDecrease = null;
				this._btnOptionsFontSizeIncrease = null;
				this._btnOptionsFontSizeReset = null;
				this._btnOptionsLoadLocalVariables = null;
				this._btnOptionsLoadGlobalVariables = null;
				this._btnOptionsLoadDictionaries = null;
				this._btnOptionsToggleHiddenVariables = null;

				this._okButton = null;
				this._cancelButton = null;
				this._callback = null;
			}

			_init() {
				try {
					if (this._dialog != null)
						return;
					this._dialog = document.getElementById("modalDialog");
					this._dialogBox = document.getElementById("modalDialogBox");
					this._dialogBody = document.getElementById("modalDialogBody");
					this._iconTable = document.getElementById("modalDialogIconTable");
					this._infoIcon = document.getElementById("modalDialogInfoIcon");
					this._warningIcon = document.getElementById("modalDialogWarningIcon");
					this._message = document.getElementById("modalDialogMessage");
					this._dictionaryHelp = document.getElementById("modalDialogDictionaryHelp");
					this._options = document.getElementById("modalDialogOptions");
					this._optionsEscapeInEmptyFilterClosesPromptCheckbox = document.getElementById("optionsEscapeInEmptyFilterClosesPromptCheckbox");
					this._optionsFocusFilterOnStartupCheckbox = document.getElementById("optionsFocusFilterOnStartupCheckbox");
					this._optionsFontSizeButtons = document.getElementById("tdOptionsFontSizeButtons");
					this._optionsLocalVariables = document.getElementById("optionsLocalVariables");
					this._optionsSortBySizeSelectsFirstVariableCheckbox = document.getElementById("optionsSortBySizeSelectsFirstVariableCheckbox");
				
					this._btnOptionsFontSizeDecrease = document.getElementById("btnOptionsFontSizeDecrease");
					this._btnOptionsFontSizeIncrease = document.getElementById("btnOptionsFontSizeIncrease");
					this._btnOptionsFontSizeReset = document.getElementById("btnOptionsFontSizeReset");
					this._btnOptionsLoadLocalVariables = document.getElementById("btnOptionsLoadLocalVariables");
					this._btnOptionsLoadGlobalVariables = document.getElementById("btnOptionsLoadGlobalVariables");
					this._btnOptionsLoadDictionaries = document.getElementById("btnOptionsLoadDictionaries");
					this._btnOptionsToggleHiddenVariables = document.getElementById("btnOptionsToggleHiddenVariables");
					
					this._okButton = document.getElementById("modalDialogOkButton");
					this._cancelButton = document.getElementById("modalDialogCancelButton");
					
					this._btnOptionsFontSizeDecrease.addEventListener("click", () =&gt; this._optionsChangeFontSize(-1));
					this._btnOptionsFontSizeIncrease.addEventListener("click", () =&gt; this._optionsChangeFontSize(1));
					this._btnOptionsFontSizeReset.addEventListener("click", () =&gt; this._optionsChangeFontSize(0));
					this._btnOptionsLoadLocalVariables.addEventListener("click", () =&gt; this.close("loadLocalVariables"));
					this._btnOptionsLoadGlobalVariables.addEventListener("click", () =&gt; this.close("loadGlobalVariables"));
					this._btnOptionsLoadDictionaries.addEventListener("click", () =&gt; this.close("loadDictionaries"));
					this._btnOptionsToggleHiddenVariables.addEventListener("click", () =&gt; this.close("toggleHiddenVariables"));

					this._optionsFontSizeButtons.addEventListener("mouseenter", () =&gt; this._dialog.toggleClass("modalOptionsDialogTransparent", true));
					this._optionsFontSizeButtons.addEventListener("mouseleave", () =&gt; this._dialog.toggleClass("modalOptionsDialogTransparent", false));

					this._okButton.addEventListener("click", () =&gt; this.close("ok"));
					this._cancelButton.addEventListener("click", () =&gt; this.close("cancel"));

					window.addEventListener("resize", () =&gt; this._setMaxHeight());
					this._setMaxHeight();
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			_optionsEnableFontSizeButtons() {
				this._btnOptionsFontSizeDecrease.setEnabled(_fontSizeController.canDecreaseFontSize());
				this._btnOptionsFontSizeIncrease.setEnabled(_fontSizeController.canIncreaseFontSize());
			}

			_optionsChangeFontSize(increment) {
				console.log(`_optionsChangeFontSize increment: ${increment}`);
				if (increment === 0)
					_fontSizeController.resetFontSize();
				else {
					let size = _fontSizeController.getFontSize();
					_fontSizeController.setFontSize(_fontSizeController.getFontSize() + increment);
				}
				this._optionsEnableFontSizeButtons();
			}

			_reset() {
				try {
					if (this.isShowing)
						throw new Error("Modal Dialog is already showing");
					this._init();
					this._dialog.toggleClass("modalOptionsDialog", false);
					// this._dialog.toggleClass("modalOptionsDialogTransparent", false);
					this._iconTable.setVisible(false);
					this._dictionaryHelp.setVisible(false);
					this._options.setVisible(false);
					this._infoIcon.setVisible(false);
					this._warningIcon.setVisible(false);
					this._cancelButton.setVisible(false);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			_setMaxHeight() {
				if (!this._dialog) {
					// this will probably never happen, but better safe that sorry
					return;
				}
				this._dialogBody.style.maxHeight = `${window.innerHeight - 100}px`;
			}

			_show(isInfo, message, callback, messageIsHTML) {
				try {
					this._reset();
					this._iconTable.setVisible(true);
					this._infoIcon.setVisible(isInfo);
					this._warningIcon.setVisible(!isInfo);
					if (messageIsHTML)
						this._message.innerHTML = message;
					else
						this._message.innerText = message;
					this._cancelButton.setVisible(!isInfo);
					this._callback = callback;
					this._dialog.swapClasses("modalDialogVisible", "modalDialogHidden");
					enableControls();
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * @returns {bool}
			 */
			get isShowing() { return this._dialog != null &amp;&amp; this._dialog.hasClass("modalDialogVisible"); }

			/**
			 * Shows the Dictionary Help screen.
			 */
			showDictionaryHelp() {
				try {
					this._reset();
					this._dictionaryHelp.setVisible(true);
					this._callback = null;
					this._dialog.swapClasses("modalDialogVisible", "modalDialogHidden");
					enableControls();
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Shows the Info dialog (no Cancel button)
			 * @param {string} message 
			 * @param {function} [callback] function(result), where result is irrelevant and undefined.
			 * @param {bool} [messageIsHTML] if true, the message is in HTML format.
			 */
			showInfoDialog(message, callback, messageIsHTML) {
				this._show(true, message, callback, messageIsHTML);
				enableControls();
			}

			/**
			 * Shows the OK/Cancel dialog
			 * @param {string} message 
			 * @param {function} callback function(result), where result is "ok" or "cancel"
			 */
			showOkCancelDialog(message, callback) {
				this._show(false, message, callback);
				enableControls();
			}

			/**
			 * Shows the Options dialog.
			 * @param {function} callback function(result), where result is "loadLocalVariables", "loadGlobalVariables",
			 * "loadDictionaries", "toggleHiddenVariables".
			 */
			showOptions(callback) {
				try {
					this._reset();
					this._dialog.toggleClass("modalOptionsDialog", true);
					this._optionsEnableFontSizeButtons();
					this._optionsEscapeInEmptyFilterClosesPromptCheckbox.checked = _userOptions.escapeInEmptyFilterClosesPrompt;
					this._optionsFocusFilterOnStartupCheckbox.checked = _userOptions.focusFilterOnStartup;
					this._optionsLocalVariables.setVisible(!_isAsync);
					this._optionsSortBySizeSelectsFirstVariableCheckbox.checked = _userOptions.sortBySizeSelectsFirstVariable;
					this._options.setVisible(true);
					this._callback = callback;
					this._dialog.swapClasses("modalDialogVisible", "modalDialogHidden");
					enableControls();
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Closes the dialog. You don't normally need to call this yourself.
			 * @param {string} result "ok" or "cancel"
			 * @returns 
			 */
			close(result) {
				try {
					if (!this.isShowing)
						return;
					this._dialog.swapClasses("modalDialogHidden", "modalDialogVisible");
					_userOptions.escapeInEmptyFilterClosesPrompt = this._optionsEscapeInEmptyFilterClosesPromptCheckbox.checked;
					_userOptions.focusFilterOnStartup = this._optionsFocusFilterOnStartupCheckbox.checked;
					_userOptions.sortBySizeSelectsFirstVariable = this._optionsSortBySizeSelectsFirstVariableCheckbox.checked;
					enableControls();
					if (this._callback)
						this._callback(result);
					this._callback = null;
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}
		}

	// #endregion

	// #region ======== EditBoxDialogController =============
		class EditBoxDialogController {
			constructor() {
				this._dialog = null;
				this._title = null;
				this._input = null;
				this._errorMessage = null;
				this._okButton = null;
				this._cancelButton = null;
				this._validateCallback = null;
				this._finishedCallback = null;
			}

			_init() {
				try {
					if (this._dialog != null)
						return;
					this._dialog = document.getElementById("editBoxDialog");
					this._title = document.getElementById("editBoxDialogTitle");
					this._input = document.getElementById("editBoxDialogInput");
					this._checkboxRow = document.getElementById("editBoxDialogCheckboxRow");
					this._checkbox = document.getElementById("editBoxDialogCheckbox");
					this._checkboxLabel = document.getElementById("editBoxDialogCheckboxLabel");
					this._errorMessage = document.getElementById("editBoxDialogErrorMessage");
					this._okButton = document.getElementById("editBoxDialogOkButton");
					this._cancelButton = document.getElementById("editBoxDialogCancelButton");

					this._okButton.addEventListener("click", () =&gt; this.close("ok"));
					this._cancelButton.addEventListener("click", () =&gt; this.close("cancel"));
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Shows the edit box
			 * @param {string} title the edit box title
			 * @param {{initialValue: string, checkboxLabel: string}} [options]
			 * @param {function({text: string, checked: bool}): string} validateCallback 
			 * @param {function({canceled: bool, text: string, checked: bool}): void} finishedCallback 
			 */
			show(title, options, validateCallback, finishedCallback) {
				try {
					options = validateOptions(options, ["initialValue", "checkboxLabel"]);
					if (this.isShowing)
						throw new Error("Edit Box Dialog is already showing");
					this._init();
					this._title.innerText = title;
					this._input.value = "";
					this._errorMessage.innerText = "";
					this._validateCallback = validateCallback;
					this._finishedCallback = finishedCallback;
					if (options.initialValue)
						this._input.value = options.initialValue;
					if (this._checkboxRow.setVisible(options.checkboxLabel != null))
						this._checkboxLabel.innerText = options.checkboxLabel;
					this._dialog.swapClasses("modalDialogVisible", "modalDialogHidden");
					enableControls();
					this._input.focus();
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Close the dialog. You don't need to call this yourself unless there's a specific reason.
			 * @param {string} result "ok" or "cancel"
			 */
			close(result) {
				try {
					if (!this.isShowing)
						return;
						
					var data = {};

					if (result === "ok") {
						data.text = this._input.value.trim();
						if (this._checkboxRow.isVisible())
							data.checked = this._checkbox.checked;
						if (this._validateCallback) {
							let errorMessage = this._validateCallback(data);
							if (errorMessage) {
								this._errorMessage.innerText = errorMessage;
								this._input.focus();
								return;
							}
						}
					} else
						data.canceled = true;
					this._dialog.swapClasses("modalDialogHidden", "modalDialogVisible");
					enableControls();
					if (this._finishedCallback)
						this._finishedCallback(data);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * @returns {bool}
			 */
			get isShowing() { 
				return this._dialog != null &amp;&amp; this._dialog.hasClass("modalDialogVisible");
			}
		}
	// #endregion

	// #region ======== ModalDialogController ===================
			
		class ModalDialogController {
			constructor() {
				this._simplelDialog = new SimpleDialogController();
				this._editBoxDialog = new EditBoxDialogController();
			}

			get isShowing() { return this._simplelDialog.isShowing || this._editBoxDialog.isShowing; }
		
			/**
			 * Shows the Dictionary Help screen.
			 */
			showDictionaryHelp() {
				try {
					if (this.isShowing)
						throw new Error(`Dialog is already showing`);
					this._simplelDialog.showDictionaryHelp();
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Shows the edit box dialog
			 * @param {string} title the edit box title
			 * @param {{initialValue: string, checkboxLabel: string}} [options]
			 * @param {function({text: string, checked: bool}): string} validateCallback 
			 * @param {function({canceled: bool, text: string, checked: bool}): void} finishedCallback 
			 */
			showEditBoxDialog(title, options, validateCallback, finishedCallback) {
				try {
					if (this.isShowing)
						throw new Error("Edit Box Dialog is already showing");
					this._editBoxDialog.show(title, options, validateCallback, finishedCallback);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Shows the Info dialog (no Cancel button)
			 * @param {string} message 
			 * @param {function} [callback] function(result), where result is irrelevant and undefined.
			 * @param {bool} [messageIsHTML] if true, the message is in HTML format.
			 */
			showInfoDialog(message, callback, messageIsHTML) {
				try {
					if (this.isShowing)
						throw new Error(`Dialog is already showing`);
					this._simplelDialog.showInfoDialog(message, callback, messageIsHTML);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Displays the message, then closes the window
			 * @param {string} message 
			 * @param {bool} [messageIsHTML] if true, the message is in HTML format.
			 */
			showMessageAndAbort(message, messageIsHTML) {
				this.showInfoDialog(message, () =&gt; cancelWindow("canceled"), messageIsHTML);
			}

			/**
			 * Shows the OK/Cancel dialog
			 * @param {string} message 
			 * @param {function} callback function(result), where result is "ok" or "cancel"
			 */
			showOkCancelDialog(message, callback) {
				try {
					if (this.isShowing)
						throw new Error(`Dialog is already showing`);
					this._simplelDialog.showOkCancelDialog(message, callback);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Shows the Options dialog.
			 * @param {function} callback function(result), where result is "loadLocalVariables", "loadGlobalVariables",
			 * "loadDictionaries", "toggleHiddenVariables".
			 */
			showOptions(callback) {
				try {
					if (this.isShowing)
						throw new Error("Dialog is already showing");
					this._simplelDialog.showOptions(callback);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Closes the dialog. You don't normally need to call this yourself.
			 * @returns 
			 */
			close(result) {
				try {
					debugger
					if (this._simplelDialog.isShowing)
						this._simplelDialog.close(result);
					if (this._editBoxDialog.isShowing)
						this._editBoxDialog.close(result);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

		}

	// #endregion

	const _modalDialogController = new ModalDialogController();

// #endregion

// #region ======== TooltipFadeInAnimator ===================
	var TooltipFadeInAnimator = (function(delay, duration) {
		var _delay = delay;
		var _duration = duration;
		var _tooltipTextElement = null;
		var _timer = null;
		var _animation = null;

		function _getTooltipTextElement(element) {
			var tooltipText = element.querySelector(".tooltipText");
			if (!tooltipText) {
				console.log(`${element.id} doesn't have a "tooltipText" element`);
				return null;
			}
			return tooltipText;
		}

		function _mouseEnterEvent(event) {
			// In case a tooltip is currently being displayed:
			_hideTooltip();

			_tooltipTextElement = _getTooltipTextElement(event.target);
			_timer = window.setTimeout(() =&gt; _showToolTip(), _delay);
		}

		function _showToolTip() {
			_tooltipTextElement.style.visibility = "visible";
			_animation = _tooltipTextElement.animate([
				{ opacity: 0 },
				{ opacity: 1 }
			], {
				duration: _duration
			});
		}

		function _clearTimer() {
			if (!_timer)
				return;
			clearTimeout(_timer);
			_timer = null;
		}

		function _clearAnimation() {
			if (!_animation)
				return;
			try {
				_animation.cancel();
			} catch {
			}
			_animation = null;
		}

		function _hideTooltip() {
			if (!_tooltipTextElement)
				return;

			_clearTimer();
			_clearAnimation();
			_tooltipTextElement.style.visibility = "hidden";
			_tooltipTextElement = null;
		}

		return {
			// You can pass the element name, or the element object, although
			// I'm only using the name version in this program. This function
			// returns the element object, so you can use it to string (nest)
			// functions.
			attach: function(element) {
				if (typeof element === "string" || element instanceof String)
					element = document.getElementById(element);
				var tooltipText = _getTooltipTextElement(element);
				if (tooltipText) {
					element.addEventListener("mouseenter", _mouseEnterEvent);
					element.addEventListener("mousedown", _hideTooltip);
					element.addEventListener("mouseleave", _hideTooltip);
				}
				return element;
			}
		};
	});
	var _tooltipFadeInAnimator = new TooltipFadeInAnimator(750, 250);
// #endregion

// #region ======== ShowHideAnimator ========================
	/**
	 * @readonly
	 * @enum {string}
	 */
	const ShowAnimation = {
		scaleInCenter: "scale-in-center"
	};

	/**
	 * @readonly
	 * @enum {string}
	 */
	const HideAnimation = {
		fadeOut: "fade-out"
	};

	class ShowHideAnimator {
		/**
		 * 
		 * @param {HTMLElement} element 
		 * @param {ShowAnimation} showClass 
		 * @param {HideAnimation} hideClass 
		 */
		constructor(element, showClass, hideClass) {
			this._element = element;
			this._showClass = showClass;
			this._hideClass = hideClass;
			this._hideTimer = null;
		}

		elementIsVisible() {
			return this._element.isVisible() &amp;&amp; window.getComputedStyle(this._element).getPropertyValue("opacity") != "0";
		}

		/**
		 * Hides the element, with or without animation
		 * @param {bool} [noAnimation] set to true if you want to skip the animation.
		 */
		hide(noAnimation) {
			if (!this.elementIsVisible())
				return;

			if (this._hideTimer) {
				clearTimeout(this._hideTimer);
				this._hideTimer = null;
			}
			this._element.toggleClass(this._showClass, false);
			this._element.toggleClass(this._hideClass, !noAnimation);
			if (noAnimation)
				this._element.setVisible(false);
		}

		/**
		 * Shows the element. Optionally close it on timeout.
		 * @param {number} [hideTimeout ] number of milliseconds to automatically hide.
		 * @param {bool} [noAnimation] set to true if you want to skip the animation.
		 */
		show(hideTimeout, noAnimation) {
			if (this.elementIsVisible())
				return;

			this._element.toggleClass(this._hideClass, false);
			this._element.toggleClass(this._showClass, !noAnimation);
			this._element.setVisible(true);

			if (hideTimeout &gt; 0)
				this._hideTimer = setTimeout(() =&gt; {
					this.hideTimer = null;
					this.hide();
				}, hideTimeout);
		}
	}

	class InfoBoxShowHideAnimator extends ShowHideAnimator {
		/**
		 * 
		 * @param {HTMLElement} element 
		 * @param {ShowAnimation} showClass 
		 * @param {HideAnimation} hideClass 
		 */
		constructor(element, showClass, hideClass) {
			super(element, showClass, hideClass);
			this._textElement = element.querySelector(".infoText");
			if (!this._textElement)
				throw new Error(`Element doesn't have a child with class "infoText"`);
			this._element.querySelector("a").addEventListener("click", () =&gt; this.hide(true));
		}

		/**
		 * Shows the element. Optionally close it on timeout.
		 * @param {string} text the text to display
		 * @param {number} [hideTimeout ] number of milliseconds to automatically hide.
		 * @param {bool} [noAnimation] set to true if you want to skip the animation.
		 */
		show(text, hideTimeout, noAnimation) {
			this._textElement.innerText = text;
			super.show(hideTimeout, noAnimation);
		}
	}
 
// #endregion

// #region ======== MomentaryClassController ================

	class MomentaryClassController {
		constructor() {
			this._entries = [];
		}

		apply(element, className, timeout) {
			try {
				this.remove(element);
	
				element.toggleClass(className, true);
				var entry = {
					element: element,
					className: className
				};
				entry.timer = setTimeout(() =&gt; this.remove(element), timeout);
				this._entries.push(entry);
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		findIndexOf(element) {
			try {
				for (let i = 0; i &lt; this._entries.length; i++) {
					const entry = this._entries[i];
					if (entry.element === element)
						return i;
				}
				return -1;
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		removeAll() {
			try {
				while (this._entries.length &gt; 0) {
					this.remove(this.elements[0]);
				}
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		remove(element) {
			try {
				var i = this.findIndexOf(element);
				if (i &lt; 0)
					return;
				var entry = this._entries[i];
				clearTimeout(entry.timer);
				element.toggleClass(entry.className, false);
				entry.element = null;
				this._entries.splice(i, 1);
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}
	}

	const _momentaryClassController = new MomentaryClassController();

// #endregion		

// #region ======== FloatingWarning =========================
		
	class FloatingWarning {
		constructor() {
			this.animator = null;
		}

		hide(noAnimation) {
			if (this.animator) {
				this.animator.hide(noAnimation);
			}
		}

		show(text, noAnimation) {
			try {
				if (!this.animator) {
					this.animator = new InfoBoxShowHideAnimator(
						document.getElementById("divFloatingWarning"), 
						ShowAnimation.scaleInCenter, 
						HideAnimation.fadeOut);
				} else
					this.hide(true);
				this.animator.show(text, 5000, noAnimation);
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}
	}
	const _floatingWarning = new FloatingWarning();

// #endregion

// #region ======== StatusMessageController =================

	class StatusLineController {
		constructor() {
			this._divStatusMessage = document.getElementById("divStatusMessage");
			this._spanStatusMessage = document.getElementById("spanStatusMessage");
			this._divStatusStats = document.getElementById("divStatusStats");
			this._tblVariableCount = document.getElementById("tblVariableCount");
			this._tblFilterCount = document.getElementById("tblFilterCount");
			this._tblHiddenCount = document.getElementById("tblHiddenCount");
			this._tblSelectedCount = document.getElementById("tblSelectedCount");
			this._momentaryMessageTimer = null;
			this._refreshTimer = null;
		}

		_clearMomentaryMessage() {
			try {
				if (this._momentaryMessageTimer) {
					clearTimeout(this._momentaryMessageTimer);
					this._momentaryMessageTimer = null;
				}
				this._divStatusMessage.setVisible(false)
				this._divStatusStats.setVisible(true);
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		/**
		 * Displays a status message for a short period of time
		 * @param {string} msg the message to display
		 */
		showMomentaryMessage(msg) {
			try {
				this._divStatusStats.setVisible(false);
				this._spanStatusMessage.innerText = msg;
				this._divStatusMessage.setVisible(true);
				this._momentaryMessageTimer = setTimeout(() =&gt; {
					this._momentaryMessageTimer = null;
					this._clearMomentaryMessage();
				}, 4000);
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		refresh() {
			if (this._refreshTimer)
				return;
			this._refreshTimer = setTimeout(() =&gt; {
				this._refreshTimer = null;
				this._showStats();
			}, 10);
		}

		_showStats() {
			function setStat(element, text, visible) {
				visible = visible == null ? true : visible;
				if (element.setVisible(visible))
					element.querySelector(".statusText").innerText = text;
			}

			try {
				if (this._refreshTimer) {
					clearInterval(this._refreshTimer);
					this._refreshTimer = null;
				}
				this._clearMomentaryMessage();

				var variableCount = _variables.data.length;
				var filterCount = _selectOptions.length;
				var hiddenCount = _hiddenVariables.getNumberOfHiddenVariablesInThisViewMode();
				var selectionCount = _selectOptions.getSelectionCount();

				setStat(this._tblVariableCount, variableCount);
				setStat(this._tblFilterCount, filterCount, filterCount != variableCount);
				setStat(this._tblHiddenCount, hiddenCount, hiddenCount &gt; 0);
				setStat(this._tblSelectedCount, selectionCount, selectionCount &gt; 1);
				// this._tblVariableCount.querySelector(".statusText").innerText = variableCount;
				// if (this._tblFilterCount.setVisible(filterCount !== variableCount))
				// 	this._tblFilterCount.querySelector(".statusText").innerText = filterCount;
				// if (this._tblHiddenCount.setVisible(hiddenCount &gt; 0))
				// 	this._tblHiddenCount.querySelector(".statusText").innerText = hiddenCount;
				// this._tblSelectedCount.querySelector(".statusText").innerText = selectionCount;
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

	}

	/**
	 * @type {StatusLineController}
	 */
	var _statusLine;

// #endregion		

// #region ======== SplitterHandler =========================
	var SplitterHandler = (function(splitter, leftBox) {
		var _splitter = splitter;
		var _leftBox = leftBox;
		var _isDragging = false;
		var _lastPos;
		var _changeCallbacks = [];
		_leftBox.style.flexGrow = 0;

		document.addEventListener('mousedown', function (e) {
			if (e.target === _splitter) {
				_isDragging = true;
				_lastPos = e.clientX;
			}
		});

		document.addEventListener('mousemove', function (e) {
			if (!_isDragging)
				return false;

			try {
				e.preventDefault();

				var amountMoved = e.clientX - _lastPos;
				_lastPos = e.clientX;

				_leftBox.style.width = `${_leftBox.offsetWidth + amountMoved}px`;

				_changeCallbacks.forEach(callback =&gt; callback());
			} catch (e) {
				ErrorHandler.handle(e);
			}
		});

		document.addEventListener('mouseup', function (e) {
			_isDragging = false;
		});
	
		return {
			addChangeCallback(callback) {
				_changeCallbacks.push(callback);
			},

			getSplitterPosition: function() {
				return _leftBox.style.width;
			},

			setSplitterPosition: function(value) {
				try {
					if (!value)
						return;
					if (!/px;?$/i.test(value))
						value += "px";
					_leftBox.style.width = value;
				} catch (err) {
					console.log(`Error in setSplitterPosition: ${err.message}`);
				}
			}
		};
	});
	var _splitterHandler = null;

// #endregion

// #region ======== ResizableColumnHandler ==================

	var ResizableColumnHandler = (function(th, handle) {
		var _th = th;
		var _handle = handle;
		var _startingMouseX;
		var _startingWidth;
		var _minWidth = 0;
		var _currWidth = 0;

		// NOTE: There's more initialization code below these handlers.

		const mouseDownHandler = (e) =&gt; {
			try {
				if (e.target !== _handle)
					return;
	
				_th.dataset.resizing = true;
				_startingMouseX = e.clientX;
				var computedStyles = window.getComputedStyle(_th);
				_startingWidth = parseInt(computedStyles.width);
				_minWidth = parseInt(computedStyles["min-width"])
				if (_minWidth === 0)
					_minWidth = 20;
		
				document.addEventListener("mousemove", mouseMoveHandler);
				document.addEventListener("mouseup", mouseUpHandler);
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		const mouseMoveHandler = (e) =&gt; {
			try {
				var amountMoved = e.clientX - _startingMouseX;
				setWidth(_startingWidth + amountMoved);
			} catch (e) {
				ErrorHandler.handle(e);
			}
		};

		const mouseUpHandler = (e) =&gt; {
			try {
				document.removeEventListener('mousemove', mouseMoveHandler);
				document.removeEventListener('mouseup', mouseUpHandler);
				setTimeout(() =&gt; { delete _th.dataset.resizing; }, 10);

				_variables.saveKMAppDataVariableValue("dictionaryKeyColumnWidth", `${_currWidth}`);
			} catch (e) {
				ErrorHandler.handle(e);
			}
		};

		function setWidth(width) {
			_currWidth = Math.max(width, _minWidth);
			_th.style.width = `${_currWidth}px`;
		}
		
		_handle.addEventListener("mousedown", mouseDownHandler);

		var savedWidth = _variables.getKMAppDataVariableValue("dictionaryKeyColumnWidth");
		if (savedWidth) {
			setWidth(savedWidth, true)
		}

		return {
		}
	});

// #endregion

// #region ======== ModifierKeys ============================
	class ModifierKeys {
		constructor(event) {
			this._altKey = event.altKey;
			this._cmdKey = event.metaKey;
			this._ctrlKey = event.ctrlKey;
			this._shiftKey = event.shiftKey;
		}

		get altKey() { return this._altKey; }
		get cmdKey() { return this._cmdKey; }
		get ctrlKey() { return this._ctrlKey; }
		get shiftKey() { return this._shiftKey; }

		get noModifiers() {return !this._shiftKey &amp;&amp; !this._ctrlKey &amp;&amp; !this._altKey &amp;&amp; !this._cmdKey}

		get altKeyOnly() {return !this._shiftKey &amp;&amp; !this._ctrlKey &amp;&amp; this._altKey &amp;&amp; !this._cmdKey}
		get cmdKeyOnly() {return !this._shiftKey &amp;&amp; !this._ctrlKey &amp;&amp; !this._altKey &amp;&amp; this._cmdKey}
		get ctrlKeyOnly() {return !this._shiftKey &amp;&amp; this._ctrlKey &amp;&amp; !this._altKey &amp;&amp; !this._cmdKey}
		get shiftCmdKeysOnly() {return this._shiftKey &amp;&amp; !this._ctrlKey &amp;&amp; !this._altKey &amp;&amp; this._cmdKey}
		get shiftKeyOnly() {return this._shiftKey &amp;&amp; !this._ctrlKey &amp;&amp; !this._altKey &amp;&amp; !this._cmdKey}

		toString() { return `altKey: ${this._altKey}, cmdKey: ${this._cmdKey}, ctrlKey: ${this._ctrlKey}, shiftKey: ${this._shiftKey}`; }
	}
// #endregion

// #region ======== documentOnKeyDown =======================

	// I swear there has to be a better way to implement keyboard
	// shortcuts, and there may be, but this works.
	//
	// The thing I really don't like about it is the fact that the testing
	// of keys is separated so far from the tooltips - meaning you have to
	// synchronize changes in multiple places.
	//
	// I could have come up with a way to have it all in one class, but
	// it started to reek of over-ennineering.
	function documentOnKeyDown(event) {

		try {
			if (_miscStateController.uiBusy)
				return false;

			var dialogShowing = _modalDialogController.isShowing;
			var inInputField = document.activeElement === _txtValue 
				|| document.activeElement === _inpSearchFilter
				|| _dictionaryCellEditAdapter.isAttached();

			var modifierKeys = new ModifierKeys(event);

			if (modifierKeys.noModifiers) {
				switch (event.which) {
					case 8:  // delete
					case 46: // forward-delete
						if (_btnDeleteVariables.isEnabled() &amp;&amp; !inInputField) {
							setTimeout(btnDeleteVariablesClicked,10);
							return false;
						}
						return true;
					case 9: // tab
						if (_editMode &amp;&amp; inInputField) {
							let text = _isShowingJsonData ? "  " : "\t";
							setTimeout(() =&gt; { _internalTasksMacro.insertText(text); }, 10);
							return false;
						} if (_dictionaryCellEditAdapter.isAttached()) {
							setTimeout(() =&gt; _dictionaryHelper.saveCellEdit("right"), 10);
							return false;
						} else if (dialogShowing) {
							return false;
						}
						return true;
					case 13: // return
						if (_modalDialogController.isShowing) {
							setTimeout(() =&gt; _modalDialogController.close("ok"), 10);
							return false;
						} else if (document.activeElement === _selVariables) {
							let selectedVariable = _selectOptions.getSelectedVariable();
							if (selectedVariable &amp;&amp; !selectedVariable.isDictionary)
								setTimeout(btnEditClicked, 10);
							return false;
						} else if (document.activeElement === _inpSearchFilter) {
							setSelectIndexAsync(0);
							return false;
						} else if (_dictionaryCellEditAdapter.isAttached()) {
							setTimeout(_dictionaryHelper.saveCellEdit, 10);
							return false;
						}
						return true;
					case 27: // escape
						if (_modalDialogController.isShowing) {
							setTimeout(() =&gt; _modalDialogController.close("cancel"), 10);
							return false;
						} else if (_editMode) {
							setTimeout(btnEditCancelClicked,10);
							return false;
						} else if (document.activeElement === _inpSearchFilter) {
							if (_inpSearchFilter.value) {
								_inpSearchFilter.value = "";
								return false;
							} if (_userOptions.escapeInEmptyFilterClosesPrompt) {
								return true;
							}
							return false;
						} else if (_dictionaryCellEditAdapter.isAttached()) {
							setTimeout(() =&gt; _dictionaryCellEditAdapter.detach(true), 10);
							return false;
						}
						return true;
					case 38: // up arrow
						if  (document.activeElement === _selVariables &amp;&amp; _selectOptions.selectedIndex === 0 &amp;&amp; _inpSearchFilter.isEnabled()) {
							setTimeout(() =&gt; _inpSearchFilter.focus(), 10);
							return false;
						} else if (_dictionaryCellEditAdapter.isAttached()) {
							setTimeout(() =&gt; _dictionaryHelper.saveCellEdit("up"), 10);
							return false;
						}
						return true;
					case 40: // down arrow
						if (document.activeElement === _inpSearchFilter) {
							if (_selVariables.options.length &gt; 0) {
								if (_selectOptions.selectedIndex &lt; 0)
									setSelectIndexAsync(0);
								else
									setTimeout(() =&gt; _selVariables.focus(), 10);
								return false;
							}
						} else if (_dictionaryCellEditAdapter.isAttached()) {
							setTimeout(() =&gt; _dictionaryHelper.saveCellEdit("down"), 10);
							return false;
						}
						return true;
					case 107: // numeric keypad +
					case 187: // unshifted +/=
						if (_btnAddVariable.isEnabled() &amp;&amp; !inInputField) {
							setTimeout(btnAddVariableClicked, 10);
							return false;
						}
						return true;
					default:
						return true;
				}
			}

			if (modifierKeys.shiftKeyOnly) {
				switch (event.which) {
					case 9: // tab
						if (_dictionaryCellEditAdapter.isAttached()) {
							setTimeout(() =&gt; _dictionaryHelper.saveCellEdit("left"), 10);
							return false;
						}
						return true;
					case 187: // shifted +/=
						if (_btnAddVariable.isEnabled() &amp;&amp; !inInputField) {
							setTimeout(btnAddVariableClicked, 10);
							return false;
						}
						return true;
					default:
						break;
				}
			}

			// if (modifierKeys.altKeyOnly) {
			// 	switch (event.which) {
			// 		case 13: // Enter
			// 			if (_dictionaryCellEditAdapter.isAttachedTo(document.activeElement)) {
			// 				setTimeout(() =&gt; { insertText("\n"); }, 10);
			// 				return false;
			// 			}
			// 			return true;
			// 		default:
			// 			return true;
			// 	}
			// }

			if (modifierKeys.cmdKeyOnly) {
				switch (event.which) {
					case 13: // Enter
						if (_btnEditOK.isEnabled() &amp;&amp; _editMode) {
							setTimeout(btnEditOKClicked,10);
							return false;
						}
						return true;
					case 67:  // C
						if (_btnCopyNames.isEnabled() &amp;&amp; !inInputField) {
							setTimeout(btnCopyNamesClicked, 10);
							return false;
						}
						return true;
					case 75:  // K
						if (_btnSearchKM.isEnabled() &amp;&amp; !inInputField) {
							setTimeout(btnSearchKMClicked, 10);
							return false;
						}
						return true;
					case 78: // N
						if (document.activeElement === _selVariables) {
							let selectedVariable = _selectOptions.getSelectedVariable();
							if (selectedVariable)
								setTimeout(btnRenameVariableClicked, 10);
							return false;
						}
						return true;
					case 83: // S
						console.log(83);
						if (document.activeElement !== _inpSearchFilter &amp;&amp; _inpSearchFilter.isEnabled()) {
							setTimeout(() =&gt; _inpSearchFilter.focus(), 10);
							return false;
						}
						return true;
					case 90: // Z
						if (_btnUndo.isEnabled() &amp;&amp; !inInputField) {
							setTimeout(btnUndoClicked(), 10);
							return false;
						}
						return true;
					default:
						return true;
				}
			}

			if (modifierKeys.shiftCmdKeysOnly) {
				switch (event.which) {
					case 67: // C
					if (_btnCopyVariables.isEnabled() &amp;&amp; !inInputField) {
							setTimeout(btnCopyVariablesClicked, 10);
							return false;
						}
						return true;
					case 90: // Z 
						if (_btnRedo.isEnabled() &amp;&amp; !inInputField) {
								setTimeout(btnRedoClicked(), 10);
								return false;
							}
						return true;
					default:
						return true;;
				}
			}
		} catch (e) {
			ErrorHandler.handle(e);
		}
	}
// #endregion

// #region ======== InternalTasksMacro ======================
		
	class InternalTasksMacro {
		constructor() {
			this._macroUUID = null;
			this._macroName = null;
		}

		_executeTask(triggerParam) {
			try {
				if (!this._macroUUID)
					throw new Error(`_executeTask can't be called before initialize`);
				window.KeyboardMaestro.Trigger(this._macroUUID, JSON.stringify(triggerParam, null, 2));
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		copyToClipboard(text) {
			this._executeTask({
				action: "copyToClipboard",
				text: text
			});
		}

		deleteTempHtmlFile() {
			console.log(`Deleting temp html file`);
			this._executeTask({
				action: "deleteTempHtmlFile"
			});
		}

		/**
		 * Verifies that the InternalTasksMacro is enabled, and if it isn't,
		 * a message is displayed and the prompt is closed. Otherwise, it deletes
		 * the temp html file, if needed. Note that this does some asynchronous
		 * stuff, but the UI will be disabled during the process.
		 */
		initialize() {
			var timedOut = false;
			var timer;
			var self = this;

			function makeInitializationErrorObject(message) {
				var result = new Error(message);
				result.isInitializationError = true;
				return result;
			}

			function handlePingResponse() {
				try {
					console.log(`Got pingBack event`);
					if (timedOut) {
						console.log(`Aborting because of timeout`);
						return;
					}
					clearTimeout(timer);
					if (_parameters.deleteTempHtmlFile == "1") 
						self.deleteTempHtmlFile();

					_miscStateController.uiBusy = false;
					if (_userOptions.focusFilterOnStartup || _selectOptions.length === 0)
						_inpSearchFilter.focus();
					else
						_selVariables.focus();
					} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			function handleTimeout() {
				try {
					timedOut = true;
					let macroGroupName = `&lt;font size="3"&gt;&lt;b&gt;${escape(_macroGroupName)}&lt;/b&gt;&lt;/font&gt;`;
					let macroName = `&lt;font size="3"&gt;&lt;b&gt;${escape(self._macroName)}&lt;/b&gt;&lt;/font&gt;`;
					throw makeInitializationErrorObject(
						`Make sure the macro group&lt;br/&gt;`
						+ `${macroGroupName}&lt;br/&gt;`
						+ `is enabled, and the macro&lt;br/&gt;`
						+ `&lt;strong&gt;${macroName}&lt;/strong&gt;&lt;br/&gt;`
						+ `is enabled.&lt;br/&gt;&lt;br/&gt;`
						+ `Timed out waiting for a response from the macro &lt;strong&gt;${macroName}&lt;/strong&gt;`);
				} catch (e) {
					if (e.isInitializationError) {
						_modalDialogController.showMessageAndAbort(e.message, true);
						setTimeout(() =&gt; _miscStateController.uiBusy = false, 100);
					} else
						ErrorHandler.handle(e);
				}
			}

			try {
				this._macroUUID = _parameters.internalTasksMacroUUID;
				if (!this._macroUUID)
					throw makeInitializationErrorObject(`Missing internalTasksMacroUUID.`);
				this._macroName = window.KeyboardMaestro.ProcessTokens(`%MacroNameForUUID%${this._macroUUID}%`);
				if (this._macroName === "Not Found")
					throw makeInitializationErrorObject(`Could not find Internal Tasks Macro for UUID ${this._macroUUID}`);

				_miscStateController.uiBusy = true;
				this._executeTask({
					action: "ping",
					customHTMLPromptID: _kmwindowid
				});

				document.addEventListener("pingBack", () =&gt; handlePingResponse(), {once: true});
				timer = setTimeout(() =&gt; handleTimeout(), 2000);
			} catch (e) {
				if (e.isInitializationError)
					_modalDialogController.showMessageAndAbort(e.message);
				else
					ErrorHandler.handle(e);
			}
		}

		insertText(text) {
			this._executeTask({
				action: "insertText",
				text: text
			});
		}

		pingBack() {
			console.log(`pingBack() called`);
			document.dispatchEvent(new Event("pingBack"));
		}

		reloadData(globalVariableNames, dictionaryNames) {
			this._executeTask( {
				action: "reloadData",
				parameters: {
					customHTMLPromptID: _kmwindowid,
					getAllGlobalVariableNames: globalVariableNames,
					getAllDictionaryNames: dictionaryNames
				}
			});
		}

		searchKM(name) {
			this._executeTask({
				action: "searchKM",
				name: name,
				searchAllMacros: _isAsync ? "1" : "0"
			});
		}

		setDictionaryValue(name, value) {
			this._executeTask({
				action: "setDictionaryValue",
				name: name,
				value: value
			});
		}

	}
	const _internalTasksMacro = new InternalTasksMacro();

// #endregion

// #region ======== UserOptions =============================

	class UserOptions {
		constructor() {
			this._escapeInEmptyFilterClosesPrompt = true;
			this._fixedFont = false;
			this._focusFilterOnStartup = true;
			this._fontSize = null;
			this._jsonVariableDisplayMode = false;
			this._sortBySizeSelectsFirstVariable = false;
			this._wordWrap = true;
			this._load();
		}

		_load() {
			try {
				var oldFontSize = _variables.getKMAppDataVariableValue("_fontSize");
				var options = _variables.getKMAppDataVariableValue("userOptions");
				if (options) {
					this._escapeInEmptyFilterClosesPrompt = options.escapeInEmptyFilterClosesPrompt !== false;
					this._fixedFont = options.fixedFont == true;
					this._focusFilterOnStartup = options.focusFilterOnStartup !== false;
					this._fontSize = oldFontSize || options.fontSize || null;
					this._jsonVariableDisplayMode = options.jsonVariableDisplayMode == true;
					this._sortBySizeSelectsFirstVariable = options.sortBySizeSelectsFirstVariable == true;
					this._wordWrap = options.wordWrap !== false;
				}
				if (oldFontSize) {
					_variables.saveKMAppDataVariableValue("_fontSize", null);
					this._save();
				}
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		_save() {
			var options = {};
			if (!this.escapeInEmptyFilterClosesPrompt) options.escapeInEmptyFilterClosesPrompt = false;
			if (this._fixedFont) options.fixedFont = true;
			if (!this.focusFilterOnStartup) options.focusFilterOnStartup = false;
			if (this._fontSize != null) options.fontSize = this._fontSize;
			if (this._jsonVariableDisplayMode) options.jsonVariableDisplayMode = true;
			if (this._sortBySizeSelectsFirstVariable) options.sortBySizeSelectsFirstVariable = true;
			if (!this._wordWrap) options.wordWrap = false;
			_variables.saveKMAppDataVariableValue("userOptions", options);
		}

		get escapeInEmptyFilterClosesPrompt() { return this._escapeInEmptyFilterClosesPrompt; }
		set escapeInEmptyFilterClosesPrompt(value) {
			this._escapeInEmptyFilterClosesPrompt = value;
			this._save();
		}

		get fixedFont() { return this._fixedFont; }
		set fixedFont(value) {
			this._fixedFont = value;
			this._save();
		}

		get focusFilterOnStartup() { return this._focusFilterOnStartup; }
		set focusFilterOnStartup(value) {
			this._focusFilterOnStartup = value;
			this._save();
		}

		/**
		 * The Font Size, which can be a number or null.
		 */
		get fontSize() { return this._fontSize; }
		set fontSize(value) {
			this._fontSize = value;
			this._save();
		}

		get jsonVariableDisplayModeMode() { return this._jsonVariableDisplayMode; }
		set jsonVariableDisplayModeMode(value) {
			this._jsonVariableDisplayMode = value;
			this._save();
		}

		get sortBySizeSelectsFirstVariable() { return this._sortBySizeSelectsFirstVariable; }
		set sortBySizeSelectsFirstVariable(value) {
			this._sortBySizeSelectsFirstVariable = value;
			this._save();
		}

		get wordWrap() { return this._wordWrap; }
		set wordWrap(value) {
			this._wordWrap = value;
			this._save();
		}
	}

	/**
	 * @type UserOptions
	 */
	var _userOptions;

// #endregion		

// #region ======== UI Stuff ================================

	// #region ======== Elements Variables &amp; initControls ===
		var _btnAddVariable;
		var _btnCancel;
		var _btnCode;
		var _btnCopyNames;
		var _btnCopyVariables;
		var _btnDeleteVariables;
		var _btnEdit;
		var _btnEditCancel;
		var _btnEditOK;
		var _btnHelp;
		var _btnHiddenVariables_toggleVariables;
		var _btnHiddenVariables_toggleViewMode
		var _btnJson;
		var _btnOK;
		var _btnRedo;
		var _btnReload;
		var _btnRenameVariable;
		var _btnSearchKM;
		var _btnSort;
		var _btnUndo;
		var _btnWordWrap;
		var _divDictionary;
		var _divSelVariables;
		var _divUIBusy;
		var _divVariables;
		var _divVariableToolButtons;
		var _imgHiddenVariables_toggleViewMode_all;
		var _imgHiddenVariables_toggleViewMode_hide;
		var _imgHiddenVariables_toggleViewMode_only;
		var	_imgHiddenVariables_toggleVariables_hide;
		var _imgHiddenVariables_toggleVariables_unhide;
		var _infoHiddenVariables_warning;
		var _infoHiddenVariables_warningText;
		var _inpSearchFilter;
		var _optionsMenu;
		var _selVariables;
		var _spanStatusLine;
		var _txtValue;

		var _editMode = false;
		var _sortBySize = false;
		var _undoList = [];

		function initControls() {
			try {
				_undoRedoStack = new UndoRedoStack();
				_userOptions = new UserOptions();

				_btnAddVariable = _tooltipFadeInAnimator.attach("btnAddVariable");
				_btnCancel = document.getElementById("btnCancel");
				_btnCode = _tooltipFadeInAnimator.attach("btnCode");
				_btnCopyNames = _tooltipFadeInAnimator.attach("btnCopyNames");
				_btnCopyVariables = _tooltipFadeInAnimator.attach("btnCopyVariables");
				_btnDeleteVariables = _tooltipFadeInAnimator.attach("btnDeleteVariables");
				_btnEdit = _tooltipFadeInAnimator.attach("btnEdit");
				_btnEditCancel = _tooltipFadeInAnimator.attach("btnEditCancel");
				_btnEditOK = _tooltipFadeInAnimator.attach("btnEditOK");
				_btnHelp = _tooltipFadeInAnimator.attach("btnHelp");
				_btnHiddenVariables_toggleVariables = _tooltipFadeInAnimator.attach("btnHiddenVariables_toggleVariables");
				_btnHiddenVariables_toggleViewMode = _tooltipFadeInAnimator.attach("btnHiddenVariables_toggleViewMode");
				_btnJson = _tooltipFadeInAnimator.attach("btnJson");
				_btnOK = document.getElementById("btnOK");
				_btnRedo = _tooltipFadeInAnimator.attach("btnRedo");
				_btnReload = document.getElementById("btnReload")
				_btnRenameVariable = _tooltipFadeInAnimator.attach("btnRenameVariable");
				_btnSearchKM = _tooltipFadeInAnimator.attach("btnSearchKM");
				_btnSort = _tooltipFadeInAnimator.attach("btnSort");
				_btnUndo = _tooltipFadeInAnimator.attach("btnUndo");
				_btnWordWrap = _tooltipFadeInAnimator.attach("btnWordWrap");
				_divDictionary = document.getElementById("divDictionary");
				_divSelVariables = document.getElementById("divSelVariables");
				_divUIBusy = document.getElementById("divUIBusy");
				_divVariables = document.getElementById("divVariables");
				_divVariableToolButtons = document.getElementById("divVariableToolButtons");
				_imgHiddenVariables_toggleViewMode_all = document.getElementById("imgHiddenVariables_toggleViewMode_all");
				_imgHiddenVariables_toggleViewMode_hide = document.getElementById("imgHiddenVariables_toggleViewMode_hide");
				_imgHiddenVariables_toggleViewMode_only = document.getElementById("imgHiddenVariables_toggleViewMode_only");
				_imgHiddenVariables_toggleVariables_hide = document.getElementById("imgHiddenVariables_toggleVariables_hide");
				_imgHiddenVariables_toggleVariables_unhide = document.getElementById("imgHiddenVariables_toggleVariables_unhide");;

				_infoHiddenVariables_warning = document.getElementById("infoHiddenVariables_warning");
				_infoHiddenVariables_warningText = document.getElementById("infoHiddenVariables_warningText");
				_inpSearchFilter = document.getElementById("inpSearchFilter");
				_optionsMenu = document.getElementById("optionsMenu");
				_selVariables = document.getElementById("selVariables");
				_spanStatusLine = document.getElementById("spanStatusLine");
				_txtValue = document.getElementById("txtValue");

				_variableSortMode.setSortBySize(false, false);

				_fontSizeController = new FontSizeController(document.body, 10, 20);
				_miscStateController.load();

				if (_isAsync) {
					_btnOK.text = "Done";
					_btnCancel.setVisible(false);
				}

				if (_btnReload.setVisible(_showReloadButton &amp;&amp; !_variables.getIsEmpty())) {
					if (_isAsync &amp;&amp; _showingLocalVariables &amp;&amp; !_showingGlobalVariables &amp;&amp; !_showingDictionaries)
						_btnReload.toggleClass("pseudoDisabled", true);
				}

				document.onkeydown = documentOnKeyDown;

				_statusLine = new StatusLineController();

				window.addEventListener("resize", () =&gt; {
					divVariablesResized();
				});

				_splitterHandler.addChangeCallback(divVariablesResized);
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		function divVariablesResized() {
			adjustWrapableTooltipAignment();
			adjustSelVariablesHeight();
		}

		function adjustSelVariablesHeight() {
			var height = document.getElementById("divSelVariables").clientHeight;
			_selVariables.setAttribute("style", `height:${height - 4}px;`);
		}
	// #endregion

	// #region ======== VariableController ==================

		/**
		 * @typedef {(Object | string)} VariableValue
		 */

		/**
		 * @typedef {Object} Variable
		 * @property {string} name
		 * @property {VariableValue} value
		 * @property {bool} [isLocalVariable]
		 * @property {string} [jsonValue]
		 */

		/**
		 * @typedef {Object} DictionaryVariable
		 * @property {string} name
		 * @property {string} dictionaryName
		 * @property {{key: string, value: string}} value
		 * @property {bool} isDictionary
		 * @property {string} [jsonValue]
		 */

		class VariableController {
			constructor() {
				this._data = [];
			}

			/**
			 * @returns {Variable[]} variables storage.
			 */
			get data() { return this._data; }
			set data(value) { this._data = value;}
			getIsEmpty() { return this._data.length === 0 }

			/**
			 * Saves the variable's value to KM. Adds it to _data. If the variable
			 * is NOT currently hidden, adds an option for it.
			 * @param {Variable} variable
			 * @param {{saveUndo: bool}} [options]
			 */
			addVariable(variable, options) {
				try {
					options = validateOptions(options, ["saveUndo"]);
					this.saveKMVariableValue(variable, variable.value);
					this._data.push(variable);
					if (options.saveUndo)
						_undoRedoStack.addVariableAddedAction(variable);
					if (_hiddenVariables.getVariableIsHiddenInThisViewMode(variable.name))
						return new NoOptionResult();
					return _selectOptions.addOption(variable);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Saves the changed variable to KM, optionally: adds to Undo, updates jsonValue, update Option display name
			 * @param {Variable} variable
			 * @param {VariableValue} newValue The new value
			 * @param {{saveUndo: bool, undoDictionaryAction: UndoRedoDictionaryAction, dontSetupJsonValue: bool, noOptionElement: bool}} [options]
			 */
			changeVariable(variable, newValue, options) {
				try {
					options = validateOptions(options, ["saveUndo", "undoDictionaryAction", "dontSetupJsonValue", "noOptionElement"]);
					if (options.saveUndo)
						_undoRedoStack.addValueChangedAction(variable, newValue, options.undoDictionaryAction);
					this.saveKMVariableValue(variable, newValue);
					variable.value = newValue;
						
					if (!options.dontSetupJsonValue)
						_variables.setupJsonValue(variable);

					if (options.noOptionElement || _hiddenVariables.getVariableIsHiddenInThisViewMode(variable.name))
						return new NoOptionResult();

					var option = _selectOptions.getOptionByVariableName(variable.name);
					option.text = _variables.getDisplayName(variable);
					return new OptionUpdatedResult(option);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Creates a new Variable object. Does NOT add it to _data. If you don't specify a value, 
			 * gets the existing value from KM, if any.
			 * @param {string} name the variable's name
			 * @param {VariableValue} [value] if undefined, gets the existing value from KM, if any.
			 * @returns {Variable}
			 */
			createVariable(name, value) {
				if (value === undefined)
					value = this.getKMVariableValue(name);
				var result = {
					name: name,
					value: value,
					isLocalVariable: this.isLocalVariableName(name)
				};
				this.setupJsonValue(result);
				return result;
			}

			/**
			 * Creates a new Dictionary Variable object. Does NOT add it to _data. Gets the existing value from KM, if any.
			 * @param {string} name 
			 * @param {VariableValue} [value] if undefined, gets the existing value from KM, if any.
			 * @returns {DictionaryVariable}
			 */
			createDictionaryVariable(name, value) {
				if (!value)
					value = this.getKMDictionaryVariableValue(name);
				var result = this.createVariable(`${name} (Dictionary)`, value);
				result.dictionaryName = name;
				result.isDictionary = true;
				return result;
			}

			/**
			 * Deletes a variable from KM, removes it from _data, removes the Option if any, and optionally adds to undo.
			 * @param {Variable} variable
			 * @param {{saveUndo: bool, undoGroupNumber: number}} [options]
			 */
			deleteVariable(variable, options) {
				try {
					var isHidden = _hiddenVariables.getVariableIsHidden(variable.name);
					options = validateOptions(options, ["saveUndo", "undoGroupNumber"]);
					if (options.saveUndo)
						_undoRedoStack.addVariableDeletedAction(variable, isHidden, options.undoGroupNumber);
					if (variable.isDictionary)
						this.saveKMVariableValue(variable, {});
					else
						this.saveKMVariableValue(variable, "%Delete%");
					if (isHidden)
						_hiddenVariables.setVariableIsHidden(variable.name, false);
					var variableIndex = this.getVariableByName(variable.name).index;
					this._data.splice(variableIndex, 1);
					return _selectOptions.deleteOption(variable);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Gets the name of the variable or dictionary,
			 * @param {Variable} variable 
			 * @returns {string}
			 */
			getActualVariableName(variable) {
				return variable.isDictionary ? variable.dictionaryName : variable.name;
			}

			/**
			 * Gets the variable's display name, based on current sortMode and "hidden" status
			 * @param {Variable} variable 
			 * @returns {string}
			 */
			getDisplayName(variable) {
				var result = _variableSortMode.sortBySize ? `(${this.getVariableSize(variable)}) ${variable.name}` : variable.name;
				if (_hiddenVariables.getVariableIsHidden(variable.name))
					result = ` ${result}`;
				return result;
			}

			/**
			 * Gets data stored in the "Additional Data" of the WindowBoundsController
			 * @param {string} name the name of the "variable"
			 * @returns {string | object} the value, or an empty string. Use JSON.parse() on the result, if needed.
			 */
			getKMAppDataVariableValue(name) {
				return _appStateDataController.getAdditionalData(name) || "";
			}

			/**
			 * Gets the dictionary's value from KM.
			 * @param {string} dictionaryName 
			 * @returns {{key: string, value: string}} the value, as an object literal
			 */
			getKMDictionaryVariableValue(dictionaryName) {
				return JSON.parse(window.KeyboardMaestro.ProcessTokens(`%JSONFromDictionary%${dictionaryName}%`));
			}
	
			/**
			 * Gets the value of the variable from KM, or document.kmvar if _isAsync and it's a local variable.
			 * @param {string} name 
			 * @returns {string}
			 */
			getKMVariableValue(name) {
				if (_isAsync &amp;&amp; this.isLocalVariableName(name))
					return document.kmvar[name] || "";
				return window.KeyboardMaestro.GetVariable(name);
			}

			/**
			 * Gets the variable for the specified name
			 * @param {string} name 
			 * @param {{isDictionary: bool, caseInsensitive: bool, returnNullIfNotFound: bool}} [options]
			 * @returns {{variable: Variable, index: number}}
			 */
			getVariableByName(name, options) {
				options = validateOptions(options, ["isDictionary", "caseInsensitive", "returnNullIfNotFound"]);
				if (options.caseInsensitive)
					name = name.toLowerCase();
				for (let i = 0; i &lt; this._data.length; i++) {
					const variable = this._data[i];

					let varName = variable.name;
					if (options.isDictionary) {
						if (!variable.isDictionary)
							continue;
						varName = variable.dictionaryName;
					}
					if (options.caseInsensitive)
						varName = varName.toLowerCase();
					if (varName === name) {
						return {
							variable: variable,
							index: i
						}
					}
				}
				if (options.returnNullIfNotFound)
					return null;
				throw new Error(`Logic Error: Could not find variable named "${name}"`);
			}

			/**
			 * Calculates the size of the variable's content
			 * @param {Variable} variable 
			 * @returns {number}
			 */
			getVariableSize(variable) {
				if (variable.isDictionary)
					return variable.jsonValue.length;
				return variable.value.length;
			}

			/**
			 * Returns true if the dictionary variable is empty.
			 * @param {Variable} variable 
			 * @returns {bool}
			 */
			isDictionaryEmpty(variable) {
				try {
					if (!variable.isDictionary)
						throw new Error(`Variable "${variable.name}" is not a Dictionary`)
					return Object.keys(variable.value).length === 0;
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Is this a Local or Instance variable name?
			 * @param {string} name 
			 * @returns {bool}
			 */
			isLocalVariableName(name) {
				return /^instance|^local/i.test(name);
			}
		
			/**
			 * Is the specified string a valid KM variable name?
			 * @param {string} name 
			 * @returns {bool}
			 */
			isValidVariableName(name) {
				return /^[a-z][a-z0-9 _]*$/i.test(name);
			}

			isVariableEmpty(variable) {
				if (variable.isDictionary)
					return this.isDictionaryEmpty(variable);
				return variable.value == null || variable.value == "";
			}

			/**
			 * Renames the variable by calling deleteVariable and addVariable, and optionally adds to undo.
			 * @param {Variable} variable the existing variable
			 * @param {string} newName  the new name
			 * @param {{saveUndo: boolean}} [options]
			 * @returns 
			 */
			renameVariable(variable, newName, options) {
				try {
					options = validateOptions(options, ["saveUndo"]);
					var wasHidden = _hiddenVariables.getVariableIsHidden(variable.name);
					this.deleteVariable(variable);
					var newVariable = variable.isDictionary ? 
						this.createDictionaryVariable(newName, variable.value.clone()) : 
						this.createVariable(newName, variable.value);
					if (options.saveUndo)
						_undoRedoStack.addVariableRenamedAction(variable, newVariable);
					if (wasHidden)
						_hiddenVariables.setVariableIsHidden(newName, true);
					return this.addVariable(newVariable);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Saves data stored in the "Additional Data" of the WindowBoundsController
			 * @param {string} name the name of the "variable"
			 * @param {string | object} value the value.
			 */
			saveKMAppDataVariableValue(name, value) {
				_appStateDataController.setAdditionalData(name, value);
				_appStateDataController.save();
			}

			/**
			 * Saves the variable's value to KM
			 * @param {Variable} variable 
			 * @param {VariableValue} newValue 
			 */
			saveKMVariableValue(variable, newValue) {
				try {
					if (variable.isDictionary) {
						_internalTasksMacro.setDictionaryValue(variable.dictionaryName, JSON.stringify(newValue, null, 2));
						if (_saveKMVariableValue_logging)
							console.log(`Saved Dictionary`, triggerParam);
					} else {
						window.KeyboardMaestro.SetVariable(variable.name, newValue);
						if (_saveKMVariableValue_logging)
							console.log(`Saved Variable "${variable.name}":\n${newValue}`);
					}
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Sets the variable's jsonValue
			 * @param {Variable} variable 
			 */
			setupJsonValue(variable) {

				function isString(value) {
					return typeof value === 'string' || value.value instanceof String;
				}
	
				variable.jsonValue = null;
				if (!variable || !variable.value)
					return;
	
				if (!isString(variable.value)) {
					variable.jsonValue = JSON.stringify(variable.value, null, 2);
					return;
				}
	
				if (/^[\[{]/.test(variable.value)) {
					try {
						variable.jsonValue = JSON.stringify(JSON.parse(variable.value), null, 2);
					} catch {
					}
				}
			}
	
		}
		const _variables = new VariableController();
	// #endregion

	// #region ======== MiscStateController ======================
			
		class MiscStateController {
			constructor() {
				this._fixedFont = false;
				this._jsonDictionaryDisplayMode = false;
				this._jsonVariableDisplayMode = false;
				this._uiBusy = false;
				this._wordWrap = true;
				this._loading = false;
			}

			load() {
				try {
					this._loading = true;
					this.fixedFont = _userOptions.fixedFont;
					this.jsonVariableDisplayMode = _userOptions.jsonVariableDisplayModeMode;
					this.wordWrap = _userOptions.wordWrap;
				} catch (e) {
					ErrorHandler.handle(e);
				} finally {
					this._loading = false;
				}
			}

			get fixedFont() { return this._fixedFont; }
			set fixedFont(value) {
				try {
					this._fixedFont = value;
					if (!this._loading) {
						_userOptions.fixedFont = this._fixedFont;
						showCurrentlySelectedValue();
					}
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			get jsonDictionaryDisplayMode() { return this._jsonDictionaryDisplayMode; }
			set jsonDictionaryDisplayMode(value) {
				try {
					this._jsonDictionaryDisplayMode = value;
					if (!this._loading)
						showCurrentlySelectedValue();
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			get jsonVariableDisplayMode() { return this._jsonVariableDisplayMode; }
			set jsonVariableDisplayMode(value) {
				try {
					this._jsonVariableDisplayMode = value;
					if (!this._loading) {
						_userOptions.jsonVariableDisplayModeMode = this._jsonVariableDisplayMode;
						showCurrentlySelectedValue();
					}
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			get uiBusy() { return this._uiBusy; }
			set uiBusy(value) {
				this._uiBusy = value;
				_divUIBusy.setVisible(this._uiBusy);
				_divUIBusy.swapClasses("divUIBusyVisible", "divUIBusyHidden", this._uiBusy);
			}

			get wordWrap() { return this._wordWrap; }
			set wordWrap(value) {
				try {
					this._wordWrap = value;
					if (!this._loading) {
						_userOptions.wordWrap = this._wordWrap;
						showCurrentlySelectedValue();
					}
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}
		}
		const _miscStateController = new MiscStateController();

	// #endregion

	// #region ======== SelectOptionController ==================

		// #region ======== Result Classes (for Intellisense) ===
			class BaseOptionResult {
				constructor(resultType) {
					this.resultType = resultType;
				}
		
				_getPropertyValue(propertyName) {
					var result = this[`_${propertyName}`];
					if (result === undefined)
						throw new Error(`AccessError: ${this.resultType} doesn't have an ${propertyName}`);
					return result;
				}
		
				_hasPropertyValue(propertyName) {
					return this[`_${propertyName}`] !== undefined;
				}
		
				/**
				 * @returns {HTMLOptionElement}
				 */
				get option() { return this._getPropertyValue("option"); }
				get hasOption() { return this._hasPropertyValue("option"); }
				
				get addedOption() { return this._getPropertyValue("addedOption"); }
				get hasAddedOption() { return this._hasPropertyValue("addedOption"); }
		
				get deletedOptionIndex() { return this._getPropertyValue("deletedOptionIndex"); }
				get hasDeletedOptionIndex() { return this._hasPropertyValue("deletedOptionIndex"); }
		
				get updatedOption() { return this._getPropertyValue("updatedOption"); }
				get hasUpdatedOption() { return this._hasPropertyValue("updatedOption"); }
			}
			class OptionAddedResult extends BaseOptionResult {
				constructor(option) {
					super("OptionAddedResult");
					this._option = option;
					this._addedOption = option;
				}
			}
			class OptionDeletedIndexResult extends BaseOptionResult {
				constructor(index) { 
					super("OptionDeletedIndexResult");
					this._deletedOptionIndex = index;
				}
			}
			class OptionUpdatedResult extends BaseOptionResult {
				constructor(option) {
					super("OptionUpdatedResult");
					this._option = option;
					this._updatedOption = option; 
				}
			}
			class NoOptionResult extends BaseOptionResult {
				constructor() {
					super("NoOptionResult");
					this._noOption = true;
				}
			}

		// #endregion

		class SelectOptionController {
			constructor() {}

			_changed() {
				_statusLine.refresh();
			}

			/**
			 * Creates a new Option, adds it to _selVariables
			 * @param {Variable} variable 
			 */
			addOption(variable) {
				var option = this.makeOptionElement(variable);
				var index = this.getOptionInsertIndex(variable);
				_selVariables.add(option, index);
				this._changed();
				return new OptionAddedResult(option);
			}

			/**
			 * Deletes the Option for the variable, if any
			 * @param {Variable} variable 
			 */
			deleteOption(variable) {
				var option = this.getOptionByVariableName(variable.name, false);
				if (!option)
					return new NoOptionResult();
				var optionIndex = option.index;
				option.remove();
				this._changed();
				return new OptionDeletedIndexResult(optionIndex);
			}

			/**
			 * Finds and selects the Option for the specified variable.
			 * If the variable is not currently selected, it will be selected.
			 * If the variable is not available because of a filter, the filter will be cleared.
			 * If the variable is hidden by the ViewMode, the ViewMode will be changed to "all".
			 * @param {Variable} variable
			 * @param {{dontThrowErrorIfNotFound: bool}} [options]
			 * @returns {{optionWasAlreadySelected: bool, notFound: boolean}} 
			 */
			findAndSelectOptionForVariable(variableName, options) {

				function findAndSelectOption(self) {
					var option = self.getOptionByVariableName(variableName, false);
					if (option) {
						self.selectedIndex = option.index;
						showCurrentlySelectedValue();
						return true;
					}
					return false;
				}
	
				try {
					options = validateOptions(options, ["dontThrowErrorIfNotFound"]);
					var selection = this.getSelection();
					if (selection &amp;&amp; selection.variable.name === variableName)
						return {optionWasAlreadySelected: true};
					if (findAndSelectOption(this))
						return {optionWasAlreadySelected: false};
					if (clearSearchFilter() &amp;&amp; findAndSelectOption(this))
						return {optionWasAlreadySelected: false};
					if (_hiddenVariables.resetViewMode()) {
						if (findAndSelectOption(this))
							return {optionWasAlreadySelected: false};
					}
					if (options.dontThrowErrorIfNotFound)
						return { notFound: true };
					throw new Error(`Can't find option for variable "${variableName}"`);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Finds the option for the specified variable name
			 * @param {string} name the name to find.
			 * @param {bool} [throwErrorIfNotFound] default true. Throw Error if not found.
			 * @returns {HTMLOptionElement | null} the option for the specified variable name, or null unless error is thrown
			 */
			getOptionByVariableName(name, throwErrorIfNotFound) {
				throwErrorIfNotFound = throwErrorIfNotFound != null ? throwErrorIfNotFound : true;
				var result = Array.from(_selVariables.options).find(o =&gt; o.value === name);
				if (result)
					return result;
				if (throwErrorIfNotFound)
					throw new Error(`Logic Error: Could not find Option for variable named "${name}"`);
				return null;
			}

			/**
			 * Returns the index for where to insert this option, based on the current sort mode.
			 * @param {Variable} variable 
			 * @returns {number}
			 */
			getOptionInsertIndex(variable) {
				try {
					var compare = _variableSortMode.getSortCompareFunction();
					for (let i = 0; i &lt; _selVariables.options.length; i++) {
						const o = _selVariables.options[i];
						var selVariable = _variables.getVariableByName(o.value).variable;
						if (compare(variable, selVariable) &lt; 0)
							return i;
					}
					return _selVariables.options.length;
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}
	
			/**
			 * Gets the variable for the SelectOption that is currently selected, if there is only one, otherwise null
			 * @returns {Variable|null} selected variable, or null
			 */
			getSelectedVariable() {
				var result = this.getSelection();
				return result != null ? result.variable : null;
			}
	
			/**
			 * Gets information for the current selection, if there is only 1, else null
			 * @returns {{option: HTMLOptionElement, variable: Variable, variableIndex: number}}
			 */
			getSelection() {
				var options = _selVariables.selectedOptions;
				if (options.length !== 1)
					return null;
				var option = options[0];
				var variableInfo = _variables.getVariableByName(option.value);
				return {
					option: option,
					variable: variableInfo.variable,
					variableIndex: variableInfo.index
				};
			}

			/**
			 * Returns the number of variables currently selected.
			 * @returns {number}
			 */
			getSelectionCount() { return _selVariables.selectedOptions.length; }

			/**
			 * Gets information for all the current selections, or an empty array if none
			 * @returns { {offScreenItemsCount: number, selections: {option: HTMLOptionElement, variable: Variable, index: number}[]}}
			 */
			getSelections() {
				function isElementInViewport (ele, container) {
					var rect = ele.getBoundingClientRect();
					const eleTop = rect.top;
					const eleBottom = eleTop + rect.height;
					const containerTop = container.offsetTop;
					const containerBottom = containerTop + container.clientHeight;
					return eleTop &gt;= containerTop &amp;&amp; eleBottom-4 &lt;= containerBottom;
				}
		
				var options = _selVariables.selectedOptions;

				var result = {
					offScreenItemsCount: 0,
					selections: []
				};
				for (let i = 0; i &lt; options.length; i++) {
					const option = options[i];
					if (!isElementInViewport(option, _selVariables))
						result.offScreenItemsCount++;
					var variableInfo = _variables.getVariableByName(option.value);
					result.selections.push({
						option: option,
						variable: variableInfo.variable,
						variableIndex: variableInfo.index
					});
				};
				return result;
			}

			/**
			 * Returns the number of _selVariables options.
			 * @returns {number}
			 */
			get length() { return _selVariables.options.length; }

			/**
			 * Creates a new option element for the specified variable. Does NOT add it to the collection.
			 * @param {Variable} variable the variable
			 * @returns {HTMLOptionElement}
			 */
			makeOptionElement(variable) {
				var option = document.createElement("option");
				option.text = _variables.getDisplayName(variable);
				option.value = variable.name;
				if (_hiddenVariables.viewMode === HiddenVariablesViewMode.all &amp;&amp; _hiddenVariables.getVariableIsHidden(option.value))
					option.dataset.hiddenVariable = true;
				return option;
			}

			/**
			 * Sets an option's "selected" to true or false
			 * @param {HTMLOptionElement} option the option
			 * @param {bool} select whether to select it or not
			 */
			setOptionIsSelected(option, select) {
				option.selected = select;
				this._changed();
			}

			/**
			 * Selects the option at this index, calls showCurrentlySelectedValue(), sets focus
			 * @param {number} index 
			 */
			setSelectedIndexAndRefresh(index) {
				this.selectedIndex = index;
				showCurrentlySelectedValue();
				_selVariables.focus();
			}

			/**
			 * Gets the index of the currently-selected option, or -1 if none.
			 * @returns {number}
			 */
			get selectedIndex() { return _selVariables.selectedIndex; }

			/**
			 * Sets the currently-selected index, which unselects everthing else.
			 * Does NOT call "showCurrentlySelectedValue".
			 * If the value is out of range (too large), it will be adjusted down
			 * so as to select the last item, if any, or -1.
			 * Setting this to -1 will cause everything to be unselected, and nothing gets selected.
			 * @param {number} value
			 */
			set selectedIndex(value) {
				if (value == null)
					value = -1;
				_selVariables.selectedIndex = Math.min(value, _selVariables.options.length - 1);
				this._changed();
			}

			/**
			 * If the Option for this Variable is visible in this ViewMode,
			 * then it is replaced with a refreshed version.
			 * @param {Variable} variable 
			 */
			updateOption(variable) {
				if (_hiddenVariables.getVariableIsHiddenInThisViewMode(variable.name))
					return new NoOptionResult();
				var option = this.getOptionByVariableName(variable.name);
				var optionIndex = option.index;
				var newOption = this.makeOptionElement(variable);
				_selVariables.add(newOption, optionIndex);
				option.remove();
				this._changed();
				return new OptionUpdatedResult(newOption);
			}
		}
		
		var _selectOptions = new SelectOptionController();
	// #endregion

	// #region ======== VariableSortMode ========================

		class VariableSortMode {
			constructor() {
				this._sortBySize = false;
			}

			/**
			 * True if sort by size, false if sort by name.
			 * @returns {bool}
			 */
			get sortBySize() { return this._sortBySize; }

			/**
			 * Sets sortBySize, changes the _btnSort glyph, and optionally refreshes _selVariables.
			 * @param {bool} value 
			 * @param {bool} refresh whether to refresh
			 */
			setSortBySize(value, refresh) {
				try {
					this._sortBySize = value;
					var selectedVariable = _selectOptions.getSelectedVariable();
					_btnSort.dataset.sortByName = !this._sortBySize;
					document.getElementById("btnSortTooltipText").textContent = `Sorted by ${this._sortBySize ? "Size" : "Name"}`;
					if (refresh) {
						fillSelect();
						if (this._sortBySize &amp;&amp; _userOptions.sortBySizeSelectsFirstVariable)
							setSelectIndexAsync(0);
						else if (selectedVariable)
							setSelectIndexAsync(_selectOptions.getOptionByVariableName(selectedVariable.name).index);
					}
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			static sortCompareVariableNames(v1, v2) {
				var s1 = v1.name.toLowerCase();
				var s2 = v2.name.toLowerCase();
				return s1 &lt; s2 ? -1 : s1 &gt; s2 ? 1 : 0;
			}

			static sortCompareVariableSizes(v1, v2) {
				var v1Size = _variables.getVariableSize(v1);
				var v2Size = _variables.getVariableSize(v2);
				var result = v2Size &lt; v1Size ? -1 : v2Size &gt; v1Size ? 1 : 0;
				if (result !== 0)
					return result;
				return VariableSortMode.sortCompareVariableNames(v1, v2);
			}

			/**
			 * @callback SortCompareFunction
			 * @param value1
			 * @param value2
			 * @returns {number} -1, 0, or 1
			 */

			/**
			 * Gets the sort compare function for the current sort mode.
			 * @returns {SortCompareFunction}
			 */
			getSortCompareFunction() {
				return this._sortBySize ? VariableSortMode.sortCompareVariableSizes : VariableSortMode.sortCompareVariableNames;
			}
		}

		const _variableSortMode = new VariableSortMode();
	// #endregion

	// #region ======== Undo/Redo Stuff =========================

		// #region ======== Undo/Redo Types &amp; Classes ===============
					
			/**
			 * @readonly
			 * @enum {string}
			 */
			const UndoRedoActionType = {
				added: "added",
				changed: "changed",
				deleted: "deleted",
				hidden: "hidden",
				renamed: "renamed",
				unhidden: "unhidden"
			};

			/**
			 * @readonly
			 * @enum {string}
			 */
			const UndoRedoDictionaryActionType = {
				keyAdded: "keyAdded",
				keyChanged: "keyChanged",
				keyDeleted: "keyDeleted",
				valueChanged: "valueChanged"
			}

			function UndoRedoDictionaryKeyAddedAction(keyName) {
				return {
					actionType: UndoRedoDictionaryActionType.keyAdded,
					keyName: keyName
				};
			}

			function UndoRedoDictionaryKeyChangedAction(keyName, newKeyName) {
				return {
					actionType: UndoRedoDictionaryActionType.keyChanged,
					keyName: keyName,
					newKeyName: newKeyName
				};
			}

			function UndoRedoDictionaryKeyDeletedAction(keyName, value) {
				return {
					actionType: UndoRedoDictionaryActionType.keyDeleted,
					keyName: keyName,
					value: value
				};
			}

			function UndoRedoDictionaryValueChangedAction(keyName, value, newValue) {
				return {
					actionType: UndoRedoDictionaryActionType.valueChanged,
					keyName: keyName,
					value: value,
					newValue: newValue
				}
			}

			/**
			 * @typedef {Object} VariableAddedAction
			 * @property {UndoRedoActionType} actionType
			 * @property {Variable} variable
			 */

			/**
			 * @typedef {Object} VariableChangedAction
			 * @property {UndoRedoActionType} actionType
			 * @property {Variable} variable
			 * @property {VariableValue} newValue
			 * @property {UndoRedoDictionaryKeyAddedAction | UndoRedoDictionaryKeyChangedAction | UndoRedoDictionaryKeyDeletedAction | UndoRedoDictionaryValueChangedAction} [dictionaryAction]
			 */

			/**
			 * @typedef {Object} VariableDeletedAction
			 * @property {UndoRedoActionType} actionType
			 * @property {Variable} variable
			 * @property {bool} wasHidden
			 * @property {number} groupNumber
			 */
				
			/**
			 * @typedef {Object} VariableHiddenAction
			 * @property {UndoRedoActionType} actionType
			 * @property {string} hiddenVariableName
			 * @property {number} groupNumber
			 */

			/**
			 * @typedef {Object} VariableRenamedAction
			 * @property {UndoRedoActionType} actionType
			 * @property {Variable} variable
			 * @property {Variable} newVariable
			 */
		// #endregion

		class UndoRedoStack {
			constructor() {
				this._undoStack = [];
				this._redoStack = [];
				this._groupNumber = 1;
			}

			_getActionTypeDescription(action) {
				var suffix = action.groupNumber ? "s" : "";
				switch (action.actionType) {
					case UndoRedoActionType.added:
						return `Add Variable`;
					case UndoRedoActionType.changed:
						if (action.dictionaryAction) {
							switch (action.dictionaryAction.actionType) {
								case UndoRedoDictionaryActionType.keyAdded:
									return "Add Dictionary Key";
								case UndoRedoDictionaryActionType.keyChanged:
									return "Change Dictionary Key";
								case UndoRedoDictionaryActionType.keyDeleted:
									return "Delete Dictionary Key";
								case UndoRedoDictionaryActionType.valueChanged:
									return "Change Dictionary Value";
								default:
									throw new Error(`Unexpected undo dictionary action type "${action.dictionaryAction.actionType}"`);
							}
						}
						return `Edit Variable`;
					case UndoRedoActionType.deleted:
						return `Delete Variable${suffix}`;
					case UndoRedoActionType.hidden:
						return `Hide Variable${suffix}`;
					case UndoRedoActionType.renamed:
						return `Rename Variable${suffix}`;
					case UndoRedoActionType.unhidden:
						return `UnHide Variable${suffix}`;
					default:
						throw new Error(`Unexpected undo action type "${action.actionType}"`);
				}
			}

			_logAction(functionName, action) {
				if (!_undoRedoStack_logging)
					return;
				if (_undoRedoStack_logging === "summary")
					console.log("UndoRedoStack", functionName, action);
				else
					console.log("UndoRedoStack", functionName, action, this._undoStack, this._redoStack);
			}

			/**
			 * Logs the contents of the UndoStack and the RedoStack.
			 */
			logContents() {
				console.log("UndoRedoStack Stacks", this._undoStack, this._redoStack);
			}

			/**
			 * Records when a variable is added
			 * @param {Variable} variable the variable being added
			 */
			addVariableAddedAction(variable) {
				this._redoStack = [];
				var action = {
					actionType: UndoRedoActionType.added,
					variable: variable.clone(),
				}
				this._undoStack.push(action);
				this._logAction(fname(), action);
			}

			/**
			 * Records when a variable is changed
			 * @param {Variable} variable the variable being affected
			 * @param {VariableValue} newValue the value that's about to be applied
			 * @param {UndoRedoDictionaryKeyAddedAction | UndoRedoDictionaryKeyChangedAction | UndoRedoDictionaryKeyDeletedAction | UndoRedoDictionaryValueChangedAction} [dictionaryAction] info about how a dictionary was changed
			 */
			addValueChangedAction(variable, newValue, dictionaryAction) {
				this._redoStack = [];
				var action = {
					actionType: UndoRedoActionType.changed,
					variable: variable.clone(),
					newValue: newValue,
					dictionaryAction: dictionaryAction
				}
				this._undoStack.push(action);
				this._logAction(fname(), action);
			}

			/**
			 * Records when a variable is deleted
			 * @param {Variable} variable the variable being deleted
			 * @param {bool} wasHidden whether the variable was hidden or not
			 * @param {number} [groupNumber] the group number, if any
			 */
			addVariableDeletedAction(variable, wasHidden, groupNumber) {
				this._redoStack = [];
				var action = {
					actionType: UndoRedoActionType.deleted,
					variable: variable.clone(),
					wasHidden: wasHidden,
					groupNumber: groupNumber
				}
				this._undoStack.push(action);
				this._logAction(fname(), action);
			}

			/**
			 * Records when a variable is hidden
			 * @param {string} hiddenVariableName the name of the variable that is being hidden
			 * @param {bool} hidden whether the variable was hidden, or unhidden
			 * @param {number} [groupNumber] the group number, if any
			 */
			addVariableHiddenAction(hiddenVariableName, hidden, groupNumber) {
				this._redoStack = [];
				var action = {
					actionType: hidden ? UndoRedoActionType.hidden : UndoRedoActionType.unhidden,
					hiddenVariableName: hiddenVariableName,
					groupNumber: groupNumber
				};
				this._undoStack.push(action);
				this._logAction(fname(), action);
			}

			/**
			 * Records when a variable is renamed
			 * @param {Variable} variable the variable being affected
			 * @param {Variable} newVariable the renamed variable
			 */
			addVariableRenamedAction(variable, newVariable) {
				this._redoStack = [];
				var action = {
					actionType: UndoRedoActionType.renamed,
					variable: variable.clone(),
					newVariable: newVariable.clone()
				}
				this._undoStack.push(action);
				this._logAction(fname(), action);
			}

			/**
			 * Clears the Undo and Redo Stacks
			 */
			clear() {
				this._undoStack = [];
				this._redoStack = [];
			}

			/**
			 * Returns the next GroupNumber. Use this when doing something
			 * to multiple variables at a time.
			 * @returns {number} the next group number
			 */
			getNextGroupNumber() {
				return this._groupNumber++;
			}

			/**
			 * Returns the Undo Tooltip Text
			 * @returns {string}
			 */
			getUndoTooltip() {
				if (this._undoStack.length === 0)
					return "Undo";

				var undoAction = this._undoStack[this._undoStack.length-1];
				return `Undo ${this._getActionTypeDescription(undoAction)}`;
			}

			/**
			 * Returns the Redo Tooltip Text
			 * @returns {string}
			 */
			 getRedoTooltip() {
				if (this._redoStack.length === 0)
					return "Redo";

				var redoAction = this._redoStack[this._redoStack.length-1];
				return `Redo ${this._getActionTypeDescription(redoAction)}`;
			}

			/**
			 * Returns true if the undo stack is empty.
			 * @returns {bool}
			 */
			undoStackIsEmpty() {
				return this._undoStack.length === 0;
			}

			/**
			 * Returns true if the redo stack is empty.
			 * @returns {bool}
			 */
			 redoStackIsEmpty() {
				return this._redoStack.length === 0;
			}

			/**
			 * Pops the last Action from the Undo Stack, puts it on the Redo Stack, and returns it.
			 * @returns {VariableAddedAction | VariableChangedAction | VariableDeletedAction | VariableHiddenAction | VariableRenamedAction}
			 */
			popUndoStack() {
				if (this._undoStack.length === 0)
					throw new Error(`popUndoStack() called when the stack was empty`);
				var undoItem = this._undoStack.pop();
				var redoItem = undoItem.clone();
				this._redoStack.push(redoItem);
				return undoItem;
			}

			/**
			 * Pops the last Undo Action and returns it, if it's for the specified groupNumber.
			 * If groupNumber is null, this always returns null.
			 * @param {number} [groupNumber ]
			 * @returns {VariableAddedAction | VariableChangedAction | VariableDeletedAction | VariableHiddenAction | VariableRenamedAction}
			 */
			popNextUndoInGroup(groupNumber) {
				if (!groupNumber)
					return null;
				if (this._undoStack.length === 0)
					return null;
				if (this._undoStack[this._undoStack.length - 1].groupNumber !== groupNumber)
					return null;
				return this.popUndoStack();
			}

			/**
			 * Pops the last Action from the Redo Stack, puts it on the Undo Stack, and returns it.
			 * @returns {VariableAddedAction | VariableChangedAction | VariableDeletedAction | VariableHiddenAction | VariableRenamedAction}
			 */
			 popRedoStack() {
				if (this._redoStack.length === 0)
					throw new Error(`popRedoStack() called when the stack was empty`);
				var redoItem = this._redoStack.pop();
				var undoItem = redoItem.clone();
				this._undoStack.push(undoItem);
				return redoItem;
			}

			/**
			 * Pops the last Redo Action and returns it, if it's for the specified groupNumber.
			 * If groupNumber is null, this always returns null.
			 * @param {number} [groupNumber]
			 * @returns {VariableAddedAction | VariableChangedAction | VariableDeletedAction | VariableHiddenAction | VariableRenamedAction}
			 */
			 popNextRedoInGroup(groupNumber) {
				if (!groupNumber)
					return null;
				if (this._redoStack.length === 0)
					return null;
				if (this._redoStack[this._redoStack.length - 1].groupNumber !== groupNumber)
					return null;
				return this.popRedoStack();
			}
		}

		/**
		 * @type {UndoRedoStack}
		 */
		var _undoRedoStack;

		function showOffScreenSelectedItemsWarning() {
			var msgs = [];
			if (_selectOptions.getSelections().offScreenItemsCount &gt; 0)
				msgs.push("Some selections are scrolled out of view.");
			if (msgs.length &gt; 0)
				_floatingWarning.show(msgs.join("\n"));
		}

		function btnRedoClicked() {

			/**
			 * Redoes a Variable Add
			 * @param {VariableAddedAction} action 
			 */
			function redoAdded(action) {
				try {
					clearSearchFilter();
					_hiddenVariables.resetViewMode();
					var result = _variables.addVariable(action.variable);
					if (!result.hasOption)
						throw new Error(`Couldn't find the Option after addVariable`);

					_selectOptions.selectedIndex = result.option.index;
					showCurrentlySelectedValue();
					_selVariables.focus();
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Redoes a Variable Change
			 * @param {VariableChangedAction} action 
			 */
			function redoChange(action) {

				function redoDictionaryKeyAdded() {
					try {
						_dictionaryHelper.addKeyAndRowForUndelete(action.dictionaryAction.keyName, action.dictionaryAction.value);
						enableControls();
					} catch (e) {
						ErrorHandler.handle(e);
					}
				}

				function redoDictionaryChange() {
					try {
						var variable = _variables.getVariableByName(action.variable.name).variable;
	
						var dictAction = action.dictionaryAction;
						var dictActionType = dictAction.actionType;
	
						var findOptions = {};
						switch (dictActionType) {
							case UndoRedoDictionaryActionType.keyChanged:
								findOptions.highlightKeyCell = true;
								break;
							case UndoRedoDictionaryActionType.valueChanged:
								findOptions.highlightValueCell = true;
								break;
						}
						var findResult = _dictionaryHelper.findAndSelectKeyCell(action.variable.name, dictAction.keyName, findOptions);
	
						// We have to do this After the row was selected, or the grid won't contain the current values.
						_variables.changeVariable(variable, action.newValue, {noOptionElement: true});
	
						var keyCell = findResult.cell;
						if (findResult.optionWasAlreadySelected) {
							// Since the option was already selected, we need to update the controls,
							// so the Undo/Redo buttons reflect their new status.
							enableControls();
						}
						switch (dictActionType) {
							case UndoRedoDictionaryActionType.keyDeleted:
								_dictionaryHelper.deleteKeyAndRowAsync(keyCell);
								break;
							case UndoRedoDictionaryActionType.keyChanged:
								keyCell.value = dictAction.newKeyName;
								break;
							case UndoRedoDictionaryActionType.valueChanged:
								_dictionaryHelper.getRowValueCellContentElement(keyCell.row).innerText = dictAction.newValue;
								break;
							default:
								throw new Error(`Unexpected DictionaryActionType: "${dictActionType}"`);
						}
					} catch (e) {
						ErrorHandler.handle(e);
					}
				}

				try {
					_selectOptions.findAndSelectOptionForVariable(action.variable.name);

					if (action.dictionaryAction) {
						if (action.dictionaryAction.actionType === UndoRedoDictionaryActionType.keyAdded)
							redoDictionaryKeyAdded();
						else
							redoDictionaryChange();
						return;
					}

					var variable = _variables.getVariableByName(action.variable.name).variable;
					var result = _variables.changeVariable(variable, action.newValue);
					if (result.hasUpdatedOption)
						_selectOptions.setSelectedIndexAndRefresh(result.updatedOption.index);
					else
						enableControls();
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Redoes a Variable Delete
			 * @param {VariableDeletedAction} action 
			 * @returns {bool} returns true if any of the affected variables
			 * are hidden due to the current ViewMode.
			 */
			function redoDelete(action) {
				try {
					clearSearchFilter();
					_hiddenVariables.resetViewMode();
					var optionIndex = null;
					do {
						if (_hiddenVariables.getVariableIsHidden(action.variable.name))
							_hiddenVariables.setVariableIsHidden(action.variable.name, false);
						var result = _variables.deleteVariable(action.variable);
						if (result.hasDeletedOptionIndex) {
							if (optionIndex == null)
								optionIndex = result.deletedOptionIndex;
							else
								optionIndex = Math.min(optionIndex, result.deletedOptionIndex);
						}
						action = _undoRedoStack.popNextRedoInGroup(action.groupNumber);
					} while (action != null);
	
					if (optionIndex != null)
						_selectOptions.setSelectedIndexAndRefresh(optionIndex);
					else {
						showCurrentlySelectedValue();
						_selVariables.focus();
					}
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Redoes the Hide or Unhide action
			 * @param {VariableHiddenAction} action
			 * @param {bool} hide 
			 * @returns {bool} returns true if any of the affected variables
			 * are hidden due to the current ViewMode.
			 */
			function redoHide(action, hide) {
				try {
					clearSearchFilter();
					_hiddenVariables.resetViewMode();
					_selectOptions.selectedIndex = -1;
					do {
						var variable = _variables.getVariableByName(action.hiddenVariableName).variable;
	
						var result = hideVariable(variable, hide, {throwErrorIfOptionNotFound: true});
						_selectOptions.setOptionIsSelected(result.option, true);
	
						action = _undoRedoStack.popNextRedoInGroup(action.groupNumber);
					} while (action != null);
	
					showCurrentlySelectedValue();
					_selVariables.focus();
					showOffScreenSelectedItemsWarning();
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Redoes the Rename action
			 * @param {VariableRenamedAction} action 
			 */
			 function redoRename(action) {
				try {
					_selectOptions.findAndSelectOptionForVariable(action.variable.name);
					_variables.renameVariable(action.variable, _variables.getActualVariableName(action.newVariable));
					_selectOptions.findAndSelectOptionForVariable(action.action.newVariable.name);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			try {
				if (_undoRedoStack.redoStackIsEmpty()) {
					console.log(`redoStackIsEmpty()`);
					return;
				}

				clearSearchFilter();
				_hiddenVariables.resetViewMode();
				var action = _undoRedoStack.popRedoStack();
				switch (action.actionType) {
					case UndoRedoActionType.added:
						redoAdded(action);
						break;
					case UndoRedoActionType.changed:
						redoChange(action);
						break;
					case UndoRedoActionType.deleted:
						redoDelete(action);
						break;
					case UndoRedoActionType.hidden:
						redoHide(action, true);
						break;
					case UndoRedoActionType.renamed:
						redoRename(action);
						break;
					case UndoRedoActionType.unhidden:
						redoHide(action, false);
						break;
					default:
						throw new Error(`Logic error: Unknown Redo Action Type: "${action.actionType}"`);
				}
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		function btnUndoClicked() {

			/**
			 * Undoes the Added action
			 * @param {VariableAddedAction} action 
			 */
			function undoAdd(action) {
				try {
					_selectOptions.findAndSelectOptionForVariable(action.variable.name);
					if (_hiddenVariables.getVariableIsHidden(action.variable.name))
						_hiddenVariables.setVariableIsHidden(action.variable.name, false);
					var optionIndex = null;
					var result = _variables.deleteVariable(action.variable);
					if (result.hasDeletedOptionIndex) {
						if (optionIndex == null)
							optionIndex = result.deletedOptionIndex;
						else
							optionIndex = Math.min(optionIndex, result.deletedOptionIndex);
					}
					if (optionIndex != null)
						_selectOptions.setSelectedIndexAndRefresh(optionIndex);
					else
						showCurrentlySelectedValue();
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Undoes the Changed action
			 * @param {VariableChangedAction} action 
			 */
			function undoChange(action) {

				function undoDictionaryKeyDeleted() {
					try {
						_dictionaryHelper.addKeyAndRowForUndelete(action.dictionaryAction.keyName, action.dictionaryAction.value);

						// Make sure the Undo/Redo butttons get updated properly
						enableControls();
					} catch (e) {
						ErrorHandler.handle(e);
					}
				}

				function undoDictionaryChange() {
					try {
						var variable = _variables.getVariableByName(action.variable.name).variable;
	
						var dictAction = action.dictionaryAction;
						var dictActionType = dictAction.actionType;
	
						var findKeyName = dictActionType === UndoRedoDictionaryActionType.keyChanged ? dictAction.newKeyName : dictAction.keyName;

						var findOptions = {};
						switch (dictActionType) {
							case UndoRedoDictionaryActionType.keyChanged:
								findOptions.highlightKeyCell = true;
								break;
							case UndoRedoDictionaryActionType.valueChanged:
								findOptions.highlightValueCell = true;
								break;
						}
						var findResult = _dictionaryHelper.findAndSelectKeyCell(action.variable.name, findKeyName, findOptions);
	
						// We have to do this After the row was selected, or the grid won't contain the current values.
						_variables.changeVariable(variable, action.variable.value, {noOptionElement: true});
	
						var keyCell = findResult.cell;
						if (findResult.optionWasAlreadySelected) {
							// Since the option was already selected, we need to update the controls,
							// so the Undo/Redo buttons reflect their new status.
							enableControls();
						}
						switch (dictActionType) {
							case UndoRedoDictionaryActionType.keyAdded:
								_dictionaryHelper.deleteKeyAndRowAsync(keyCell);
								break;
							case UndoRedoDictionaryActionType.keyChanged:
								keyCell.value = dictAction.keyName;
								break;
							case UndoRedoDictionaryActionType.valueChanged:
								_dictionaryHelper.getRowValueCellContentElement(keyCell.row).innerText = dictAction.value;
								break;
							default:
								throw new Error(`Unexpected DictionaryActionType: "${dictActionType}"`);
						}
					} catch (e) {
						ErrorHandler.handle(e);
					}
				}

				try {
					_selectOptions.findAndSelectOptionForVariable(action.variable.name);

					if (action.dictionaryAction) {
						if (action.dictionaryAction.actionType === UndoRedoDictionaryActionType.keyDeleted)
							undoDictionaryKeyDeleted();
						else
							undoDictionaryChange();
						return;
					}

					var variable = _variables.getVariableByName(action.variable.name).variable;
					var result = _variables.changeVariable(variable, action.variable.value);
					if (result.hasUpdatedOption)
						_selectOptions.setSelectedIndexAndRefresh(result.updatedOption.index);
					else
						enableControls();
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Undoes the Delete action(s)
			 * @param {VariableDeletedAction} action 
			 * @returns {bool} returns true if any of the affected variables
			 * are hidden due to the current ViewMode.
			 */
			function undoDelete(action) {
				try {
					clearSearchFilter();
					_hiddenVariables.resetViewMode();
					_selectOptions.selectedIndex = -1;
					do {
						if (action.wasHidden)
							_hiddenVariables.setVariableIsHidden(action.variable.name, true);
						var result = _variables.addVariable(action.variable);
						if (!result.hasOption)
							throw new Error(`Couldn't find the Option after addVariable`);
						if (_selectOptions.selectedIndex &lt; 0)
							_selectOptions.selectedIndex = result.option.index;
						else
							_selectOptions.setOptionIsSelected(result.option, true);
	
						action = _undoRedoStack.popNextUndoInGroup(action.groupNumber);
					} while (action != null);
	
					showCurrentlySelectedValue();
					_selVariables.focus();
					showOffScreenSelectedItemsWarning();
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * @param {VariableHiddenAction} action
			 * @param {bool} hide 
			 * @returns {bool} returns true if any of the affected variables
			 * are hidden due to the current ViewMode.
			 */
			function undoHide(action, hide) {
				try {
					clearSearchFilter();
					_hiddenVariables.resetViewMode();
					_selectOptions.selectedIndex = -1;
					do {
						var variable = _variables.getVariableByName(action.hiddenVariableName).variable;
	
						var result = hideVariable(variable, !hide, {throwErrorIfOptionNotFound: true});
						if (_selectOptions.selectedIndex &lt; 0)
							_selectOptions.selectedIndex = result.option.index;
						else
							_selectOptions.setOptionIsSelected(result.option, true);
	
						action = _undoRedoStack.popNextUndoInGroup(action.groupNumber);
					} while (action != null);
	
					showCurrentlySelectedValue();
					_selVariables.focus();
					showOffScreenSelectedItemsWarning();
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Undoes the Rename action
			 * @param {VariableRenamedAction} action 
			 */
			function undoRename(action) {
				try {
					_selectOptions.findAndSelectOptionForVariable(action.newVariable.name);
					var result = _variables.renameVariable(action.newVariable, _variables.getActualVariableName(action.variable));
					if (result.hasOption)
						_selectOptions.setSelectedIndexAndRefresh(result.option.index);
					else
						_selectOptions.findAndSelectOptionForVariable(action.variable.name);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			try {
				if (_undoRedoStack.undoStackIsEmpty())
					return;

				var action = _undoRedoStack.popUndoStack();
				switch (action.actionType) {
					case UndoRedoActionType.added:
						undoAdd(action);
						break;
					case UndoRedoActionType.changed:
						undoChange(action);
						break;
					case UndoRedoActionType.deleted:
						undoDelete(action);
						break;
					case UndoRedoActionType.hidden:
						undoHide(action, true);
						break;
					case UndoRedoActionType.renamed:
						undoRename(action);
						break;
					case UndoRedoActionType.unhidden:
						undoHide(action, false);
						break;
					default:
						throw new Error(`Logic error: Unknown Undo Action Type: "${action.actionType}"`);
				}
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

	// #endregion

	// #region ======== HiddenVariables stuff ===================

		/**
		 * @readonly
		 * @enum {string}
		 */
		const HiddenVariablesViewMode = {
			all: "all",
			hide: "hide",
			only: "only",
			values: []
		};
		HiddenVariablesViewMode.values = Object.keys(HiddenVariablesViewMode).filter(v =&gt; v !== "values");

		class HiddenVariablesController {
			constructor() {
				this._enabled = false;
				this._name = "hiddenVariables";
				this._value = [];
			}

			loadContent() {
				try {
					this._value = _variables.getKMAppDataVariableValue(this._name) || [];
					this._viewMode = HiddenVariablesViewMode.hide;
					this._enabled = true;
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			disable() {
				this._enabled = false;
			}

			get enabled() { return this._enabled; }
			set enabled(value) { 
				if (value == this._enabled)
					return;
				this._enabled = value == true;
				if (value)
					this.loadContent();
			}

			// // Members to mimic a "Variable" object
			// get isHiddenVariables() { return true; }
			// get name() { return this._name }
			// get value() { return this._value; }
			// set value(value) { this._value = value; }

			// Other Members
			getSelectedVariablesToggleShouldHide(selections) {
				try {
					if (!this.enabled)
						return false;
					if (selections === undefined)
						selections = _selectOptions.getSelections().selections;
					if (!selections || selections.length === 0)
						return false;

					var hidden = selections.find(sel =&gt; {
						return this.getVariableIsHidden(sel.variable.name);
					});
					return hidden == null;
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}
			
			areAnyVariablesHiddenInThisViewMode() {
				try {
					if (!this._enabled || this._viewMode != HiddenVariablesViewMode.hide)
						return false;
					return _variables.data.find(variable =&gt; this.getVariableIsHidden(variable.name)) != null;
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			getNumberOfHiddenVariablesInThisViewMode() {
				if (!this._enabled || this._viewMode != HiddenVariablesViewMode.hide)
					return 0;
				return _variables.data.filter(variable =&gt; this.getVariableIsHidden(variable.name)).length;
			}

			getVariableIsHiddenInThisViewMode(name) {
				try {
					if (!this._enabled)
						return false;
					switch (this._viewMode) {
						case HiddenVariablesViewMode.hide:
							return this.getVariableIsHidden(name);
						case HiddenVariablesViewMode.only:
							return !this.getVariableIsHidden(name);
						case HiddenVariablesViewMode.all:
							return false;
						default:
							throw new Error(`Unexpected viewMode: "${this._viewMode}"`);
					}
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			getVariableIsHidden(name) { 
				if (!this._enabled)
					return false;
				return this._value.indexOf(name) &gt;= 0;
			}

			/**
			 * Saves the content to KM, but there's no need to call this yourself -
			 * it's called automatically when needed.
			 */
			saveContent() {
				try {
					if (this.enabled)
						_variables.saveKMAppDataVariableValue(this._name, this._value);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Hides/unhides a variable. Result is stored to KM immediately.
			 * @param {string} name 
			 * @param {bool} hidden
			 * @returns 
			 */
			setVariableIsHidden(name, hidden) {
				try {
					if (!this._enabled)
						return;
					if (hidden)
						this._value.push(name);
					else {
						let i = this._value.indexOf(name);
						if (i &lt; 0)
							throw new Error(`Could not find variable "${variable.name}" in setVariableIsHidden`)
						this._value.splice(i, 1);
					}
					this.saveContent();
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			/**
			 * Gets the viewMode.
			 * @type {HiddenVariablesViewMode} 
			 */
			get viewMode() { return this._enabled ? this._viewMode : HiddenVariablesViewMode.all; }

			/**
			 * Sets viweMode to HiddenVariablesViewMode.all. If the view mode was changed, fillSelect() is called.
			 * @returns {bool} true if the viewMode changed, false if it didn't.
			 */
			resetViewMode() {
				return this.setViewMode(HiddenVariablesViewMode.all);
			}

			/**
			 * Sets the viewMode. If the view mode was changed, fillSelect() is called.
			 * @param {HiddenVariablesViewMode} mode 
			 * @returns {bool} true if the viewMode changed, false if it didn't.
			 */
			setViewMode(mode, log) {
				try {
					if (!this._enabled)
						return false;
					if (HiddenVariablesViewMode.values.indexOf(mode) &lt; 0)
						throw new Error(`Invalid viewMode "${mode}"`);
					if (mode === this._viewMode)
						return false;
					this._viewMode = mode;
					fillSelect();
					return true;
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			toggleViewMode() {
				try {
					if (!this._enabled)
						return;
					var i = HiddenVariablesViewMode.values.indexOf(this._viewMode);
					if (i &lt; 0)
						throw new Error(`Unknown viewMode: "${this.viewMode}"`);
					i += 1;
					if (i &gt;= HiddenVariablesViewMode.values.length)
						i = 0;
					this.setViewMode(HiddenVariablesViewMode.values[i]);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}
		};
		var _hiddenVariables = new HiddenVariablesController();

		/**
		 * @param {Variable} variable
		 * @param {bool} hide True to hide, false to un-hide
		 * @param {{saveUndo: bool, undoGroupNumber: number, throwErrorIfOptionNotFound: bool}} [options]
		 */
		function hideVariable(variable, hide, options) {
			try {
				options = validateOptions(options, ["saveUndo", "undoGroupNumber", "throwErrorIfOptionNotFound"]);

				_hiddenVariables.setVariableIsHidden(variable.name, hide);
				if (options.saveUndo)
					_undoRedoStack.addVariableHiddenAction(variable.name, hide, options.undoGroupNumber);

				if (_hiddenVariables.getVariableIsHiddenInThisViewMode(variable.name))
					return _selectOptions.deleteOption(variable, options.refreshSelection);
				if (_selectOptions.getOptionByVariableName(variable.name, options.throwErrorIfOptionNotFound === true))
					return _selectOptions.updateOption(variable);
				return _selectOptions.addOption(variable, options.refreshSelection);
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		function btnHiddenVariables_toggleVariablesClicked() {
			try {
				var selections = _selectOptions.getSelections().selections;
				if (selections.length === 0)
					return;
				selections = selections.sort((s1, s2) =&gt; {
					return s1.option.index &lt; s2.option.index ? -1 : s1.option.index &gt; s2.option.index ? 1 : 0;
				});

				var undoGroupNumber = selections.length &gt; 1 ? _undoRedoStack.getNextGroupNumber() : null;

				_selectOptions.selectedIndex = -1;
				var hide = _hiddenVariables.getSelectedVariablesToggleShouldHide(selections);
				var optionWasSelected = false;
				var deletedIndex = null;
				selections.forEach(selection =&gt; {
					if (hide != _hiddenVariables.getVariableIsHidden(selection.variable.name)) {
						var result = hideVariable(selection.variable, hide, { saveUndo: true, undoGroupNumber: undoGroupNumber });
						if (result.hasOption) {
							if (!optionWasSelected) {
								_selectOptions.selectedIndex = result.option.index;
								optionWasSelected = true;
							} else
								_selectOptions.setOptionIsSelected(result.option, true);
						} else if (result.hasDeletedOptionIndex)
							deletedIndex = Math.max(deletedIndex, result.deletedOptionIndex);
						}
				});

				if (optionWasSelected) {
					showCurrentlySelectedValue();
					_selVariables.focus();
				} else
					_selectOptions.setSelectedIndexAndRefresh(deletedIndex);
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		function btnHiddenVariables_toggleViewModeClicked() {
			_hiddenVariables.toggleViewMode();
		}

	// #endregion

	// #region ======== FontController ==========================
		class FontSizeController {
			constructor(element, minFontSize, maxFontSize) {
				this._element = element;
				this._minFontSize = minFontSize;
				this._maxFontSize = maxFontSize;
				this._defaultFontSize = this.getFontSize();
				this._variableName = `${this._element.id}_fontSize`;
				this._load();
			}

			_load() {
				var fontSize = _userOptions.fontSize;
				if (fontSize)
					this.setFontSize(fontSize);
			}

			_save() {
				var fontSize = this.getFontSize();
				_userOptions.fontSize = fontSize === this._defaultFontSize ? null : fontSize;
			}

			canDecreaseFontSize() { return this.getFontSize() &gt; this._minFontSize; }
			canIncreaseFontSize() { return this.getFontSize() &lt; this._maxFontSize; }

			getFontSize() { 
				try {
					var fontSize = this._element.style.fontSize;
					if (!fontSize)
						fontSize = window.getComputedStyle(this._element).getPropertyValue("font-size");
					fontSize = /\d+/.exec(window.getComputedStyle(this._element).getPropertyValue("font-size"));
					if (!fontSize || fontSize.length != 1)
						throw new Error(`Could not extract the font size from the string "${fontSize}"`);
					return parseInt(fontSize[0]);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			setFontSize(value) {
				var fontSize = Math.max(Math.min(value, this._maxFontSize), this._minFontSize);
				console.log(`value: ${value}, fontSize: ${fontSize}, _minFontSize: ${this._minFontSize}, _maxFontSize: ${this._maxFontSize}`);
				this._element.style.fontSize = `${fontSize}px`;
				this._save();
			}

			resetFontSize() {
				this.setFontSize(this._defaultFontSize);
			}
		}

		/**
		 * @type FontSizeController
		 */
		var _fontSizeController = null;
	// #endregion		

	// #region ======== Misc Click Handlers =====================
		function btnAddVariableClicked() {

			function validateVariableName(data) {
				try {
					if (!data.text)
						return "Name is required, or click Cancel or press Escape"
					if (!_variables.isValidVariableName(data.text))
						return "Not a valid variable name";
					if (_variables.getVariableByName(data.text, {isDictionary: data.checked, caseInsensitive: true, returnNullIfNotFound: true}))
						return `This ${data.checked ? "dictionary" : "variable"} already exists`;
					if (_isAsync &amp;&amp; _variables.isLocalVariableName(data.text))
						return "You can't add Local or Instance variables when the Inspector is being shown Asynchronously."
					return null;
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			function handleResult(data) {
				try {
					if (data.canceled)
						return;
	
					clearSearchFilter();
					var variable = data.checked ? _variables.createDictionaryVariable(data.text) : _variables.createVariable(data.text);
					var options = {
						saveUndo: _variables.isVariableEmpty(variable)
					}
					var result = _variables.addVariable(variable, options);
					if (result.hasOption)
						_selectOptions.setSelectedIndexAndRefresh(result.option.index);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			_modalDialogController.showEditBoxDialog("Add a New Variable", {checkboxLabel: "Dictionary"}, validateVariableName, handleResult);
		}

		function btnCodeClicked() {
			_miscStateController.fixedFont = !_miscStateController.fixedFont;
		}

		function btnCopyNamesClicked() {
			try {
				var selections = _selectOptions.getSelections().selections;
				if (selections.length === 0)
					return;

				var names = selections.map(s =&gt; _variables.getActualVariableName(s.variable)).join("\n");
				_internalTasksMacro.copyToClipboard(names);
				_statusLine.showMomentaryMessage("Variable Name(s) copied to the clipboard");
				_selVariables.focus();
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		function btnCopyVariablesClicked() {
			try {
				var selections = _selectOptions.getSelections().selections;
				if (selections.length === 0)
					return;

				var values = selections.map(s =&gt; {
					var result = [];
					result.push(`${_variables.getActualVariableName(s.variable)}:`);
					if (s.variable.isDictionary)
						result.push(JSON.stringify(s.variable.value));
					else
						result.push(s.variable.value);
					return result.join(" ");
				}).join("\n");
				_internalTasksMacro.copyToClipboard(values);
				_statusLine.showMomentaryMessage("Variable(s) copied to the clipboard");
				_selVariables.focus();
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		function btnDeleteVariablesClicked() {
			try {
				var selections = _selectOptions.getSelections().selections;
				if (selections.length === 0)
					return;
				selections = selections.sort((s1, s2) =&gt; {
					return s1.option.index &lt; s2.option.index ? 1 : s1.option.index &gt; s2.option.index ? -1 : 0;
				});

				var undoGroupNumber = selections.length &gt; 1 ? _undoRedoStack.getNextGroupNumber() : null;

				var optionIndexToSelect = null;
				selections.forEach(selection =&gt; {
					var result = _variables.deleteVariable(selection.variable, { saveUndo: true, undoGroupNumber: undoGroupNumber });
					if (result.hasDeletedOptionIndex) {
						if (optionIndexToSelect == null)
							optionIndexToSelect = result.deletedOptionIndex;
						else
							optionIndexToSelect = Math.min(optionIndexToSelect, result.deletedOptionIndex);
					}
				});

				_selectOptions.setSelectedIndexAndRefresh(optionIndexToSelect);
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		function btnEditClicked() {
			try {
				var selectedVariable = _selectOptions.getSelectedVariable();
				if (!selectedVariable)
					return;

				if (isLocalVariableCantEdit(selectedVariable)) {
					_modalDialogController.showInfoDialog("You can't edit Local or Instance variables when the Inspector is being shown Asynchronously.");
					return;
				}
				
				if (_selectOptions.getSelectedVariable())
					setEditMode(true);
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		function btnEditOKClicked() {
			try {
				var text = _txtValue.value;
				if (text &amp;&amp; _isShowingJsonData) {
					try {
						JSON.parse(text);
					} catch (e) {
						_modalDialogController.showInfoDialog(e.message);
						return;
					}
				}
				setEditMode(false);
				var selection = _selectOptions.getSelection();
				if (!selection)
					return;
				_variables.changeVariable(selection.variable, _txtValue.value, {saveUndo: true});
				showCurrentlySelectedValue();
				_selVariables.focus();
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		function btnEditCancelClicked() {
			try {
				_txtValue.value = _selectOptions.getSelectedVariable().value;
				setEditMode(false);
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		function btnHelpClicked() {
			_modalDialogController.showDictionaryHelp();
		}

		function btnJsonClicked() {
			try {
				var selectedVariable = _selectOptions.getSelectedVariable();
				if (!selectedVariable || !selectedVariable.jsonValue)
					return;

				if (selectedVariable.isDictionary)
					_miscStateController.jsonDictionaryDisplayMode = !_miscStateController.jsonDictionaryDisplayMode;
				else
					_miscStateController.jsonVariableDisplayMode = !_miscStateController.jsonVariableDisplayMode;
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		function btnRenameVariableClicked() {

			function validateRenameName(data, variable) {
				try {
					if (!data.text)
						return "Name is required, or click Cancel or press Escape"
					if (data.text.toLowerCase() === variable.name.toLowerCase())
						return null;
	
					const vord = variable.isDictionary ? "dictionary" : "variable";
	
					if (!_variables.isValidVariableName(data.text))
						return `Not a valid ${vord} name`;
					if (_variables.getVariableByName(data.text, {isDictionary: variable.isDictionary, caseInsensitive: true, returnNullIfNotFound: true}))
						return `This ${vord} already exists`;
	
					if (variable.isDictionary) {
						let dict = _variables.createDictionaryVariable(data.text);
						if (!_variables.isDictionaryEmpty(dict))
							return `This dictionary already exists (it's not in the list right now, but it exists in KM)`;
					} else {
						let v = _variables.createVariable(data.text);
						if (v.value)
							return `This variable already exists (it's not in the list right now, but it exists in KM)`;
					}
	
					if ((variable.isLocalVariable === true) !== (_variables.isLocalVariableName(data.text) === true))
						return `You can't switch between Local/Instance Variables and Global Variables`;
					return null;
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			function handleResult(data, variable) {
				try {
					if (data.canceled)
						return;
					if (data.text.toLowerCase() === variable.name.toLowerCase())
						return null;
	
					clearSearchFilter();
					var result = _variables.renameVariable(variable, data.text, {saveUndo: true});
					if (result.hasOption)
						_selectOptions.setSelectedIndexAndRefresh(result.option.index);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			try {
				var variable = _selectOptions.getSelectedVariable();
				if (!variable)
					return;
				if (_isAsync &amp;&amp; variable.isLocalVariable) {
					_modalDialogController.showInfoDialog("You can't rename Local or Instance variables when the Inspector is being shown Asynchronously.")
					return;
				}

				_modalDialogController.showEditBoxDialog(
					`Rename ${variable.isDictionary ? "Dictionary" : "Variable"}`,
					{initialValue: _variables.getActualVariableName(variable)}, 
					(data) =&gt; validateRenameName(data, variable), 
					(data) =&gt; handleResult(data, variable));
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		function btnSearchKMClicked() {
			try {
				var variable = _selectOptions.getSelectedVariable();
				if (!variable)
					return;
				_internalTasksMacro.searchKM(_variables.getActualVariableName(variable));
				_selVariables.focus();
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		function btnSortClicked() {
			_variableSortMode.setSortBySize(!_variableSortMode.sortBySize, true);
		}

		function btnWordWrapClicked() {
			_miscStateController.wordWrap = !_miscStateController.wordWrap;
		}
		
		function openConsoleClicked() {
			if (_openConsoleMacroUUID)
				window.KeyboardMaestro.Trigger(_openConsoleMacroUUID);
		}

		function optionsMenuClicled() {

			function loadLocalVariables() {
				try {
					Object.keys(document.kmvar).forEach(name =&gt; {
						if (_variables.isLocalVariableName(name)) {
							var value = _variables.getKMVariableValue(name);
							var variable = _variables.getVariableByName(name, {returnNullIfNotFound: true});
							if (variable) {
								variable.value = value;
								_variables.setupJsonValue(variable);
							} else {
								variable = _variables.createVariable(name);
								_variables._data.push(variable);
							}
						}
					});
					fillSelect();
					setTimeout(() =&gt; _statusLine.showMomentaryMessage("Local Variables have been loaded/reloaded"), 100);
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			function optionsDialogDone(result) {
				try {
					switch (result) {
						case "loadLocalVariables":
							_undoRedoStack.clear();
							loadLocalVariables();
							break;
						case "loadGlobalVariables":
							_undoRedoStack.clear();
							_internalTasksMacro.reloadData(true, false);
							break;
						case "loadDictionaries":
							_undoRedoStack.clear();
							_internalTasksMacro.reloadData(false, true);
							break;
						case "toggleHiddenVariables":
							_undoRedoStack.clear();
							_hiddenVariables.enabled = !_hiddenVariables.enabled;
							fillSelect();
							break;
						default:
							_inpSearchFilter.focus();
							break;
					}
				} catch (e) {
					ErrorHandler.handle(e);
				}
			}

			try {
				_modalDialogController.showOptions((result) =&gt; optionsDialogDone(result));
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		function selVariablesDblClicked() {
			if (_btnEdit.isEnabled() &amp;&amp; _btnEdit.isVisible())
				btnEditClicked();
		}
	// #endregion

	// #region ======== Misc Functions ==========================

		function clearTextSelection(){
			try {
				// if (window.getSelection) {
				// 	var sel = window.getSelection();
				// 	if (sel &amp;&amp; sel.removeAllRanges)
				// 		sel.removeAllRanges();
				// } else 
				if (document.selection)
					document.selection.empty();
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		function escape(s) {
			let lookup = {
				'&amp;': "&amp;amp;",
				'"': "&amp;quot;",
				'\'': "&amp;apos;",
				'&lt;': "&amp;lt;",
				'&gt;': "&amp;gt;"
			};
			return s.replace( /[&amp;"'&lt;&gt;]/g, c =&gt; lookup[c] );
		}

		function isLocalVariableCantEdit(variable) {
			if (!_isAsync || !variable)
				return false;
			return variable.isLocalVariable;
		}

		function setEditMode(value) {
			try {
				_editMode = value;
				enableControls();
				if (value) {
					_txtValue.focus();
					_txtValue.select();
				} else {
					clearTextSelection();
					_selVariables.focus();
				}
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}

		function setSelectIndexAsync(index) {
			if (_selVariables.options.length &lt;= 0)
				return;
			setTimeout(() =&gt; {
				_selectOptions.selectedIndex = index;
				showCurrentlySelectedValue();
				_selVariables.focus();
			}, 10);
		}
	
		function validateOptions(options, validOptions) {
			try {
				if (options == null)
					return {};
				Object.keys(options).forEach(key =&gt; {
					if (validOptions.indexOf(key) &lt; 0)
						throw new Error(`Invalid Option: "${key}"`);
				});
				return options;
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}
	
	// #endregion			

	// #region ======== Dictionary Stuff ========================

		// #region ======== DictionarySortMode ======================
			class DictionarySortMode {
				constructor() {
					this.keyColumnType ="key";
					this.valueColumnType = "value";
					this.sortByKeyAscending = "sortByKeyAscending";
					this.sortByKeyDescending = "sortByKeyDescending";
					this.sortByValueAscending = "sortByValueAscending";
					this.sortByValueDescending = "sortByValueDescending";
					this.currSortMode = this.sortByKeyAscending;
					this.sortByKeyModes = [this.sortByKeyAscending, this.sortByKeyDescending];
					this.sortByValueModes = [this.sortByValueAscending, this.sortByValueDescending];
					this.sortModes = { [this.keyColumnType]: this.sortByKeyModes, [this.valueColumnType]: this.sortByValueModes};
					this.sortCodes = ["", ""];
				}

				getSortCode(columnType) {
					var i = this.sortModes[columnType].indexOf(this.currSortMode);
					return i &lt; 0 ? "" : this.sortCodes[i];
				}
	
				/**
				 * Compares two row/key combinations based on the current sort mode.
				 * @param {{key: string, value: string}} a 
				 * @param {{key: string, value: string}} b 
				 * @returns 
				 */
				sortCompare(a, b) {

					function stringSortCompare(a1, b1, a2, b2) {
						return a1 &lt; b1 ? -1 : a1 &gt; b1 ? 1 : a2 &lt; b2 ? -1 : a2 &gt; b2 ? 1 : 0;
					}

					switch (_dictionarySortMode.currSortMode) {
						case _dictionarySortMode.sortByKeyAscending:
							return stringSortCompare(a.key, b.key, a.value, b.value);
						case _dictionarySortMode.sortByKeyDescending:
							return stringSortCompare(b.key, a.key, a.value, b.value);
						case _dictionarySortMode.sortByValueAscending:
							return stringSortCompare(a.value, b.value, a.key, b.key);
						case _dictionarySortMode.sortByValueDescending:
							return stringSortCompare(b.value, a.value, a.key, b.key);
						default:
							throw new Error(`Uknown Dictionary SortMode "${_dictionarySortMode.currSortMode}"`);
					}
				}

				toggleSortCode(columnType) {
					var sortModes = this.sortModes[columnType];
					var i = sortModes.indexOf(this.currSortMode) + 1;
					if (i &gt;= sortModes.length)
						i = 0;
					this.currSortMode = sortModes[i];
				}
			}

			/**
			 * @type DictionarySortMode
			 */
			const _dictionarySortMode = new DictionarySortMode();
		// #endregion

		// #region ======== DictionaryCellNavigator =================
			class DictionaryCellNavigator {
				constructor(cell) {
					this._cell = cell;
					this._colIndex = Array.prototype.indexOf.call(this._cell.parentElement.children, this._cell);
				}

				getCellAbove() {
					try {
						var prevRow = this._cell.parentElement.previousElementSibling;
						return prevRow ? prevRow.children[this._colIndex] : null;
					} catch (e) {
						ErrorHandler.handle(e);
						return null;
					}
				}

				getCellBelow() {
					try {
						var nextRow = this._cell.parentElement.nextElementSibling;
						if (!nextRow)
							return null;
						var dictCellBelow = new DictionaryCell(nextRow.children[this._colIndex]);
						if (!dictCellBelow.isNewRow || !dictCellBelow.isValueCell || dictCellBelow.rowKey)
							return dictCellBelow.cell;
						return _dictionaryHelper.getRowKeyCellElement(nextRow);
					} catch (e) {
						ErrorHandler.handle(e);
						return null;
					}
				}

				getCellLeft() {
					try {
						var prevCell = this._cell.previousElementSibling;
						while (prevCell &amp;&amp; !prevCell.hasClass("dictCell")) {
							prevCell = prevCell.previousElementSibling;
						}
						if (prevCell)
							return prevCell;

						var prevRow = this._cell.parentElement.previousElementSibling;
						if (!prevRow)
							return null;

						var result = prevRow.lastChild;
						if (!result.hasClass("dictCell"))
							throw new Error(`Expected last cell to have the class "dictCell"`);
						return result;
					} catch (e) {
						ErrorHandler.handle(e);
						return null;
					}
				}

				getCellRight() {
					try {
						var nextCell = this._cell.nextElementSibling;
						if (nextCell) {
							if (!nextCell.hasClass("dictCell"))
								throw new Error(`Expected next cell to have the class "dictCell"`);
							return nextCell;
						}
						var nextRow = this._cell.parentElement.nextElementSibling;
						if (!nextRow)
							return null;

						var cell = nextRow.firstChild;
						while (cell &amp;&amp; !cell.hasClass("dictCell")) {
							cell = cell.nextElementSibling;
						}
						if (!cell)
							throw new Error(`Didn't find any cells with the class "dictCell" in the row`);
						return cell;
					} catch (e) {
						ErrorHandler.handle(e);
						return null;
					}
				}
			}
		// #endregion

		// #region ======== DictionaryCell ==========================
			class DictionaryCell {
				constructor(cellOrContentElement) {
					if (cellOrContentElement.hasClass("dictCellContent")) {
						this._contentElement = cellOrContentElement;
						this._cell = this._contentElement.parentElement;
					} else if (cellOrContentElement.hasClass("dictCell")) {
						this._cell = cellOrContentElement;
						this._contentElement = this._cell.querySelector(".dictCellContent");
					} else if (cellOrContentElement.hasClass("trashCan")) {
						this._contentElement = cellOrContentElement.parentElement;
						this._cell = this._contentElement.parentElement;
					} else
						throw new Error(`Element isn't a Dictionary Cell`);

					this._isKeyCell = this._cell.hasClass("dictKeyCell");
					this._isValueCell = this._cell.hasClass("dictValueCell");
					this._isDeleteButtonCell = this._cell.hasClass("dictDeleteCell");

					this._row = this._cell.parentElement;
					this._rowKeyCellContentElement = _dictionaryHelper.getRowKeyCellContentElement(this._row);
					this._rowValueCellContentElement = _dictionaryHelper.getRowValueCellContentElement(this._row);
					this._isNewRow = _dictionaryHelper.getIsNewRow(this._row);
				}

				get cell() { return this._cell; }
				get contentElement() { return this._contentElement; }
				get value() { 
					if (this._isDeleteButtonCell)
						return "";
					return this._contentElement.innerText.trimEnd(); 
				}
				set value(value) {
					if (this._isDeleteButtonCell)
						return;
					if (!value)
						this._contentElement.innerHTML = "&amp;nbsp;";
					else
						this._contentElement.innerText = value;
				}
				get isDictionaryCell() { return true; }
				get isKeyCell() { return this._isKeyCell; }
				get isValueCell() { return this._isValueCell; }
				get isDeleteButtonCell() { return this._isDeleteButtonCell; }
				get isNewRow() { return DictionaryCell.isNewRow(this._row); }
				get row() { return this._row; }
				get rowKey() { return this._rowKeyCellContentElement.innerText.trimEnd(); }
				get rowValue() { return this._rowValueCellContentElement.innerText.trimEnd(); }
				get isNewRow() { return this._isNewRow; }

				animateForDelete(duration, callback) {
					try {
						var elements = this._row.querySelectorAll(".dictCellContent");
						elements.forEach(ele =&gt; {
							var trashCan = ele.querySelector(".trashCan");
							if (trashCan) {
								trashCan.setVisible(false);
								// ele.animate([
								// 	{ transform: "scale(1) translateY(0)" },
								// 	{ transform: "scale(0.1) translateY(-15px)" },
								// ], {
								// 	duration: duration
								// });
							} else {
								ele.style.fontSize = "1px";
								ele.animate([
									{ fontSize: _fontSizeController.getFontSize()+"px" },
									{ fontSize: "1px" },
								], {
									duration: duration
								});
							}
						});
						if (callback)
							setTimeout(() =&gt; callback(this), duration+10);
					} catch (e) {
						ErrorHandler.handle(e);
					}
				}

				animateForUndelete(duration, callback) {
					try {
						let elements = this._row.querySelectorAll(".dictCellContent");
						var fontSize = _fontSizeController.getFontSize() + "px";
						elements.forEach(ele =&gt; {
							let trashCan = ele.querySelector(".trashCan");
							if (trashCan) {
								trashCan.setVisible(false);
							} else {
								ele.style.fontSize = fontSize;
								ele.animate([
									{ fontSize: "1px" },
									{ fontSize: fontSize }
								], {
									duration: duration
								});
							}
						});
						setTimeout(() =&gt; {
							let elements = this._row.querySelectorAll(".dictCellContent");
							elements.forEach(ele =&gt; {
								let trashCan = ele.querySelector(".trashCan");
								if (trashCan) {
									trashCan.setVisible(true);
									ele.animate([
										{ opacity: 0 },
										{ opacity: 1 },
									], {
										duration: 200
									});
								} else
									ele.style.fontSize = "1em";
							});
							if (callback)
								callback(this);
						}, duration+10);
					} catch (e) {
						ErrorHandler.handle(e);
					}
				}

				setErrorMessage(errorMessage) {
					var errorMessageElement = this._cell.querySelector(".dictCellError");
					if (!errorMessage) {
						if (errorMessageElement)
							errorMessageElement.remove();
					} else {
						if (!errorMessageElement) {
							errorMessageElement = document.createElement("div");
							errorMessageElement.className = "dictCellError";
							this._cell.appendChild(errorMessageElement);
						}
						errorMessageElement.innerText = errorMessage;
					}
				}

				get cellType() { return this._isKeyCell ? "Key" : this._isValueCell ? "Value" : this._isDeleteButtonCell ? "DeleteButton" : "unknown"; }
				toString() { 
					return [
						`${this.cellType} Cell`,
						`Value: "${this.value}"`,
						`RowKey: "${this.rowKey}"`,
						`RowValue: "${this.rowValue}"`
					].join("; ");
				}					
			}
		// #endregion

		// #region ======== DictionaryCellEditAdapter ===============
			var DictionaryCellEditAdapter = (function() {
				var _variable = null;
				var _cell = null;
				var _originalValue;

				function _attach(variable, cell) {
					try {
						if (_isAttached())
							throw new Error(`EditAdapter is already attached`);

						_variable = variable;

						_cell = new DictionaryCell(cell);
						_originalValue = _cell.value;

						_cell.contentElement.contentEditable = "true";
						_cell.contentElement.toggleClass("dictCellEdit", true);
						_cell.contentElement.addEventListener("blur", _contentElementBlur);

						disableDictDelete(true);

						// position the cursor
						const selection = document.getSelection();
						const range = document.createRange();
						selection.removeAllRanges();
						range.selectNodeContents(_cell.contentElement);
						range.collapse(false);
						selection.addRange(range);

						enableControls();
						_cell.contentElement.focus();
						return true;
					} catch (e) {
						ErrorHandler.handle(e);
					}
				}

				function _contentElementBlur(event) {
					_validateAndSave();
				}

				function disableDictDelete(disable) {
					var row = _dictionaryHelper.getFirstRowElement();
					while (row &amp;&amp; !_dictionaryHelper.getIsNewRow(row)) {
						_dictionaryHelper.getRowTrashCanElement(row).swapClasses("trashCanDisabled", "trashCanEnabled", disable);
						row = row.nextElementSibling;
					}
				}

				function _detach(resetValue) {
					try {
						if (!_isAttached())
							return;

						_setErrorMessage(null);
						_cell.contentElement.contentEditable = "false";
						_cell.contentElement.toggleClass("dictCellEdit", false);
						_cell.contentElement.removeEventListener("blur", _contentElementBlur);
						if (resetValue)
							_cell.value = _originalValue;
						
						disableDictDelete(false);

						_cell = null;
						_variable = null;
						enableControls();
						_selVariables.focus();
					} catch (e) {
						ErrorHandler.handle(e);
					}
				}

				function _isAttached() {
					return _cell != null;
				}

				function _setErrorMessage(errorMessage) {
					try {
						if (!_isAttached()) {
							if (errorMessage)
								throw new Error(`Cell Edit Adaptor isn't Attached`);
							return;
						}
						_cell.setErrorMessage(errorMessage);
					} catch (e) {
						ErrorHandler.handle(e);
					}
				}

				function _validateAndSave() {

					function makeValidationError(message) {
						var error = new Error(message);
						error.isValidationError = true;
						return error;
					}

					function validate(newValue) {
						try {
							if (!_cell.isKeyCell)
								return true;

							if (!newValue)
								throw makeValidationError("Key is required");

							if (_variable.value[newValue] != null)
								throw makeValidationError("Duplicate key");

							return true;
						} catch (e) {
							if (e.isValidationError) {
								_setErrorMessage(e.message);
								setTimeout(() =&gt; _cell.contentElement.focus(), 10);
							} else
								ErrorHandler.handle(e);
							return false;
						}
					}

					try {
						if (!_isAttached())
							throw new Error(`Cell Edit Adaptor isn't Attached`);

						var newValue = _cell.value.trim();
						if (newValue !== _originalValue) {
							if (!validate(newValue))
								return false;

							var undoDictionaryAction = null;
							var newDictionaryContent = _variable.value.clone();
							if (_cell.isKeyCell) {
								var value = _originalValue ? _variable.value[_originalValue] : "";
								if (_originalValue) {
									delete newDictionaryContent[_originalValue];
									undoDictionaryAction = new UndoRedoDictionaryKeyChangedAction(_originalValue, newValue);
								} else
									undoDictionaryAction = new UndoRedoDictionaryKeyAddedAction(newValue);
								newDictionaryContent[newValue] = value;
							} else {
								undoDictionaryAction = new UndoRedoDictionaryValueChangedAction(_cell.rowKey, newDictionaryContent[_cell.rowKey], newValue);
								newDictionaryContent[_cell.rowKey] = newValue;
							}
							_variables.changeVariable(_variable, newDictionaryContent, { saveUndo: true, undoDictionaryAction: undoDictionaryAction });

							// This is necessary in case the new value is empty, because if it is,
							// we need to set innerHTML to &amp;nbsp;
							_cell.value = newValue;

							if (_cell.isNewRow) {
								_dictionaryHelper.getRowTrashCanElement(_cell.row).swapClasses("trashCanEnabled", "trashCanDisabled", true);
								_dictionaryBuilder.addNewDictionaryRow();
							}
						}
						_detach();

						return true;
					} catch (e) {
						ErrorHandler.handle(e);
					}
				}
				
				return {
					attach: function(variable, cell) {
						return _attach(variable, cell);
					},

					detach: function(resetValue) {
						_detach(resetValue);
					},

					getCell: function() {
						return _cell;
					},

					isAttached: function () {
						return _isAttached();
					},

					isAttachedTo(cell) {
						return cell === _cell;
					},
					
					setErrorMessage: function(errorMessage) {
						_setErrorMessage(errorMessage);
					},

					validateAndSave: function() {
						return _validateAndSave();
					}

				};
			})
			var _dictionaryCellEditAdapter = new DictionaryCellEditAdapter();
		// #endregion

		// #region ======== DictionaryBuilder =======================
			class DictionaryBuilder {
				constructor () {
					this._buildNumber = 0;
				}

				_dictCellDoubleClick(event) {
					try {
						if (_dictionaryCellEditAdapter.isAttached())
							return;
		
						var cell = new DictionaryCell(event.target);
						if (cell.isNewRow &amp;&amp; cell.isValueCell &amp;&amp; !cell.rowKey) {
							setTimeout(() =&gt; { _modalDialogController.showInfoDialog("You have to enter the Key first."); }, 10)
							return false;
						}
						_dictionaryCellEditAdapter.attach(_selectOptions.getSelectedVariable(), event.target);
						return false;
					} catch (e) {
						ErrorHandler.handle(e);
					}
				}
	
				_addDictionaryColumnHeader(tr, text, columnType) {
					var th = document.createElement("th");
					tr.appendChild(th);
					if (text) {
						th.dataset.columnType = columnType;
						var sortCode = _dictionarySortMode.getSortCode(columnType);
						var textNode = document.createTextNode(`${text} ${sortCode}`)
						th.appendChild(textNode);
						if (columnType === _dictionarySortMode.keyColumnType) {
							let span = document.createElement("span");
							span.className = "resize-handle";
							span.innerHTML = "&amp;nbsp;"
							th.appendChild(span);
							new ResizableColumnHandler(th, span);
						}
						th.addEventListener("click", (event) =&gt; {
							if (event.target !== th || th.dataset.resizing)
								return;

							_dictionarySortMode.toggleSortCode(event.target.dataset.columnType);
							showCurrentlySelectedValue();
						});
					}
					return th;
				}
		
				/**
				 * Makes a Dictionary Cell
				 * @param {HTMLTableRowElement} tr 
				 * @param {{cellValue: string, isDeleteCell: bool, disableTrashCan: bool}} options 
				 * @returns 
				 */
				_addDictionaryCell(tr, options) {
					try {
						options = validateOptions(options, ["cellValue", "isDeleteCell", "disableTrashCan"]);
		
						var cell = tr.insertCell(-1);
						cell.className = options.isDeleteCell ? "dictDeleteCell" : "dictCell";
						var div = document.createElement("div");
						div.className = "dictCellContent";
						cell.appendChild(div);
						if (options.isDeleteCell) {
							div.toggleClass("dictDeleteCellContent", true);
							var a = document.createElement("a");
							a.href = "#";
							a.className = "trashCan";
							a.swapClasses("trashCanDisabled", "trashCanEnabled", options.disableTrashCan == true);
							a.onclick = (event) =&gt; {
								var cell = new DictionaryCell(event.target);
								_dictionaryHelper.deleteKeyAndRowAsync(cell, {saveUndo: true});
							};
							div.appendChild(a, -1);
						} else {
							if (!options.cellValue)
								div.innerHTML = "&amp;nbsp;"
							else
								div.innerText = options.cellValue;
							cell.ondblclick = (event) =&gt; { 
								_dictionaryHelper.editCell(event.target);
								return false;
							};
				
							// This prevents the text being selected on a double-click.
							div.addEventListener('mousedown', function (event) {
								if (!_dictionaryCellEditAdapter.isAttached() &amp;&amp; event.detail &gt; 1) {
									event.preventDefault();
								}
							}, false);
						}
			
						return cell;
					} catch (e) {
						ErrorHandler.handle(e);
					}
				}
		
				addDictionaryRow(tbody, index, key, value, disableTrashCan) {
					var tr = tbody.insertRow(index);
					tr.className = "selectableRow";

					if (_dictionaryBuild_logging)
						tr.dataset.buildNumber = `${this._buildNumber}`;
		
					var cell = this._addDictionaryCell(tr, {isDeleteCell: true, disableTrashCan: disableTrashCan});
		
					cell = this._addDictionaryCell(tr, {cellValue: key});
					cell.toggleClass("dictKeyCell", true);
		
					cell = this._addDictionaryCell(tr, {cellValue: value});
					cell.toggleClass("dictValueCell", true);
		
					return tr;
				}
		
				addNewDictionaryRow() {
					var tbody = document.querySelector(".tblDictionary tbody");
					this.addDictionaryRow(tbody, -1, "", "", true);
				}

				build(variable) {
					if (_dictionaryBuild_logging) {
						this._buildNumber += 1;
						console.log(`Building Table - Build Number: ${this._buildNumber}`); // \nStack Trace:\n${getStackTrace()}`);
					}
					var dictionary = variable.value;
					_txtValue.setVisible(false);
					_divDictionary.setVisible(true);
					var table = document.createElement("table");
					table.className = "tblDictionary"
	
					var thead = table.createTHead();
					var tr = thead.insertRow(-1);
	
					var th = this._addDictionaryColumnHeader(tr, "", "");
					th = this._addDictionaryColumnHeader(tr, "Key", _dictionarySortMode.keyColumnType);
					th = this._addDictionaryColumnHeader(tr, "Value", _dictionarySortMode.valueColumnType);
	
					var tbody = table.createTBody();
					Object.keys(dictionary).map(k =&gt; { return { key: k, value: dictionary[k] }; })
						.sort((a, b) =&gt; _dictionarySortMode.sortCompare(a, b))
						.forEach(item =&gt; {
							this.addDictionaryRow(tbody, -1, item.key, item.value);
						});
					this.addDictionaryRow(tbody, -1, "", "", true);
	
					_divDictionary.innerHTML = "";
					_divDictionary.appendChild(table);
				}
			}
			const _dictionaryBuilder = new DictionaryBuilder();
		// #endregion

		// #region ======== DictionaryHelper ========================
			class DictionaryHelper {
				constructor() {}

				getRowKeyCellElement(rowElement) { return rowElement.querySelector(".dictKeyCell"); }
				getRowKeyCellContentElement(rowElement) { return rowElement.querySelector(".dictKeyCell .dictCellContent"); }
				getRowKey(rowElement) { return this.getRowKeyCellContentElement(rowElement).innerText; }
				getRowValueCellElement(rowElement) { return rowElement.querySelector(".dictValueCell"); }
				getRowValueCellContentElement(rowElement) { return rowElement.querySelector(".dictValueCell .dictCellContent"); }
				getRowValue(rowElement) { return this,this.getRowValueCellContentElement(rowElement).innerText; }
				getRowTrashCanElement(rowElement) { return rowElement.querySelector(".trashCan"); }
				getIsNewRow(rowElement) { return rowElement.nextElementSibling == null; }
				getFirstRowElement() { return _divDictionary.querySelector("tbody").firstChild; }
				getTableBodyElement()  { return _divDictionary.querySelector("tbody"); }

				/**
				 * Adds a new row to the table, adds the key and value to the variable's value,
				 * and saves the variable changes. This uses setTimeout() to finish the action, so don't
				 * assume it's complete when the call returns. This does NOT save an Undo action, because
				 * this is only ever called from Undo/Redo.
				 * @param {string} key 
				 * @param {string} value 
				 */
				addKeyAndRowForUndelete(key, value) {
					try {
						var variable = _selectOptions.getSelection().variable;
						var newDictionaryContent = variable.value.clone();
						newDictionaryContent[key] = value;
						_variables.changeVariable(variable, newDictionaryContent, { noOptionElement: true });
						var index = this.getInsertBeforeRowIndex(key, value);
						var body = this.getTableBodyElement();
						var row = _dictionaryBuilder.addDictionaryRow(body, index, key, value);
						row.scrollIntoViewIfNeeded();
						var cell = new DictionaryCell(this.getRowKeyCellElement(row));
						_momentaryClassController.apply(cell.row, "selectedRow", 1500);
						cell.animateForUndelete(300);
					} catch (e) {
						ErrorHandler.handle(e);
					}
				}

				/**
				 * Deletes the table row for the specified cell, deletes the key in the variable's value,
				 * and saves the variable changes. This uses setTimeout() to finish the action, so don't
				 * assume it's complete when the call returns.
				 * @param {DictionaryCell} cell any cell in the row
				 * @param {{saveUndo: bool}} [options]
				 */
				deleteKeyAndRowAsync(cell, options) {

					function finishDelete(cell) {
						try {
							var variable = _selectOptions.getSelectedVariable();
							var newDictionaryContent = variable.value.clone();
							var undoDictionaryAction = new UndoRedoDictionaryKeyDeletedAction(cell.rowKey, cell.rowValue);
							delete newDictionaryContent[cell.rowKey];
							_variables.changeVariable(variable, newDictionaryContent, { saveUndo: options.saveUndo, undoDictionaryAction: undoDictionaryAction});
							cell.row.remove();
							enableControls();
						} catch (e) {
							ErrorHandler.handle(e);
						}
					}
		
					try {
						options = validateOptions(options, ["saveUndo"]);
						cell.animateForDelete(300, finishDelete);
					} catch (e) {
						ErrorHandler.handle(e);
					}
				}

				/**
				 * @param {DictionaryCell | HTMLElement} cell 
				 */
				editCell(cell) {
					try {
						if (_dictionaryCellEditAdapter.isAttached())
							return;
						if (!cell.isDictionaryCell)
							cell = new DictionaryCell(cell);
						if (cell.isNewRow &amp;&amp; cell.isValueCell &amp;&amp; !cell.rowKey) {
							setTimeout(() =&gt; { _modalDialogController.showInfoDialog("You have to enter the Key first."); }, 10)
							return;
						}
						_dictionaryCellEditAdapter.attach(_selectOptions.getSelectedVariable(), cell.cell);
					} catch (e) {
						ErrorHandler.handle(e);
					}
				}

				/**
				 * Finds and selects the Dictionary Option for the specified variable, and returns
				 * a DictionaryCell for the Key cell for specified rowKey. If the dictionary is not
				 * currently selected, it will be selected. If the dictionary is not available because
				 * of a filter, the filter will be cleared.
				 * @param {string} variableName
				 * @param {string} keyName
				 * @param {{highlightRow: bool, highlightKeyCell: bool, highlightValueCell: bool, returnNullIfKeyNotFound: bool}} [options]
				 * @returns {{cell: DictionaryCell, optionWasAlreadySelected: bool}}
				 */
				findAndSelectKeyCell(variableName, keyName, options) {

					function findTheKeyCell(self) {
						try {
							var row = self.getFirstRowElement();
							while (row) {
								if (!self.getIsNewRow(row)) {
									if (self.getRowKey(row) === keyName)
										break;
								}
								row = row.nextElementSibling;
							}
			
							if (!row) {
								if (options.returnNullIfKeyNotFound)
									return self;
								throw new Error(`Can't find row for keyName "${keyName}"`);
							}

							row.scrollIntoViewIfNeeded();
							return new DictionaryCell(self.getRowKeyCellElement(row));
						} catch (e) {
							ErrorHandler.handle(e);
						}
					}

					try {
						options = validateOptions(options, ["highlightRow", "highlightKeyCell", "highlightValueCell", "returnNullIfKeyNotFound"]);
						var alreadySelected = _selectOptions.findAndSelectOptionForVariable(variableName).optionWasAlreadySelected === true;
						var cell = findTheKeyCell(this);
						if (cell) {
							if (options.highlightRow)
								_momentaryClassController.apply(cell.row, "selectedRow", 1500);
							else if (options.highlightKeyCell)
								_momentaryClassController.apply(this.getRowKeyCellElement(cell.row), "selectedCell", 1500);
							else if (options.highlightValueCell)
								_momentaryClassController.apply(this.getRowValueCellElement(cell.row), "selectedCell", 1500);
						}
						return {
							cell: cell,
							optionWasAlreadySelected: alreadySelected
						};
					} catch (e) {
						ErrorHandler.handle(e);
					}
				}

				/**
				 * Returns the index of the table row for use in tbody.insertRow(), to insert the
				 * row in the property sort position based on the specified key/value combination.
				 * @param {string} key 
				 * @param {string} value 
				 * @returns {HTMLTableRowElement}
				 */
				getInsertBeforeRowIndex(key, value) {
					var keyAndValue = { key: key, value: value };
					var body = this.getTableBodyElement();
					for (let i = 0; i &lt; body.children.length; i++) {
						const row = body.children[i];
						if (this.getIsNewRow(row))
							return i;
						if (_dictionarySortMode.sortCompare(keyAndValue, {key: this.getRowKey(row), value: this.getRowValue(row)}) &lt; 0)
							return i;
					}
					return -1;
				}

				saveCellEdit(nextCellDirection) {
					try {
						var cell = _dictionaryCellEditAdapter.getCell().cell;
						if (!_dictionaryCellEditAdapter.validateAndSave() || !nextCellDirection)
							return;
		
						var nav = new DictionaryCellNavigator(cell);
						var nextCell = null;
						switch (nextCellDirection) {
							case "left":
								nextCell = nav.getCellLeft();
								break;
							case "right":
								nextCell = nav.getCellRight();
								break;
							case "up":
								nextCell = nav.getCellAbove();
								break;
							case "down":
								nextCell = nav.getCellBelow();
								break;
							default:
								throw new Error(`Unknown nextCellDirection: "${nextCellDirection}"`);
						}
						if (nextCell) {
							_dictionaryCellEditAdapter.attach(_selectOptions.getSelectedVariable(), nextCell);
						}
					} catch (e) {
						ErrorHandler.handle(e);
					}
				}
			}
			const _dictionaryHelper = new DictionaryHelper();
		// #endregion		
	
	// #endregion

	// #region ======== Enable Controls =========================
		function adjustWrapableTooltipAignment() {
			var lastFirstLineButton = null;
			var button = _divVariableToolButtons.firstElementChild;
			while (button != null) {
				if (button.isVisible()) {
					if (button.hasClass("btnToolSeparator"))
						button.toggleClass("invisible", false);
					if (lastFirstLineButton == null)
						lastFirstLineButton = button;
					else if (button.offsetTop &lt; lastFirstLineButton.offsetTop + 20 &amp;&amp; button.offsetLeft &gt; lastFirstLineButton.offsetLeft)
						lastFirstLineButton = button;
					var tooltipText = button.querySelector(".tooltipText");
					if (tooltipText)
						tooltipText.swapClasses("tooltipTextRight", "tooltipTextCenter", button.offsetLeft &lt; 40);
				}
				button = button.nextElementSibling;
			}

			if (lastFirstLineButton &amp;&amp; lastFirstLineButton.hasClass("btnToolSeparator"))
				lastFirstLineButton.toggleClass("invisible", true);
		}

		function enableControls() {

			function setTooltipText(element, text) {
				var tooltiptextElement = element.getElementsByClassName("tooltipText");
				if (tooltiptextElement.length !== 1)
					throw new Error(`${element} must have one and only one tooltipText element`);
				tooltiptextElement = tooltiptextElement[0];
				var existingText = tooltiptextElement.textContent;
				var matches = /( -.*)/.exec(existingText);
				var hotkeyText = (matches &amp;&amp; matches.length) &gt; 0 ? matches[0] : "";
				tooltiptextElement.innerText = `${text}${hotkeyText}`
			}

			function enableToolButton(btn, enabled, visible, down) {
				visible = visible == null || btn.setVisible(visible);
				if (!visible)
					enabled = false;
				else if (enabled == null)
					enabled = true;
				btn.toggleClass("disabled", !enabled);
				btn.toggleClass("btnToolHover", enabled);
				if (down != null)
					btn.setButtonDown(down);
			}

			function enableRegularButtons(btn, enable) {
				btn.toggleClass("disabled", !enable);
			}

			try {
				var selections = _selectOptions.getSelections().selections;
				var selectedVariable = selections.length === 1 ? selections[0].variable : null;
				var isDictionaryShowing = selectedVariable != null &amp;&amp; _divDictionary.isVisible();
				var isDictionary = selectedVariable != null &amp;&amp; selectedVariable.isDictionary;
				var editingDicionary = _dictionaryCellEditAdapter.isAttached();
				var dialogShowing = _modalDialogController.isShowing;

				enableToolButton(_btnAddVariable, !_editMode &amp;&amp; !editingDicionary &amp;&amp; !dialogShowing);
				enableToolButton(_btnCode, selectedVariable != null &amp;&amp; !dialogShowing, !isDictionaryShowing, _miscStateController.fixedFont);
				enableToolButton(_btnCopyNames, selections.length &gt; 0 &amp;&amp; !_editMode &amp;&amp; !editingDicionary &amp;&amp; !dialogShowing);
				enableToolButton(_btnCopyVariables, selections.length &gt; 0 &amp;&amp; !_editMode &amp;&amp; !editingDicionary &amp;&amp; !dialogShowing);
				enableToolButton(_btnDeleteVariables, selections.length &gt; 0 &amp;&amp; !_editMode &amp;&amp; !editingDicionary &amp;&amp; !dialogShowing);
				enableToolButton(_btnRenameVariable, selectedVariable != null &amp;&amp; !_editMode &amp;&amp; !editingDicionary &amp;&amp; !dialogShowing);

				_btnEdit.toggleClass("pseudoDisabled", false);
				enableToolButton(_btnEdit, selectedVariable != null &amp;&amp; !dialogShowing, !_editMode &amp;&amp; !isDictionary);
				if (_btnEdit.isVisible() &amp;&amp; _btnEdit.isEnabled() &amp;&amp; isLocalVariableCantEdit(selectedVariable))
					_btnEdit.toggleClass("pseudoDisabled", true);

				enableToolButton(_btnEditCancel, null, _editMode);
				enableToolButton(_btnEditOK, null, _editMode);
				enableToolButton(_btnHelp, !dialogShowing, isDictionaryShowing);

				var clickHidesVariable = _hiddenVariables.getSelectedVariablesToggleShouldHide();
				enableToolButton(_btnHiddenVariables_toggleVariables, selections.length &gt; 0 &amp;&amp; !_editMode &amp;&amp; !editingDicionary &amp;&amp; !dialogShowing, _hiddenVariables.enabled);
				if (_imgHiddenVariables_toggleVariables_hide.setVisible(clickHidesVariable)) {
					_imgHiddenVariables_toggleVariables_unhide.setVisible(false);
					setTooltipText(_btnHiddenVariables_toggleVariables, "Hide selected variable(s)");
				} else {
					_imgHiddenVariables_toggleVariables_unhide.setVisible(true);
					setTooltipText(_btnHiddenVariables_toggleVariables, "Unhide selected variable(s)");
				}

				enableToolButton(_btnHiddenVariables_toggleViewMode, !_editMode &amp;&amp; !editingDicionary &amp;&amp; !dialogShowing, _hiddenVariables.enabled);
				if (_btnHiddenVariables_toggleViewMode.isVisible()) {
					if (_imgHiddenVariables_toggleViewMode_all.setVisible(_hiddenVariables.viewMode === HiddenVariablesViewMode.all)) {
						setTooltipText(_btnHiddenVariables_toggleViewMode, "Showing All Variables");
						_infoHiddenVariables_warning.setVisible(false);
					}
					if (_imgHiddenVariables_toggleViewMode_hide.setVisible(_hiddenVariables.viewMode === HiddenVariablesViewMode.hide)) {
						setTooltipText(_btnHiddenVariables_toggleViewMode, `Showing "Visible" Variables Only`);
						if (_infoHiddenVariables_warning.setVisible(_hiddenVariables.areAnyVariablesHiddenInThisViewMode()))
							_infoHiddenVariables_warningText.innerText = "Some variables are hidden";
						}
					if (_imgHiddenVariables_toggleViewMode_only.setVisible(_hiddenVariables.viewMode === HiddenVariablesViewMode.only)) {
						setTooltipText(_btnHiddenVariables_toggleViewMode, "Showing Hidden Variables only");
						_infoHiddenVariables_warning.setVisible(true);
						if (selections.length &gt; 0)
							_infoHiddenVariables_warningText.innerText = "Showing Hidden Variables Only";
						else
							_infoHiddenVariables_warningText.innerText = "No Hidden Variables";
					}
				} else {
					_infoHiddenVariables_warning.setVisible(false);
				}

				enableToolButton(_btnJson, null, selectedVariable != null &amp;&amp; selectedVariable.jsonValue != null &amp;&amp; !_editMode &amp;&amp; !editingDicionary &amp;&amp; !dialogShowing, _isShowingJsonData);
				enableToolButton(_btnSearchKM, selectedVariable != null &amp;&amp; !_editMode &amp;&amp; !editingDicionary &amp;&amp; !dialogShowing);
				enableToolButton(_btnSort, !_editMode &amp;&amp; !editingDicionary &amp;&amp; !dialogShowing, null, _variableSortMode.sortBySize);
				enableToolButton(_btnWordWrap, selectedVariable != null &amp;&amp; !dialogShowing, !isDictionaryShowing, _miscStateController.wordWrap);

				enableToolButton(_btnRedo, !_undoRedoStack.redoStackIsEmpty() &amp;&amp; !_editMode &amp;&amp; !editingDicionary &amp;&amp; !dialogShowing);
				setTooltipText(_btnRedo, _undoRedoStack.getRedoTooltip());

				enableToolButton(_btnUndo, !_undoRedoStack.undoStackIsEmpty() &amp;&amp; !_editMode &amp;&amp; !editingDicionary &amp;&amp; !dialogShowing);
				setTooltipText(_btnUndo, _undoRedoStack.getUndoTooltip());

				enableRegularButtons(_btnCancel, !_editMode &amp;&amp; !editingDicionary &amp;&amp; !dialogShowing);
				enableRegularButtons(_btnOK, !_editMode &amp;&amp; !editingDicionary &amp;&amp; !dialogShowing);
				enableRegularButtons(_btnReload, !_editMode &amp;&amp; !editingDicionary &amp;&amp; !dialogShowing);

				_optionsMenu.toggleClass("optionsMenuDisabled", _editMode || editingDicionary || dialogShowing);

				adjustWrapableTooltipAignment();

				var firstVisibleButton = true;
				var button = document.getElementById("divValueToolButtons").lastElementChild;
				while (button != null &amp;&amp; button.hasClass("btnToolRight")) {
					if (button.isVisible()) {
						var tooltipText = button.querySelector(".tooltipText");
						if (tooltipText)
							tooltipText.swapClasses("tooltipTextLeft", "tooltipTextCenter", firstVisibleButton);
						firstVisibleButton = false;
					}
					button = button.previousElementSibling;
				}

				_inpSearchFilter.setEnabled(!_editMode &amp;&amp; !editingDicionary &amp;&amp; !dialogShowing);
				_selVariables.setEnabled(!_editMode &amp;&amp; !editingDicionary &amp;&amp; !dialogShowing);
				if (_editMode)
					_txtValue.removeAttribute("readonly");
				else
					_txtValue.setAttribute("readonly", true);

				adjustSelVariablesHeight();
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}
	// #endregion

	// #region ======== showCurrentlySelectedValue ==============
		var _isShowingJsonData = false;
		function showCurrentlySelectedValue() {

			function showTextValue(value) {
				_txtValue.toggleClass("fixedFont", _miscStateController.fixedFont);
				_txtValue.wrap = _miscStateController.wordWrap ? "soft" : "off";
				_txtValue.setVisible(true);
				_divDictionary.setVisible(false);
				_txtValue.value = value;
			}

			try {
				_isShowingJsonData = false;
				var selectedVariable = _selectOptions.getSelectedVariable();
				if (!selectedVariable) {
					showTextValue("")
				} else if (selectedVariable.jsonValue != null
					&amp;&amp; (
						(selectedVariable.isDictionary &amp;&amp; _miscStateController.jsonDictionaryDisplayMode)
						|| (!selectedVariable.isDictionary &amp;&amp; _miscStateController.jsonVariableDisplayMode)
						)
					) {
					_isShowingJsonData = true;
					showTextValue(selectedVariable.jsonValue);
				} else if (selectedVariable.isDictionary) {
					_dictionaryBuilder.build(selectedVariable);
				} else {
					showTextValue(selectedVariable.value);
				}

				_statusLine.refresh();
				enableControls();
			} catch (e) {
				ErrorHandler.handle(e);
			}
		}
	// #endregion
	
	// #region ======== Filtering Stuff =========================
		const FilterModes = {
			contains: "contains",
			letters: "letters",
			groups: "groups"
		};
	
		/**
		 * @param {bool} [callFillSelect] Default is true. If the filter is
		 * changed, should "fillSelect()" get called?
		 * @returns true if the filter was changed, false if not.
		 */
		function clearSearchFilter(callFillSelect) {
			if (_inpSearchFilter.value) {
				_inpSearchFilter.value = "";
				if (callFillSelect !== false)
					fillSelect();
				return true;
			}
			return false;
		}

		function filterVariables(variables, filterText, filterMode) {

			function matchesFilter_ContainsMode(target) {
				return target.toLowerCase().indexOf(filterText) &gt;= 0;
			}

			function matchesFilter_LettersMode(target) {
				target = target.toLowerCase();
				var index = 0;
				for (let i = 0; i &lt; filterText.length; i++) {
					index = target.indexOf(filterText.charAt(i), index);
					if (index &lt; 0)
						return false;
				}
				return true;
			}

			var filterGroups = null;
			function matchesFilter_GroupsMode(target) {
				if (!filterGroups)
					filterGroups = filterText.trim().split(/\s*/);
				target = target.toLowerCase();
				for (let i = 0; i &lt; filterGroups.length; i++) {
					if (target.indexOf(filterGroups[i]) &lt; 0) {
						return false;
					}
				}
				return true;
			}

			if (!filterText)
				return variables;

			filterText = filterText.toLowerCase();
			var filterProc;
			switch (filterMode) {
				case FilterModes.contains:
					filterProc = matchesFilter_ContainsMode;
					break;
				case FilterModes.letters:
					filterProc = matchesFilter_LettersMode;
					break;
				case FilterModes.groups:
					filterProc = matchesFilter_GroupsMode;
					break;
				default:
					throw new Error(`Unknown FilterMode "${filterMode}"`);
			}

			return variables.filter(v =&gt; {
				return filterProc(v.name);
			});
		}
		
		function inpSearchFilterKeyUp() {
			fillSelect();
		}

	// #endregion

	// #region ======== fillSelect Stuff ========================
		var _lastFilterText = "";
		function fillSelect() {
			try {
				_dictionaryCellEditAdapter.detach();
				_floatingWarning.hide(true);

				var filterText = _inpSearchFilter.value;
				var reSelectVariableName = null;
				if (!filterText &amp;&amp; _lastFilterText) {
					let sel = _selectOptions.getSelectedVariable();
					reSelectVariableName = sel ? sel.name : null;
				}
				_lastFilterText = filterText;

				document.querySelectorAll('#selVariables option').forEach(o =&gt; o.remove());
				var list = _variables.data.sort(_variableSortMode.getSortCompareFunction());
				if (filterText)
					list = filterVariables(list, filterText, _filterMode);
				if (_hiddenVariables.viewMode != HiddenVariablesViewMode.all)
					list = list.filter(variable =&gt; !_hiddenVariables.getVariableIsHiddenInThisViewMode(variable.name));

				list.forEach(variable =&gt; {
					_selVariables.add(_selectOptions.makeOptionElement(variable));
				});

				if (!_variables.getIsEmpty()) {
					let selIndex = 0;
					if (reSelectVariableName) {
						let option = _selectOptions.getOptionByVariableName(reSelectVariableName, false);
						if (option)
							selIndex = option.index;
					}
					_selectOptions.selectedIndex = selIndex;
					if (document.activeElement !== _inpSearchFilter)
						_selVariables.focus();
				}
				showCurrentlySelectedValue();

				if (_loadErrorMessages &amp;&amp; _loadErrorMessages.length &gt; 0) {
					var msgs = _loadErrorMessages.join("\n");
					_loadErrorMessages = null;
					_modalDialogController.showInfoDialog(msgs);
				}
			} catch (e) {
				ErrorHandler.handle(e);
			} 
		}
	// #endregion

// #endregion

// #region ======== Logging flags ===========================
	var _saveKMVariableValue_logging = false;
	var _undoRedoStack_logging = ""; // "summary", "detail"
	var _dictionaryBuild_logging = false;
	var _logNumber = 1;
// #endregion

// #region ======== Main Body Logic =========================

	var _parameters;
	var _isAsync;
	var _showReloadButton;
	var _openConsoleMacroUUID;
	var _filterMode;
	var _loadErrorMessages = [];
	var _macroGroupName;
	var _showingGlobalVariables = false;
	var _showingAllGlobalVariables = false;
	var _showingLocalVariables = false;
	var _showingDictionaries = false;
	var _showingAllDictionaries = false;
	var _kmwindowid;

	function splitVariableNames(names) {
		return names.split(/,|\n/gm).map(n =&gt; n.trim());
	}

	function tryParseJson(jsonString, description, required) {
		if (!jsonString) {
			if (required)
				throw new Error(`${description} is required`);
			return null;
		}
		try {
			return JSON.parse(jsonString);
		} catch (e) {
			throw new Error(`Error parsing "${description}": ${e.message}\nValue:\n${jsonString}`);
		}
	}

	// NOTE: This can get called from KM, using an "Execute Javascript in Custom HTML Prompt" action.
	// It can also be called internally.
	function reloadData(dataString) {

		function reloadAllGlobalVariables(allGlobalVariableNames) {
			_variables.data = _variables.data.filter(variable =&gt; {
				return variable.isDictionary || variable.isLocalVariable;
			});
			var variableNames = splitVariableNames(allGlobalVariableNames).removeDups();
			variableNames.forEach(name =&gt; {
				_variables.data.push(_variables.createVariable(name));
			});
		}

		function reloadExistingGlobalVariables() {
			for (let i = 0; i &lt; _variables.data.length; i++) {
				const variable = _variables.data[i];
				if (!variable.isDictionary &amp;&amp; !variable.isLocalVariable)
					_variables.data[i] = _variables.createVariable(variable.name)
			}
		}

		function reloadLocalVariables() {
			for (let i = 0; i &lt; _variables.data.length; i++) {
				const variable = _variables.data[i];
				if (variable.isLocalVariable)
					_variables.data[i] = _variables.createVariable(variable.name);
			}
		}

		function reloadAllDictionaries(allDictionaryNames) {
			_variables.data = _variables.data.filter(variable =&gt; {
				return !variable.isDictionary;
			});
			var variableNames = splitVariableNames(allDictionaryNames).removeDups();
			variableNames.forEach(name =&gt; {
				_variables.data.push(_variables.createDictionaryVariable(name));
			});
		}

		function reloadExistingDictionaries() {
			for (let i = 0; i &lt; _variables.data.length; i++) {
				const variable = _variables.data[i];
				if (variable.isDictionary)
					_variables.data[i] = _variables.createDictionaryVariable(variable.dictionaryName);
			}
		}

		try {
			console.log(`reloadData`);
			_undoRedoStack.clear();

			var parameters = tryParseJson(dataString, "reloadData dataString", true);

			if (parameters.allGlobalVariableNames)
				reloadAllGlobalVariables(parameters.allGlobalVariableNames);
			else
				reloadExistingGlobalVariables();

			if (!_isAsync)
				reloadLocalVariables();

			if (parameters.allDictionaryNames)
				reloadAllDictionaries(parameters.allDictionaryNames);
			else
				reloadExistingDictionaries();

			fillSelect();
			setSelectIndexAsync(0);
			setTimeout(() =&gt; _statusLine.showMomentaryMessage("Data has been loaded/reloaded"), 100);
		} catch (e) {
			ErrorHandler.handle(e);
		}
	}

	function loadData() {

		function parseFilterMode(filterMode) {
			var result = filterMode.toLowerCase();
			var validFilterModes = Object.keys(FilterModes);
			if (validFilterModes.indexOf(result) &lt; 0) {
				_loadErrorMessages.push(`Invalid searchFilterMode "${filterMode}". Valid values are "${validFilterModes.join('" | "')}".`);
				return FilterModes.contains;
			}
			return result;
		}

		try {
			_isAsync = _parameters.isAsync == "1";
			_macroGroupName = _parameters.macroGroupName;
			_showReloadButton = _parameters.showReloadButton == "1";
			if (_parameters.canHideVariables == "1")
				_hiddenVariables.enabled = true;

			_openConsoleMacroUUID = _parameters.openConsoleMacroUUID;
			if (_openConsoleMacroUUID)
				document.getElementById("openConsole").setVisible(true);

			_filterMode = parseFilterMode(_parameters.searchFilterMode);

			var variableNames = [];
			if (_parameters.allGlobalVariableNames) {
				variableNames = splitVariableNames(_parameters.allGlobalVariableNames);
				_showingAllGlobalVariables = true;
			}

			if (_parameters.variableNames) {
				variableNames = variableNames.concat(splitVariableNames(_parameters.variableNames));
			}

			variableNames = variableNames.removeDups();

			if (_parameters.showParameters != "1") {
				const viVariableNames = [
					"Instance_VipParameters", 
					"VIP TESTING Variable Inspector Prompt Path",
					"VIP TESTING Open Console Macro UUID",
					"VIP TESTING Show Parameters"
				];
				variableNames = variableNames.filter(n =&gt; viVariableNames.indexOf(n) &lt; 0);
			}

			variableNames.forEach(name =&gt; {
				if (_variables.isLocalVariableName(name))
					_showingLocalVariables = true;
				else
					_showingGlobalVariables = true;
				_variables.data.push(_variables.createVariable(name));
			});

			var dictionaryNames = null;
			if (_parameters.allDictionaryNames) {
				_showingAllDictionaries = true;
				_showingDictionaries = true;
				dictionaryNames = _parameters.allDictionaryNames;
			} else if (_parameters.dictionaryNames) {
				dictionaryNames = _parameters.dictionaryNames;
				_showingDictionaries = true;
			}

			if (dictionaryNames) {
				dictionaryNames = splitVariableNames(dictionaryNames).removeDups();
				dictionaryNames.forEach(name =&gt; {
					if (name)
						_variables.data.push(_variables.createDictionaryVariable(name));
				});
			}
		} catch (e) {
			ErrorHandler.handle(e);
		}
	}

	function setupUI() {
		try {
			loadData();
			initControls();
			fillSelect();
			_internalTasksMacro.initialize();
		} catch (e) {
			ErrorHandler.handle(e);
		}
	}

	function KMDidShowWindow() {
		try {
			_splitterHandler = new SplitterHandler(document.getElementById("divSplitter"), document.getElementById("divVariables"));
			var splitterPosition = _appStateDataController.getAdditionalData("splitterPosition");
			if (splitterPosition)
				_splitterHandler.setSplitterPosition(splitterPosition);
			
			setTimeout(setupUI, 1);
		} catch (e) {
			ErrorHandler.handle(e);
		}
	}

	function KMWindow() {
		var appDataVariableName;
		const oldWindowPositionVariableName = "DND__VipWindowPosition";

		function convertOldWindowPositionVariable() {
			var oldWindowPosition = window.KeyboardMaestro.GetVariable(oldWindowPositionVariableName);
			if (!oldWindowPosition)
				return;

			if (!window.KeyboardMaestro.GetVariable(appDataVariableName))
				window.KeyboardMaestro.SetVariable(appDataVariableName, oldWindowPosition);
			window.KeyboardMaestro.SetVariable(oldWindowPositionVariableName, "%Delete%");;
		}

		try {
			_parameters = tryParseJson(document.kmvar.Instance_VipParameters, "Instance_VipParameters", true);
			appDataVariableName = _parameters.appDataVariableName || "DND__VipAppData";

			_kmwindowid = document.body.dataset.kmwindowid;
			document.getElementById("version").innerText = `v${_version}`;

			convertOldWindowPositionVariable();
			_appStateDataController = new AppStateDataController(appDataVariableName, true, true, ErrorHandler.log);
			_appStateDataController.registerPreSaveCallback((controller) =&gt; {
				if (_splitterHandler)
					controller.setAdditionalData("splitterPosition", _splitterHandler.getSplitterPosition());
			});

			var width = 800;
			var height = 600;

			return _appStateDataController.getKMWindowResult(width, height);
		} catch (e) {
			ErrorHandler.handle(e);
		}
	}

	function saveWindowPosition() {
		_appStateDataController.save();
	}

	function submitWindow(result) {
		saveWindowPosition();
		window.KeyboardMaestro.Submit(result);
	}

	function cancelWindow(result) {
		saveWindowPosition();
		window.KeyboardMaestro.Cancel(result);
	}

	function btnReloadClicked() {

		function doReload() {
			if (_showingAllGlobalVariables || _showingAllDictionaries)
				_internalTasksMacro.reloadData(_showingAllGlobalVariables, _showingAllDictionaries);
			else
				reloadData("{}");
		}

		try {
			if (!_isAsync || !_showingLocalVariables) {
				doReload();
				return;
			}

			var msgPart;
			if (_showingGlobalVariables &amp;&amp; _showingDictionaries)
				msgPart = "global variables and dictionaries";
			else if (_showingGlobalVariables)
				msgPart = "global variables";
			else if (_showingDictionaries)
				msgPart = "dictionaries";
			else {
				_modalDialogController.showInfoDialog(`You can't reload Local/Instance variables, since the Inspector is being shown Asynchronously.`);
				return;
			}
			_modalDialogController.showOkCancelDialog(
				`If you continue, only the ${msgPart} will be reloaded, since the Inspector is being shown Asynchronously.`, 
				result =&gt; { if (result === "ok") doReload(); }
			);
		} catch (e) {
			ErrorHandler.handle(e);
		}
	}
// #endregion

&lt;/script&gt;
	&lt;/head&gt;

	&lt;body data-kmwindowid="E36A74A0-1E20-4618-AFC8-8B2782D3F671"&gt;
		&lt;div id="divUIBusy" class="divUIBusy divUIBusyHidden hidden"&gt;
		&lt;/div&gt;

		&lt;div id="modalDialog" class="modalDialog modalDialogHidden"&gt;
			&lt;div id="modalDialogBox" class="modalDialogBox"&gt;
				&lt;div id="modalDialogBody" class="modalDialogBody"&gt;
					&lt;table id="modalDialogIconTable" class="modalDialogIconTable"&gt;
						&lt;tr&gt;
							&lt;td&gt;
								&lt;img id="modalDialogInfoIcon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QATgCdAO018OgxAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5QwcADczerXklQAAA9FJREFUWEedV0tIVGEUPjPjzPh2xCQttbSUMLMsCikUdWGhEfSiF7Rp1yZoUeFCIoN0U9Gqja16UVEhWvRQKwpdSOVIEKYmapqm4iMHx9Gp74x37lzH69z/3gMfd+b+5z/f97/Of66JBO1A7VgsXMuBEmArsB5wSN0n8OwFvgJNQEPdmYRpkdAmLScQZ8HnInAciNTyl9pdeD4AaiDkR6g+KwoAcQQ6VgHngDBB4mA3D17cBCohZFYthqoAkGfC+SmQY5A4uFsrXhyCiKHghmUCQJ4Hp1dAoih5dJiJTm2xk9VMdNfppgnPP7WuA3hZDhFOZeMSAdLIP+kh52A3ymIoI8nqi9vWNUtVH3gLqBqL2AkRv/2t0LxoIA/H47Fe8pRIk0zOceIi5ZBqClLwsl7aX752pfdV/Ofjpcumsc3m5gNT3to9p9V/Bxwu+Z18SyAdtW/4aWi3l6aFUX66jZwDHnrezRtf0/7CI5OXwk/I59wQOVO97pv3QYdFw7cSOGuSMhwfD9EkI/PsSQqjvdl2SnJYaMrlpermGRp1q54ANW0zeJnMo+b0qos8wWai8wWRlLPOLgdejaRckOqmZ11CS8D9ooAyFsC5XdiyHWa6UBpD8dGWZX26x73CcSTHEj4Fwjt/M8gr9sWSxWyit04XfR8I7HheAuf4gl4BuTwD6aK98tOsVPfZhWmeIw8GW3skTu7aPSw89Uq6DBbA16yQ1SLN+m1jjJlWxQaWoQNH0IDFhUxboQIWpi+mXjYvZuN9nyEBvkw4ZUA5Za8JCBgcn9dz/JR0kyzgp14BdvRKSwwI6BwyNnrw9rAALqN0WVGKlezWwEXa1m9YQDsL4BpOl+WlBkbvcnupZVhXGlZyNbKAeoDTorBtkO5+7tA7Mk9e4ey7hII5X5pxI/HN9FCU3YGpVx6/vlHDo7/P3P5jWAMBQgu5K9lCSISy9YwtECoyOpxpo1v7Y6hordClyim0moP4BEilM1evmpYWv/QO2I7seOeYg07ujqKPnW5690toRq6Ds0cWILHy/czVa0iLjViau/KzwslmMdHtpml61KlZDXHsFuCyn0SOJtXtB9HQH0pBf9CF0zvioYq6SXrTLzTyQcQ+Ci45p6uV5blwagC4gFS1E5tslIwipB35v3FAiJjj8MC4LO9QBl3pw4S/CZ4AhVpLItjO084fJnI5vmwJlIHg+Af/S4ErgK4cESSIN8U1oFiNnH1FPk6T4Mcb9DTAZZSIseh7AH+c+nb7SqYpwN8RxStXslw/FgPbAC5klJ/nfKl9AZqBF1KC0xT7Hx6XEIIjsn1kAAAAAElFTkSuQmCC"&gt;
								&lt;img id="modalDialogWarningIcon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAcCAYAAAAAwr0iAAAABmJLR0QA8wAAAAD215HyAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5QwcAQMca4xADAAAAzFJREFUSEutVl1IFFEUPrtuRvYDEflQQeRbBgZBUNSTLz33YEVPmSChISgGYqVShIQQZL3Ya0FUGmQ/L1Fv1VPajz9gxZJmVpCos78zu96+c2dmZ5fZde5Mu/DtXu495/u+e+6ZOxuigB+NaCdSOwEduLGZ6HdAKv9pEK8EpgBhYYLn/DMRhYMkIacD2AtcBnqAfUB7QC5/adjpDkCLt5BYzZjgMc/xmj+2ANEQucdlN75AXJgwZnJHcTcApXoKhI8Cq4nbjrhtgud4DTiizugjEsQVwJhWRyKz6DbAc1qtNPEeCNpbpR2BtJlLn3phii8tkxj/QGJsnMTyijmXep47imYfe/MOhfBW4E/sBIlsmsTnCRK12C0yJfbUmEZ4LXZamvgLbPNmVowA2SDvXv9o7rSjwxG3TbSeN9d0VMW6G26q0HueFchqQXSu4gpRpM6kjKxzU2/BVSjX9qNZrslhK3KtDBUrJWJA8kqrRuMtOI03POKuwMhjZz3zE1VADnJf/4c0bhaiBi5n8kFh109OuQ1MTxfGJO/njqIhkAkIbwCisXo0V6yQPJ4gUY0d2ufPY56z7wT+zcbRkMekiVlgo28TSOrj3affup95Fujqcgx0dxePSb/JVaHPlwEI7wYS8XYQZ4uTj446Bp4+Kx7DuczBXMypbALBw7x741sJYlRgBu8C+wh4nF/+/LERzVXhkZIBCNfLxrtTmpQF0rp5GTF4XMoAzzOXdTfUr2kCQRHgk3YQTbS0NikT9/eTGBjwjsvi2tYOSROTQJFbxLKFxTbZeC+9SdnAPJ73hV9qscxpVaGtaBWwuB1YjJ0BoaFGulbZXWvgZG7WYC2XCUwOsUN9Uk18do7ExUskenpJ/JhXy2FuqwpDBQYweQDIJq6rEfHuWvA3zH4KOi+o57EGa7EmmwhjEMLvIO2icGWj0oMig3TDiTXyxl4MUqNG/mG5JbXxdZLLksILxs+ZfsUd0XiWRFMTiSiedT+5rGUdxakQBg/h5nhVnCKhKi//5VkXSVyNVZQF25MIvuaASLIF9VhfHgEvFpGWERXAd67AJgyuAofZiFdymda5a94Bvf8AzsXp/m/GmAgAAAAASUVORK5CYII="&gt;
							&lt;/td&gt;
							&lt;td id="modalDialogMessage"&gt;
							&lt;/td&gt;
						&lt;/tr&gt;
					&lt;/table&gt;
					&lt;div id="modalDialogDictionaryHelp"&gt;
						&lt;h2&gt;Dictionaries&lt;/h2&gt;
						&lt;h3&gt;Editing&lt;/h3&gt;
						&lt;ul&gt;
							&lt;li&gt;Double-click a cell to start editing it.&lt;/li&gt;
							&lt;li&gt;Press Escape to cancel the edit, or..&lt;/li&gt;
							&lt;li&gt;Press Enter to accept the edit.&lt;/li&gt;
							&lt;li&gt;Press Enter to type a newline character.&lt;/li&gt;
							&lt;li&gt;To delete a row, click the "trash can" icon in the row.&lt;/li&gt;
							&lt;li&gt;To delete the dictionary, use the trash can tool button above.&lt;/li&gt;
						&lt;/ul&gt;
						&lt;h3&gt;Navigation&lt;/h3&gt;
						&lt;p&gt;When you're editing a cell, you can move from cell to cell with Up Arrow, Down Arrow, Tab, and Shift Tab.&lt;/p&gt;
						&lt;h3&gt;Saving Your Changes&lt;/h3&gt;
						&lt;p&gt;Each cell's value is automatically saved whenever you exit the cell, unless you pressed Escape.&lt;/p&gt;
						&lt;p&gt;The OK and Cancel buttons on the bottom right dont affect whether your changes are saved or not. They just determine if
						your macro continues, or is canceled.&lt;/p&gt;
					&lt;/div&gt;
					&lt;div id="modalDialogOptions"&gt;
						&lt;h2&gt;Options&lt;/h2&gt;
						&lt;div id="divOptionsTable"&gt;
							&lt;table class="tblOptions"&gt;
								&lt;tr id="optionsFontSize"&gt;
									&lt;td&gt;
										Font Size
									&lt;/td&gt;
									&lt;td id="tdOptionsFontSizeButtons"&gt;
										&lt;a id="btnOptionsFontSizeIncrease" class="tblOptionsButtonSmall tblOptionsButtonSmallPlus" href="#"&gt;+&lt;/a&gt;
										&amp;nbsp;
										&lt;a id="btnOptionsFontSizeDecrease" class="tblOptionsButtonSmall" href="#"&gt;-&lt;/a&gt;
										&amp;nbsp;
										&lt;a id="btnOptionsFontSizeReset" class="tblOptionsButtonSmall" href="#"&gt;
											&lt;svg fill="white" version="1.1" viewBox="0 0 95 97.939" xmlns="http://www.w3.org/2000/svg"&gt;
												&lt;g transform="translate(15,16.469)"&gt;
													&lt;path d="m32.5 4.999c-5.405 0-10.444 1.577-14.699 4.282l-5.75-5.75v16.11h16.11l-6.395-6.395c3.18-1.787 6.834-2.82 10.734-2.82 12.171 0 22.073 9.902 22.073 22.074 0 2.899-0.577 5.664-1.599 8.202l4.738 2.762c1.47-3.363 2.288-7.068 2.288-10.964 0-15.164-12.337-27.501-27.5-27.501z"/&gt;
													&lt;path d="m43.227 51.746c-3.179 1.786-6.826 2.827-10.726 2.827-12.171 0-22.073-9.902-22.073-22.073 0-2.739 0.524-5.35 1.439-7.771l-4.731-2.851c-1.375 3.271-2.136 6.858-2.136 10.622 0 15.164 12.336 27.5 27.5 27.5 5.406 0 10.434-1.584 14.691-4.289l5.758 5.759v-16.112h-16.111z"/&gt;
												&lt;/g&gt;
											&lt;/svg&gt;
										&lt;/a&gt;
									&lt;/td&gt;
								&lt;/tr&gt;
								&lt;tr id="optionsLocalVariables"&gt;
									&lt;td&gt;
										Local/Instance Variables
									&lt;/td&gt;
									&lt;td&gt;
										&lt;a id="btnOptionsLoadLocalVariables" class="tblOptionsButton" href="#"&gt;Load All&lt;/a&gt;
									&lt;/td&gt;
								&lt;/tr&gt;
								&lt;tr id="optionsGlobalVariables"&gt;
									&lt;td&gt;
										Global Variables
									&lt;/td&gt;
									&lt;td&gt;
										&lt;a id="btnOptionsLoadGlobalVariables" class="tblOptionsButton" href="#"&gt;Load All&lt;/a&gt;
									&lt;/td&gt;
								&lt;/tr&gt;
								&lt;tr id="optionsDictionaries"&gt;
									&lt;td&gt;
										Dictionaries
									&lt;/td&gt;
									&lt;td&gt;
										&lt;a id="btnOptionsLoadDictionaries" class="tblOptionsButton" href="#"&gt;Load All&lt;/a&gt;
									&lt;/td&gt;
								&lt;/tr&gt;
								&lt;tr id="optionsHiddenVariables"&gt;
									&lt;td&gt;
										Hidden Variables Buttons
									&lt;/td&gt;
									&lt;td&gt;
										&lt;a id="btnOptionsToggleHiddenVariables" class="tblOptionsButton" href="#"&gt;Toggle Visible&lt;/a&gt;
									&lt;/td&gt;
								&lt;/tr&gt;
								&lt;tr id="optionsFocusFilterOnStartup"&gt;
									&lt;td&gt;
										&lt;label id="optionsFocusFilterOnStartupLabel" for="optionsFocusFilterOnStartupCheckbox"&gt;
											Focus Filter on Startup
										&lt;/label&gt;
									&lt;/td&gt;
									&lt;td&gt;
										&lt;label class="switch"&gt;
											&lt;input id="optionsFocusFilterOnStartupCheckbox" type="checkbox" checked&gt;
											&lt;span class="slider round"&gt;&lt;/span&gt;
										  &lt;/label&gt;
									&lt;/td&gt;
								&lt;/tr&gt;
								&lt;tr id="optionsSortBySizeSelectsFirstVariable"&gt;
									&lt;td&gt;
										&lt;label id="optionsSortBySizeSelectsFirstVariableLabel" for="optionsSortBySizeSelectsFirstVariableCheckbox"&gt;
											Sort By Size Selects First Variable
										&lt;/label&gt;
									&lt;/td&gt;
									&lt;td&gt;
										&lt;label class="switch"&gt;
											&lt;input id="optionsSortBySizeSelectsFirstVariableCheckbox" type="checkbox" checked&gt;
											&lt;span class="slider round"&gt;&lt;/span&gt;
										  &lt;/label&gt;
									&lt;/td&gt;
								&lt;/tr&gt;
								&lt;tr id="optionsEscapeInEmptyFilterClosesPrompt"&gt;
									&lt;td&gt;
										&lt;label id="optionsEscapeInEmptyFilterClosesPromptLabel" for="optionsEscapeInEmptyFilterClosesPromptCheckbox"&gt;
											Esc in Empty Filter Closes Prompt
										&lt;/label&gt;
									&lt;/td&gt;
									&lt;td&gt;
										&lt;label class="switch"&gt;
											&lt;input id="optionsEscapeInEmptyFilterClosesPromptCheckbox" type="checkbox" checked&gt;
											&lt;span class="slider round"&gt;&lt;/span&gt;
										  &lt;/label&gt;
									&lt;/td&gt;
								&lt;/tr&gt;
							&lt;/table&gt;
						&lt;/div&gt;
					&lt;/div&gt;
				&lt;/div&gt;
				&lt;div class="modalDialogFooter"&gt;
					&lt;a id="modalDialogOkButton" class="dialogBottomButton dialogOkButton"&gt;OK&lt;/a&gt;
					&lt;a id="modalDialogCancelButton" class="dialogBottomButton dialogCancelButton"&gt;Cancel&lt;/a&gt;
				&lt;/div&gt;
			&lt;/div&gt;
		&lt;/div&gt;

		&lt;div id="editBoxDialog" class="modalDialog modalDialogHidden"&gt;
			&lt;div class="modalDialogBox"&gt;
				&lt;div class="modalDialogHeader"&gt;
					&lt;span id="editBoxDialogTitle"&gt;Enter Variable Name&lt;/span&gt;
					&lt;hr /&gt;
				&lt;/div&gt;
				&lt;div class="modalDialogBody"&gt;
					&lt;table class="modalDialogInputTable"&gt;
						&lt;tr&gt;
							&lt;td colspan="2"&gt;
								&lt;input id="editBoxDialogInput"/&gt;
							&lt;/td&gt;
						&lt;/tr&gt;
						&lt;tr id="editBoxDialogCheckboxRow"&gt;
							&lt;td id="editBoxDialogCheckboxCell"&gt;
								&lt;input id="editBoxDialogCheckbox" type="checkbox" &gt;
							&lt;/td&gt;
							&lt;td&gt;
								&lt;label id="editBoxDialogCheckboxLabel" for="editBoxDialogCheckbox"&gt;&lt;/label&gt;
							&lt;/td&gt;
						&lt;/tr&gt;
						&lt;tr&gt;
							&lt;td class="errorMessage" colspan="2"&gt;
								&lt;span id="editBoxDialogErrorMessage"&gt;&lt;/span&gt;
							&lt;/td&gt;
						&lt;/tr&gt;
					&lt;/table&gt;
				&lt;/div&gt;
				&lt;div class="modalDialogFooter"&gt;
					&lt;a id="editBoxDialogOkButton" class="dialogBottomButton dialogOkButton"&gt;OK&lt;/a&gt;
					&lt;a id="editBoxDialogCancelButton" class="dialogBottomButton dialogCancelButton"&gt;Cancel&lt;/a&gt;
				&lt;/div&gt;
			&lt;/div&gt;
		&lt;/div&gt;

		&lt;a href="#" id="optionsMenu" onclick="optionsMenuClicled()"&gt;Options&lt;/a&gt;
		&lt;a href="#" id="openConsole" class="hidden" onclick="openConsoleClicked()"&gt;Open Console&lt;/a&gt;
		&lt;span id="version"&gt;&lt;/span&gt;
		
		&lt;div class="page"&gt;
			&lt;div id="divFloatingWarningContainer"&gt;
				&lt;div id="divFloatingWarning" class="warning hidden"&gt;
					&lt;table&gt;
						&lt;tr&gt;
							&lt;td&gt;&lt;/td&gt;
							&lt;td&gt;&lt;span class="infoText"&gt;Something goes here.&lt;/span&gt;&lt;/td&gt;
							&lt;td&gt;
								&lt;a href="#"&gt;x&lt;/a&gt;
							&lt;/td&gt;
						&lt;/tr&gt;
					&lt;/table&gt;
				&lt;/div&gt;
			&lt;/div&gt;

			&lt;header&gt;
				&lt;div id="divHeader"&gt;
					&lt;img id="imgIcon" src="data:image/png;base64,
						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"&gt;
					&lt;h2 id="hHeader"&gt;Variable Inspector&lt;/h2&gt;
				&lt;/div&gt;
			&lt;/header&gt;

			&lt;div id="content"&gt;
				&lt;div id="divVariables"&gt;
					&lt;div id="divVariableToolButtons" class="divToolButtonsWrap"&gt;
						
						&lt;a href="#" id="btnSort" data-sort-by-name=true class="btnTool btnToolLeft btnToolHover tooltip" onclick="btnSortClicked()"&gt;
							&lt;span id="btnSortTooltipText" class="tooltipText tooltipTextRight"&gt;Sorted by Size&lt;/span&gt;
							&lt;svg id="imgSortByName" version="1.1" viewBox="0 0 185.08 203.59" xmlns="http://www.w3.org/2000/svg"&gt;
								&lt;path id="Selection" d="m57.181 76.089h-24c-2.25 0-5.69-0.22-7.61 1.02-4.52 2.93-4.33 19.42-17.39 16.58-10.71-2.32-7.93-13.17-5.19-20.6l15.14-41c2.1-5.74 6.68-19.39 9.53-23.99 7.36-11.85 21.22-9.07 27.03 2.99l5.07 13 10 27 8.98 25c1.03 3.49 2.08 8.48 0.7 11.98-2.65 6.73-12.07 7.66-16.87 2.74-3.44-3.52-4.72-9.99-5.39-14.72zm74 64v-125c0.01-3.44-0.27-6.95 1.74-9.95 4.4-6.58 13.44-6.05 17.09 0.97 1.38 2.65 1.17 6.06 1.17 8.98v125h24c3.24 0.05 6.86-0.03 8.67 3.23 2.76 4.95-3 11.1-5.88 14.77l-25 33c-2.7 3.45-7.03 10.55-11.79 10.55-5 0-9.17-6.95-11.87-10.55l-25-33c-2.7-3.6-8.67-10.02-5.94-14.77 2.12-3.7 7.16-3.22 10.81-3.23h22zm-90-115-11 31h20l-9-31zm4 106h-25c-3.22-0.01-7.05 0.18-9.98-1.31-6.24-3.17-6.36-11.27-1.79-15.18 2.8-2.4 6.29-2.46 9.77-2.51h38c2.94 0 6.18-0.12 8.99 0.85 7.84 2.72 8.54 10.66 4.9 17.15l-15.01 21s-23.88 32-23.88 32h24c3.49 0 9.91-0.32 12.98 0.89 7.67 3.02 7.13 12.75 2.74 16.41-2.92 2.44-7.1 2.65-10.72 2.7h-38c-10.19-0.02-23.18-3.62-17.47-17 1.85-4.33 11.46-16.49 14.84-21l25.63-34z" fill="#060606" stroke="#000"/&gt;
							&lt;/svg&gt;
							&lt;svg id="imgSortBySize" version="1.1" viewBox="0 0 177.33 201.97" xmlns="http://www.w3.org/2000/svg"&gt;
								&lt;path id="Selection" d="m123.66 139.92v-124c0-3.19-0.18-7.07 1.31-9.96 3.3-6.39 11.43-7.39 16.04-1.82 2.87 3.48 2.64 7.57 2.65 11.78v124h24c3.55 0.07 7.05 0.34 8.73 4.06 2.14 4.73-4.16 11.35-6.86 14.94l-24.24 32c-2.52 3.35-7.06 10.55-11.63 10.55s-9.11-7.2-11.63-10.55l-24.24-32c-2.74-3.65-9.19-10.19-6.91-14.94 2.1-4.39 6.68-4.05 10.78-4.06h22zm-117.96-120.26c5.73-1.41 22.11-0.74 28.96-0.74h54c7.96 0.04 11.84 1.13 12 10 0.2 11.18-1.9 12.98-13 13h-74c-3.65-0.01-7.84 0.33-10.69-2.43-3.01-2.92-3.12-12.94-1.14-16.46 1.19-2.1 1.97-2.27 3.87-3.37zm0 47c5.48-1.35 17.73-0.74 23.96-0.74h44c3.19 0.01 7.09-0.29 9.77 1.74 4.18 3.15 4.59 15.27 0.92 18.83-2.85 2.76-7.04 2.42-10.69 2.43h-60c-3.65-0.01-7.84 0.33-10.69-2.43-3.01-2.92-3.12-12.94-1.14-16.46 1.19-2.1 1.97-2.27 3.87-3.37zm0 47c5.33-1.32 13.28-0.74 18.96-0.74h35c3.19 0.01 7.09-0.29 9.77 1.74 4.18 3.15 4.59 15.27 0.92 18.83-2.85 2.76-7.04 2.42-10.69 2.43h-47c-3.43-0.01-7.04 0.33-9.69-2.31-2.98-2.98-3.14-13.03-1.14-16.58 1.19-2.1 1.97-2.27 3.87-3.37zm1.96 44.79 32-0.53c4.34 0 11.09-0.47 14.89 1.57 5.23 2.81 5.88 15.93 1.54 19.69-2.39 2.07-6.45 1.74-9.43 1.74h-35c-3.16-0.02-7 0.23-9.26-2.43-2.5-2.94-2.45-14.18 0-17.15 1.49-1.81 3.18-2.2 5.26-2.89z" fill="#060606" stroke="#000"/&gt;
							&lt;/svg&gt;
						
						&lt;/a&gt;

						&lt;a href="#" id="btnHiddenVariables_toggleViewMode" class="btnTool btnToolLeft btnToolHover tooltip" onclick="btnHiddenVariables_toggleViewModeClicked()"&gt;
							&lt;span class="tooltipText tooltipTextCenter toolTipTextWider"&gt;Showing All Variables&lt;/span&gt;
							&lt;svg id="imgHiddenVariables_toggleViewMode_all" version="1.1" viewBox="0 0 600 600" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"&gt;
								&lt;defs&gt;
									&lt;linearGradient id="linearGradient975"&gt;
										&lt;stop stop-color="#fff" stop-opacity="0" offset="0"/&gt;
									&lt;/linearGradient&gt;
									&lt;linearGradient id="linearGradient935" x1="-.51431" x2="600.51" y1="300.11" y2="300.11" gradientUnits="userSpaceOnUse"&gt;
										&lt;stop offset="0"/&gt;
									&lt;/linearGradient&gt;
									&lt;linearGradient id="linearGradient977" x1="38.541" x2="254.5" y1="301" y2="301" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient975"/&gt;
									&lt;linearGradient id="linearGradient1001" x1="345.5" x2="561.5" y1="301.02" y2="301.02" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient975"/&gt;
								&lt;/defs&gt;
								&lt;g stroke="#000"&gt;
									&lt;path id="Frame" d="m0 207s22-2.72 22-2.72l33-3.19c33.93-2.32 67.94-2.14 102-2.09 17.91 0.03 61.75 7.99 79 13.67l34 13.32c11.85 2.56 29.59 2.15 42 2.01 25.39-0.3 31.45-8.75 53-15.66 17.11-5.48 60.33-13.31 78-13.34 34.06-0.05 68.07-0.23 102 2.09l33 3.19s22 2.72 22 2.72l-0.83 26c-0.22 2.33 0.04 6.92-0.77 8.79-1.47 3.39-5.2 3.63-9.31 7.42-4.26 3.93-6.8 9.29-8.34 14.79l-4.15 22c-5.1 25.55-12.99 60.95-28.52 82-29.06 39.39-88.69 37.27-131.08 26.37-14.43-3.71-28.9-9.27-41-18.13-23.02-16.85-41.58-54.39-50.33-81.24-4.65-14.25-5.17-34.42-25.67-34.42s-21.02 20.17-25.67 34.42c-8.75 26.85-27.31 64.39-50.33 81.24-12.1 8.86-26.57 14.42-41 18.13-42.28 10.87-100.63 12.99-130.32-25.37-16.13-20.84-24.36-58.24-29.48-84l-3.96-21c-1.46-5.45-4.15-10.92-8.33-14.79-4.11-3.79-7.84-4.03-9.31-7.42-0.81-1.87-0.55-6.46-0.77-8.79l-0.83-26zm114 10.14-14 1.14c-19.11 2.3-40.68 8.84-51.9 25.72-9.48 14.27-7.17 32-5.25 48 2.99 25.09 8.18 43.53 23.8 64 5.6 7.33 9.46 11.85 17.35 16.91 11.71 7.51 30.13 11.92 44 12.09 25.68 0.3 59.08-4.35 81-18.55 24.62-15.94 42.95-55.35 43-84.45v-11c-0.07-5.51-1.19-11.68-2.64-17-4.26-15.6-15.09-23.26-29.36-29.14-22.58-9.31-50.95-7.86-75-7.72h-31zm304 0c-19.74 2.98-40.05 3.95-55.96 18.16-10.52 9.4-14.02 24.09-14.04 37.7v9c0.05 29.08 17.47 65.91 41 83.07 15.63 11.41 50.6 19.7 70 19.93 15.8 0.18 32.23-0.55 47-6.87 22.03-9.43 37.88-32.75 44.97-55.13 3.19-10.04 4.94-20.56 6.18-31 2.06-17.2 4.46-36.54-7.48-51-21.81-26.43-64.63-24-95.67-23.86h-36z" fill="url(#linearGradient935)"/&gt;
									&lt;path id="Right Lens" d="m416 215.21h35c24.11-0.21 57.06-1.72 79 8.57 12.82 6.01 24.35 15.1 28.56 29.22 1.84 6.18 2.47 12.59 2.44 19l-0.91 11c-2.1 28.72-7.47 51.75-25.51 75-6.25 8.04-11.53 13.69-20.58 18.69-17.64 9.74-36.4 10.54-56 10.31-19.29-0.23-53.16-8.31-69-19.22-24.56-16.92-42.95-55.03-43-84.78-0.03-19.02-0.21-37.21 16-50.53 16.22-13.34 34.43-14.27 54-17.26z" fill="url(#linearGradient1001)"/&gt;
									&lt;path id="Left Lens" d="m112 215.21h33c24.81-0.21 53.77-1.78 77 8.07 14.08 5.98 25.16 14.33 29.36 29.72 1.45 5.32 2.57 11.49 2.64 17v13c-0.05 29.71-18.91 69.2-44 85.45-22.87 14.81-56.32 18.86-83 18.55-13.55-0.16-31.41-4.4-43-11.46-8.13-4.95-12.82-10.12-18.58-17.54-16.15-20.81-21.51-39.32-24.57-65-1.96-16.36-4.42-35.44 5.25-50 11.64-17.51 33.04-24.33 52.9-26.72l13-1.07z" fill="url(#linearGradient977)"/&gt;
								&lt;/g&gt;
							&lt;/svg&gt;
							&lt;svg id="imgHiddenVariables_toggleViewMode_hide" class="hidden" version="1.1" viewBox="0 0 600 600" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"&gt;
								&lt;defs&gt;
									&lt;linearGradient id="linearGradient933"&gt;
										&lt;stop offset="0"/&gt;
									&lt;/linearGradient&gt;
									&lt;linearGradient id="linearGradient935" x1="-.51431" x2="600.51" y1="300.11" y2="300.11" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient933"/&gt;
									&lt;linearGradient id="linearGradient977" x1="38.541" x2="254.5" y1="301" y2="301" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient933"/&gt;
									&lt;linearGradient id="linearGradient1001" x1="345.5" x2="561.5" y1="301.02" y2="301.02" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient933"/&gt;
								&lt;/defs&gt;
								&lt;g stroke="#000"&gt;
									&lt;path id="Frame" d="m0 207s22-2.72 22-2.72l33-3.19c33.93-2.32 67.94-2.14 102-2.09 17.91 0.03 61.75 7.99 79 13.67l34 13.32c11.85 2.56 29.59 2.15 42 2.01 25.39-0.3 31.45-8.75 53-15.66 17.11-5.48 60.33-13.31 78-13.34 34.06-0.05 68.07-0.23 102 2.09l33 3.19s22 2.72 22 2.72l-0.83 26c-0.22 2.33 0.04 6.92-0.77 8.79-1.47 3.39-5.2 3.63-9.31 7.42-4.26 3.93-6.8 9.29-8.34 14.79l-4.15 22c-5.1 25.55-12.99 60.95-28.52 82-29.06 39.39-88.69 37.27-131.08 26.37-14.43-3.71-28.9-9.27-41-18.13-23.02-16.85-41.58-54.39-50.33-81.24-4.65-14.25-5.17-34.42-25.67-34.42s-21.02 20.17-25.67 34.42c-8.75 26.85-27.31 64.39-50.33 81.24-12.1 8.86-26.57 14.42-41 18.13-42.28 10.87-100.63 12.99-130.32-25.37-16.13-20.84-24.36-58.24-29.48-84l-3.96-21c-1.46-5.45-4.15-10.92-8.33-14.79-4.11-3.79-7.84-4.03-9.31-7.42-0.81-1.87-0.55-6.46-0.77-8.79l-0.83-26zm114 10.14-14 1.14c-19.11 2.3-40.68 8.84-51.9 25.72-9.48 14.27-7.17 32-5.25 48 2.99 25.09 8.18 43.53 23.8 64 5.6 7.33 9.46 11.85 17.35 16.91 11.71 7.51 30.13 11.92 44 12.09 25.68 0.3 59.08-4.35 81-18.55 24.62-15.94 42.95-55.35 43-84.45v-11c-0.07-5.51-1.19-11.68-2.64-17-4.26-15.6-15.09-23.26-29.36-29.14-22.58-9.31-50.95-7.86-75-7.72h-31zm304 0c-19.74 2.98-40.05 3.95-55.96 18.16-10.52 9.4-14.02 24.09-14.04 37.7v9c0.05 29.08 17.47 65.91 41 83.07 15.63 11.41 50.6 19.7 70 19.93 15.8 0.18 32.23-0.55 47-6.87 22.03-9.43 37.88-32.75 44.97-55.13 3.19-10.04 4.94-20.56 6.18-31 2.06-17.2 4.46-36.54-7.48-51-21.81-26.43-64.63-24-95.67-23.86h-36z" fill="url(#linearGradient935)"/&gt;
									&lt;path id="Right Lens" d="m416 215.21h35c24.11-0.21 57.06-1.72 79 8.57 12.82 6.01 24.35 15.1 28.56 29.22 1.84 6.18 2.47 12.59 2.44 19l-0.91 11c-2.1 28.72-7.47 51.75-25.51 75-6.25 8.04-11.53 13.69-20.58 18.69-17.64 9.74-36.4 10.54-56 10.31-19.29-0.23-53.16-8.31-69-19.22-24.56-16.92-42.95-55.03-43-84.78-0.03-19.02-0.21-37.21 16-50.53 16.22-13.34 34.43-14.27 54-17.26z" fill="url(#linearGradient1001)"/&gt;
									&lt;path id="Left Lens" d="m112 215.21h33c24.81-0.21 53.77-1.78 77 8.07 14.08 5.98 25.16 14.33 29.36 29.72 1.45 5.32 2.57 11.49 2.64 17v13c-0.05 29.71-18.91 69.2-44 85.45-22.87 14.81-56.32 18.86-83 18.55-13.55-0.16-31.41-4.4-43-11.46-8.13-4.95-12.82-10.12-18.58-17.54-16.15-20.81-21.51-39.32-24.57-65-1.96-16.36-4.42-35.44 5.25-50 11.64-17.51 33.04-24.33 52.9-26.72l13-1.07z" fill="url(#linearGradient977)"/&gt;
								&lt;/g&gt;
							&lt;/svg&gt;
							&lt;svg id="imgHiddenVariables_toggleViewMode_only" class="hidden" version="1.1" viewBox="0 0 600 600" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"&gt;
								&lt;defs&gt;
									&lt;linearGradient id="linearGradient999"&gt;
										&lt;stop stop-color="#00dbe8" offset="0"/&gt;
									&lt;/linearGradient&gt;
									&lt;linearGradient id="linearGradient935" x1="-.51431" x2="600.51" y1="300.11" y2="300.11" gradientUnits="userSpaceOnUse"&gt;
										&lt;stop offset="0"/&gt;
									&lt;/linearGradient&gt;
									&lt;linearGradient id="linearGradient977" x1="38.541" x2="254.5" y1="301" y2="301" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient999"/&gt;
									&lt;linearGradient id="linearGradient1001" x1="345.5" x2="561.5" y1="301.02" y2="301.02" gradientUnits="userSpaceOnUse" xlink:href="#linearGradient999"/&gt;
								&lt;/defs&gt;
								&lt;g stroke="#000"&gt;
									&lt;path id="Frame" d="m0 207s22-2.72 22-2.72l33-3.19c33.93-2.32 67.94-2.14 102-2.09 17.91 0.03 61.75 7.99 79 13.67l34 13.32c11.85 2.56 29.59 2.15 42 2.01 25.39-0.3 31.45-8.75 53-15.66 17.11-5.48 60.33-13.31 78-13.34 34.06-0.05 68.07-0.23 102 2.09l33 3.19s22 2.72 22 2.72l-0.83 26c-0.22 2.33 0.04 6.92-0.77 8.79-1.47 3.39-5.2 3.63-9.31 7.42-4.26 3.93-6.8 9.29-8.34 14.79l-4.15 22c-5.1 25.55-12.99 60.95-28.52 82-29.06 39.39-88.69 37.27-131.08 26.37-14.43-3.71-28.9-9.27-41-18.13-23.02-16.85-41.58-54.39-50.33-81.24-4.65-14.25-5.17-34.42-25.67-34.42s-21.02 20.17-25.67 34.42c-8.75 26.85-27.31 64.39-50.33 81.24-12.1 8.86-26.57 14.42-41 18.13-42.28 10.87-100.63 12.99-130.32-25.37-16.13-20.84-24.36-58.24-29.48-84l-3.96-21c-1.46-5.45-4.15-10.92-8.33-14.79-4.11-3.79-7.84-4.03-9.31-7.42-0.81-1.87-0.55-6.46-0.77-8.79l-0.83-26zm114 10.14-14 1.14c-19.11 2.3-40.68 8.84-51.9 25.72-9.48 14.27-7.17 32-5.25 48 2.99 25.09 8.18 43.53 23.8 64 5.6 7.33 9.46 11.85 17.35 16.91 11.71 7.51 30.13 11.92 44 12.09 25.68 0.3 59.08-4.35 81-18.55 24.62-15.94 42.95-55.35 43-84.45v-11c-0.07-5.51-1.19-11.68-2.64-17-4.26-15.6-15.09-23.26-29.36-29.14-22.58-9.31-50.95-7.86-75-7.72h-31zm304 0c-19.74 2.98-40.05 3.95-55.96 18.16-10.52 9.4-14.02 24.09-14.04 37.7v9c0.05 29.08 17.47 65.91 41 83.07 15.63 11.41 50.6 19.7 70 19.93 15.8 0.18 32.23-0.55 47-6.87 22.03-9.43 37.88-32.75 44.97-55.13 3.19-10.04 4.94-20.56 6.18-31 2.06-17.2 4.46-36.54-7.48-51-21.81-26.43-64.63-24-95.67-23.86h-36z" fill="url(#linearGradient935)"/&gt;
									&lt;path id="Right Lens" d="m416 215.21h35c24.11-0.21 57.06-1.72 79 8.57 12.82 6.01 24.35 15.1 28.56 29.22 1.84 6.18 2.47 12.59 2.44 19l-0.91 11c-2.1 28.72-7.47 51.75-25.51 75-6.25 8.04-11.53 13.69-20.58 18.69-17.64 9.74-36.4 10.54-56 10.31-19.29-0.23-53.16-8.31-69-19.22-24.56-16.92-42.95-55.03-43-84.78-0.03-19.02-0.21-37.21 16-50.53 16.22-13.34 34.43-14.27 54-17.26z" fill="url(#linearGradient1001)"/&gt;
									&lt;path id="Left Lens" d="m112 215.21h33c24.81-0.21 53.77-1.78 77 8.07 14.08 5.98 25.16 14.33 29.36 29.72 1.45 5.32 2.57 11.49 2.64 17v13c-0.05 29.71-18.91 69.2-44 85.45-22.87 14.81-56.32 18.86-83 18.55-13.55-0.16-31.41-4.4-43-11.46-8.13-4.95-12.82-10.12-18.58-17.54-16.15-20.81-21.51-39.32-24.57-65-1.96-16.36-4.42-35.44 5.25-50 11.64-17.51 33.04-24.33 52.9-26.72l13-1.07z" fill="url(#linearGradient977)"/&gt;
								&lt;/g&gt;
							&lt;/svg&gt;
						&lt;/a&gt;

						&lt;span class="btnToolSeparator"&gt;
							&lt;svg version="1.1" viewBox="0 0 5.6319 58.704" stroke="currentColor" xmlns="http://www.w3.org/2000/svg"&gt;
								&lt;g transform="translate(-99.219,-27.292)"&gt;
									&lt;path d="m101.86 29.938 0.34021 53.412" fill="none" stroke-linecap="round" stroke-width="5.2917"/&gt;
								&lt;/g&gt;
							&lt;/svg&gt;
						&lt;/span&gt;

						&lt;a href="#" id="btnCopyNames" class="btnTool btnToolHover btnToolLeft tooltip" onclick="btnCopyNamesClicked()"&gt;
							&lt;span class="tooltipText tooltipTextCenter"&gt;Copy Variable Name(s) - C&lt;/span&gt;
							&lt;svg fill='none' stroke='#0E1A27' stroke-width='8' stroke-dashoffset='0' stroke-dasharray='0' stroke-linecap='round' stroke-linejoin='round' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'&gt;&lt;rect x="15" y="10" width="70" height="80"/&gt; &lt;rect x="30" y="5" width="40" height="15"/&gt; &lt;/svg&gt;
						&lt;/a&gt;

						&lt;a href="#" id="btnCopyVariables" class="btnTool btnToolHover btnToolLeft tooltip" onclick="btnCopyVariablesClicked()"&gt;
							&lt;span class="tooltipText tooltipTextCenter"&gt;Copy Variable(s) Contents - C&lt;/span&gt;
							&lt;svg fill='none' stroke='#0E1A27' stroke-width='8' stroke-dashoffset='0' stroke-dasharray='0' stroke-linecap='round' stroke-linejoin='round' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'&gt;&lt;rect x="15" y="10" width="70" height="80"/&gt; &lt;rect x="30" y="5" width="40" height="15"/&gt; &lt;circle cx="30" cy="50" r="1"/&gt; &lt;circle cx="30" cy="70" r="1"/&gt; &lt;line x1="45" y1="50" x2="70" y2="50" /&gt; &lt;line x1="45" y1="70" x2="70" y2="70" /&gt;&lt;/svg&gt;
						&lt;/a&gt;

						&lt;a href="#" id="btnSearchKM" class="btnTool btnToolLeft btnToolHover tooltip" onclick="btnSearchKMClicked()"&gt;
							&lt;span class="tooltipText tooltipTextCenter"&gt;Search KM for Variable - K&lt;/span&gt;
							&lt;svg version="1.1" viewBox="0 0 468 462" xmlns="http://www.w3.org/2000/svg"&gt;
								&lt;path id="Command" d="m147 186h-50c-18.93-0.03-36.09-6.36-51-17.89-11.77-9.1-22.27-22.32-27.99-36.11-5.3-12.79-7.5-27.29-6.18-41 0.57-5.94 0.59-9.96 2.07-16 6.22-25.5 26.72-49.66 51.1-59.55 18.34-7.43 42-8.63 61-3.01 34.23 10.13 61.94 43.31 62 79.56v52h84v-52c0.02-11.4 2.72-22.78 7.76-33 10.77-21.86 29.94-38.81 53.24-46.25 31.67-10.13 70.3-0.94 92.42 24.26 6.6 7.52 10.12 11.86 14.41 20.99 4.3 9.14 7.57 18.84 8.14 29l0.85 10c0 9.3-2.2 22.17-5.18 31-5 14.87-15.84 28.61-27.64 38.7-14.33 12.27-34.18 19.27-53 19.3h-50v83h34c28.02 0 47.4 0.96 70 20.3 6.07 5.19 11.46 11.2 16.09 17.7 9.91 13.89 13.83 27.22 15 44 0.22 3.14 0.83 4.71 0.59 8-0.58 7.7-1.01 15.53-3.11 23-7.61 27.1-26.49 47.86-52.57 58.4-7.99 3.22-18.37 5.5-27 5.6-15.31 0.18-26.53-0.58-41-6.45-28.47-11.54-52.85-43.27-53-74.55v-46c-0.15-8.15-2.78-7.99-10-8h-55c-4.07 0-15.65-1.17-17.98 2.31-1.23 1.85-1.02 5.5-1.02 7.69v44c-0.2 42.38-41.19 80.51-83 81-20.4 0.23-36.58-2.24-54-13.89-43.67-29.2-52.9-90.57-19.54-131.11 10.82-13.15 27.91-24.87 44.54-29.1 18.2-4.63 51.1-2.9 71-2.9v-83zm0-42v-42c-0.02-10.05-1.59-20.4-7.09-29-4.64-7.26-10.25-12.72-17.91-16.74-8.92-4.67-14.1-5.37-24-5.26-39.14 0.46-57.8 46.31-34.33 76 4.48 5.67 8.92 9.02 15.33 12.24 7.7 3.88 12.46 4.75 21 4.76h47zm166 0h47c8.54-0.01 13.3-0.88 21-4.76 6.41-3.22 10.85-6.57 15.33-12.24 16.92-21.42 13.24-52.02-9.33-67.96-7.12-5.02-15.27-7.93-24-8.04-10.38-0.12-15.58 0.33-25 5.26-7.66 4.02-13.27 9.48-17.91 16.74-5.5 8.6-7.07 18.95-7.09 29v42zm-122.69 42.6c-2.6 2.19-2.24 3.02-2.31 6.4v25 44c0.14 7.49 2.26 6.99 9 7h56c3.48 0 15.99 0.92 17.98-1.6 1.25-1.59 1.02-5.41 1.02-7.4v-55c0-3.48 0.92-15.99-1.6-17.98-1.59-1.25-5.41-1.02-7.4-1.02h-48c-5.8 0-19.85-0.57-24.69 0.6zm-43.31 124.4h-46c-8.65 0.01-16.41 1.52-24 5.88-5.86 3.36-10.69 7.76-14.76 13.12-5.58 7.34-8.84 16.77-9.2 26-1.47 37.48 40.63 60.97 71.96 41.12 6.48-4.1 10.79-8.68 14.91-15.12 5.5-8.6 7.07-18.95 7.09-29v-42zm166 0v42c0.02 10.05 1.59 20.4 7.09 29 4.12 6.44 8.43 11.02 14.91 15.12 31.27 19.81 73.43-3.69 71.96-41.12-0.36-9.23-3.62-18.66-9.2-26-4.07-5.36-8.9-9.76-14.76-13.12-7.59-4.36-15.35-5.87-24-5.88h-46z" fill="#060606" stroke="#000"/&gt;
							&lt;/svg&gt;
						&lt;/a&gt;

						&lt;span class="btnToolSeparator"&gt;
							&lt;svg version="1.1" viewBox="0 0 5.6319 58.704" stroke="currentColor" xmlns="http://www.w3.org/2000/svg"&gt;
								&lt;g transform="translate(-99.219,-27.292)"&gt;
									&lt;path d="m101.86 29.938 0.34021 53.412" fill="none" stroke-linecap="round" stroke-width="5.2917"/&gt;
								&lt;/g&gt;
							&lt;/svg&gt;
						&lt;/span&gt;

						&lt;a href="#" id="btnAddVariable" class="btnTool btnToolHover btnToolLeft tooltip" onclick="btnAddVariableClicked()"&gt;
							&lt;span class="tooltipText tooltipTextCenter"&gt;Add New Variable - +/=&lt;/span&gt;
							&lt;svg id="imgAddVariable" version="1.1" viewBox="0 0 127.35 127.35" xmlns="http://www.w3.org/2000/svg"&gt;
								&lt;g transform="translate(-35.666 -33.115)" fill="none" stroke="#007f00" stroke-linecap="round" stroke-width="31.75"&gt;
									&lt;path d="m99.34 48.99v95.598"/&gt;
									&lt;path d="m147.14 96.789h-95.598"/&gt;
								&lt;/g&gt;
							&lt;/svg&gt;
						&lt;/a&gt;

						&lt;a href="#" id="btnRenameVariable" class="btnTool btnToolHover btnToolLeft tooltip" onclick="btnRenameVariableClicked()"&gt;
							&lt;span class="tooltipText tooltipTextCenter"&gt;Rename Variable - N&lt;/span&gt;
							&lt;svg version="1.1" viewBox="0 0 588.6 524.37" xmlns="http://www.w3.org/2000/svg"&gt;
								&lt;path id="Selection" d="m394.3 38.716c8.87-1.45 20.06 1.37 28 5.45 2.87 1.47 9.77 6.99 12 7.03 2.18 0.04 9.24-5.31 12-6.75 13.2-6.88 41.19-12.9 39.96 10.74-0.82 15.67-15.13 12.57-22.96 16.19-10.17 4.69-12.98 12.42-13 22.81v336c0.02 10.39 2.83 18.12 13 22.81 7.83 3.62 22.14 0.52 22.96 16.19 1.23 23.64-26.76 17.62-39.96 10.74-2.76-1.44-9.82-6.79-12-6.75-2.3 0.05-8.37 5.04-11 6.5-11.07 6.13-37.15 12.73-40.78-5.49-0.2-1.64-0.27-4.33 0-6 1.33-15.35 15.59-10.76 24.78-16.22 10.01-5.96 11.98-15.03 12-25.78v-212-118c-0.14-11.47-4.46-21.49-16-25.61-6.68-2.39-12.26-0.29-17.61-6.5-6.8-7.88-4.26-21.51 8.61-25.36zm-4 373.47h-202-101c-27.21-0.32-48.96-24.28-49-51v-198c0.04-28.26 22.73-50.96 51-51h301v300zm89-300h21c27.73 0.13 49.96 23.56 50 51v198c-0.04 26.71-21.82 50.68-49 51h-22v-300zm-228 120v-40c0-6.43 0.68-15.16-1.97-21-4.12-9.07-16.82-10.9-23.5-3.67-3.72 4.03-3.52 7.59-3.53 12.67v127 39c0.27 19.8 26.07 20.03 28 2l19 9.3c11.36 4.06 18.28 3.83 30 3.7 6.81-0.08 13.66-2.03 20-4.42 32.75-12.37 51.74-48.64 43.76-82.58-7.63-32.47-34.75-54.05-67.76-55.26-16.75-0.61-30.07 4.19-44 13.26zm-84 112c0.01 4.11-0.25 7.29 2.15 10.91 4.6 6.94 15.49 8.32 21.64 2.7 4.29-3.93 5.14-10.11 5.21-15.61v-103c-0.01-6.46-0.08-13.02-5.11-17.79-7.67-7.27-20.01-4.51-23.24 5.79-0.71 2.25-0.63 4.67-0.65 7-10.26-3.24-16.38-9.8-33-10-13.09-0.15-20.88 0.56-33 6.32-37.93 18.02-47.72 68.74-21.54 100.68 12.22 14.91 27.88 21.49 46.54 23.72 7.95 0.95 21.61-1.84 29-4.95l12-5.77zm117-95.54c14.63-2.02 29.2 0.58 39.83 11.63 19.96 20.75 13.56 56.66-12.83 68.6-7.86 3.55-12.67 3.4-21 3.31-18.41-0.22-34.51-14.1-38.33-32-0.89-4.14-0.72-8.76-0.67-13 0.06-4.57 0.53-7.66 2.09-12 5.19-14.47 16.11-23.24 30.91-26.54zm-162 5.01c8.02-1.12 16.6-0.89 24 2.66 19.9 9.54 26.78 35.58 14.4 53.87-6.25 9.23-14.7 13.5-25.4 15.39-5.35 0.94-7.77 0.53-13-0.6-13.39-2.89-24.58-13.2-27.48-26.79-0.67-3.14-0.55-7.71-0.52-11 0.12-9.74 3.81-18.16 11.04-24.82 4.72-4.34 10.76-7.24 16.96-8.71z" stroke="#000"/&gt;
							&lt;/svg&gt;
						&lt;/a&gt;

						&lt;a href="#" id="btnDeleteVariables" class="btnTool btnToolHover btnToolLeft tooltip" onclick="btnDeleteVariablesClicked()"&gt;
							&lt;span class="tooltipText tooltipTextCenter"&gt;Delete Variable(s) -  or &lt;/span&gt;
							&lt;svg id="imgDeleteVariables" version="1.1" viewBox="0 0 13 15" xmlns="http://www.w3.org/2000/svg"&gt;
								&lt;path d="m4 5.5a0.5 0.5 0 0 1 0.5 0.5v6a0.5 0.5 0 0 1-1 0v-6a0.5 0.5 0 0 1 0.5-0.5zm2.5 0a0.5 0.5 0 0 1 0.5 0.5v6a0.5 0.5 0 0 1-1 0v-6a0.5 0.5 0 0 1 0.5-0.5zm3 0.5a0.5 0.5 0 0 0-1 0v6a0.5 0.5 0 0 0 1 0z" fill="#060606"/&gt;
								&lt;path d="m13 3a1 1 0 0 1-1 1h-0.5v9a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-9h-0.5a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h3.5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zm-10.382 1-0.118 0.059v8.941a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-8.941l-0.118-0.059zm-1.618-1v-1h11v1z" fill="#060606" fill-rule="evenodd"/&gt;
							&lt;/svg&gt;
						&lt;/a&gt;

						&lt;a href="#" id="btnHiddenVariables_toggleVariables" class="btnTool btnToolLeft btnToolHover tooltip" onclick="btnHiddenVariables_toggleVariablesClicked()"&gt;
							&lt;span class="tooltipText tooltipTextCenter"&gt;Hide Selected Variable(s)&lt;/span&gt;
							&lt;svg id="imgHiddenVariables_toggleVariables_hide" fill="currentColor" version="1.1" viewBox="0 0 16 12.708" xmlns="http://www.w3.org/2000/svg"&gt;
								&lt;g transform="matrix(-1,0,0,1,16,0)" fill="#000"&gt;
									&lt;path d="m3.1693 12.723 11.199-11.141-1.4651-1.5233-11.374 11.068z"/&gt;
									&lt;path d="m5.525 6.708 2.829-2.83a2.5 2.5 0 0 0-2.829 2.829z"/&gt;
									&lt;path d="m10.475 6a2.5 2.5 0 0 1-2.829 2.829l2.83-2.829z"/&gt;
									&lt;path d="m10.79 1.442a7.028 7.028 0 0 0-2.79-0.588c-5 0-8 5.5-8 5.5s0.939 1.721 2.641 3.238l2.062-2.062a3.5 3.5 0 0 1 4.474-4.474l1.613-1.613z"/&gt;
									&lt;path d="m5.21 11.266 1.614-1.615a3.5 3.5 0 0 0 4.474-4.474l2.06-2.06c1.704 1.515 2.642 3.237 2.642 3.237s-3 5.5-8 5.5a7.029 7.029 0 0 1-2.79-0.588z"/&gt;
								&lt;/g&gt;
							&lt;/svg&gt;
							&lt;svg id="imgHiddenVariables_toggleVariables_unhide" version="1.1" viewBox="0 0 257.94 180.3" xmlns="http://www.w3.org/2000/svg"&gt;
								&lt;path id="Pupil" d="m124.93 60.731c32.55-4.07 45.84 37.24 21 54.34-4.16 2.86-8.08 4.01-13 4.78-24.12 3.77-41.66-22.29-30.6-43.56 4.98-9.57 12.41-13.65 22.6-15.56z" opacity=".5068" stroke="#000"/&gt;
								&lt;path id="Eye" d="m118.93 10.711c39.6-4.82 79.03 16 105.99 43.58 6.35 6.5 11.97 13.71 17.38 21 1.87 2.52 5.33 6.86 5.6 10 0.26 3.16-2.57 7.34-4.17 10-4.9 8.11-10.48 15.74-16.55 23-26.27 31.4-59.44 52.49-101.25 52-37.63-0.44-71.7-26.78-95.13-54-5.51-6.4-10.78-13.01-15.53-20-1.44-2.13-4.61-6.63-5.14-9-0.84-3.79 2.04-7.11 4.1-10 4.07-5.73 10.83-14 15.71-19 27.78-28.46 49.59-41.86 88.99-47.58zm4 29.87c-10.16 1.68-17.93 4.3-26 11.03-31.61 26.38-19.81 78.67 21 87.47 5.55 1.2 11.34 1.66 17 0.92 42.59-5.54 59.22-57.56 28-86.62-5-4.65-10.57-7.97-17-10.23-7.62-2.67-15-3.33-23-2.57z" fill="#fff" stroke="#000" stroke-width="20"/&gt;
							&lt;/svg&gt;
						&lt;/a&gt;

						&lt;span class="btnToolSeparator"&gt;
							&lt;svg version="1.1" viewBox="0 0 5.6319 58.704" stroke="currentColor" xmlns="http://www.w3.org/2000/svg"&gt;
								&lt;g transform="translate(-99.219,-27.292)"&gt;
									&lt;path d="m101.86 29.938 0.34021 53.412" fill="none" stroke-linecap="round" stroke-width="5.2917"/&gt;
								&lt;/g&gt;
							&lt;/svg&gt;
						&lt;/span&gt;

						&lt;a href="#" id="btnUndo" class="btnTool btnToolLeft tooltip" onclick="btnUndoClicked()"&gt;
							&lt;span class="tooltipText tooltipTextCenter"&gt;Undo - Z&lt;/span&gt;
							&lt;svg id="imgUndo" version="1.1" viewBox="0 0 433.11 417.95" xmlns="http://www.w3.org/2000/svg"&gt;
								&lt;path d="m60.5 80.452c9.23-15.81 33.56-35.39 49-45.67 70.98-47.23 166.66-45.46 236 4.1 42.09 30.07 72.06 74.87 82.79 125.57 4.66 21.99 4.46 35.89 4.21 58-0.35 29.5-13.32 67.87-28.4 93-17.57 29.29-41.27 54.08-70.6 71.8-34.44 20.8-69.92 30.2-110 30.2v-65c26.52 0 51.24-6.72 74-20.45 20.4-12.3 36.25-28.5 48.95-48.55 37.76-59.63 23.68-136.93-28.95-182.71-45.91-39.94-110.27-46.28-163-16.14-12.04 6.89-27.97 18.63-36 29.85l17 8.85 37 21.15v2l-41 23.58-78 44.84-34 19.73s-19 9.85-19 9.85v-198l23 12.15 37 21.85z" fill="#060606" stroke="#000"/&gt;
							&lt;/svg&gt;
						&lt;/a&gt;

						&lt;a href="#" id="btnRedo" class="btnTool btnToolLeft tooltip" onclick="btnRedoClicked()"&gt;
							&lt;span class="tooltipText tooltipTextCenter"&gt;Redo - Z&lt;/span&gt;
							&lt;svg id="imgRedo" version="1.1" viewBox="0 0 433.11 417.95" xmlns="http://www.w3.org/2000/svg"&gt;
								&lt;path d="m372.61 80.452c-9.23-15.81-33.56-35.39-49-45.67-70.98-47.23-166.66-45.46-236 4.1-42.09 30.07-72.06 74.87-82.79 125.57-4.66 21.99-4.46 35.89-4.21 58 0.35 29.5 13.32 67.87 28.4 93 17.57 29.29 41.27 54.08 70.6 71.8 34.44 20.8 69.92 30.2 110 30.2v-65c-26.52 0-51.24-6.72-74-20.45-20.4-12.3-36.25-28.5-48.95-48.55-37.76-59.63-23.68-136.93 28.95-182.71 45.91-39.94 110.27-46.28 163-16.14 12.04 6.89 27.97 18.63 36 29.85l-17 8.85-37 21.15v2l41 23.58 78 44.84 34 19.73s19 9.85 19 9.85v-198l-23 12.15-37 21.85z" fill="#060606" stroke="#000"/&gt;
							&lt;/svg&gt;
						&lt;/a&gt;

					&lt;/div&gt;
					&lt;input id="inpSearchFilter" placeholder="Search - S. Also try  and " autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" onkeyup="inpSearchFilterKeyUp()"/&gt;
					&lt;div id="infoHiddenVariables_warning" class="warning hidden"&gt;
						&lt;span class="infoBoxIcon"&gt;&lt;/span&gt;
						&lt;span id="infoHiddenVariables_warningText"&gt;Some variables are hidden.&lt;/span&gt;
					&lt;/div&gt;
					&lt;div id="divSelVariables"&gt;
						&lt;select id="selVariables" multiple size="2" ondblclick="selVariablesDblClicked()" onchange="showCurrentlySelectedValue()"&gt;&lt;/select&gt;
					&lt;/div&gt;
					&lt;div id="divStatusLine" class="statusLine"&gt;
						&lt;div id="divStatusMessage" class="statusPanel popup-in-center hidden"&gt;
							&lt;span id="spanStatusMessage" class="statusPanelLabel"&gt;&lt;/span&gt;
						&lt;/div&gt;
						&lt;div id="divStatusStats" class="statusPanelContainer"&gt;
							&lt;table id="tblVariableCount" title="Total number of variables"&gt;
								&lt;tr&gt;
									&lt;td&gt;
										&lt;svg class="statusCountSVG" fill="none" version="1.1" viewBox="0 0 19.871 18" xmlns="http://www.w3.org/2000/svg"&gt;
											&lt;path d="m2.871 1c-1.1976 2.4099-1.871 5.1263-1.871 8 0 2.8737 0.67341 5.5901 1.871 8m14.129 0c1.1976-2.4099 1.871-5.1263 1.871-8 0-2.8737-0.6734-5.5901-1.871-8m-10 5h1.2457c0.4465 0 0.8389 0.29598 0.9615 0.72528l1.5856 5.5494c0.1226 0.4293 0.515 0.7253 0.9615 0.7253h1.2457m1-7h-0.0801c-0.5839 0-1.1386 0.25513-1.5185 0.69842l-4.8028 5.6032c-0.37996 0.4433-0.93466 0.6984-1.5185 0.6984h-0.08013"
											stroke="#0000ff" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/&gt;
										&lt;/svg&gt;
								   &lt;/td&gt;
									&lt;td class="statusText"&gt;
										12
									&lt;/td&gt;
								&lt;/tr&gt;
							&lt;/table&gt;
							&lt;table id="tblFilterCount" class="hidden" title="Number of filtered variables"&gt;
								&lt;tr&gt;
									&lt;td&gt;
										&lt;svg class="statusFilterSVG" fill="currentColor" version="1.1" viewBox="0 0 14.002 14.999" xmlns="http://www.w3.org/2000/svg"&gt;
											&lt;path d="m0.50079 1.0008a0.5 0.5 0 0 1 0.5-0.5h12a0.5 0.5 0 0 1 0.5 0.5v2a0.5 0.5 0 0 1-0.128 0.334l-4.372 4.858v4.808a0.5 0.5 0 0 1-0.342 0.474l-3 1a0.5 0.5 0 0 1-0.658-0.474v-5.808l-4.372-4.858a0.5 0.5 0 0 1-0.128-0.334zm1 0.5v1.308l4.372 4.858a0.5 0.5 0 0 1 0.128 0.334v5.306l2-0.666v-4.64a0.5 0.5 0 0 1 0.128-0.334l4.372-4.858v-1.308z" fill="none" stroke="#00f" stroke-width="1.0016"/&gt;
										&lt;/svg&gt;
									&lt;/td&gt;
									&lt;td class="statusText"&gt;
										12345
									&lt;/td&gt;
								&lt;/tr&gt;
							&lt;/table&gt;
							&lt;table id="tblHiddenCount" class="hidden" title="Number of hidden variables"&gt;
								&lt;tr&gt;
									&lt;td&gt;
										&lt;svg class="statusHiddenSVG" fill="currentColor" version="1.1" viewBox="0 0 16 12.708" xmlns="http://www.w3.org/2000/svg"&gt;
											&lt;g transform="matrix(1,0,0,-1,0,12.708)" fill="#00f"&gt;
											 &lt;path d="m2.354 12.708 12-12-0.708-0.708-12 12z"/&gt;
											 &lt;path d="m5.525 6.708 2.829-2.83a2.5 2.5 0 0 0-2.829 2.829z"/&gt;
											 &lt;path d="m10.475 6a2.5 2.5 0 0 1-2.829 2.829l2.83-2.829z"/&gt;
											 &lt;path d="m10.79 1.442a7.028 7.028 0 0 0-2.79-0.588c-5 0-8 5.5-8 5.5s0.939 1.721 2.641 3.238l2.062-2.062a3.5 3.5 0 0 1 4.474-4.474l1.613-1.613z"/&gt;
											 &lt;path d="m5.21 11.266 1.614-1.615a3.5 3.5 0 0 0 4.474-4.474l2.06-2.06c1.704 1.515 2.642 3.237 2.642 3.237s-3 5.5-8 5.5a7.029 7.029 0 0 1-2.79-0.588z"/&gt;
											&lt;/g&gt;
										&lt;/svg&gt;
									&lt;/td&gt;
									&lt;td class="statusText"&gt;
										12345
									&lt;/td&gt;
								&lt;/tr&gt;
							&lt;/table&gt;
							&lt;table id="tblSelectedCount" class="hidden" title="Number of selected variables"&gt;
								&lt;tr&gt;
									&lt;td&gt;
										&lt;svg class="statusSelectedSVG" version="1.1" viewBox="0 0 169.08 163.37" xmlns="http://www.w3.org/2000/svg"&gt;
											&lt;g transform="translate(-33.485 -29.853)"&gt;
											 &lt;rect x="64.548" y="143.73" width="119.68" height="25.442" fill="#00f" stroke="#00f" stroke-linecap="round" stroke-linejoin="round" stroke-width="10.003"/&gt;
											 &lt;rect x="64.548" y="52.083" width="119.68" height="25.442" fill="#00f" stroke="#00f" stroke-linecap="round" stroke-linejoin="round" stroke-width="10.003"/&gt;
											 &lt;g fill="none" stroke="#000"&gt;
											  &lt;g stroke-linecap="round"&gt;
											   &lt;path d="m75.984 64.385h98.357" stroke-width="9.1038"/&gt;
											   &lt;path d="m76.94 111.12h97.401" stroke-width="9.0594"/&gt;
											   &lt;path d="m77.658 156.81h96.683" stroke-width="9.026"/&gt;
											  &lt;/g&gt;
											  &lt;rect x="49.247" y="32.353" width="150.82" height="158.37" ry="8.0481" stroke-linecap="square" stroke-miterlimit="1" stroke-width="4.7937"/&gt;
											 &lt;/g&gt;
											&lt;/g&gt;
										   &lt;/svg&gt;
									&lt;/td&gt;
									&lt;td class="statusText" class="hidden"&gt;
										12345
									&lt;/td&gt;
								&lt;/tr&gt;
							&lt;/table&gt;
						&lt;/div&gt;
					&lt;/div&gt;
				&lt;/div&gt;
				&lt;div id="divSplitter" class="splitter"&gt;&lt;/div&gt;
				&lt;div id="divValue"&gt;
					&lt;div id="divValueToolButtons" class="divToolButtons"&gt;
						&lt;a href="#" id="btnJson" class="btnTool btnToolHover btnToolLeft tooltip hidden" onclick="btnJsonClicked()"&gt;
							&lt;span class="tooltipText tooltipTextCenter"&gt;Toggle Pretty &lt;br/&gt; JSON View&lt;/span&gt;
							&lt;img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAdCAYAAAC9pNwMAAACi3pUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHja7ZdbzhshDIXfWUWXgG/YLIfhInUHXX4Pk2T+W1Spl5dKGTSBeMyx8QejJM0f31f6hou8clLzKLWUjEurVm4YRH675r2vOa89Vtx0t9HlRenDg8eI0N7Zl9+fMiyCXm5fr3iyheSdULl6emYn+2SXKzx/yCjKFZnf212uEG+p3O+1RiysOW1vbVpQn3Jf1GOJ5wiOBwoj57SC5rgNYz9bRYvcck+keeSeD7ROlZgkL1Ia1GjRPPtOHSkqT3b0zJ3ltIU4V+6ShUSTqCgtdqkyJISl8xSBla9c6Ixbz3CdAoEHwZMJYoQZZ0uPwd+2p0Jr9V0iOovpZ62QF/PGQLuKsj/hBSC0HvvIzgI/2ucLYCGi8NplDiyw5eMmcRi97S1JJ2iBo6HX22QfdwGUCLENyZCAQC4kRoWyMzsR6hjg05A5S1I+gIDMeCBLVpECOME7NuY4nb5sfDPjCAGESREHmioNrFRNS1LXwB5qJqZmVswtrForUrRYKcXLPovNxdXNi7uHV28hoWFRwiOiRkuVq+CsWi3Va9RaW0PQBuWG2S0aDAcfcuhhRzn8iKMerWP7dO3WS/cevfaWBg8ZOmyU4SNGHW3SxFaaOm2W6TNmnW1hqy1ZumyV5StWXe2idlJNH5h9JfdranSnBmDpZKZwelCD2f0hQft1YpsZiLESiPsmgA3Nm1kOUuVNLm1muTJOhTGytA1n0CYGgjqJbdHF7o3cF24J5/5PufF7cmmj+xfk0kb3hNxXbk+ojf1+7/scZrzY9jHcRc2C4weHGY0DHvx7ffrdCS+hl9BL6CX0EnoJvYT+D6GFHw/4E5h+AimLWgSnSkFBAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5QwNDyshjIK/RwAAAIhJREFUSEvtks0KgDAMg6fs/V9Z6aFSykoCWg8jnkb/0nx1DH0iIAIisAuBq9vIQQjEJWJ9Xs5zFre35xmNZw1vysOruDXGXOxb0jsJx7GE3R7WTSAckVkpHMgaQcJZzO/Hzi/rEOq2vxs5rlDn+GdnaHPq7BHq17esBqyE2922udFgERCBXwncNsQUEEFahJIAAAAASUVORK5CYII=" /&gt;
						&lt;/a&gt;

						&lt;a href="#" id="btnEdit" class="btnTool btnToolHover btnToolLeft tooltip" onclick="btnEditClicked()"&gt;
							&lt;span class="tooltipText tooltipTextCenter"&gt;Edit Variable - &lt;/span&gt;
							&lt;img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH4AwXEjoDcazL2AAAAtlJREFUSMftlktIVFEYx//n3nNH78yYXGcqJ/Nm4KLXylZFGRGaJSrZy0XQIggisullm4gSW0WvTWUbE7LCRw8XGlJTESFUGG1ykRUzppXFPJrxzjj38bUxokVqo0WL+cPZHM73/fh//29xgLTSSut/UrskoVuW5U6wrodqvnYHOP7Xod4tS9EDZLc5HSMfGvbRaGsjvahaQ9eBkxPVselAa7cvhm2wX04s2enPL1jo3kXfmGETwMnA40tt2Owf+m1/IWWn5YD9bb8cW7Q9UFKxxV1RvY01RjiE9xpi/SHyfw4+n6heSBUqSVxOehCoKFVdgsgZCFi8cgUatDi1dHR8jXNx7YyC95cDNonLpmkOHjt91LWxdD5zxFvR2t6JaDRGI6Ghb3osVpgkGp2xjPdtADIyuN0wTP/xM3UuxeVhCPsANgst3Yzu9gxHnIMPVEtxR5t9XyfsxacK3VsGcInbk7oVOHG2LkdxeRhCPlhWNiJaBvk6miLOsKnqiit6bRLolB3vKQEy7dyuJ61A/fm6HMWVyxC6D8tSENYy6KC3KWwRFlimGW15OjUjk2a8tdiNLBuyxhJWoP7c4V+hozby1jaFdQuqoU8dCgDiZA9e+zXMnjPvxpGjK5arqpOxyEtYpCAUs5HXezXMGFTTMGM3e/9sSSd0XLlKxbI85qipqaruvGeB6SJM5vkBDTEG1cZ+hTocDgBAUVHR9DLeVFxw4crF+tpPIzF0dd9G5ToFp061BwlQXw3KmpGZL4iiKIiiKAAA55wAUF9fnz6trS5bv7o2GBmDKGViXt4iHDh2o0fH3N1Bc+4sSWE50s+4TAAGESUBJACkDq4qzjuUm+uB72EvHj159uDNcPyyyQs+CjAXAjAAjAFIMMYSRGSM3yXHT+qj3lFe+FbTErfefZGbLZ49KjJTBGAxxnQiShLR2LgzA4DJGLMMw6B4PE4DAwPp/0Jaaf0bfQefhjmDiw2RTAAAAABJRU5ErkJggg==" /&gt;
						&lt;/a&gt;

						&lt;a href="#" id="btnHelp" class="btnTool btnToolHover tooltip hidden" onclick="btnHelpClicked()"&gt;
							&lt;span class="tooltipText tooltipTextCenter"&gt;Dictionary Help&lt;/span&gt;
							&lt;svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="black" class="bi bi-question-circle-fill" viewBox="0 0 16 16"&gt;
								&lt;path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.496 6.033h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286a.237.237 0 0 0 .241.247zm2.325 6.443c.61 0 1.029-.394 1.029-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94 0 .533.425.927 1.01.927z" /&gt;
							&lt;/svg&gt;
						&lt;/a&gt;

						&lt;a href="#" id="btnEditOK" class="btnTool btnToolHover btnToolLeft hidden tooltip" onclick="btnEditOKClicked()"&gt;
							&lt;span class="tooltipText tooltipTextCenter"&gt;Save Edit - &lt;/span&gt;
							&lt;svg fill='none' stroke='#00b300' stroke-width='16' stroke-dashoffset='0' stroke-dasharray='0' stroke-linecap='round' stroke-linejoin='round' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'&gt;&lt;polyline fill="none" points="10,60 40,85 85,15 "/&gt;&lt;/svg&gt;
						&lt;/a&gt;

						&lt;a href="#" id="btnEditCancel" title="Cancel the Edit" class="btnTool btnToolHover btnToolLeft hidden tooltip" onclick="btnEditCancelClicked()"&gt;
							&lt;span class="tooltipText tooltipTextCenter"&gt;Cancel Edit - esc&lt;/span&gt;
							&lt;svg fill='none' stroke='red' stroke-width='16' stroke-dashoffset='0' stroke-dasharray='0' stroke-linecap='round' stroke-linejoin='round' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'&gt;&lt;line x1="15" y1="15" x2="85" y2="85" /&gt; &lt;line x1="85" y1="15" x2="15" y2="85" /&gt;&lt;/svg&gt;
						&lt;/a&gt;

						&lt;div class="btnToolSpacer"&gt;
						&lt;/div&gt;

						&lt;a href="#" id="btnCode" class="btnTool btnToolHover btnToolRight tooltip" onclick="btnCodeClicked()"&gt;
							&lt;span class="tooltipText tooltipTextCenter"&gt;Toggle Fixed Font&lt;/span&gt;
							&lt;svg version="1.1" viewBox="0 0 578.12 578.12" xmlns="http://www.w3.org/2000/svg"&gt;
								&lt;path id="Code" d="m329.1 93.673c2.24-0.76 2.47-0.98 4.96-0.96 4.55 0.02 20.55 4.34 23.72 7.36 2.43 2.29 3.29 5.32 2.92 8.58l-8.22 29s-17 59-17 59l-56.56 196s-19.72 68-19.72 68c-1.79 6.33-4.31 20.73-10.18 23.6-3.7 2.17-8.17 0.74-11.96 0-8.36-2.37-21.27-4.03-19.52-15.6l8.81-31s17-59 17-59l54.29-188 20-69c2.35-8.25 4.56-22.86 11.46-27.98zm-161.04 52.56c3.05-0.38 4.13-0.5 7 0.99 3.48 1.81 7.21 5.65 10 8.43 5.2 5.2 12.39 12.1 7.4 20 0 0-26.4 27-26.4 27l-76 76c-1.82 1.82-7.22 6.78-7.8 9-0.81 3.08 2.89 6.06 4.8 8l98 98c2.66 2.66 6.94 6.52 8.26 10 3.26 8.56-4.95 14.72-10.26 20-2.48 2.47-5.72 6.01-9 7.26-6.86 2.61-11.49-1.82-16-6.26l-116-116c-2.58-2.58-7.17-6.66-8.4-10-0.87-2.35-0.65-11.05-0.6-14 0.15-7.82 3.73-9.72 9-15l113-113c4.25-4.25 7.29-8.22 13-10.42zm237 0.13c9.27-1.66 16.05 8.34 22 14.29l110 110c2.41 2.41 6.23 5.82 7.4 9 0.87 2.35 0.65 11.05 0.6 14-0.14999 7.82-3.73 9.72-9 15l-115 115c-3.14 3.13-6.41 7-11 7.77-6.87 1.15-10.6-3.39-15-7.77-5.84-5.81-14.93-12.83-9.26-22l26.26-27 76-76c1.82-1.82 7.22-6.78 7.8-9 0.86-3.26-3.74-6.93-5.8-9l-97-97c-2.57-2.57-7.18-6.68-8.4-10-3.54-9.66 12.71-23.87 20.4-27.29z" stroke="#000"/&gt;
							&lt;/svg&gt;
						&lt;/a&gt;

						&lt;a href="#" id="btnWordWrap" class="btnTool btnToolHover btnToolRight btnToolDown tooltip" onclick="btnWordWrapClicked()"&gt;
							&lt;span class="tooltipText tooltipTextLeft"&gt;Toggle Word Wrap&lt;/span&gt;
							&lt;svg version="1.1" viewBox="0 0 203.12 203.13" xmlns="http://www.w3.org/2000/svg"&gt;
								&lt;path id="wrap" d="m12.091 25.85h169v20h-169v-20zm0 57h145c8.65 0.01 18.45 1.82 24.82 8.18 11.81 11.8 11.93 44.07 1.65 56.78-10.2 12.62-33.64 11.04-48.47 11.04v18l-17-11.13-22-17.87 38-28 1 19c8.99 0 22.81 1.56 29.95-4.39 8.38-6.99 7.78-22.57-0.99-28.96-4.46-3.25-13.51-3.64-18.96-3.65h-133v-19zm0 56h66v20h-66v-20z" stroke="#000"/&gt;
							&lt;/svg&gt;
						&lt;/a&gt;
					&lt;/div&gt;
					&lt;textarea id="txtValue" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" readonly&gt;&lt;/textarea&gt;
					&lt;div id="divDictionary"&gt;
					&lt;/div&gt;
				&lt;/div&gt;
			&lt;/div&gt;

			&lt;footer&gt;
				&lt;div&gt;
					&lt;span id="spanStatusLine" class="spanFooterLeft"&gt;&lt;/span&gt;
					&lt;a id="btnOK" class="okButton" onclick="submitWindow('OK')"&gt;OK&lt;/a&gt;
					&lt;a id="btnReload" class="reloadButton hidden" onclick="btnReloadClicked()"&gt;Reload&lt;/a&gt;
					&lt;a id="btnCancel" class="cancelButton" onclick="cancelWindow('Cancel')"&gt;Cancel&lt;/a&gt;
				&lt;/div&gt;
			&lt;/footer&gt;
		&lt;/div&gt;
	&lt;/body&gt;

&lt;/html&gt;</string>
										<key>Variable</key>
										<string>Local_HTML</string>
									</dict>
									<dict>
										<key>Action</key>
										<string>IgnoreCaseString</string>
										<key>ActionUID</key>
										<integer>16032974</integer>
										<key>IsDisclosed</key>
										<false/>
										<key>MacroActionType</key>
										<string>SearchReplace</string>
										<key>Replace</key>
										<string>%RandomUUID%</string>
										<key>Search</key>
										<string>E36A74A0-1E20-4618-AFC8-8B2782D3F671</string>
										<key>Source</key>
										<string>Variable</string>
										<key>Variable</key>
										<string>Local_HTML</string>
										<key>Which</key>
										<string>All</string>
									</dict>
									<dict>
										<key>ActionUID</key>
										<integer>16032975</integer>
										<key>Append</key>
										<false/>
										<key>Destination</key>
										<string>%JSONValue%Instance_VipParameters.htmlFilePath%</string>
										<key>Encoding</key>
										<string>UTF8</string>
										<key>Format</key>
										<string>PlainText</string>
										<key>Format2</key>
										<string>PlainText</string>
										<key>IsDisclosed</key>
										<false/>
										<key>MacroActionType</key>
										<string>WriteFile</string>
										<key>Source</key>
										<string>Variable</string>
										<key>Variable</key>
										<string>Local_HTML</string>
									</dict>
									<dict>
										<key>ActionUID</key>
										<integer>16032976</integer>
										<key>IsDisclosed</key>
										<false/>
										<key>MacroActionType</key>
										<string>SetVariableToText</string>
										<key>ProcessingMode</key>
										<string>Nothing</string>
										<key>Text</key>
										<string>%Delete%</string>
										<key>Variable</key>
										<string>Local_HTML</string>
									</dict>
									<dict>
										<key>ActionUID</key>
										<integer>16032977</integer>
										<key>IsDisclosed</key>
										<false/>
										<key>MacroActionType</key>
										<string>SetJSONValue</string>
										<key>Target</key>
										<string>Instance_VipParameters.deleteTempHtmlFile</string>
										<key>Text</key>
										<string>1</string>
									</dict>
								</array>
								<key>MacroActionType</key>
								<string>Group</string>
								<key>TimeOutAbortsMacro</key>
								<true/>
							</dict>
						</array>
						<key>MacroActionType</key>
						<string>IfThenElse</string>
						<key>ThenActions</key>
						<array>
							<dict>
								<key>ActionColor</key>
								<string>Green</string>
								<key>ActionName</key>
								<string>Use development HTML file</string>
								<key>ActionUID</key>
								<integer>16032969</integer>
								<key>Actions</key>
								<array>
									<dict>
										<key>ActionUID</key>
										<integer>16032970</integer>
										<key>IsDisclosed</key>
										<false/>
										<key>MacroActionType</key>
										<string>SetJSONValue</string>
										<key>Target</key>
										<string>Instance_VipParameters.htmlFilePath</string>
										<key>Text</key>
										<string>%Variable%VIP TESTING Variable Inspector Prompt Path%</string>
									</dict>
								</array>
								<key>IsDisclosed</key>
								<false/>
								<key>MacroActionType</key>
								<string>Group</string>
								<key>TimeOutAbortsMacro</key>
								<true/>
							</dict>
						</array>
						<key>TimeOutAbortsMacro</key>
						<true/>
					</dict>
				</array>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>Group</string>
				<key>TimeOutAbortsMacro</key>
				<true/>
			</dict>
		</array>
		<key>CreationDate</key>
		<real>662421579.33689904</real>
		<key>ModificationDate</key>
		<real>759504687.48003101</real>
		<key>Name</key>
		<string>[VIP] Setup Variable Inspector Prompt - Advanced (Subroutine)</string>
		<key>Triggers</key>
		<array>
			<dict>
				<key>MacroTriggerType</key>
				<string>Subroutine</string>
				<key>Parameters</key>
				<array>
					<string>Local__Accessed Variables _ 1 for yes</string>
					<string>Local__Variable Names _ or ALL</string>
					<string>Local__Dictionary Names _ or ALL</string>
					<string>Local__Async _ 1 for yes</string>
					<string>Local__Show Reload Button _ 1 for yes</string>
					<string>Local__Can Hide Variables _ 1 for yes</string>
				</array>
				<key>ReturnsValue</key>
				<false/>
			</dict>
		</array>
		<key>UID</key>
		<string>8261D8CF-34BA-46D8-83F8-56332127EC2C</string>
	</dict>
</array>
</plist>
