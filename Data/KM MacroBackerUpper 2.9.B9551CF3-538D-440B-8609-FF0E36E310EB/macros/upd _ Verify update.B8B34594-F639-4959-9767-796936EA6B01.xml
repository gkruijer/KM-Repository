<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<array>
	<dict>
		<key>Actions</key>
		<array>
			<dict>
				<key>ActionColor</key>
				<string>Teal</string>
				<key>ActionUID</key>
				<integer>15603583</integer>
				<key>MacroActionType</key>
				<string>Comment</string>
				<key>StyledText</key>
				<data>
							cnRmZAAAAAADAAAAAgAA
							AAcAAABUWFQucnRmAQAA
							AC4CAgAAKwAAAAEAAAD6
							AQAAe1xydGYxXGFuc2lc
							YW5zaWNwZzEyNTJcY29j
							b2FydGYxNjcxXGNvY29h
							c3VicnRmNjAwCntcZm9u
							dHRibFxmMFxmc3dpc3Nc
							ZmNoYXJzZXQwIEhlbHZl
							dGljYS1Cb2xkO1xmMVxm
							c3dpc3NcZmNoYXJzZXQw
							IEhlbHZldGljYTt9Cntc
							Y29sb3J0Ymw7XHJlZDI1
							NVxncmVlbjI1NVxibHVl
							MjU1O1xyZWQwXGdyZWVu
							MFxibHVlMDt9CntcKlxl
							eHBhbmRlZGNvbG9ydGJs
							OztcY3NzcmdiXGMwXGMw
							XGMwXGM4NDcwNlxjbmFt
							ZSBjb250cm9sVGV4dENv
							bG9yO30KXHBhcmRcdHg1
							NjBcdHgxMTIwXHR4MTY4
							MFx0eDIyNDBcdHgyODAw
							XHR4MzM2MFx0eDM5MjBc
							dHg0NDgwXHR4NTA0MFx0
							eDU2MDBcdHg2MTYwXHR4
							NjcyMFxwYXJkaXJuYXR1
							cmFsXHBhcnRpZ2h0ZW5m
							YWN0b3IwCgpcZjBcYlxm
							czI2IFxjZjIgUHVycG9z
							ZQpcZjFcYjAgXAogIFwn
							OTUgVXNlcyBhIGhhc2gg
							dmFsdWUgZnJvbSBhbm90
							aGVyIHNpdGUgdG8gaW5z
							dXJlIHRoZSBpbnRlZ3Jp
							dHkgb2YgdGhlIGRvd25s
							b2FkZWQgdXBkYXRlLn0B
							AAAAIwAAAAEAAAAHAAAA
							VFhULnJ0ZhAAAAAj8Pph
							tgEAAAAAAAAAAAAA
							</data>
				<key>Title</key>
				<string>upd: Verify update</string>
			</dict>
			<dict>
				<key>ActionUID</key>
				<integer>15603584</integer>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>Semaphore</string>
				<key>SemaphoreAction</key>
				<string>Lock</string>
				<key>SemaphoreName</key>
				<string>verify_update</string>
				<key>TimeOutAbortsMacro</key>
				<true/>
			</dict>
			<dict>
				<key>ActionName</key>
				<string>Get uploaded SHA-1 values from Github</string>
				<key>ActionUID</key>
				<integer>15603585</integer>
				<key>DisplayKind</key>
				<string>Variable</string>
				<key>HonourFailureSettings</key>
				<true/>
				<key>IncludeStdErr</key>
				<false/>
				<key>IncludedVariables</key>
				<array>
					<string>9999</string>
				</array>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>ExecuteShellScript</string>
				<key>Path</key>
				<string></string>
				<key>Source</key>
				<string>Nothing</string>
				<key>Text</key>
				<string>curl https://raw.githubusercontent.com/rfgmacros/shasum/main/macrobackerupper</string>
				<key>TimeOutAbortsMacro</key>
				<true/>
				<key>TrimResults</key>
				<true/>
				<key>TrimResultsNew</key>
				<true/>
				<key>UseText</key>
				<true/>
				<key>Variable</key>
				<string>localTheShasums</string>
			</dict>
			<dict>
				<key>Action</key>
				<string>EncodeForRegularExpression</string>
				<key>ActionUID</key>
				<integer>15603586</integer>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>Filter</string>
				<key>Source</key>
				<string>Variable</string>
				<key>Variable</key>
				<string>instanceLatestVersion</string>
			</dict>
			<dict>
				<key>Action</key>
				<string>IgnoreCaseRegEx</string>
				<key>ActionUID</key>
				<integer>15603587</integer>
				<key>Captures</key>
				<array>
					<string></string>
					<string>localShServer1</string>
					<string>localShServer2</string>
				</array>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>SearchRegEx</string>
				<key>Search</key>
				<string>(?m)v%Variable%instanceLatestVersion%:\ (.*)\nv%Variable%instanceLatestVersion%:\ (.*)\n</string>
				<key>Source</key>
				<string>Variable</string>
				<key>Variable</key>
				<string>localTheShasums</string>
			</dict>
			<dict>
				<key>ActionUID</key>
				<integer>15603588</integer>
				<key>Buttons</key>
				<array>
					<dict>
						<key>Button</key>
						<string>OK</string>
					</dict>
					<dict>
						<key>Button</key>
						<string>Cancel</string>
						<key>Cancel</key>
						<true/>
					</dict>
				</array>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>PromptForUserInput</string>
				<key>Prompt</key>
				<string>Click OK and then navigate to the downloaded macro in the dialog that appears—its name begins with "%Variable%instanceMacroName%…", and you can pick either the .zip or .kmmacros file.

The macro will then download a calculated shasum value that we uploaded to Github, and compare it to a calculated shasum value for your download. If they're the same, then nobody has modified the file that was uploaded. If they're different, well, that's a problem. Hopefully they'll never be different.</string>
				<key>TimeOutAbortsMacro</key>
				<true/>
				<key>Title</key>
				<string>Verify your download…</string>
				<key>Variables</key>
				<array/>
			</dict>
			<dict>
				<key>ActionUID</key>
				<integer>15603589</integer>
				<key>Actions</key>
				<array>
					<dict>
						<key>ActionUID</key>
						<integer>15603590</integer>
						<key>DisplayKind</key>
						<string>Variable</string>
						<key>HonourFailureSettings</key>
						<true/>
						<key>IncludeStdErr</key>
						<false/>
						<key>IncludedVariables</key>
						<array>
							<string>9999</string>
						</array>
						<key>IsDisclosed</key>
						<false/>
						<key>MacroActionType</key>
						<string>ExecuteAppleScript</string>
						<key>Path</key>
						<string></string>
						<key>Text</key>
						<string>set promptStr to "Please select the downloaded macro…"set filePath to POSIX path of (choose file with prompt promptStr)return filePath</string>
						<key>TimeOutAbortsMacro</key>
						<true/>
						<key>TrimResults</key>
						<true/>
						<key>TrimResultsNew</key>
						<true/>
						<key>UseText</key>
						<true/>
						<key>Variable</key>
						<string>localTheFile</string>
					</dict>
					<dict>
						<key>ActionUID</key>
						<integer>15603591</integer>
						<key>Conditions</key>
						<dict>
							<key>ConditionList</key>
							<array>
								<dict>
									<key>ConditionType</key>
									<string>Variable</string>
									<key>Variable</key>
									<string>localTheFile</string>
									<key>VariableConditionType</key>
									<string>DoesNotMatch</string>
									<key>VariableValue</key>
									<string>(.*\.zip$|.*\.kmmacros)</string>
								</dict>
							</array>
							<key>ConditionListMatch</key>
							<string>All</string>
						</dict>
						<key>ElseActionListDisclosed</key>
						<false/>
						<key>ElseActions</key>
						<array/>
						<key>IsDisclosed</key>
						<false/>
						<key>MacroActionType</key>
						<string>IfThenElse</string>
						<key>ThenActions</key>
						<array>
							<dict>
								<key>ActionUID</key>
								<integer>15603592</integer>
								<key>Buttons</key>
								<array>
									<dict>
										<key>Button</key>
										<string>OK</string>
									</dict>
								</array>
								<key>IsDisclosed</key>
								<false/>
								<key>MacroActionType</key>
								<string>PromptForUserInput</string>
								<key>Prompt</key>
								<string>Select the macro you downloaded, which will end with either .zip or .kmmacros.</string>
								<key>TimeOutAbortsMacro</key>
								<true/>
								<key>Title</key>
								<string>.zip or .kmmacros files only</string>
								<key>Variables</key>
								<array/>
							</dict>
						</array>
						<key>TimeOutAbortsMacro</key>
						<true/>
					</dict>
				</array>
				<key>Conditions</key>
				<dict>
					<key>ConditionList</key>
					<array>
						<dict>
							<key>ConditionType</key>
							<string>Variable</string>
							<key>Variable</key>
							<string>localTheFile</string>
							<key>VariableConditionType</key>
							<string>EndsWith</string>
							<key>VariableValue</key>
							<string>.zip</string>
						</dict>
						<dict>
							<key>ConditionType</key>
							<string>Variable</string>
							<key>Variable</key>
							<string>localTheFile</string>
							<key>VariableConditionType</key>
							<string>EndsWith</string>
							<key>VariableValue</key>
							<string>.kmmacros</string>
						</dict>
					</array>
					<key>ConditionListMatch</key>
					<string>None</string>
				</dict>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>While</string>
				<key>TimeOutAbortsMacro</key>
				<true/>
			</dict>
			<dict>
				<key>ActionUID</key>
				<integer>15603593</integer>
				<key>DisplayKind</key>
				<string>Variable</string>
				<key>HonourFailureSettings</key>
				<true/>
				<key>IncludeStdErr</key>
				<false/>
				<key>IncludedVariables</key>
				<array>
					<string>9999</string>
				</array>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>ExecuteShellScript</string>
				<key>Path</key>
				<string></string>
				<key>Source</key>
				<string>Nothing</string>
				<key>Text</key>
				<string>shasum -a 256 "$KMVAR_localTheFile" | cut -c1-64</string>
				<key>TimeOutAbortsMacro</key>
				<true/>
				<key>TrimResults</key>
				<false/>
				<key>TrimResultsNew</key>
				<false/>
				<key>UseText</key>
				<true/>
				<key>Variable</key>
				<string>localShDownload</string>
			</dict>
			<dict>
				<key>ActionName</key>
				<string>Analyze results of shasum comparison</string>
				<key>ActionUID</key>
				<integer>15603594</integer>
				<key>Conditions</key>
				<dict>
					<key>ConditionList</key>
					<array>
						<dict>
							<key>ConditionType</key>
							<string>Variable</string>
							<key>Variable</key>
							<string>localShDownload</string>
							<key>VariableConditionType</key>
							<string>Matches</string>
							<key>VariableValue</key>
							<string>%Variable%localShServer1%</string>
						</dict>
						<dict>
							<key>ConditionType</key>
							<string>Variable</string>
							<key>Variable</key>
							<string>localShDownload</string>
							<key>VariableConditionType</key>
							<string>Matches</string>
							<key>VariableValue</key>
							<string>%Variable%localShServer2%</string>
						</dict>
					</array>
					<key>ConditionListMatch</key>
					<string>Any</string>
				</dict>
				<key>ElseActions</key>
				<array>
					<dict>
						<key>Action</key>
						<string>DisplayWindow</string>
						<key>ActionUID</key>
						<integer>15603596</integer>
						<key>MacroActionType</key>
						<string>InsertText</string>
						<key>StyledText</key>
						<data>
								cnRmZAAAAAAD
								AAAAAgAAAAcA
								AABUWFQucnRm
								AQAAAC7rBAAA
								KwAAAAEAAADj
								BAAAe1xydGYx
								XGFuc2lcYW5z
								aWNwZzEyNTJc
								Y29jb2FydGYx
								NjcxXGNvY29h
								c3VicnRmNjAw
								CntcZm9udHRi
								bFxmMFxmc3dp
								c3NcZmNoYXJz
								ZXQwIEhlbHZl
								dGljYS1Cb2xk
								O1xmMVxmc3dp
								c3NcZmNoYXJz
								ZXQwIEhlbHZl
								dGljYTtcZjJc
								Zm5pbFxmY2hh
								cnNldDAgTWVu
								bG8tUmVndWxh
								cjsKfQp7XGNv
								bG9ydGJsO1xy
								ZWQyNTVcZ3Jl
								ZW4yNTVcYmx1
								ZTI1NTtccmVk
								MjUxXGdyZWVu
								MlxibHVlNztc
								cmVkMFxncmVl
								bjBcYmx1ZTA7
								fQp7XCpcZXhw
								YW5kZWRjb2xv
								cnRibDs7XGNz
								c3JnYlxjMTAw
								MDAwXGMxNDkx
								M1xjMDtcY3Nz
								cmdiXGMwXGMw
								XGMwO30KXHBh
								cmRcdHg3MjBc
								dHgxNDQwXHR4
								MjE2MFx0eDI4
								ODBcdHgzNjAw
								XHR4NDMyMFx0
								eDUwNDBcdHg1
								NzYwXHR4NjQ4
								MFx0eDcyMDBc
								dHg3OTIwXHR4
								ODY0MFxwYXJk
								aXJuYXR1cmFs
								XHBhcnRpZ2h0
								ZW5mYWN0b3Iw
								CgpcZjBcYlxm
								czcyIFxjZjIg
								RE8gTk9UIElO
								U1RBTEwgVEhJ
								UyBNQUNSTyFc
								CgpcZnMyNiAg
								ClxmczcyIFwK
								ClxmczI4IFxj
								ZjMgVGhlIHR3
								byBzaGFzdW0g
								dmFsdWVzIGFy
								ZSBub3QgaWRl
								bnRpY2FsLgpc
								ZjFcYjAgIFRo
								ZSBtYWNybydz
								IHNoYXN1bSB2
								YWx1ZSBzaG91
								bGQgYmUgb25l
								IG9mIHRoZXNl
								IHR3byB2YWx1
								ZXM6XApcCgpc
								ZjJcZnMyNCAl
								VmFyaWFibGUl
								bG9jYWxTaFNl
								cnZlcjElXAol
								VmFyaWFibGUl
								bG9jYWxTaFNl
								cnZlcjIlClxm
								MVxmczI4IFwK
								XApCdXQgdGhl
								IGNhbGN1bGF0
								ZWQgdmFsdWUg
								Zm9yIHRoZSBm
								aWxlIHlvdSBk
								b3dubG9hZGVk
								IGlzOlwKXAoK
								XGYyXGZzMjQg
								JVZhcmlhYmxl
								JWxvY2FsU2hE
								b3dubG9hZCUK
								XGYxXGZzMjgg
								XApcClRoaXMg
								aW5kaWNhdGVz
								IHRoYXQgdGhl
								IGZpbGUgeW91
								IGRvd25sb2Fk
								ZWQgaXMgbm90
								IHRoZSBzYW1l
								IG9uZSBJIHVw
								bG9hZGVkXCc5
								N2RlbGV0ZSBp
								dCBpbW1lZGlh
								dGVseS5cClwK
								UGxlYXNlIGxl
								dCBtZSBrbm93
								IHZpYSBUd2l0
								dGVyICh7XGZp
								ZWxke1wqXGZs
								ZGluc3R7SFlQ
								RVJMSU5LICJo
								dHRwczovL3R3
								aXR0ZXIuY29t
								L3JncmlmZiJ9
								fXtcZmxkcnNs
								dCBAcmdyaWZm
								fX0pIG9yIHtc
								ZmllbGR7XCpc
								ZmxkaW5zdHtI
								WVBFUkxJTksg
								Imh0dHBzOi8v
								cm9ic2VydmF0
								b3J5LmNvbS9j
								b250YWN0LXJv
								Yi8ifX17XGZs
								ZHJzbHQgZW1h
								aWx9fSBpZiB5
								b3UgZ2V0IHRo
								aXMgbWVzc2Fn
								ZSwgYXMgaXQg
								bWVhbnMgc29t
								ZW9uZSBoYXMg
								YXBwYXJlbnRs
								eSBtYW5hZ2Vk
								IHRvIGdldCBp
								bnRvIG15IHNp
								dGUgYW5kIHJl
								cGxhY2UgdGhl
								IGRvd25sb2Fk
								YWJsZSBtYWNy
								b3Mgd2l0aCBv
								dGhlciBmaWxl
								cy59AQAAACMA
								AAABAAAABwAA
								AFRYVC5ydGYQ
								AAAA+vrYYbYB
								AAAAAAAAAAAA
								AA==
									</data>
						<key>Text</key>
						<string>DO NOT INSTALL THIS MACRO!
 
The two shasum values are not identical. The macro's shasum value should be one of these two values:

%Variable%localShServer1%
%Variable%localShServer2%

But the calculated value for the file you downloaded is:

%Variable%localShDownload%

This indicates that the file you downloaded is not the same one I uploaded—delete it immediately.

Please let me know via Twitter (@rgriff) or email if you get this message, as it means someone has apparently managed to get into my site and replace the downloadable macros with other files.</string>
					</dict>
				</array>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>IfThenElse</string>
				<key>ThenActions</key>
				<array>
					<dict>
						<key>ActionUID</key>
						<integer>15603595</integer>
						<key>Buttons</key>
						<array>
							<dict>
								<key>Button</key>
								<string>OK</string>
							</dict>
						</array>
						<key>MacroActionType</key>
						<string>PromptForUserInput</string>
						<key>Prompt</key>
						<string>The shasum values matched, so unless someone has hacked two separate servers at the same time, the downloaded macro is the same as the uploaded macro—you can add it to Keyboard Maestro in confidence.

In case you're curious, the shasum value was:

%Variable%localShDownload%

Thrilling, I know!</string>
						<key>TimeOutAbortsMacro</key>
						<true/>
						<key>Title</key>
						<string>Download verified!</string>
						<key>Variables</key>
						<array/>
					</dict>
				</array>
				<key>TimeOutAbortsMacro</key>
				<true/>
			</dict>
			<dict>
				<key>ActionUID</key>
				<integer>15603597</integer>
				<key>IsDisclosed</key>
				<false/>
				<key>MacroActionType</key>
				<string>Semaphore</string>
				<key>SemaphoreAction</key>
				<string>Unlock</string>
				<key>SemaphoreName</key>
				<string>verify_update</string>
			</dict>
		</array>
		<key>CreationDate</key>
		<real>725560211.02653503</real>
		<key>CustomIconData</key>
		<string>KMEC=Square=KMCOLOR:255,255,255,0==86=0=0=0=KMCOLOR:0,0,0,255</string>
		<key>ModificationDate</key>
		<real>759492789.11351299</real>
		<key>Name</key>
		<string>upd | Verify update</string>
		<key>Triggers</key>
		<array/>
		<key>UID</key>
		<string>B8B34594-F639-4959-9767-796936EA6B01</string>
	</dict>
</array>
</plist>
