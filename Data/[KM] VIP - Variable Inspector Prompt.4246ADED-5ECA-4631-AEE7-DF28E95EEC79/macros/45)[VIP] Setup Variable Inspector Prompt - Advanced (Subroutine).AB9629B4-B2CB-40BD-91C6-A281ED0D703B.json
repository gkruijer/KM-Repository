{
	"CreationDate": 662421579.336899,
	"UID": "AB9629B4-B2CB-40BD-91C6-A281ED0D703B",
	"Name": "45)[VIP] Setup Variable Inspector Prompt - Advanced (Subroutine)",
	"Triggers": [
		{
			"ReturnsValue": false,
			"MacroTriggerType": "Subroutine",
			"Parameters": [
				"Local__Accessed Variables _ 1 for yes",
				"Local__Variable Names _ or ALL",
				"Local__Dictionary Names _ or ALL",
				"Local__Async _ 1 for yes",
				"Local__Show Reload Button _ 1 for yes",
				"Local__Can Hide Variables _ 1 for yes"
			]
		}
	],
	"ModificationDate": 666568983.822159,
	"Actions": [
		{
			"MacroActionType": "Comment",
			"Title": "Setup Variable Inspector Prompt - Advanced v3.2",
			"StyledText": "\n\t\t\t\t\t\t\t41E4D515-C065-4C24-9859-EA2479C52CC9\n\t\t\t\t\t\t\tcnRmZAAAAAADAAAAAgAA\n\t\t\t\t\t\t\tAAcAAABUWFQucnRmAQAA\n\t\t\t\t\t\t\tAC52CwAAKwAAAAEAAABu\n\t\t\t\t\t\t\tCwAAe1xydGYxXGFuc2lc\n\t\t\t\t\t\t\tYW5zaWNwZzEyNTJcY29j\n\t\t\t\t\t\t\tb2FydGYyNTEzClxjb2Nv\n\t\t\t\t\t\t\tYXRleHRzY2FsaW5nMFxj\n\t\t\t\t\t\t\tb2NvYXBsYXRmb3JtMHtc\n\t\t\t\t\t\t\tZm9udHRibFxmMFxmc3dp\n\t\t\t\t\t\t\tc3NcZmNoYXJzZXQwIEhl\n\t\t\t\t\t\t\tbHZldGljYS1Cb2xkO1xm\n\t\t\t\t\t\t\tMVxmc3dpc3NcZmNoYXJz\n\t\t\t\t\t\t\tZXQwIEhlbHZldGljYTt9\n\t\t\t\t\t\t\tCntcY29sb3J0Ymw7XHJl\n\t\t\t\t\t\t\tZDI1NVxncmVlbjI1NVxi\n\t\t\t\t\t\t\tbHVlMjU1O30Ke1wqXGV4\n\t\t\t\t\t\t\tcGFuZGVkY29sb3J0Ymw7\n\t\t\t\t\t\t\tO30KXHBhcmRcdHg1NjBc\n\t\t\t\t\t\t\tdHgxMTIwXHR4MTY4MFx0\n\t\t\t\t\t\t\teDIyNDBcdHgyODAwXHR4\n\t\t\t\t\t\t\tMzM2MFx0eDM5MjBcdHg0\n\t\t\t\t\t\t\tNDgwXHR4NTA0MFx0eDU2\n\t\t\t\t\t\t\tMDBcdHg2MTYwXHR4Njcy\n\t\t\t\t\t\t\tMFxwYXJkaXJuYXR1cmFs\n\t\t\t\t\t\t\tXHBhcnRpZ2h0ZW5mYWN0\n\t\t\t\t\t\t\tb3IwCgpcZjBcYlxmczI4\n\t\t\t\t\t\t\tIFxjZjAgTmFtZQpcZjFc\n\t\t\t\t\t\t\tYjAgOiBTZXR1cCBWYXJp\n\t\t\t\t\t\t\tYWJsZSBJbnNwZWN0b3Ig\n\t\t\t\t\t\t\tUHJvbXB0IC0gQWR2YW5j\n\t\t\t\t\t\t\tZWRcCgpcZjBcYiBWZXJz\n\t\t\t\t\t\t\taW9uClxmMVxiMCA6IDMu\n\t\t\t\t\t\t\tMlwKClxmMFxiIFVwZGF0\n\t\t\t\t\t\t\tZWQKXGYxXGIwIDogMjAy\n\t\t\t\t\t\t\tMi8wMi8xNCAxNDowMiBQ\n\t\t\t\t\t\t\tVFwKClxmMFxiIEJ5Clxm\n\t\t\t\t\t\t\tMVxiMCA6IERhbiBUaG9t\n\t\t\t\t\t\t\tYXNcClwKClxmMFxiIFBV\n\t\t\t\t\t\t\tUlBPU0UKXGYxXGIwIDpc\n\t\t\t\t\t\t\tClwKU2V0cyB1cCB0aGUg\n\t\t\t\t\t\t\tYWR2YW5jZWQgVmFyaWFi\n\t\t\t\t\t\t\tbGUgSW5zcGVjdG9yIFBy\n\t\t\t\t\t\t\tb21wdCB2YWx1ZXMuIFRo\n\t\t\t\t\t\t\tZSByZXN1bHQgaXMgcmV0\n\t\t\t\t\t\t\tdXJuZWQgaW4gClxmMFxi\n\t\t\t\t\t\t\tIEluc3RhbmNlX1ZpcFBh\n\t\t\t\t\t\t\tcmFtZXRlcnMKXGYxXGIw\n\t\t\t\t\t\t\tIC5cClwKClxmMFxiIFVT\n\t\t\t\t\t\t\tQUdFClxmMVxiMCA6XApc\n\t\t\t\t\t\t\tClRoaXMgaXMgdGhlIHNh\n\t\t\t\t\t\t\tbWUgYXMge1xmaWVsZHtc\n\t\t\t\t\t\t\tKlxmbGRpbnN0e0hZUEVS\n\t\t\t\t\t\t\tTElOSyAia2V5Ym9hcmRt\n\t\t\t\t\t\t\tYWVzdHJvOi8vbT1FNUFB\n\t\t\t\t\t\t\tOUQ5Ri0wREMxLTQ2Rjgt\n\t\t\t\t\t\t\tQkFDQS1ERURBRUFFQzJB\n\t\t\t\t\t\t\tOTgifX17XGZsZHJzbHQg\n\t\t\t\t\t\t\tU2V0dXAgVmFyaWFibGUg\n\t\t\t\t\t\t\tSW5zcGVjdG9yIFByb21w\n\t\t\t\t\t\t\tdH19ClxmMFxiICwKXGYx\n\t\t\t\t\t\t\tXGIwICB3aXRoIHNvbWUg\n\t\t\t\t\t\t\tYWRkaXRpb25hbCBwYXJh\n\t\t\t\t\t\t\tbWV0ZXJzOlwKXAoKXGYw\n\t\t\t\t\t\t\tXGIgUEFSQU1FVEVSUwpc\n\t\t\t\t\t\t\tZjFcYjAgOlwKXApccGFy\n\t\t\t\t\t\t\tZFx0eDQ2NzhcdHg1MDQw\n\t\t\t\t\t\t\tXHR4NTYwMFx0eDYxNjBc\n\t\t\t\t\t\t\tdHg2NzIwXGxpNDY3Nlxm\n\t\t\t\t\t\t\taS00Mzg1XHBhcmRpcm5h\n\t\t\t\t\t\t\tdHVyYWxccGFydGlnaHRl\n\t\t\t\t\t\t\tbmZhY3RvcjAKClxmMFxi\n\t\t\t\t\t\t\tIFxjZjAgQXN5bmMgXyAx\n\t\t\t\t\t\t\tIGZvciB5ZXMKXGYxXGIw\n\t\t\t\t\t\t\tIAlOb3JtYWxseSB0aGUg\n\t\t\t\t\t\t\tSW5zcGVjdG9yIHdpbGwg\n\t\t\t\t\t\t\tYWN0IGp1c3QgbGlrZSBh\n\t\t\t\t\t\t\tbnkgb3RoZXIgUHJvbXB0\n\t\t\t\t\t\t\tIC0gaXQgc3RvcHMgbWFj\n\t\t\t\t\t\t\tcm8gZXhlY3V0aW9uIGFu\n\t\t\t\t\t\t\tZCB3YWl0cyBmb3IgdGhl\n\t\t\t\t\t\t\tIHVzZXIgdG8gY2xpY2sg\n\t\t\t\t\t\t\tT0sgb3IgQ2FuY2VsLiBC\n\t\t\t\t\t\t\tdXQgaWYgeW91IGVudGVy\n\t\t\t\t\t\t\tICIxIiBoZXJlLCB0aGUg\n\t\t\t\t\t\t\tSW5zcGVjdG9yIHdpbGwg\n\t\t\t\t\t\t\tcnVuIGFzeW5jaHJvbm91\n\t\t\t\t\t\t\tc2x5LCB3aGljaCBtZWFu\n\t\t\t\t\t\t\tcyBLZXlib2FyZCBNYWVz\n\t\t\t\t\t\t\tdHJvIHdvbid0IHdhaXQg\n\t\t\t\t\t\t\tZm9yIGl0IHRvIGZpbmlz\n\t\t\t\t\t\t\taC5cClwKCVlvdSBtaWdo\n\t\t\t\t\t\t\tdCB3YW50IHRvIHVzZSBB\n\t\t\t\t\t\t\tc3luYyBhbG9uZyB3aXRo\n\t\t\t\t\t\t\tICJhbGwiIGluIHRoZSBW\n\t\t\t\t\t\t\tYXJpYWJsZSBOYW1lcyBw\n\t\t\t\t\t\t\tYXJhbWV0ZXIsIHdoaWxl\n\t\t\t\t\t\t\tIHlvdSdyZSB3b3JraW5n\n\t\t\t\t\t\t\tIG9uIGNsZWFuaW5nIHVw\n\t\t\t\t\t\t\tIHNvbWUgZ2xvYmFsIHZh\n\t\t\t\t\t\t\tcmlhYmxlcy5cClwKCU5P\n\t\t\t\t\t\t\tVEU6IFlvdSBjYW4ndCBj\n\t\t\t\t\t\t\taGFuZ2UgdGhlIHZhbHVl\n\t\t\t\t\t\t\tcyBvZiBMb2NhbCBhbmQg\n\t\t\t\t\t\t\tSW5zdGFuY2UgdmFyaWFi\n\t\t\t\t\t\t\tbGVzIHdoZW4gcnVubmlu\n\t\t\t\t\t\t\tZyBhc3luY2hyb25vdXNs\n\t\t\t\t\t\t\teSwgYWx0aG91Z2ggeW91\n\t\t\t\t\t\t\tIGNhbiBzZWUgdGhlaXIg\n\t\t\t\t\t\t\taW5pdGlhbCB2YWx1ZXMu\n\t\t\t\t\t\t\tXApcCgpcZjBcYiBTaG93\n\t\t\t\t\t\t\tIFJlbG9hZCBCdXR0b24g\n\t\t\t\t\t\t\tXyAxIGZvciB5ZXMKXGYx\n\t\t\t\t\t\t\tXGIwIAlFbnRlciAiMSIg\n\t\t\t\t\t\t\tdG8gc2hvdyB0aGUgIlJl\n\t\t\t\t\t\t\tbG9hZCIgYnV0dG9uLlwK\n\t\t\t\t\t\t\tXAoKXGYwXGIgQ2FuIEhp\n\t\t\t\t\t\t\tZGUgVmFyaWFibGVzIF8g\n\t\t\t\t\t\t\tMSBmb3IgeWVzClxmMVxi\n\t\t\t\t\t\t\tMCAJRW50ZXIgIjEiIHRv\n\t\t\t\t\t\t\tIHR1cm4gb24gdGhlIG9w\n\t\t\t\t\t\t\tdGlvbiB0aGF0IGFsbG93\n\t\t\t\t\t\t\tcyB5b3UgdG8gaGlkZSAm\n\t\t\t\t\t\t\tIHVuaGlkZSB2YXJpYWJs\n\t\t\t\t\t\t\tZXMuXApcClxwYXJkXHR4\n\t\t\t\t\t\t\tMzkyMFx0eDQ0ODBcdHg1\n\t\t\t\t\t\t\tMDQwXHR4NTYwMFx0eDYx\n\t\t\t\t\t\t\tNjBcdHg2NzIwXGxpMzk2\n\t\t\t\t\t\t\tMlxmaS0zODkwXHBhcmRp\n\t\t\t\t\t\t\tcm5hdHVyYWxccGFydGln\n\t\t\t\t\t\t\taHRlbmZhY3RvcjAKXGNm\n\t\t\t\t\t\t\tMCBcClxwYXJkXHR4NTYw\n\t\t\t\t\t\t\tXHR4MTEyMFx0eDE2ODBc\n\t\t\t\t\t\t\tdHgyMjQwXHR4MjgwMFx0\n\t\t\t\t\t\t\teDMzNjBcdHgzOTIwXHR4\n\t\t\t\t\t\t\tNDQ4MFx0eDUwNDBcdHg1\n\t\t\t\t\t\t\tNjAwXHR4NjE2MFx0eDY3\n\t\t\t\t\t\t\tMjBccGFyZGlybmF0dXJh\n\t\t\t\t\t\t\tbFxwYXJ0aWdodGVuZmFj\n\t\t\t\t\t\t\tdG9yMAoKXGYwXGIgXGNm\n\t\t\t\t\t\t\tMCBWRVJTSU9OIEhJU1RP\n\t\t\t\t\t\t\tUlkKXGYxXGIwIDpcCjMu\n\t\t\t\t\t\t\tMiAtICJQaW5nIiAKXGYw\n\t\t\t\t\t\t\tXGIgSW50ZXJuYWwgSW5z\n\t\t\t\t\t\t\tcGVjdG9yIFRhc2tzClxm\n\t\t\t\t\t\t\tMVxiMCAgbWFjcm8gdG8g\n\t\t\t\t\t\t\tdmVyaWZ5IGdyb3VwIGFu\n\t\t\t\t\t\t\tZCBtYWNybyBhcmUgZW5h\n\t\t\t\t\t\t\tYmxlZC4gQWRkZWQgbnVt\n\t\t\t\t\t\t\tZXJvdXMgb3B0aW9ucy4g\n\t\t\t\t\t\t\tQ2hhbmdlZCBzb21lIHZp\n\t\t\t\t\t\t\tc3VhbCBlbGVtZW50cyBm\n\t\t\t\t\t\t\tb3IgYmV0dGVyIGZlZWRi\n\t\t\t\t\t\t\tYWNrLlwKMy4xIC0gTWpv\n\t\t\t\t\t\t\tYXZlIGZpeGVzLCBjb25z\n\t\t\t\t\t\t\tb2xpZGF0ZWQgaW50ZXJu\n\t\t\t\t\t\t\tYWwgbWFjcm9zLlwKMy4w\n\t\t\t\t\t\t\tLjIgLSBSZW1vdmVkICJu\n\t\t\t\t\t\t\tYXZpZ2F0b3IuY2xpcGJv\n\t\t\t\t\t\t\tYXJkLndyaXRlVGV4dCIg\n\t\t\t\t\t\t\tYW5kIHJlcGxhY2VkIGl0\n\t\t\t\t\t\t\tIHdpdGggYSBLTSBNYWNy\n\t\t\t\t\t\t\tbywgYmVjYXVzZSBvZiBs\n\t\t\t\t\t\t\tYWNrIG9mIHN1cHBvcnQg\n\t\t\t\t\t\t\tdW5kZXIgTW9qYXZlLlwK\n\t\t\t\t\t\t\tMy4wLjEgLSBSZW1vdmVk\n\t\t\t\t\t\t\tIHVzaW5nIHRoZSBSZXNp\n\t\t\t\t\t\t\temVPYnNlcnZlciwgYmVj\n\t\t\t\t\t\t\tYXVzZSBpdCdzIG5vdCBz\n\t\t\t\t\t\t\tdXBwb3J0ZWQgdW5kZXIg\n\t\t\t\t\t\t\tTW9qYXZlLlwKMy4wIC0g\n\t\t\t\t\t\t\tQWRkZWQgYW4gb3B0aW9u\n\t\t\t\t\t\t\tIHRvIGJlIGFibGUgdG8g\n\t\t\t\t\t\t\taGlkZSAmIHVuaGlkZSB2\n\t\t\t\t\t\t\tYXJpYWJsZXMgKGluIApc\n\t\t\t\t\t\t\tZjBcYiBTZXR1cCBWYXJp\n\t\t\t\t\t\t\tYWJsZSBJbnNwZWN0b3Ig\n\t\t\t\t\t\t\tUHJvbXB0IC0gQWR2YW5j\n\t\t\t\t\t\t\tZWQKXGYxXGIwICksIGFu\n\t\t\t\t\t\t\tZCBhIGJ1bmNoIG9mIG90\n\t\t\t\t\t\t\taGVyIHN0dWZmLlwKMi4w\n\t\t\t\t\t\t\tLjIgLSBGaXhlZCBhIGJ1\n\t\t\t\t\t\t\tZyB3aGljaCBjYXVzZWQg\n\t\t\t\t\t\t\tc2Nyb2xsaW5nIG5vdCB0\n\t\t\t\t\t\t\tbyB3b3JrIHJpZ2h0IChz\n\t\t\t\t\t\t\tb21ldGltZXMpIHVuZGVy\n\t\t\t\t\t\t\tIE1vbnRlcmV5LCBhbmQg\n\t\t\t\t\t\t\tYWxzbyBoYWQgYSBtb3Jl\n\t\t\t\t\t\t\tIHN1YnRsZSBlZmZlY3Qg\n\t\t\t\t\t\t\tdW5kZXIgcHJpb3IgdmVy\n\t\t\t\t\t\t\tc2lvbnMgb2YgbWFjT1Mu\n\t\t\t\t\t\t\tXAoyLjAuMSAtIEZpeGVk\n\t\t\t\t\t\t\tIGEgYnVnIHdpdGggc29t\n\t\t\t\t\t\t\tZSBrZXlib2FyZCBzaG9y\n\t\t\t\t\t\t\tdGN1dHMuXAoyLjAgLSBG\n\t\t\t\t\t\t\tdWxseSBpbXBsZW1lbnRl\n\t\t\t\t\t\t\tZCB0aGUgRGljdGlvbmFy\n\t\t\t\t\t\t\teSBFZGl0b3IuXAoxLjAg\n\t\t\t\t\t\t\tLSBJbml0aWFsIHZlcnNp\n\t\t\t\t\t\t\tb24ufQEAAAAjAAAAAQAA\n\t\t\t\t\t\t\tAAcAAABUWFQucnRmEAAA\n\t\t\t\t\t\t\tAJjRCmK2AQAAAAAAAAAA\n\t\t\t\t\t\t\tAAA=\n\t\t\t\t\t\t\t41E4D515-C065-4C24-9859-EA2479C52CC9\n\t\t\t\t\t\t\t",
			"ActionColor": "Yellow",
			"ActionUID": 217011
		},
		{
			"MacroActionType": "Comment",
			"Title": "License Agreement / Disclaimer",
			"IsDisclosed": false,
			"StyledText": "\n\t\t\t\t\t\t\t41E4D515-C065-4C24-9859-EA2479C52CC9\n\t\t\t\t\t\t\tcnRmZAAAAAADAAAAAgAA\n\t\t\t\t\t\t\tAAcAAABUWFQucnRmAQAA\n\t\t\t\t\t\t\tAC5KBAAAKwAAAAEAAABC\n\t\t\t\t\t\t\tBAAAe1xydGYxXGFuc2lc\n\t\t\t\t\t\t\tYW5zaWNwZzEyNTJcY29j\n\t\t\t\t\t\t\tb2FydGYyNTEzClxjb2Nv\n\t\t\t\t\t\t\tYXRleHRzY2FsaW5nMFxj\n\t\t\t\t\t\t\tb2NvYXBsYXRmb3JtMHtc\n\t\t\t\t\t\t\tZm9udHRibFxmMFxmbmls\n\t\t\t\t\t\t\tXGZjaGFyc2V0MCBUYWhv\n\t\t\t\t\t\t\tbWEtQm9sZDtcZjFcZm5p\n\t\t\t\t\t\t\tbFxmY2hhcnNldDAgVGFo\n\t\t\t\t\t\t\tb21hO30Ke1xjb2xvcnRi\n\t\t\t\t\t\t\tbDtccmVkMjU1XGdyZWVu\n\t\t\t\t\t\t\tMjU1XGJsdWUyNTU7fQp7\n\t\t\t\t\t\t\tXCpcZXhwYW5kZWRjb2xv\n\t\t\t\t\t\t\tcnRibDs7fQpccGFyZFx0\n\t\t\t\t\t\t\teDcyMFx0eDE0NDBcdHgy\n\t\t\t\t\t\t\tMTYwXHR4Mjg4MFx0eDM2\n\t\t\t\t\t\t\tMDBcdHg0MzIwXHR4NTA0\n\t\t\t\t\t\t\tMFx0eDU3NjBcdHg2NDgw\n\t\t\t\t\t\t\tXHR4NzIwMFx0eDc5MjBc\n\t\t\t\t\t\t\tdHg4NjQwXHBhcmRpcm5h\n\t\t\t\t\t\t\tdHVyYWxccGFydGlnaHRl\n\t\t\t\t\t\t\tbmZhY3RvcjAKClxmMFxi\n\t\t\t\t\t\t\tXGZzMzIgXGNmMCBTaG9y\n\t\t\t\t\t\t\tdCBWZXJzaW9uClxmMVxi\n\t\t\t\t\t\t\tMCA6IERvIHdoYXRldmVy\n\t\t\t\t\t\t\tIHlvdSB3YW50IHdpdGgg\n\t\t\t\t\t\t\tdGhpcy4gSnVzdCBkb25c\n\t\t\t\t\t\t\tJzkydCBibGFtZSBtZSBp\n\t\t\t\t\t\t\tZiBhbnl0aGluZyBiYWQg\n\t\t\t\t\t\t\taGFwcGVucy5cClwKClxm\n\t\t\t\t\t\t\tMFxiXGZzMjQgTG9uZyBW\n\t\t\t\t\t\t\tZXJzaW9uClxmMVxiMCA6\n\t\t\t\t\t\t\tXApcClBlcm1pc3Npb24g\n\t\t\t\t\t\t\tdG8gdXNlLCBjb3B5LCBt\n\t\t\t\t\t\t\tb2RpZnksIGFuZC9vciBk\n\t\t\t\t\t\t\taXN0cmlidXRlIHRoaXMg\n\t\t\t\t\t\t\tc29mdHdhcmUgZm9yIGFu\n\t\t\t\t\t\t\teSBwdXJwb3NlIHdpdGgg\n\t\t\t\t\t\t\tb3Igd2l0aG91dCBmZWUg\n\t\t\t\t\t\t\taXMgaGVyZWJ5IGdyYW50\n\t\t\t\t\t\t\tZWQuXApcClRIRSBTT0ZU\n\t\t\t\t\t\t\tV0FSRSBJUyBQUk9WSURF\n\t\t\t\t\t\t\tRCAiQVMgSVMiIEFORCBU\n\t\t\t\t\t\t\tSEUgQVVUSE9SIERJU0NM\n\t\t\t\t\t\t\tQUlNUyBBTEwgV0FSUkFO\n\t\t\t\t\t\t\tVElFUyBXSVRIIFJFR0FS\n\t\t\t\t\t\t\tRCBUTyBUSElTIFNPRlRX\n\t\t\t\t\t\t\tQVJFIElOQ0xVRElORyBB\n\t\t\t\t\t\t\tTEwgSU1QTElFRCBXQVJS\n\t\t\t\t\t\t\tQU5USUVTIE9GIE1FUkNI\n\t\t\t\t\t\t\tQU5UQUJJTElUWSBBTkQg\n\t\t\t\t\t\t\tRklUTkVTUy4gSU4gTk8g\n\t\t\t\t\t\t\tRVZFTlQgU0hBTEwgVEhF\n\t\t\t\t\t\t\tIEFVVEhPUiBCRSBMSUFC\n\t\t\t\t\t\t\tTEUgRk9SIEFOWSBTUEVD\n\t\t\t\t\t\t\tSUFMLCBESVJFQ1QsIElO\n\t\t\t\t\t\t\tRElSRUNULCBPUiBDT05T\n\t\t\t\t\t\t\tRVFVRU5USUFMIERBTUFH\n\t\t\t\t\t\t\tRVMgT1IgQU5ZIERBTUFH\n\t\t\t\t\t\t\tRVMgV0hBVFNPRVZFUiBS\n\t\t\t\t\t\t\tRVNVTFRJTkcgRlJPTSBM\n\t\t\t\t\t\t\tT1NTIE9GIFVTRSwgREFU\n\t\t\t\t\t\t\tQSBPUiBQUk9GSVRTLCBX\n\t\t\t\t\t\t\tSEVUSEVSIElOIEFOIEFD\n\t\t\t\t\t\t\tVElPTiBPRiBDT05UUkFD\n\t\t\t\t\t\t\tVCwgTkVHTElHRU5DRSBP\n\t\t\t\t\t\t\tUiBPVEhFUiBUT1JUSU9V\n\t\t\t\t\t\t\tUyBBQ1RJT04sIEFSSVNJ\n\t\t\t\t\t\t\tTkcgT1VUIE9GIE9SIElO\n\t\t\t\t\t\t\tIENPTk5FQ1RJT04gV0lU\n\t\t\t\t\t\t\tSCBUSEUgVVNFIE9SIFBF\n\t\t\t\t\t\t\tUkZPUk1BTkNFIE9GIFRI\n\t\t\t\t\t\t\tSVMgU09GVFdBUkUufQEA\n\t\t\t\t\t\t\tAAAjAAAAAQAAAAcAAABU\n\t\t\t\t\t\t\tWFQucnRmEAAAAIidy2G2\n\t\t\t\t\t\t\tAQAAAAAAAAAAAAA=\n\t\t\t\t\t\t\t41E4D515-C065-4C24-9859-EA2479C52CC9\n\t\t\t\t\t\t\t",
			"ActionColor": "Yellow",
			"ActionUID": 217012
		},
		{
			"MacroActionType": "SetVariableToText",
			"IsDisclosed": false,
			"Variable": "Instance_VipParameters",
			"Text": "{}",
			"ActionUID": 217013
		},
		{
			"MacroActionType": "SetJSONValue",
			"ActionName": "searchFilterMode (default \"contains\")",
			"IsDisclosed": false,
			"Target": "Instance_VipParameters.searchFilterMode",
			"Text": "contains",
			"ActionUID": 217015
		},
		{
			"MacroActionType": "SetJSONValue",
			"ActionName": "internalTasksMacroUUID",
			"IsDisclosed": false,
			"Target": "Instance_VipParameters.internalTasksMacroUUID",
			"Text": "51FDED47-65E6-4172-84B5-EECE5F774E0D",
			"ActionUID": 217020
		},
		{
			"MacroActionType": "SetJSONValue",
			"ActionName": "macroGroupName",
			"IsDisclosed": false,
			"Target": "Instance_VipParameters.macroGroupName",
			"Text": "%ExecutingThisMacroGroup%",
			"ActionUID": 515275
		},
		{
			"MacroActionType": "SetJSONValue",
			"ActionName": "appDataVariableName",
			"IsDisclosed": false,
			"Target": "Instance_VipParameters.appDataVariableName",
			"Text": "DND__VipAppData",
			"ActionUID": 243294
		},
		{
			"MacroActionType": "IfThenElse",
			"ActionName": "showParameters (for testing)",
			"ActionUID": 217016,
			"IsDisclosed": false,
			"ElseActions": [],
			"TimeOutAbortsMacro": true,
			"Conditions": {
				"ConditionListMatch": "All",
				"ConditionList": [
					{
						"ConditionType": "Variable",
						"VariableValue": "1",
						"Variable": "VIP TESTING Show Parameters",
						"VariableConditionType": "IsNotEmpty"
					}
				]
			},
			"ElseActionListDisclosed": false,
			"ThenActions": [
				{
					"MacroActionType": "SetJSONValue",
					"Target": "Instance_VipParameters.showParameters",
					"Text": "%Variable%VIP TESTING Show Parameters%",
					"ActionUID": 217017
				}
			]
		},
		{
			"MacroActionType": "IfThenElse",
			"ActionName": "showReloadButton, if specified",
			"ActionUID": 217050,
			"IsDisclosed": false,
			"ElseActions": [],
			"TimeOutAbortsMacro": true,
			"Conditions": {
				"ConditionListMatch": "All",
				"ConditionList": [
					{
						"ConditionType": "Variable",
						"VariableValue": "1",
						"Variable": "Local__Show Reload Button _ 1 for yes",
						"VariableConditionType": "Is"
					}
				]
			},
			"ElseActionListDisclosed": false,
			"ThenActions": [
				{
					"MacroActionType": "SetJSONValue",
					"ActionName": "reloadMacroUUID",
					"Target": "Instance_VipParameters.showReloadButton",
					"Text": "1",
					"ActionUID": 217019
				}
			]
		},
		{
			"MacroActionType": "IfThenElse",
			"ActionName": "openConsoleMacroUUID (for testing)",
			"ActionUID": 217021,
			"IsDisclosed": false,
			"ElseActions": [],
			"TimeOutAbortsMacro": true,
			"Conditions": {
				"ConditionListMatch": "All",
				"ConditionList": [
					{
						"ConditionType": "Variable",
						"VariableValue": "value",
						"Variable": "VIP TESTING Open Console Macro UUID",
						"VariableConditionType": "IsNotEmpty"
					}
				]
			},
			"ElseActionListDisclosed": false,
			"ThenActions": [
				{
					"MacroActionType": "SetJSONValue",
					"Target": "Instance_VipParameters.openConsoleMacroUUID",
					"Text": "%Variable%VIP TESTING Open Console Macro UUID%",
					"ActionUID": 217022
				}
			]
		},
		{
			"MacroActionType": "SetJSONValue",
			"ActionName": "includeAccessedVariables",
			"IsDisclosed": false,
			"Target": "Instance_VipParameters.includeAccessedVariables",
			"Text": "%Variable%Local__Accessed Variables _ 1 for yes%",
			"ActionUID": 217035
		},
		{
			"MacroActionType": "IfThenElse",
			"ActionName": "allDictionaryNames and dictionaryNames",
			"ActionUID": 217036,
			"IsDisclosed": false,
			"ElseActions": [
				{
					"MacroActionType": "SetJSONValue",
					"ActionName": "dictionaryNames",
					"Text": "%Variable%Local__Dictionary Names _ or all%",
					"Target": "Instance_VipParameters.dictionaryNames",
					"ActionColor": "Green",
					"ActionUID": 217040
				}
			],
			"TimeOutAbortsMacro": true,
			"Conditions": {
				"ConditionListMatch": "All",
				"ConditionList": [
					{
						"ConditionType": "Variable",
						"VariableValue": "all",
						"Variable": "Local__Dictionary Names _ or all",
						"VariableConditionType": "Is"
					}
				]
			},
			"ThenActions": [
				{
					"MacroActionType": "Group",
					"ActionName": "allDictionaryNames",
					"Actions": [
						{
							"MacroActionType": "ExecuteAppleScript",
							"IncludedVariables": [
								"9999"
							],
							"TrimResults": true,
							"StopOnFailure": false,
							"Variable": "Local_AllDictionaryNames",
							"IncludeStdErr": true,
							"ActionUID": 217038,
							"UseText": true,
							"TrimResultsNew": true,
							"TimeOutAbortsMacro": true,
							"Path": "",
							"DisplayKind": "Variable",
							"HonourFailureSettings": true,
							"Text": "tell application \"Keyboard Maestro Engine\"\n\tget name of dictionaries\nend tell",
							"NotifyOnFailure": false
						},
						{
							"MacroActionType": "SetJSONValue",
							"Target": "Instance_VipParameters.allDictionaryNames",
							"Text": "%Variable%Local_AllDictionaryNames%",
							"ActionUID": 217039
						}
					],
					"TimeOutAbortsMacro": true,
					"ActionColor": "Green",
					"ActionUID": 217037
				}
			]
		},
		{
			"MacroActionType": "IfThenElse",
			"ActionName": "allGlobalVariableNames and variableNames",
			"ActionUID": 217041,
			"IsDisclosed": false,
			"ElseActions": [
				{
					"MacroActionType": "SetJSONValue",
					"ActionName": "variableNames",
					"Text": "%Variable%Local__Variable Names _ or ALL%",
					"Target": "Instance_VipParameters.variableNames",
					"ActionColor": "Green",
					"ActionUID": 217046
				}
			],
			"TimeOutAbortsMacro": true,
			"Conditions": {
				"ConditionListMatch": "All",
				"ConditionList": [
					{
						"ConditionType": "Text",
						"TextValue": "all",
						"Text": "%Variable%Local__Variable Names _ or ALL%",
						"TextConditionType": "Is"
					}
				]
			},
			"ThenActions": [
				{
					"MacroActionType": "Group",
					"ActionName": "allGlobalVariableNames, no variableNames",
					"Actions": [
						{
							"MacroActionType": "ExecuteAppleScript",
							"ActionName": "Fill Local_GlobalVariableNames",
							"IncludedVariables": [
								"9999"
							],
							"TrimResults": true,
							"StopOnFailure": false,
							"Variable": "Local_GlobalVariableNames",
							"IncludeStdErr": true,
							"ActionUID": 217043,
							"UseText": true,
							"TrimResultsNew": true,
							"TimeOutAbortsMacro": true,
							"Path": "",
							"DisplayKind": "AppendVar",
							"IsDisclosed": false,
							"HonourFailureSettings": true,
							"Text": "tell application \"Keyboard Maestro Engine\"\n\tget name of variables\nend tell",
							"NotifyOnFailure": false
						},
						{
							"MacroActionType": "SetJSONValue",
							"ActionName": "allGlobalVariableNames",
							"IsDisclosed": false,
							"Target": "Instance_VipParameters.allGlobalVariableNames",
							"Text": "%Variable%Local_GlobalVariableNames%",
							"ActionUID": 217044
						}
					],
					"TimeOutAbortsMacro": true,
					"ActionColor": "Green",
					"ActionUID": 217042
				},
				{
					"MacroActionType": "SetJSONValue",
					"ActionName": "variableNames (needs to be initialized to an empty string)",
					"Text": "",
					"Target": "Instance_VipParameters.variableNames",
					"ActionColor": "Green",
					"ActionUID": 217045
				}
			]
		},
		{
			"MacroActionType": "SetJSONValue",
			"ActionName": "isAsync",
			"IsDisclosed": false,
			"Target": "Instance_VipParameters.isAsync",
			"Text": "%Variable%Local__Async _ 1 for yes%",
			"ActionUID": 217047
		},
		{
			"MacroActionType": "IfThenElse",
			"ActionName": "canHideVariables",
			"ActionUID": 239624,
			"IsDisclosed": false,
			"ElseActions": [],
			"TimeOutAbortsMacro": true,
			"Conditions": {
				"ConditionListMatch": "All",
				"ConditionList": [
					{
						"ConditionType": "Variable",
						"VariableValue": "1",
						"Variable": "Local__Can Hide Variables _ 1 for yes",
						"VariableConditionType": "Is"
					}
				]
			},
			"ElseActionListDisclosed": false,
			"ThenActions": [
				{
					"MacroActionType": "SetJSONValue",
					"Target": "Instance_VipParameters.canHideVariables",
					"Text": "1",
					"ActionUID": 239623
				}
			]
		},
		{
			"MacroActionType": "Group",
			"ActionName": "htmlFilePath, deleteTempHtmlFile",
			"Actions": [
				{
					"MacroActionType": "IfThenElse",
					"ActionName": "Use either the Production or Development HTML file.",
					"ActionUID": 217024,
					"ElseActions": [
						{
							"MacroActionType": "Group",
							"ActionName": "Save HTML file to temp file delete it when done",
							"Actions": [
								{
									"MacroActionType": "SetJSONValue",
									"IsDisclosed": false,
									"Target": "Instance_VipParameters.htmlFilePath",
									"Text": "/tmp/VariableInspectorPrompt.html",
									"ActionUID": 217029
								},
								{
									"MacroActionType": "SetVariableToText",
									"IsDisclosed": false,
									"ProcessingMode": "Nothing",
									"Variable": "Local_HTML",
									"Text": "<!DOCTYPE html>\n<html>\n\t<head>\n\t\t<title>Variable Inspector Prompt</title>\n\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n\n<style type=\"text/css\">\n/* #region ======== Content Styles ========================== */\nhtml,\nbody,\n.page {\n\theight: 100%;\n}\n\nbody {\n\toverflow: hidden;\n\tmargin: 0;\n\tfont-family: Helvetica Neue, Helvetica, Arial, sans-serif;\n\tfont-size: 14px;\n\twidth: 100%;\n\theight: 100%;\n}\n\n#optionsMenu {\n\tposition:absolute;\n\ttop:5px;\n\tleft:8px;\n\tfont-size: 0.85em;\n}\n\n.optionsMenuDisabled {\n\tcursor: not-allowed !important;\n\tpointer-events: none !important;\n\tcolor: #cbcbcb !important;\n}\n\n#openConsole {\n\tposition:absolute;\n\ttop:5px;\n\tright:10px;\n\tfont-size: 0.75em;\n}\n\n#version {\n\tposition:absolute;\n\tbottom:10px;\n\tleft:10px;\n\tfont-size: 0.75em;\n\ttext-align: right;\n}\n\n.page {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\nheader, footer {\n\tbackground: #ececec;\n\tcolor: black;\n}\n\nheader {\n\tflex: 0 0 auto;\n\tmin-height: 70px;\n\tpadding-right: 58px; /* width of icon cell */\n}\n\n#divHeader {\n\tfont-size: 14px;\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: center;\n}\n\n#imgIcon {\n\tflex: 0 0 auto;\n\twidth: 48px;\n\theight: 48px;\n\ttransform: translate(13px, 12px);\n}\n\n#hHeader {\n\tflex: 0 0 auto;\n}\n\n#content {\n\tflex: 1 1 auto;\n\tdisplay: flex;\n\tflex-direction: row;\n\tpadding-left: 20px;\n\tpadding-right: 20px;\n\tbackground: #ececec;\n}\n\n#divVariables {\n\tflex: 1 1 auto;\n\tdisplay: flex;\n\tflex-direction: column;\n\twidth: 333px;\n\tmin-width: 333px;\n\t/* margin-right: 15px; */\n\tbox-sizing: border-box;\n}\n\ninput:disabled {\n\tbackground: #dddddd;\n}\n\n#divVariables input {\n\tfont-family: Helvetica Neue, Helvetica, Arial, sans-serif;\n\tfont-size: 1em;\n\tflex: 0 0 auto;\n\tmargin-bottom: 5px;\n}\n\n#divSelVariables {\n\tflex: 1 1 auto;\n\t/* border: 1px solid red; */\n\tdisplay: block;\n\tpadding: 2px;\n\toverflow: hidden;\n}\n\n#selVariables {\n\tflex: 1 1 auto;\n\tfont-weight: 400;\n\tcolor: black;\n\tfont-size: 1em;\n\twidth: 100%;\n\theight: 1px;\n}\n\n#selVariables option[data-hidden-variable] {\n\tbackground-color: #FEEFB3;\n}\n\n#divValue {\n\tflex: 1 1 auto;\n\tdisplay: flex;\n\tflex-direction: column;\n\twidth: 200px;\n\tbox-sizing: border-box;\n\tmin-height: 0;\n\tmin-width: 200px;\n}\n\n#divDictionary {\n\tflex: 1 1 auto;\n\toverflow-y: auto;\n\toverflow-x:hidden;\n\theight: 1px;\n}\n\ntextarea {\n\tflex: 1 1 auto;\n\tfont-family: Helvetica Neue, Helvetica, Arial, sans-serif;\n\tfont-size: 1em;\n}\n\ntextArea:read-only {\n\tbackground-color: #ececec;\n}\n\n.fixedFont {\n\tfont-family: monospace !important;\n}\n\n.errorMessage {\n\tcolor: red;\n}\n\nfooter {\n\tflex: 0 0 auto;\n\tmin-height: 50px;\n\tpadding-top: 10px;\n\tpadding-right: 20px;\n\tpadding-left: 20px;\n}\n\nfooter a {\n\tfloat: right;\n\tmargin-left: 5px;\n\twidth: 3.5em;\n\ttext-align: center;\n}\n\n.invisible {\n\tvisibility: hidden !important;\n}\n\n.hidden {\n\tdisplay: none !important;\n}\n\n.disabled {\n\tcursor: not-allowed !important;\n\tpointer-events: none !important;\n\tcolor: #cbcbcb !important;\n\tbackground-color: #cbcbcb !important;\n\tborder:2px solid #cbcbcb !important;\n}\n\n.pseudoDisabled {\n\t/* color: #cbcbcb !important; */\n\tcolor: gray !important;\n\t/* background-color: #dcdcdc !important; */\n\tbackground: #dcdcdc !important;\n\t/* border:3px solid #cbcbcb !important; */\n}\n\n.divUIBusy {\n\tposition: fixed;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\tleft: 0;\n\tbackground: rgba(0, 0, 0, 0.4);\n\tz-index: 90000;\n\tanimation: divUIBusyFadeIn ease 900ms;\t\n}\n\n@keyframes divUIBusyFadeIn {\n\t0% {\n\t  opacity:0;\n\t}\n\t80% {\n\t\topacity:0;\n\t}\n\t100% {\n\t  opacity:1;\n\t}\n  }\n\n.divUIBusyHidden {\n\tvisibility: hidden;\n\topacity: 0;\n}\n\n.divUIBusyVisible {\n\tvisibility: visible;\n\topacity: 1;\n}\n\n/* #endregion */\n\n/* #region ======== Status Line ============================= */\n\n.statusLine {\n\tflex: 0 0;\n\tdisplay: flex;\n\tflex-direction: row;\n\t/* flex-basis: 25px; */\n\tflex-basis: 2em;\n\tborder: 1px solid #84bbf3;\n\tmargin-left: 2px;\n\tmargin-right: 2px;\n}\n\n.statusPanel {\n\tmargin-top: 0.35em;\n\tmargin-left: 5px;\n\tvertical-align: middle;\n\ttransform-origin: 1em;\n}\n\n.statusPanelContainer {\n\tflex: 0 1 auto;\n\tdisplay: flex;\n\tflex-direction: row;\n\tmargin-left: 3px;\n}\n\n.statusPanelContainer table {\n\tborder-collapse: collapse;\n\tborder-spacing: 1px;\n\tmargin-right: 7px;\n\theight: 100%\n}\n\n.statusPanelContainer td {\n\tvertical-align: middle;\n}\n\n.statusText {\n\tpadding-left: 2px;\n\tpadding-top: 3px;\n}\n\n.statusCountSVG {\n\tpadding-left: 2px;\n\tdisplay: block;\n\tposition: relative;\n\ttop: 0px;\n\theight: 18px;\n}\n\n.statusFilterSVG {\n\tpadding-left: 2px;\n\tdisplay: block;\n\tposition: relative;\n\ttop: 0px;\n\theight: 16px;\n}\n\n.statusHiddenSVG {\n\tpadding-left: 2px;\n\tdisplay: block;\n\tposition: relative;\n\ttop: 0px;\n\theight: 16px;\n}\n\n.statusSelectedSVG {\n\tpadding-left: 2px;\n\tdisplay: block;\n\tposition: relative;\n\ttop: 0px;\n\theight: 16px;\n}\n\n#spanStatusMessage {\n\tcolor: blue;\n}\n\n/* #endregion */\n\n/* #region ======== Info Boxes ============================== */\n\ndiv.info, div.success, div.warning, div.error {\nborder: 1px solid;\nmargin-bottom: 3px;\nmargin-left: 2px;\nmargin-right: 2px;\npadding-left: 8px;\npadding-bottom: 2px;\nborder-radius: 2px;\nflex: 0 0 auto;\n}\n\n.infoText {\n\n}\n\n.infoBoxIcon {\ndisplay: inline-block;\nposition: relative;\nbottom: -2px;\nfont-size: 18px;\n}\n\ndiv.info {\ncolor: #00529b;\nbackground-color: #bde5f8;\n}\n\ndiv.success {\ncolor: #4f8a10;\nbackground-color: #dff2bf;\n}\n\ndiv.warning {\ncolor: black;\nbackground-color: #FEEFB3;\n}\n\ndiv.error {\ncolor: #D8000C;\nbackground-color: #FFBABA;\n}\n\n#divFloatingWarningContainer {\n\tposition: fixed;\n\ttop: 18px;\n\tleft: 18px;\n\theight: 50px;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: left;\n\tjustify-content: center;\n\tz-index: 1;\n}\n\n#divFloatingWarning {\n\tflex: 0;\n\tborder: 1px solid;\n\tpadding-left: 5px;\n\tpadding-right: 4px;\n\tpadding-bottom: 0px;\n\tborder-radius: 5px;\n\tcolor: black;\n\tbackground-color: #FEEFB3;\n\tposition: fixed;\n}\n\n#divFloatingWarning td {\n\tvertical-align: top;\n}\n\n#divFloatingWarning td:first-child {\n\tfont-size: 18px;\n\tpadding-right: 3px;\n}\n\n#divFloatingWarning td:nth-child(2) {\n\tpadding-top: 3px;\n}\n\n#divFloatingWarning td:last-child {\n\tpadding-left: 6px;\n\tfont-size: 0.9em;\n}\n\n#divFloatingWarning td:last-child a {\n\ttext-decoration: none;\n}\n\n/* #endregion */\n\n/* #region ======== Animations ============================== */\n\n.scale-in-center {\n\topacity: 1;\n\tanimation: scale-in-center 0.35s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\t\n}\n\n.popup-in-center {\n\topacity: 1;\n\tanimation: popup-in-center 0.5s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;\t\n}\n\n.fade-out {\n\topacity: 0;\n\tanimation: fade-out 0.35s ease-out both;\n}\n\n/* ----------------------------------------------\n * Generated by Animista on 2022-1-11 12:7:7\n * Licensed under FreeBSD License.\n * See http://animista.net/license for more info. \n * w: http://animista.net, t: @cssanimista\n * ---------------------------------------------- */\n\n/**\n * ----------------------------------------\n * animation scale-in-center\n * ----------------------------------------\n */\n  @keyframes scale-in-center {\n\t0% {\n\t\ttransform: scale(0);\n\t\topacity: 1;\n\t}\n\t100% {\n\t\ttransform: scale(1);\n\t  \topacity: 1;\n\t}\n  }\n\n/**\n * ----------------------------------------\n * animation popup-in-center\n * ----------------------------------------\n */\n @keyframes popup-in-center {\n\t0% {\n\t\ttransform: scale(0);\n\t\topacity: 1;\n\t}\n\t75% {\n\t\ttransform: scale(1.1);\n\t\topacity: 1;\n\t}\n\t80% {\n\t\ttransform: scale(1.1);\n\t\topacity: 1;\n\t}\n\t100% {\n\t\ttransform: scale(1);\n\t\topacity: 1;\n\t}\n  }\n\n  /* ----------------------------------------------\n * Generated by Animista on 2022-1-11 12:10:8\n * Licensed under FreeBSD License.\n * See http://animista.net/license for more info. \n * w: http://animista.net, t: @cssanimista\n * ---------------------------------------------- */\n\n/**\n * ----------------------------------------\n * animation fade-out\n * ----------------------------------------\n */\n  @keyframes fade-out {\n\t0% {\n\t  opacity: 1;\n\t}\n\t100% {\n\t  opacity: 0;\n\t}\n  }\n  \n/* #endregion */\n\n/* #region ======== Splitter Styles ========================= */\n\n.splitter {\nwidth: 20px;\npadding: 0;\ncursor: ew-resize;\nflex: 0 0 auto;\n}\n\n.splitter::before {\ncontent: '';\ndisplay: block;\nwidth: 6px;\nheight: 100%;\nbackground: #d1d1d1;\nmargin-top: 38px;\nmargin-bottom: 2px;\nmargin-left: auto;\nmargin-right: auto;\n}\n\t\t\n/* #endregion */\n\n/* #region ======== Dictionary Table Styles ================= */\n\ntable.tblDictionary {\n\tborder:1px solid #84bbf3;\n\twidth: 100%;\n\ttext-align: left;\n\tborder-collapse: collapse;\n\ttable-layout:fixed;\n}\n\ntable.tblDictionary td, table.tblDictionary th {\n\tborder: 1px solid #AAAAAA;\n\tpadding: 5px 4px;\n\tword-wrap:break-word;\n\tvertical-align: top;\n}\n\ntable.tblDictionary thead {\n\tborder-top-left-radius: 6px;\n\tbackground-color:#79bbff;\n\tbackground:linear-gradient(to bottom, #79bbff 5%, #378de5 100%);\n\tborder-bottom: 1px solid #444444;\n}\n\ntable.tblDictionary thead th {\n\tfont-size: 14px;\n\t/* font-weight: bold; */\n\tcolor: #FFFFFF;\n\tborder-left: 2px solid #D0E4F5;\n\tcursor:pointer;\n\tposition: relative;\n}\n\ntable.tblDictionary thead th:hover:not([data-resizing]):not(:first-child) {\n\tbackground:linear-gradient(to bottom, #378de5 5%, #79bbff 100%);\n}\n\ntable.tblDictionary thead th:active {\n\tposition:relative;\n\ttop:1px;\n}\n\ntable.tblDictionary thead th:first-child {\n\tborder-left: none;\n\tborder-right: none;\n\tmax-width: 25px;\n\twidth: 25px;\n}\n\ntable.tblDictionary thead th:nth-child(2) {\n\tborder-left: none;\n\twidth: 150px;\n\tmin-width: 80px;\n\tpadding-right: 20px !important;\n}\n\n.resize-handle {\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\tbackground: black;\n\topacity: 0;\n\twidth: 5px;\n\tcursor: col-resize;\n}\n   \n.resize-handle:hover,\n.resize-handle:active {\n\topacity: 0.5;\n}\n\n.selectableRow {\n\ttransition: all 0.4s linear;\n}\n\n.selectedRow {\n\tbackground-color: yellow !important;\n\t/* transition: none; */\n}\n\ntable.tblDictionary tbody td {\n\tfont-size: 1em;\n}\n\ntable.tblDictionary tbody td:first-child {\n\tborder-right: none !important;\n}\n\ntable.tblDictionary tbody td:first-child a {\n\ttext-decoration: none;\n}\n\ntable.tblDictionary tbody td:nth-child(2) {\n\tborder-left: none !important;\n}\n\n.dictCell {\n\tpadding-top: 7px !important;\n}\n\n.dictDeleteCell {\n}\n\n.trashCan {\n}\n\n.trashCanEnabled::before {\n\tcontent: url('data:image/svg+xml; utf8, <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-trash\" viewBox=\"0 0 16 16\"> <path d=\"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z\"/> <path fill-rule=\"evenodd\" d=\"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z\"/> </svg>');\n\tfill: red;\n\twidth: 16px;\n\theight: 16px;\n\tdisplay: block;\n\tmargin: 2px;\n}\n\n.trashCanDisabled::before {\n\tcontent: url('data:image/svg+xml; utf8, <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"#a7a7a7\" class=\"bi bi-trash\" viewBox=\"0 0 16 16\"> <path d=\"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z\"/> <path fill-rule=\"evenodd\" d=\"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z\"/> </svg>');\n\twidth: 16px;\n\theight: 16px;\n\tdisplay: block;\n\tmargin: 2px;\n}\n\n.trashCanDisabled {\n\tcursor: not-allowed !important;\n\tpointer-events: none !important;\n}\n\n.dictKeyCell {\n\ttransition: background-color 0.4s linear;\n}\n\n.dictValueCell {\n\ttransition: background-color 0.4s linear;\n}\n\n.selectedCell {\n\tbackground-color: yellow !important;\n}\n\n.dictCellContent {\n}\n\n.dictCellContentUndeleted {\n/* \n\tmax-height: 100px;\n\ttransition: max-height 0.6s, padding 0.6s;\n*/\n}\n\n.dictCellEdit {\n\tbackground-color: white;\n}\n\n.dictCellError {\n\tborder-radius: 3px;\n\tmargin-top: 7px;\n\tpadding: 5px;\n\tpadding-left: 10px;\n\tbackground-color: red;\n\tcolor: white;\n}\n\ntable.tblDictionary tr:nth-child(even) {\n\tbackground: #D0E4F5;\n}\n/* #endregion */\n\n/* #region ======== Tool Tip Styles ========================= */\n.tooltip {\n\tposition: relative;\n\tdisplay: inline-block;\n}\n\n/* \nI'm sure theres a way to have the left, right, and center classes\nwithout repeating the entire class each time, but I couldn't figure it out.\n*/\n\n.tooltipText {\n\tfont-size: 0.9em;\n\tvisibility: hidden;\n\twidth: 9em;\n\tbackground-color: #636363;\n\tcolor: #fff;\n\ttext-align: center;\n\tborder-radius: 6px;\n\tpadding: 0.3em 0.3em;\n\tposition: absolute;\n\tz-index: 1;\n\tbottom: 140%;\n}\n\n.tooltip .tooltipTextCenter {\n\tleft: 50%;\n\tmargin-left: -5em; /* -60px */\n}\n\n.tooltip .tooltipTextCenter::after {\n\tcontent: \"\";\n\tposition: absolute;\n\ttop: 100%;\n\tleft: 50%;\n\tmargin-left: -5px;\n\tborder-width: 5px;\n\tborder-style: solid;\n\tborder-color: #636363 transparent transparent transparent;\n}\n\n.tooltip .tooltipTextRight {\n\tleft: 100%;\n\tmargin-left: -2.5em; /* -30px; */\n}\n\n.tooltip .tooltipTextRight::after {\n\tcontent: \"\";\n\tposition: absolute;\n\ttop: 100%;\n\tright: 90%;\n\tmargin-right: -5px;\n\tborder-width: 5px;\n\tborder-style: solid;\n\tborder-color: #636363 transparent transparent transparent;\n}\n\n.tooltip .tooltipTextLeft {\n\tright: 100%;\n\tmargin-right: -2.5em; /* -30px; */\n}\n\n.tooltip .tooltipTextLeft::after {\n\tcontent: \"\";\n\tposition: absolute;\n\ttop: 100%;\n\tleft: 85%;\n\tmargin-right: -5px;\n\tborder-width: 5px;\n\tborder-style: solid;\n\tborder-color: #636363 transparent transparent transparent;\n}\n\n/* NOTE: If you're NOT using my \"TooltipFadeInAnimator\", then un-comment this: */\n/*\n.tooltip:hover .tooltipTextCenter {\n\tvisibility: visible;\n}\n*/\n/* #endregion */\n\n/* #region ======== Button Styles =========================== */\n.divToolButtonsWrap {\n\tflex: 0 0;\n\tdisplay: inline-block;\n\tflex-direction: row;\n\tflex-basis: 32px;\n\tmargin-bottom: 5px;\n\talign-items: center;\n}\n\n.divToolButtons {\n\tflex: 0 0;\n\tdisplay: flex;\n\tflex-direction: row;\n\tflex-basis: 32px;\n\tmargin-bottom: 5px;\n\talign-items: center;\n}\n\n.btnToolSeparator {\n\tmargin-top: 3px;\n\tflex: 0;\n\theight: 28px;\n\tborder-radius:6px;\n\t/* width: 13px; */\n}\n\n.btnToolSeparator svg {\n\tdisplay: inline-block;\n\ttransform: translateX(1px);\n\tpadding-left: 2px;\n\tpadding-right: 1px;\n\twidth: 4px;\n\theight: 28px;\n\tcolor: #84bbf3;\n}\n\n.btnTool {\n\tmargin-top: 3px;\n\tmargin-left: 1px;\n\tmargin-right: 1px;\n\tflex: 0;\n\theight: 28px;\n\tbackground-color:#ffffff;\n\tborder-radius:6px;\n\tborder:2px solid #84bbf3;\n}\n\n.divToolButtonsWrap .btnTool {\n\tmargin-right: -3px !important;\n}\n\n#btnDeleteVariables {\n\twidth: 27px;\n\theight: 28px;\n}\n\n#btnSort[data-sort-by-name=true] #imgSortByName {\n\tdisplay:inline;\n}\n#btnSort[data-sort-by-name=true] #imgSortBySize {\n\tdisplay: none;\n}\n#btnSort[data-sort-by-name=false] #imgSortByName {\n\tdisplay: none;\n}\n#btnSort[data-sort-by-name=false] #imgSortBySize {\n\tdisplay: inline;\n}\n\n.btnToolHelp {\n\tflex: 0 1 auto !important;\n\tfont-size: 14px;\n\tpadding-right: 10px;\n\tcolor: black;\n\ttext-decoration:none;\n}\n\n.btnToolHelp svg {\n\tvertical-align: middle;\n}\n\n.btnToolHover:hover {\n\tborder:2px solid #84bbf3;\n\tbox-shadow: 0px 1px 5px 0px #8C1F13;\n}\n\n.btnToolHover:active {\n\tposition:relative;\n\ttop:1px;\n}\n\n.btnToolLeft {\n\t/* margin-right: 1px; */\n}\n\n.btnToolLeft:hover {\n\t/* margin-right: 5px !important;\n\tmargin-left: 3px !important */\n}\n\n.btnToolRight {\n\tmargin-left: 1px;\n}\n\n.btnToolRight:hover {\n\t/* margin-right: 3px !important;\n\tmargin-left: 5px !important */\n}\n\n.btnTool svg {\n\tpadding: 3px;\n\twidth: 22px;\n\theight: 22px;\n}\n\n/* .svgFontSize {\n\ttransform: translateY(-1px);\n} */\n\n.btnTool #imgDeleteVariables {\n\tpadding-left: 2px;\n\tpadding-right: 4px;\n\tpadding-top: 3px;\n\tpadding-bottom: 3px;\n\twidth: 22px;\n\theight: 22px;\n}\n\n.btnToolSpacer {\n\tflex: 1 1 auto;\n}\n\n/*.btnToolDown:not(.disabled):not(:hover) {*/\n .btnToolDown {\n\tborder:2px solid rgb(82, 85, 251) !important;\n\tbackground-color:#00ff00 !important;\n}\n\n.okButton {\n\tbox-shadow:inset 0px 1px 0px 0px #bbdaf7;\n\tbackground:linear-gradient(to bottom, #79bbff 5%, #378de5 100%);\n\tbackground-color:#79bbff;\n\tborder-radius:6px;\n\tborder:1px solid #84bbf3;\n\tdisplay:inline-block;\n\tcursor:pointer;\n\tcolor:#ffffff;\n\tfont-family:Arial;\n\tfont-size:1.1em;\n\tfont-weight:bold;\n\tpadding:6px 24px;\n\ttext-decoration:none;\n\ttext-shadow:0px 1px 0px #528ecc;\n}\n.okButton:hover {\n\tbackground:linear-gradient(to bottom, #378de5 5%, #79bbff 100%);\n\tbackground-color:#378de5;\n}\n.okButton:active {\n\tposition:relative;\n\ttop:1px;\n}\n\n.cancelButton {\n\tbox-shadow:inset 0px 1px 0px 0px #ffffff;\n\tbackground:linear-gradient(to bottom, #ffffff 5%, #f6f6f6 100%);\n\tbackground-color:#ffffff;\n\tborder-radius:6px;\n\tborder:1px solid #dcdcdc;\n\tdisplay:inline-block;\n\tcursor:pointer;\n\tcolor:#666666;\n\tfont-family:Arial;\n\tfont-size: 1.1em;\n\tfont-weight:bold;\n\tpadding:6px 24px;\n\ttext-decoration:none;\n\ttext-shadow:0px 1px 0px #ffffff;\n}\n.cancelButton:hover {\n\tbackground:linear-gradient(to bottom, #f6f6f6 5%, #ffffff 100%);\n\tbackground-color:#f6f6f6;\n}\n.cancelButton:active {\n\tposition:relative;\n\ttop:1px;\n}\n\n.reloadButton {\n\tbox-shadow:inset 0px 1px 0px 0px #caefab;\n\tbackground:linear-gradient(to bottom, #77d42a 5%, #5cb811 100%);\n\tbackground-color:#77d42a;\n\tborder-radius:6px;\n\tborder:1px solid #268a16;\n\tdisplay:inline-block;\n\tcursor:pointer;\n\tcolor:#306108;\n\tfont-family:Arial;\n\tfont-size:1.1em;\n\tfont-weight:bold;\n\tpadding:6px 24px;\n\ttext-decoration:none;\n\ttext-shadow:0px 1px 0px #aade7c;\n}\n.reloadButton:hover {\n\tbackground:linear-gradient(to bottom, #5cb811 5%, #77d42a 100%);\n\tbackground-color:#5cb811;\n}\n.reloadButton:active {\n\tposition:relative;\n\ttop:1px;\n}\n\t\t\n/* #endregion */\n\n/* #region ======== modalDialogBox Styles =================== */\n.modalDialog {\n\tposition: fixed;\n\tfont-family: Arial, Helvetica, sans-serif;\n\tfont-size: 14px;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\tleft: 0;\n\tbackground: rgba(0, 0, 0, 0.8);\n\tz-index: 99999;\n\ttransition: opacity 100ms ease-in, background 200ms ease-in;\n\t/* transition: background 200ms ease-in; */\n}\n/* \n.modalOptionsDialog {\n\tbackground: rgba(0, 0, 0, 0.4) !important;\n}\n */\n.modalOptionsDialogTransparent {\n\tbackground: rgba(0, 0, 0, 0.1) !important;\n}\n\n.modalDialogHidden {\n\topacity: 0;\n\tpointer-events: none;\n}\n\n.modalDialogVisible {\n\topacity: 1;\n\tpointer-events: auto;\n}\n\n.modalDialogBox {\n\twidth: 405px;\n\tposition: fixed;\n\tleft: 50%;\n\ttop: 50%;\n\ttransform: translate(-50%, -50%);\n\tpadding: 0;\n\tpadding-top: 15px;\n\tpadding-bottom: 15px;\n\tpadding-left: 0;\n\tpadding-right: 0;\n\tborder-radius: 10px;\n\tbackground: #ececec;\n\tborder: 1px solid darkgray;\n\tbox-shadow: 2px 2px 5px 0px #696775;\n\t/*background:linear-gradient(to bottom, #ececec 5%, #999 90%);*/\n}\n\n.modalDialogHeader span {\n\tfont-size: 1.2em;\n\tfont-weight: bold;\n\tmargin-left: 20px;\n}\n\n.modalDialogBody {\n\tfont-size: 1em;\n\tmargin-top: 0;\n\tmargin-left: 15px;\n\tmargin-right: 15px;\n\tmargin-bottom: 15px;\n\toverflow: auto;\n}\n\n.modalDialogBody h2 {\n\ttext-align: center;\n\tmargin-top: 0;\n}\n\n.modalDialogInputTable {\n\twidth: 100%;\n}\n\n.modalDialogInputTable input {\n\tfont-size: 1em;\n\twidth: 98%; /* I don't know why 100% doesn't work right, but this is good enough.   */\n}\n\n.modalDialogIconTable td:first-child {\n\tpadding-right: 10px;\n}\n\n.modalDialogFooter {\n\tmargin-right: 15px;\n}\n\n.modalDialogBox .dialogBottomButton {\n\tfloat: right;\n\twidth: 70px;\n\tmargin-left: 5px;\n\ttext-align: center;\n}\n\n#editBoxDialogCheckboxCell{\n\twidth: 20px;\n}\n\n.divOptionsTable {\n\tborder: 1px solid red;\n\t/* display: block; */\n\theight: 100%;\n\twidth: 100%\n}\n\ntable.tblOptions {\n\tborder:1px solid #84bbf3;\n\twidth: 100%;\n\ttext-align: left;\n\tborder-collapse: collapse;\n\ttable-layout:fixed;\n}\n\ntable.tblOptions tr:nth-child(even) {\n\tbackground: #f5f5f5;\n}\n\ntable.tblOptions td {\n\tborder: 1px solid #AAAAAA;\n\tpadding: 5px 4px;\n\tword-wrap:break-word;\n\tvertical-align: middle;\n}\ntable.tblOptions td:first-child {\n\t/* width: fit-content; */\n}\ntable.tblOptions td:last-child {\n\twidth: 7em;\n}\n\n.tblOptionsButtonSmall {\n\tbox-shadow:inset 0px 1px 0px 0px #bbdaf7;\n\tbackground:linear-gradient(to bottom, #79bbff 5%, #378de5 100%);\n\tbackground-color:#79bbff;\n\tborder:1px solid #84bbf3;\n\tcolor:#ffffff;\n\tborder-radius:4px;\n\tmargin-right: -6px;\n\tmargin-top: 3px;\n\tmargin-bottom: 3px;\n\tdisplay:inline-block;\n\tcursor:pointer;\n\tfont-family:Arial;\n\tfont-size:16px;\n\twidth: 19px;\n\theight: 19px;\n\ttext-align: center;\n\tvertical-align: middle;\n\ttext-decoration:none;\n}\n.tblOptionsButtonSmall svg {\n\tpadding-left: 1px;\n}\n.tblOptionsButtonSmallPlus {\n\tpadding-top: 2px;\n}\n.tblOptionsButtonSmall:hover {\n\tbackground:linear-gradient(to bottom, #378de5 5%, #79bbff 100%);\n\tbackground-color:#378de5;\n}\n.tblOptionsButtonSmall:active {\n\tposition:relative;\n\ttop:1px;\n}\n\n.tblOptionsButton {\n\tbox-shadow:inset 0px 1px 0px 0px #bbdaf7;\n\tbackground:linear-gradient(to bottom, #79bbff 5%, #378de5 100%);\n\tbackground-color:#79bbff;\n\tborder:1px solid #84bbf3;\n\tcolor:#ffffff;\n\tborder-radius:4px;\n\tmargin-right: -6px;\n\tmargin-top: 3px;\n\tmargin-bottom: 3px;\n\tdisplay:inline-block;\n\tcursor:pointer;\n\tfont-family:Arial;\n\tfont-size:13px;\n\t/* font-weight:bold; */\n\tpadding:3px 7px;\n\ttext-decoration:none;\n}\n.tblOptionsButton:hover {\n\tbackground:linear-gradient(to bottom, #378de5 5%, #79bbff 100%);\n\tbackground-color:#378de5;\n}\n.tblOptionsButton:active {\n\tposition:relative;\n\ttop:1px;\n}\n       \n.dialogOkButton {\n\tbox-shadow:inset 0px 1px 0px 0px #bbdaf7;\n\tbackground:linear-gradient(to bottom, #79bbff 5%, #378de5 100%);\n\tbackground-color:#79bbff;\n\tborder-radius:6px;\n\tborder:1px solid #84bbf3;\n\tdisplay:inline-block;\n\tcursor:pointer;\n\tcolor:#ffffff;\n\tfont-family:Arial;\n\tfont-size:1em;\n\tfont-weight:bold;\n\tpadding:6px 0px;\n\ttext-decoration:none;\n\ttext-shadow:0px 1px 0px #528ecc;\n}\n.dialogOkButton:hover {\n\tbackground:linear-gradient(to bottom, #378de5 5%, #79bbff 100%);\n\tbackground-color:#378de5;\n}\n.dialogOkButton:active {\n\tposition:relative;\n\ttop:1px;\n}\n\n.dialogCancelButton {\n\tbox-shadow:inset 0px 1px 0px 0px #ffffff;\n\tbackground:linear-gradient(to bottom, #ffffff 5%, #f6f6f6 100%);\n\tbackground-color:#ffffff;\n\tborder-radius:6px;\n\tborder:1px solid #dcdcdc;\n\tdisplay:inline-block;\n\tcursor:pointer;\n\tcolor:#666666;\n\tfont-family:Arial;\n\tfont-size:1em;\n\tfont-weight:bold;\n\tpadding:6px 0px;\n\ttext-decoration:none;\n\ttext-shadow:0px 1px 0px #ffffff;\n}\n.dialogCancelButton:hover {\n\tbackground:linear-gradient(to bottom, #f6f6f6 5%, #ffffff 100%);\n\tbackground-color:#f6f6f6;\n}\n.dialogCancelButton:active {\n\tposition:relative;\n\ttop:1px;\n}\n/* #endregion */\n\n/* #region ======== Sliders (Checkboxes) ==================== */\n.switch {\n\tposition: relative;\n\tdisplay: inline-block;\n\twidth: 30px;\n\theight: 17px;\n\tmargin-top: 6px;\n\tmargin-bottom: 6px;\n  }\n  \n  .switch input { \n\topacity: 0;\n\twidth: 0;\n\theight: 0;\n  }\n  \n  .slider {\n\tposition: absolute;\n\tcursor: pointer;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tbottom: 0;\n\tbackground-color: #ccc;\n  }\n\n  .slider:hover {\n\ttransition: .2s;\n  }\n  \n  .slider:before {\n\tposition: absolute;\n\tcontent: \"\";\n\theight: 13px;\n\twidth: 13px;\n\tleft: 2px;\n\tbottom: 2px;\n\tbackground-color: white;\n  }\n\n  .slider:before:hover {\n\ttransition: .2s;\n}\n  \n  input:checked + .slider {\n\tbackground-color: #2196F3;\n  }\n  \n  input:focus + .slider {\n\tbox-shadow: 0 0 1px #2196F3;\n  }\n  \n  input:checked + .slider:before {\n\ttransform: translateX(13px);\n  }\n  \n  /* Rounded sliders */\n  .slider.round {\n\tborder-radius: 17px;\n  }\n  \n  .slider.round:before {\n\tborder-radius: 50%;\n  }\n\t\t\t  \n/* #endregion */\n</style>\n<script type=\"text/javascript\">\n'use strict'\n\n/*\n\tVersion History \n\t---------------\n\t3.2 - \tPing \"Internal\" macro at startup\n\t\t\tTogglable Buttons remember their state\n\t\t\tSeparate JSON states for variables vs. dictionaries.\n\t\t\tUserOptions\n\t\t\t\toptionsFocusFilterOnStartup\n\t\t\t\tsortBySizeSelectsFirstVariable option.\n\t\t\t\tEscape in empty filter closes prompt.\n\t\t\t\tHover over font size buttons changes background.\n\t\t\t\tFontSize stored in UserOptions\n\t\t\tDialogs can scroll if needed.\n\n\t3.1 - Consolidate \"Internal\" macros into one macro.\n\t3.0 - Hide Variables and a bunch of other stuff.\n\t2.0 - Dictionary Editor\n\t1.0 - Initial Release\n*/\nconst _version = \"3.2\";\n\n// #region ======== Prototypes ==============================\n\tif (!String.prototype.startsWith) {\n\t\tString.prototype.startsWith = function (searchString, position) {\n\t\t\tposition = position || 0;\n\t\t\treturn this.substr(position, searchString.length) === searchString;\n\t\t};\n\t}\n\n\tString.prototype.trimTrailingNewlines = function() {\n\t\treturn this.replace(/\\n*$/, \"\");\n\t}\n\n\tObject.prototype.clone = function() {\n\t\treturn JSON.parse(JSON.stringify(this));\n\t}\n\n\tArray.prototype.removeDups = function() {\n\t\treturn this.reduce((prev, curr) => {\n\t\t\tif (curr && prev.indexOf(curr) < 0)\n\t\t\t\tprev.push(curr);\n\t\t\treturn prev;\n\t\t}, []);\n\t}\n\n\tNode.prototype.hasClass = function(className) {\n\t\treturn this.classList.contains(className);\n\t};\n\n\tNode.prototype.toggleClass = function(className, add) {\n\t\tif (add) {\n\t\t\tif (!this.classList.contains(className))\n\t\t\t\tthis.classList.add(className);\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.classList.remove(className);\n\t\treturn false;\n\t};\n\n\tNode.prototype.swapClasses = function(className1, className2, useClassName1) {\n\t\tif (useClassName1 === undefined || useClassName1) {\n\t\t\tthis.classList.remove(className2);\n\t\t\tif (!this.classList.contains(className1))\n\t\t\t\tthis.classList.add(className1);\n\t\t} else {\n\t\t\tthis.classList.remove(className1);\n\t\t\tif (!this.classList.contains(className2))\n\t\t\t\tthis.classList.add(className2);\n\t\t}\n\t};\n\n\tNode.prototype.setVisible = function(showElement) {\n\t\treturn !this.toggleClass(\"hidden\", !showElement);\n\t}\n\n\tNode.prototype.isVisible = function () {\n\t\treturn !this.hasClass(\"hidden\");\n\t}\n\n\tNode.prototype.isEnabled = function(value) {\n\t\treturn !this.hasClass(\"disabled\");\n\t}\n\n\tNode.prototype.setEnabled = function(value) {\n\t\treturn !this.toggleClass(\"disabled\", !value);\n\t}\n\n\tNode.prototype.isButtonDown = function() {\n\t\treturn this.hasClass(\"btnToolDown\");\n\t}\n\n\tNode.prototype.toggleButtonDown = function() {\n\t\treturn this.toggleClass(\"btnToolDown\", !this.isButtonDown());\n\t}\n\n\tNode.prototype.setButtonDown = function(value) {\n\t\treturn this.toggleClass(\"btnToolDown\", value);\n\t}\n\n\tHTMLSelectElement.prototype.isEnabled = function() {\n\t\treturn !this.disabled;\n\t}\n\n\tHTMLSelectElement.prototype.setEnabled = function(value) {\n\t\tthis.disabled = !value;\n\t\treturn value;\n\t}\n\n\tHTMLInputElement.prototype.isEnabled = function() {\n\t\treturn !this.disabled;\n\t}\n\n\tHTMLInputElement.prototype.setEnabled = function(value) {\n\t\tthis.disabled = !value;\n\t\treturn value;\n\t}\n// #endregion\n\n// #region ======== AppStateDataController ==================\n\n\tvar AppStateDataController = (function(variableName, hasTitleBar, isResizable, debugLogFunc) {\n\t\tvar _variableName = variableName;\n\t\tvar _hasTitleBar = hasTitleBar != null ? hasTitleBar : true;\n\t\tvar _isResizable = isResizable != null ? isResizable : false;\n\t\tvar _debugLogFunc = debugLogFunc;\n\t\tvar _preSaveCallbacks = null;\n\t\tvar _additionalData = null;\n\t\tvar _deserializedData = _deserialize();\n\t\tif (_deserializedData.additionalData)\n\t\t\t_additionalData = _deserializedData.additionalData;\n\n\t\tfunction _log(msg) {\n\t\t\ttry {\n\t\t\t\tif (_debugLogFunc) {\n\t\t\t\t\t_debugLogFunc(msg);\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\tconsole.log(`Error in _log(\"${msg}\"): ${error.message}`);\n\t\t\t}\n\t\t}\n\n\t\tfunction _logError(error, location) {\n\t\t\ttry {\n\t\t\t\tvar msg = \"Error\";\n\t\t\t\tif (location)\n\t\t\t\t\tmsg += ` in ${location}`;\n\t\t\t\tmsg += ` on line: ${error.line}: ${error.message}`;\n\t\t\t\t_log(msg);\n\t\t\t} catch (err) {\n\t\t\t\t_log(error);\n\t\t\t}\n\t\t}\n\n\t\tfunction _calculateInt(formula) { return parseInt(window.KeyboardMaestro.Calculate(formula)); }\n\t\tfunction _getWindowLeft() { return _calculateInt(\"WINDOW(Left)\"); }\n\t\tfunction _getWindowTop() { return _calculateInt(\"WINDOW(Top)\"); }\n\t\tfunction _getWindowWidth() { return _calculateInt(\"WINDOW(Width)\"); }\n\t\tfunction _getWindowHeight() { return _calculateInt(\"WINDOW(Height)\"); }\n\t\tfunction _getScreenLeft() { return _calculateInt(\"SCREENVISIBLE(Main, Left)\"); }\n\t\tfunction _getScreenTop() { return _calculateInt(\"SCREENVISIBLE(Main, Top)\"); }\n\t\tfunction _getScreenWidth() { return _calculateInt(\"SCREENVISIBLE(Main, Width)\"); }\n\t\tfunction _getScreenHeight() { return _calculateInt(\"SCREENVISIBLE(Main, Height)\"); }\n\n\t\tfunction _deserialize() {\n\t\t\t\n\t\t\tfunction getNextParam() {\n\t\t\t\tindex++;\n\t\t\t\tif (index >= a.length)\n\t\t\t\t\treturn null;\n\t\t\t\tvar result = parseInt(a[index]);\n\t\t\t\treturn isNaN(result) ? null : result;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tif (!_variableName)\n\t\t\t\t\treturn {};\n\n\t\t\t\tvar dataString = window.KeyboardMaestro.GetVariable(_variableName);\n\t\t\t\tif (!dataString)\n\t\t\t\t\treturn {};\n\n\t\t\t\tif (dataString.startsWith(\"{\")) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\treturn JSON.parse(dataString);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\treturn {};\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// left, top, width, height]\n\t\t\t\tvar a = dataString.split(/,\\s*/);\n\t\t\t\tvar index = -1;\n\t\t\t\treturn {\n\t\t\t\t\tleft: getNextParam(),\n\t\t\t\t\ttop: getNextParam(),\n\t\t\t\t\twidth: getNextParam(),\n\t\t\t\t\theight: getNextParam()\n\t\t\t\t};\n\t\t\t} catch (err) {\n\t\t\t\t_logError(err, \"_deserialize\");\n\t\t\t}\n\t\t}\n\n\t\tfunction _getAdditionalData(key) {\n\t\t\tif (_additionalData == null)\n\t\t\t\treturn null;\n\t\t\treturn _additionalData[key];\n\t\t}\n\n\t\tfunction _registerPreSaveCallback(callback) {\n\t\t\tif (_preSaveCallbacks == null)\n\t\t\t\t_preSaveCallbacks = [];\n\t\t\t_preSaveCallbacks.push(callback);\n\t\t}\n\n\t\tfunction _serialize(self) {\n\t\t\ttry {\n\t\t\t\tif (!_variableName)\n\t\t\t\t\treturn;\n\n\t\t\t\tif (_preSaveCallbacks) {\n\t\t\t\t\t_preSaveCallbacks.forEach(callback => callback(self));\n\t\t\t\t}\n\n\t\t\t\tvar data = {\n\t\t\t\t\tleft: _getWindowLeft(),\n\t\t\t\t\ttop: _getWindowTop()\n\t\t\t\t}\n\t\t\t\tif (_isResizable) {\n\t\t\t\t\tdata.width = _getWindowWidth(),\n\t\t\t\t\tdata.height = _getWindowHeight()\n\t\t\t\t}\n\t\t\t\tif (_additionalData != null)\n\t\t\t\t\tdata.additionalData = _additionalData;\n\n\t\t\t\twindow.KeyboardMaestro.SetVariable(_variableName, JSON.stringify(data));\n\t\t\t} catch (err) {\n\t\t\t\t_logError(err, \"_serialize\");\n\t\t\t}\n\t\t}\n\n\t\tfunction _setAdditionalData(key, value) {\n\t\t\ttry {\n\t\t\t\tif (!value) {\n\t\t\t\t\tif (_additionalData != null) {\n\t\t\t\t\t\tdelete _additionalData[key];\n\t\t\t\t\t\tif (Object.keys(_additionalData).length == 0)\n\t\t\t\t\t\t\t_additionalData = null;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (_additionalData == null)\n\t\t\t\t\t\t_additionalData = {};\n\t\t\t\t\t_additionalData[key] = value;\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\t_logError(err, \"_setAdditionalData\");\n\t\t\t}\n\t\t}\n\n\t\tfunction _getKMWindowResult(defaultWidth, defaultHeight, defaultHeightIncludesTitleBarHeight) {\n\t\t\ttry {\n\t\t\t\tif (defaultHeight != null && _hasTitleBar && !defaultHeightIncludesTitleBarHeight)\n\t\t\t\t\tdefaultHeight += 16;\n\t\t\t\n\t\t\t\tvar width = _deserializedData.width != null ? _deserializedData.width : defaultWidth != null ? defaultWidth : _getWindowWidth();\n\t\t\t\tvar height = _deserializedData.height != null ? _deserializedData.height : defaultHeight != null ? defaultHeight : _getWindowHeight();\n\t\t\t\tvar left = _deserializedData.left != null ? _deserializedData.left : _getScreenLeft() + Math.max(Math.floor((_getScreenWidth() - width) / 2), 0);\n\t\t\t\tvar top = _deserializedData.top != null ? _deserializedData.top : _getScreenTop() + Math.max(Math.floor((_getScreenHeight() - height) / 2), 0);\n\t\n\t\t\t\treturn `${left}, ${top + (_hasTitleBar ? 16 : 0)}, ${width}, ${height - (_hasTitleBar ? 16 : 0)}`;\n\t\t\t} catch (err) {\n\t\t\t\t_logError(err, \"_getKMWindowResult\");\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tgetAdditionalData: function(key) {\n\t\t\t\treturn _getAdditionalData(key);\n\t\t\t},\n\n\t\t\tgetKMWindowResult: function(defaultWidth, defaultHeight, defaultHeightIncludesTitleBarHeight) { \n\t\t\t\treturn _getKMWindowResult(defaultWidth, defaultHeight, defaultHeightIncludesTitleBarHeight);\n\t\t\t},\n\n\t\t\tregisterPreSaveCallback: function(callback) {\n\t\t\t\t_registerPreSaveCallback(callback);\n\t\t\t},\n\n\t\t\tsave: function() {\n\t\t\t\t_serialize(this);\n\t\t\t},\n\n\t\t\tsetDebugLogFunction: function(debugLogFunc) {\n\t\t\t\t_debugLogFunc = debugLogFunc;\n\t\t\t},\n\n\t\t\tsetAdditionalData: function(key, value) {\n\t\t\t\t_setAdditionalData(key, value);\n\t\t\t}\n\t\t};\n\t});\n\n\t/**\n\t * @type AppStateDataController\n\t */\n\tvar _appStateDataController;\n\n// #endregion\n\n// #region ======== logDebugMessage and ErrorHandler ========\n\tvar _logDebugMessageEnabled = false;\n\tvar _firstDebugMessage = true;\n\tfunction logDebugMessage(message) {\n\t\tif (!_logDebugMessageEnabled)\n\t\t\treturn;\n\t\ttry {\n\t\t\tif (_firstDebugMessage) {\n\t\t\t\t_firstDebugMessage = false;\n\t\t\t\twindow.KeyboardMaestro.Trigger(\"LogDebugMessage\", \"=====================================================\");\n\t\t\t}\n\t\t\twindow.KeyboardMaestro.Trigger(\"LogDebugMessage\", message);\n\t\t} catch (e) {\n\t\t}\n\t}\n\n\tfunction dump(obj, desc) {\n\t\tlogDebugMessage((desc ? desc + \": \" : \"\") + JSON.stringify(obj, null, \"\\t\"));\n\t}\n\n\tvar ErrorHandler = (function() {\n\t\treturn {\n\t\t\thandle: function(error) {\n\t\t\t\tthis.log(this.format(error));\n\t\t\t},\n\n\t\t\tgetErrorLocation: function(error) {\n\t\t\t\ttry {\n\t\t\t\t\tvar result = [];\n\t\t\t\t\tvar errorStack = error.stack.split(\"\\n\");\n\t\t\t\t\terrorStack.forEach(s => {\n\t\t\t\t\t\ts = decodeURIComponent(s);\n\t\t\t\t\t\tvar matches = /^([^@]*).*:(\\d*:\\d*)$/.exec(s);\n\t\t\t\t\t\tif (matches.length === 3) {\n\t\t\t\t\t\t\tif (result.length === 1)\n\t\t\t\t\t\t\t\tresult.push(\"\\nStack Trace:\");\n\t\t\t\t\t\t\tresult.push(`${matches[1]} at ${matches[2]}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn result.join(\"\\n\");\n\t\t\t\t} catch {\n\t\t\t\t\treturn \"\";\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tformat: function(error) {\n\t\t\t\tvar at = this.getErrorLocation(error);\n\t\t\t\tif (at)\n\t\t\t\t\treturn `${error.message}\\nin ${at}`;\n\t\t\t\treturn error.message;\n\t\t\t},\n\n\t\t\tlog: function(str) {\n\t\t\t\tlogDebugMessage(str);\n\t\t\t\tdocument.write(str.split(\"\\n\").join(\"<br />\") + \"<br / />\");\n\t\t\t}\n\t\t};\n\t})();\n\t\n\tfunction getStackTrace() {\n\t\tvar result = [];\n\t\tvar error = new Error(\"test\");\n\t\tvar errorStack = error.stack.split(\"\\n\");\n\t\terrorStack.forEach(s => {\n\t\t\ts = decodeURIComponent(s);\n\t\t\tvar matches = /^([^@]*).*:(\\d*:\\d*)$/.exec(s);\n\t\t\tif (matches.length === 3) {\n\t\t\t\tresult.push(`${matches[1]} at ${matches[2]}`);\n\t\t\t}\n\t\t});\n\t\tresult.splice(0,1);\n\t\treturn result.join(\"\\n\");\n\t}\n\n\tfunction fname() {\n\t\treturn (new Error(\"test\")).stack.match(/\\n[^@]*/)[0].substring(1);\n\t}\n// #endregion\n\n// #region ======== Modal Dialogs ===========================\n\t\t\n\t// #region ======== SimpleDialogController ==============\n\t\tclass SimpleDialogController {\n\t\t\tconstructor() {\n\t\t\t\tthis._dialog = null;\n\t\t\t\tthis._dialogBox = null;\n\t\t\t\tthis._dialogBody = null;\n\t\t\t\tthis._iconTable = null;\n\t\t\t\tthis._infoIcon = null;\n\t\t\t\tthis._warningIcon = null;\n\t\t\t\tthis._message = null;\n\t\t\t\tthis._dictionaryHelp = null;\n\t\t\t\tthis._options = null;\n\t\t\t\tthis._optionsEscapeInEmptyFilterClosesPromptCheckbox = null;\n\t\t\t\tthis._optionsFocusFilterOnStartupCheckbox = null;\n\t\t\t\tthis._optionsFontSizeButtons = null;\n\t\t\t\tthis._optionsLocalVariables = null;\n\t\t\t\tthis._optionsSortBySizeSelectsFirstVariableCheckbox = null;\n\t\t\t\tthis._btnOptionsFontSizeDecrease = null;\n\t\t\t\tthis._btnOptionsFontSizeIncrease = null;\n\t\t\t\tthis._btnOptionsFontSizeReset = null;\n\t\t\t\tthis._btnOptionsLoadLocalVariables = null;\n\t\t\t\tthis._btnOptionsLoadGlobalVariables = null;\n\t\t\t\tthis._btnOptionsLoadDictionaries = null;\n\t\t\t\tthis._btnOptionsToggleHiddenVariables = null;\n\n\t\t\t\tthis._okButton = null;\n\t\t\t\tthis._cancelButton = null;\n\t\t\t\tthis._callback = null;\n\t\t\t}\n\n\t\t\t_init() {\n\t\t\t\ttry {\n\t\t\t\t\tif (this._dialog != null)\n\t\t\t\t\t\treturn;\n\t\t\t\t\tthis._dialog = document.getElementById(\"modalDialog\");\n\t\t\t\t\tthis._dialogBox = document.getElementById(\"modalDialogBox\");\n\t\t\t\t\tthis._dialogBody = document.getElementById(\"modalDialogBody\");\n\t\t\t\t\tthis._iconTable = document.getElementById(\"modalDialogIconTable\");\n\t\t\t\t\tthis._infoIcon = document.getElementById(\"modalDialogInfoIcon\");\n\t\t\t\t\tthis._warningIcon = document.getElementById(\"modalDialogWarningIcon\");\n\t\t\t\t\tthis._message = document.getElementById(\"modalDialogMessage\");\n\t\t\t\t\tthis._dictionaryHelp = document.getElementById(\"modalDialogDictionaryHelp\");\n\t\t\t\t\tthis._options = document.getElementById(\"modalDialogOptions\");\n\t\t\t\t\tthis._optionsEscapeInEmptyFilterClosesPromptCheckbox = document.getElementById(\"optionsEscapeInEmptyFilterClosesPromptCheckbox\");\n\t\t\t\t\tthis._optionsFocusFilterOnStartupCheckbox = document.getElementById(\"optionsFocusFilterOnStartupCheckbox\");\n\t\t\t\t\tthis._optionsFontSizeButtons = document.getElementById(\"tdOptionsFontSizeButtons\");\n\t\t\t\t\tthis._optionsLocalVariables = document.getElementById(\"optionsLocalVariables\");\n\t\t\t\t\tthis._optionsSortBySizeSelectsFirstVariableCheckbox = document.getElementById(\"optionsSortBySizeSelectsFirstVariableCheckbox\");\n\t\t\t\t\n\t\t\t\t\tthis._btnOptionsFontSizeDecrease = document.getElementById(\"btnOptionsFontSizeDecrease\");\n\t\t\t\t\tthis._btnOptionsFontSizeIncrease = document.getElementById(\"btnOptionsFontSizeIncrease\");\n\t\t\t\t\tthis._btnOptionsFontSizeReset = document.getElementById(\"btnOptionsFontSizeReset\");\n\t\t\t\t\tthis._btnOptionsLoadLocalVariables = document.getElementById(\"btnOptionsLoadLocalVariables\");\n\t\t\t\t\tthis._btnOptionsLoadGlobalVariables = document.getElementById(\"btnOptionsLoadGlobalVariables\");\n\t\t\t\t\tthis._btnOptionsLoadDictionaries = document.getElementById(\"btnOptionsLoadDictionaries\");\n\t\t\t\t\tthis._btnOptionsToggleHiddenVariables = document.getElementById(\"btnOptionsToggleHiddenVariables\");\n\t\t\t\t\t\n\t\t\t\t\tthis._okButton = document.getElementById(\"modalDialogOkButton\");\n\t\t\t\t\tthis._cancelButton = document.getElementById(\"modalDialogCancelButton\");\n\t\t\t\t\t\n\t\t\t\t\tthis._btnOptionsFontSizeDecrease.addEventListener(\"click\", () => this._optionsChangeFontSize(-1));\n\t\t\t\t\tthis._btnOptionsFontSizeIncrease.addEventListener(\"click\", () => this._optionsChangeFontSize(1));\n\t\t\t\t\tthis._btnOptionsFontSizeReset.addEventListener(\"click\", () => this._optionsChangeFontSize(0));\n\t\t\t\t\tthis._btnOptionsLoadLocalVariables.addEventListener(\"click\", () => this.close(\"loadLocalVariables\"));\n\t\t\t\t\tthis._btnOptionsLoadGlobalVariables.addEventListener(\"click\", () => this.close(\"loadGlobalVariables\"));\n\t\t\t\t\tthis._btnOptionsLoadDictionaries.addEventListener(\"click\", () => this.close(\"loadDictionaries\"));\n\t\t\t\t\tthis._btnOptionsToggleHiddenVariables.addEventListener(\"click\", () => this.close(\"toggleHiddenVariables\"));\n\n\t\t\t\t\tthis._optionsFontSizeButtons.addEventListener(\"mouseenter\", () => this._dialog.toggleClass(\"modalOptionsDialogTransparent\", true));\n\t\t\t\t\tthis._optionsFontSizeButtons.addEventListener(\"mouseleave\", () => this._dialog.toggleClass(\"modalOptionsDialogTransparent\", false));\n\n\t\t\t\t\tthis._okButton.addEventListener(\"click\", () => this.close(\"ok\"));\n\t\t\t\t\tthis._cancelButton.addEventListener(\"click\", () => this.close(\"cancel\"));\n\n\t\t\t\t\twindow.addEventListener(\"resize\", () => this._setMaxHeight());\n\t\t\t\t\tthis._setMaxHeight();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t_optionsEnableFontSizeButtons() {\n\t\t\t\tthis._btnOptionsFontSizeDecrease.setEnabled(_fontSizeController.canDecreaseFontSize());\n\t\t\t\tthis._btnOptionsFontSizeIncrease.setEnabled(_fontSizeController.canIncreaseFontSize());\n\t\t\t}\n\n\t\t\t_optionsChangeFontSize(increment) {\n\t\t\t\tconsole.log(`_optionsChangeFontSize increment: ${increment}`);\n\t\t\t\tif (increment === 0)\n\t\t\t\t\t_fontSizeController.resetFontSize();\n\t\t\t\telse {\n\t\t\t\t\tlet size = _fontSizeController.getFontSize();\n\t\t\t\t\t_fontSizeController.setFontSize(_fontSizeController.getFontSize() + increment);\n\t\t\t\t}\n\t\t\t\tthis._optionsEnableFontSizeButtons();\n\t\t\t}\n\n\t\t\t_reset() {\n\t\t\t\ttry {\n\t\t\t\t\tif (this.isShowing)\n\t\t\t\t\t\tthrow new Error(\"Modal Dialog is already showing\");\n\t\t\t\t\tthis._init();\n\t\t\t\t\tthis._dialog.toggleClass(\"modalOptionsDialog\", false);\n\t\t\t\t\t// this._dialog.toggleClass(\"modalOptionsDialogTransparent\", false);\n\t\t\t\t\tthis._iconTable.setVisible(false);\n\t\t\t\t\tthis._dictionaryHelp.setVisible(false);\n\t\t\t\t\tthis._options.setVisible(false);\n\t\t\t\t\tthis._infoIcon.setVisible(false);\n\t\t\t\t\tthis._warningIcon.setVisible(false);\n\t\t\t\t\tthis._cancelButton.setVisible(false);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t_setMaxHeight() {\n\t\t\t\tif (!this._dialog) {\n\t\t\t\t\t// this will probably never happen, but better safe that sorry\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._dialogBody.style.maxHeight = `${window.innerHeight - 100}px`;\n\t\t\t}\n\n\t\t\t_show(isInfo, message, callback, messageIsHTML) {\n\t\t\t\ttry {\n\t\t\t\t\tthis._reset();\n\t\t\t\t\tthis._iconTable.setVisible(true);\n\t\t\t\t\tthis._infoIcon.setVisible(isInfo);\n\t\t\t\t\tthis._warningIcon.setVisible(!isInfo);\n\t\t\t\t\tif (messageIsHTML)\n\t\t\t\t\t\tthis._message.innerHTML = message;\n\t\t\t\t\telse\n\t\t\t\t\t\tthis._message.innerText = message;\n\t\t\t\t\tthis._cancelButton.setVisible(!isInfo);\n\t\t\t\t\tthis._callback = callback;\n\t\t\t\t\tthis._dialog.swapClasses(\"modalDialogVisible\", \"modalDialogHidden\");\n\t\t\t\t\tenableControls();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * @returns {bool}\n\t\t\t */\n\t\t\tget isShowing() { return this._dialog != null && this._dialog.hasClass(\"modalDialogVisible\"); }\n\n\t\t\t/**\n\t\t\t * Shows the Dictionary Help screen.\n\t\t\t */\n\t\t\tshowDictionaryHelp() {\n\t\t\t\ttry {\n\t\t\t\t\tthis._reset();\n\t\t\t\t\tthis._dictionaryHelp.setVisible(true);\n\t\t\t\t\tthis._callback = null;\n\t\t\t\t\tthis._dialog.swapClasses(\"modalDialogVisible\", \"modalDialogHidden\");\n\t\t\t\t\tenableControls();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Shows the Info dialog (no Cancel button)\n\t\t\t * @param {string} message \n\t\t\t * @param {function} [callback] function(result), where result is irrelevant and undefined.\n\t\t\t * @param {bool} [messageIsHTML] if true, the message is in HTML format.\n\t\t\t */\n\t\t\tshowInfoDialog(message, callback, messageIsHTML) {\n\t\t\t\tthis._show(true, message, callback, messageIsHTML);\n\t\t\t\tenableControls();\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Shows the OK/Cancel dialog\n\t\t\t * @param {string} message \n\t\t\t * @param {function} callback function(result), where result is \"ok\" or \"cancel\"\n\t\t\t */\n\t\t\tshowOkCancelDialog(message, callback) {\n\t\t\t\tthis._show(false, message, callback);\n\t\t\t\tenableControls();\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Shows the Options dialog.\n\t\t\t * @param {function} callback function(result), where result is \"loadLocalVariables\", \"loadGlobalVariables\",\n\t\t\t * \"loadDictionaries\", \"toggleHiddenVariables\".\n\t\t\t */\n\t\t\tshowOptions(callback) {\n\t\t\t\ttry {\n\t\t\t\t\tthis._reset();\n\t\t\t\t\tthis._dialog.toggleClass(\"modalOptionsDialog\", true);\n\t\t\t\t\tthis._optionsEnableFontSizeButtons();\n\t\t\t\t\tthis._optionsEscapeInEmptyFilterClosesPromptCheckbox.checked = _userOptions.escapeInEmptyFilterClosesPrompt;\n\t\t\t\t\tthis._optionsFocusFilterOnStartupCheckbox.checked = _userOptions.focusFilterOnStartup;\n\t\t\t\t\tthis._optionsLocalVariables.setVisible(!_isAsync);\n\t\t\t\t\tthis._optionsSortBySizeSelectsFirstVariableCheckbox.checked = _userOptions.sortBySizeSelectsFirstVariable;\n\t\t\t\t\tthis._options.setVisible(true);\n\t\t\t\t\tthis._callback = callback;\n\t\t\t\t\tthis._dialog.swapClasses(\"modalDialogVisible\", \"modalDialogHidden\");\n\t\t\t\t\tenableControls();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Closes the dialog. You don't normally need to call this yourself.\n\t\t\t * @param {string} result \"ok\" or \"cancel\"\n\t\t\t * @returns \n\t\t\t */\n\t\t\tclose(result) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!this.isShowing)\n\t\t\t\t\t\treturn;\n\t\t\t\t\tthis._dialog.swapClasses(\"modalDialogHidden\", \"modalDialogVisible\");\n\t\t\t\t\t_userOptions.escapeInEmptyFilterClosesPrompt = this._optionsEscapeInEmptyFilterClosesPromptCheckbox.checked;\n\t\t\t\t\t_userOptions.focusFilterOnStartup = this._optionsFocusFilterOnStartupCheckbox.checked;\n\t\t\t\t\t_userOptions.sortBySizeSelectsFirstVariable = this._optionsSortBySizeSelectsFirstVariableCheckbox.checked;\n\t\t\t\t\tenableControls();\n\t\t\t\t\tif (this._callback)\n\t\t\t\t\t\tthis._callback(result);\n\t\t\t\t\tthis._callback = null;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t// #endregion\n\n\t// #region ======== EditBoxDialogController =============\n\t\tclass EditBoxDialogController {\n\t\t\tconstructor() {\n\t\t\t\tthis._dialog = null;\n\t\t\t\tthis._title = null;\n\t\t\t\tthis._input = null;\n\t\t\t\tthis._errorMessage = null;\n\t\t\t\tthis._okButton = null;\n\t\t\t\tthis._cancelButton = null;\n\t\t\t\tthis._validateCallback = null;\n\t\t\t\tthis._finishedCallback = null;\n\t\t\t}\n\n\t\t\t_init() {\n\t\t\t\ttry {\n\t\t\t\t\tif (this._dialog != null)\n\t\t\t\t\t\treturn;\n\t\t\t\t\tthis._dialog = document.getElementById(\"editBoxDialog\");\n\t\t\t\t\tthis._title = document.getElementById(\"editBoxDialogTitle\");\n\t\t\t\t\tthis._input = document.getElementById(\"editBoxDialogInput\");\n\t\t\t\t\tthis._checkboxRow = document.getElementById(\"editBoxDialogCheckboxRow\");\n\t\t\t\t\tthis._checkbox = document.getElementById(\"editBoxDialogCheckbox\");\n\t\t\t\t\tthis._checkboxLabel = document.getElementById(\"editBoxDialogCheckboxLabel\");\n\t\t\t\t\tthis._errorMessage = document.getElementById(\"editBoxDialogErrorMessage\");\n\t\t\t\t\tthis._okButton = document.getElementById(\"editBoxDialogOkButton\");\n\t\t\t\t\tthis._cancelButton = document.getElementById(\"editBoxDialogCancelButton\");\n\n\t\t\t\t\tthis._okButton.addEventListener(\"click\", () => this.close(\"ok\"));\n\t\t\t\t\tthis._cancelButton.addEventListener(\"click\", () => this.close(\"cancel\"));\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Shows the edit box\n\t\t\t * @param {string} title the edit box title\n\t\t\t * @param {{initialValue: string, checkboxLabel: string}} [options]\n\t\t\t * @param {function({text: string, checked: bool}): string} validateCallback \n\t\t\t * @param {function({canceled: bool, text: string, checked: bool}): void} finishedCallback \n\t\t\t */\n\t\t\tshow(title, options, validateCallback, finishedCallback) {\n\t\t\t\ttry {\n\t\t\t\t\toptions = validateOptions(options, [\"initialValue\", \"checkboxLabel\"]);\n\t\t\t\t\tif (this.isShowing)\n\t\t\t\t\t\tthrow new Error(\"Edit Box Dialog is already showing\");\n\t\t\t\t\tthis._init();\n\t\t\t\t\tthis._title.innerText = title;\n\t\t\t\t\tthis._input.value = \"\";\n\t\t\t\t\tthis._errorMessage.innerText = \"\";\n\t\t\t\t\tthis._validateCallback = validateCallback;\n\t\t\t\t\tthis._finishedCallback = finishedCallback;\n\t\t\t\t\tif (options.initialValue)\n\t\t\t\t\t\tthis._input.value = options.initialValue;\n\t\t\t\t\tif (this._checkboxRow.setVisible(options.checkboxLabel != null))\n\t\t\t\t\t\tthis._checkboxLabel.innerText = options.checkboxLabel;\n\t\t\t\t\tthis._dialog.swapClasses(\"modalDialogVisible\", \"modalDialogHidden\");\n\t\t\t\t\tenableControls();\n\t\t\t\t\tthis._input.focus();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Close the dialog. You don't need to call this yourself unless there's a specific reason.\n\t\t\t * @param {string} result \"ok\" or \"cancel\"\n\t\t\t */\n\t\t\tclose(result) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!this.isShowing)\n\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\n\t\t\t\t\tvar data = {};\n\n\t\t\t\t\tif (result === \"ok\") {\n\t\t\t\t\t\tdata.text = this._input.value.trim();\n\t\t\t\t\t\tif (this._checkboxRow.isVisible())\n\t\t\t\t\t\t\tdata.checked = this._checkbox.checked;\n\t\t\t\t\t\tif (this._validateCallback) {\n\t\t\t\t\t\t\tlet errorMessage = this._validateCallback(data);\n\t\t\t\t\t\t\tif (errorMessage) {\n\t\t\t\t\t\t\t\tthis._errorMessage.innerText = errorMessage;\n\t\t\t\t\t\t\t\tthis._input.focus();\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else\n\t\t\t\t\t\tdata.canceled = true;\n\t\t\t\t\tthis._dialog.swapClasses(\"modalDialogHidden\", \"modalDialogVisible\");\n\t\t\t\t\tenableControls();\n\t\t\t\t\tif (this._finishedCallback)\n\t\t\t\t\t\tthis._finishedCallback(data);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * @returns {bool}\n\t\t\t */\n\t\t\tget isShowing() { \n\t\t\t\treturn this._dialog != null && this._dialog.hasClass(\"modalDialogVisible\");\n\t\t\t}\n\t\t}\n\t// #endregion\n\n\t// #region ======== ModalDialogController ===================\n\t\t\t\n\t\tclass ModalDialogController {\n\t\t\tconstructor() {\n\t\t\t\tthis._simplelDialog = new SimpleDialogController();\n\t\t\t\tthis._editBoxDialog = new EditBoxDialogController();\n\t\t\t}\n\n\t\t\tget isShowing() { return this._simplelDialog.isShowing || this._editBoxDialog.isShowing; }\n\t\t\n\t\t\t/**\n\t\t\t * Shows the Dictionary Help screen.\n\t\t\t */\n\t\t\tshowDictionaryHelp() {\n\t\t\t\ttry {\n\t\t\t\t\tif (this.isShowing)\n\t\t\t\t\t\tthrow new Error(`Dialog is already showing`);\n\t\t\t\t\tthis._simplelDialog.showDictionaryHelp();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Shows the edit box dialog\n\t\t\t * @param {string} title the edit box title\n\t\t\t * @param {{initialValue: string, checkboxLabel: string}} [options]\n\t\t\t * @param {function({text: string, checked: bool}): string} validateCallback \n\t\t\t * @param {function({canceled: bool, text: string, checked: bool}): void} finishedCallback \n\t\t\t */\n\t\t\tshowEditBoxDialog(title, options, validateCallback, finishedCallback) {\n\t\t\t\ttry {\n\t\t\t\t\tif (this.isShowing)\n\t\t\t\t\t\tthrow new Error(\"Edit Box Dialog is already showing\");\n\t\t\t\t\tthis._editBoxDialog.show(title, options, validateCallback, finishedCallback);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Shows the Info dialog (no Cancel button)\n\t\t\t * @param {string} message \n\t\t\t * @param {function} [callback] function(result), where result is irrelevant and undefined.\n\t\t\t * @param {bool} [messageIsHTML] if true, the message is in HTML format.\n\t\t\t */\n\t\t\tshowInfoDialog(message, callback, messageIsHTML) {\n\t\t\t\ttry {\n\t\t\t\t\tif (this.isShowing)\n\t\t\t\t\t\tthrow new Error(`Dialog is already showing`);\n\t\t\t\t\tthis._simplelDialog.showInfoDialog(message, callback, messageIsHTML);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Displays the message, then closes the window\n\t\t\t * @param {string} message \n\t\t\t * @param {bool} [messageIsHTML] if true, the message is in HTML format.\n\t\t\t */\n\t\t\tshowMessageAndAbort(message, messageIsHTML) {\n\t\t\t\tthis.showInfoDialog(message, () => cancelWindow(\"canceled\"), messageIsHTML);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Shows the OK/Cancel dialog\n\t\t\t * @param {string} message \n\t\t\t * @param {function} callback function(result), where result is \"ok\" or \"cancel\"\n\t\t\t */\n\t\t\tshowOkCancelDialog(message, callback) {\n\t\t\t\ttry {\n\t\t\t\t\tif (this.isShowing)\n\t\t\t\t\t\tthrow new Error(`Dialog is already showing`);\n\t\t\t\t\tthis._simplelDialog.showOkCancelDialog(message, callback);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Shows the Options dialog.\n\t\t\t * @param {function} callback function(result), where result is \"loadLocalVariables\", \"loadGlobalVariables\",\n\t\t\t * \"loadDictionaries\", \"toggleHiddenVariables\".\n\t\t\t */\n\t\t\tshowOptions(callback) {\n\t\t\t\ttry {\n\t\t\t\t\tif (this.isShowing)\n\t\t\t\t\t\tthrow new Error(\"Dialog is already showing\");\n\t\t\t\t\tthis._simplelDialog.showOptions(callback);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Closes the dialog. You don't normally need to call this yourself.\n\t\t\t * @returns \n\t\t\t */\n\t\t\tclose(result) {\n\t\t\t\ttry {\n\t\t\t\t\tdebugger\n\t\t\t\t\tif (this._simplelDialog.isShowing)\n\t\t\t\t\t\tthis._simplelDialog.close(result);\n\t\t\t\t\tif (this._editBoxDialog.isShowing)\n\t\t\t\t\t\tthis._editBoxDialog.close(result);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t// #endregion\n\n\tconst _modalDialogController = new ModalDialogController();\n\n// #endregion\n\n// #region ======== TooltipFadeInAnimator ===================\n\tvar TooltipFadeInAnimator = (function(delay, duration) {\n\t\tvar _delay = delay;\n\t\tvar _duration = duration;\n\t\tvar _tooltipTextElement = null;\n\t\tvar _timer = null;\n\t\tvar _animation = null;\n\n\t\tfunction _getTooltipTextElement(element) {\n\t\t\tvar tooltipText = element.querySelector(\".tooltipText\");\n\t\t\tif (!tooltipText) {\n\t\t\t\tconsole.log(`${element.id} doesn't have a \"tooltipText\" element`);\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn tooltipText;\n\t\t}\n\n\t\tfunction _mouseEnterEvent(event) {\n\t\t\t// In case a tooltip is currently being displayed:\n\t\t\t_hideTooltip();\n\n\t\t\t_tooltipTextElement = _getTooltipTextElement(event.target);\n\t\t\t_timer = window.setTimeout(() => _showToolTip(), _delay);\n\t\t}\n\n\t\tfunction _showToolTip() {\n\t\t\t_tooltipTextElement.style.visibility = \"visible\";\n\t\t\t_animation = _tooltipTextElement.animate([\n\t\t\t\t{ opacity: 0 },\n\t\t\t\t{ opacity: 1 }\n\t\t\t], {\n\t\t\t\tduration: _duration\n\t\t\t});\n\t\t}\n\n\t\tfunction _clearTimer() {\n\t\t\tif (!_timer)\n\t\t\t\treturn;\n\t\t\tclearTimeout(_timer);\n\t\t\t_timer = null;\n\t\t}\n\n\t\tfunction _clearAnimation() {\n\t\t\tif (!_animation)\n\t\t\t\treturn;\n\t\t\ttry {\n\t\t\t\t_animation.cancel();\n\t\t\t} catch {\n\t\t\t}\n\t\t\t_animation = null;\n\t\t}\n\n\t\tfunction _hideTooltip() {\n\t\t\tif (!_tooltipTextElement)\n\t\t\t\treturn;\n\n\t\t\t_clearTimer();\n\t\t\t_clearAnimation();\n\t\t\t_tooltipTextElement.style.visibility = \"hidden\";\n\t\t\t_tooltipTextElement = null;\n\t\t}\n\n\t\treturn {\n\t\t\t// You can pass the element name, or the element object, although\n\t\t\t// I'm only using the name version in this program. This function\n\t\t\t// returns the element object, so you can use it to string (nest)\n\t\t\t// functions.\n\t\t\tattach: function(element) {\n\t\t\t\tif (typeof element === \"string\" || element instanceof String)\n\t\t\t\t\telement = document.getElementById(element);\n\t\t\t\tvar tooltipText = _getTooltipTextElement(element);\n\t\t\t\tif (tooltipText) {\n\t\t\t\t\telement.addEventListener(\"mouseenter\", _mouseEnterEvent);\n\t\t\t\t\telement.addEventListener(\"mousedown\", _hideTooltip);\n\t\t\t\t\telement.addEventListener(\"mouseleave\", _hideTooltip);\n\t\t\t\t}\n\t\t\t\treturn element;\n\t\t\t}\n\t\t};\n\t});\n\tvar _tooltipFadeInAnimator = new TooltipFadeInAnimator(750, 250);\n// #endregion\n\n// #region ======== ShowHideAnimator ========================\n\t/**\n\t * @readonly\n\t * @enum {string}\n\t */\n\tconst ShowAnimation = {\n\t\tscaleInCenter: \"scale-in-center\"\n\t};\n\n\t/**\n\t * @readonly\n\t * @enum {string}\n\t */\n\tconst HideAnimation = {\n\t\tfadeOut: \"fade-out\"\n\t};\n\n\tclass ShowHideAnimator {\n\t\t/**\n\t\t * \n\t\t * @param {HTMLElement} element \n\t\t * @param {ShowAnimation} showClass \n\t\t * @param {HideAnimation} hideClass \n\t\t */\n\t\tconstructor(element, showClass, hideClass) {\n\t\t\tthis._element = element;\n\t\t\tthis._showClass = showClass;\n\t\t\tthis._hideClass = hideClass;\n\t\t\tthis._hideTimer = null;\n\t\t}\n\n\t\telementIsVisible() {\n\t\t\treturn this._element.isVisible() && window.getComputedStyle(this._element).getPropertyValue(\"opacity\") != \"0\";\n\t\t}\n\n\t\t/**\n\t\t * Hides the element, with or without animation\n\t\t * @param {bool} [noAnimation] set to true if you want to skip the animation.\n\t\t */\n\t\thide(noAnimation) {\n\t\t\tif (!this.elementIsVisible())\n\t\t\t\treturn;\n\n\t\t\tif (this._hideTimer) {\n\t\t\t\tclearTimeout(this._hideTimer);\n\t\t\t\tthis._hideTimer = null;\n\t\t\t}\n\t\t\tthis._element.toggleClass(this._showClass, false);\n\t\t\tthis._element.toggleClass(this._hideClass, !noAnimation);\n\t\t\tif (noAnimation)\n\t\t\t\tthis._element.setVisible(false);\n\t\t}\n\n\t\t/**\n\t\t * Shows the element. Optionally close it on timeout.\n\t\t * @param {number} [hideTimeout ] number of milliseconds to automatically hide.\n\t\t * @param {bool} [noAnimation] set to true if you want to skip the animation.\n\t\t */\n\t\tshow(hideTimeout, noAnimation) {\n\t\t\tif (this.elementIsVisible())\n\t\t\t\treturn;\n\n\t\t\tthis._element.toggleClass(this._hideClass, false);\n\t\t\tthis._element.toggleClass(this._showClass, !noAnimation);\n\t\t\tthis._element.setVisible(true);\n\n\t\t\tif (hideTimeout > 0)\n\t\t\t\tthis._hideTimer = setTimeout(() => {\n\t\t\t\t\tthis.hideTimer = null;\n\t\t\t\t\tthis.hide();\n\t\t\t\t}, hideTimeout);\n\t\t}\n\t}\n\n\tclass InfoBoxShowHideAnimator extends ShowHideAnimator {\n\t\t/**\n\t\t * \n\t\t * @param {HTMLElement} element \n\t\t * @param {ShowAnimation} showClass \n\t\t * @param {HideAnimation} hideClass \n\t\t */\n\t\tconstructor(element, showClass, hideClass) {\n\t\t\tsuper(element, showClass, hideClass);\n\t\t\tthis._textElement = element.querySelector(\".infoText\");\n\t\t\tif (!this._textElement)\n\t\t\t\tthrow new Error(`Element doesn't have a child with class \"infoText\"`);\n\t\t\tthis._element.querySelector(\"a\").addEventListener(\"click\", () => this.hide(true));\n\t\t}\n\n\t\t/**\n\t\t * Shows the element. Optionally close it on timeout.\n\t\t * @param {string} text the text to display\n\t\t * @param {number} [hideTimeout ] number of milliseconds to automatically hide.\n\t\t * @param {bool} [noAnimation] set to true if you want to skip the animation.\n\t\t */\n\t\tshow(text, hideTimeout, noAnimation) {\n\t\t\tthis._textElement.innerText = text;\n\t\t\tsuper.show(hideTimeout, noAnimation);\n\t\t}\n\t}\n \n// #endregion\n\n// #region ======== MomentaryClassController ================\n\n\tclass MomentaryClassController {\n\t\tconstructor() {\n\t\t\tthis._entries = [];\n\t\t}\n\n\t\tapply(element, className, timeout) {\n\t\t\ttry {\n\t\t\t\tthis.remove(element);\n\t\n\t\t\t\telement.toggleClass(className, true);\n\t\t\t\tvar entry = {\n\t\t\t\t\telement: element,\n\t\t\t\t\tclassName: className\n\t\t\t\t};\n\t\t\t\tentry.timer = setTimeout(() => this.remove(element), timeout);\n\t\t\t\tthis._entries.push(entry);\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tfindIndexOf(element) {\n\t\t\ttry {\n\t\t\t\tfor (let i = 0; i < this._entries.length; i++) {\n\t\t\t\t\tconst entry = this._entries[i];\n\t\t\t\t\tif (entry.element === element)\n\t\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tremoveAll() {\n\t\t\ttry {\n\t\t\t\twhile (this._entries.length > 0) {\n\t\t\t\t\tthis.remove(this.elements[0]);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tremove(element) {\n\t\t\ttry {\n\t\t\t\tvar i = this.findIndexOf(element);\n\t\t\t\tif (i < 0)\n\t\t\t\t\treturn;\n\t\t\t\tvar entry = this._entries[i];\n\t\t\t\tclearTimeout(entry.timer);\n\t\t\t\telement.toggleClass(entry.className, false);\n\t\t\t\tentry.element = null;\n\t\t\t\tthis._entries.splice(i, 1);\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\t}\n\n\tconst _momentaryClassController = new MomentaryClassController();\n\n// #endregion\t\t\n\n// #region ======== FloatingWarning =========================\n\t\t\n\tclass FloatingWarning {\n\t\tconstructor() {\n\t\t\tthis.animator = null;\n\t\t}\n\n\t\thide(noAnimation) {\n\t\t\tif (this.animator) {\n\t\t\t\tthis.animator.hide(noAnimation);\n\t\t\t}\n\t\t}\n\n\t\tshow(text, noAnimation) {\n\t\t\ttry {\n\t\t\t\tif (!this.animator) {\n\t\t\t\t\tthis.animator = new InfoBoxShowHideAnimator(\n\t\t\t\t\t\tdocument.getElementById(\"divFloatingWarning\"), \n\t\t\t\t\t\tShowAnimation.scaleInCenter, \n\t\t\t\t\t\tHideAnimation.fadeOut);\n\t\t\t\t} else\n\t\t\t\t\tthis.hide(true);\n\t\t\t\tthis.animator.show(text, 5000, noAnimation);\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\t}\n\tconst _floatingWarning = new FloatingWarning();\n\n// #endregion\n\n// #region ======== StatusMessageController =================\n\n\tclass StatusLineController {\n\t\tconstructor() {\n\t\t\tthis._divStatusMessage = document.getElementById(\"divStatusMessage\");\n\t\t\tthis._spanStatusMessage = document.getElementById(\"spanStatusMessage\");\n\t\t\tthis._divStatusStats = document.getElementById(\"divStatusStats\");\n\t\t\tthis._tblVariableCount = document.getElementById(\"tblVariableCount\");\n\t\t\tthis._tblFilterCount = document.getElementById(\"tblFilterCount\");\n\t\t\tthis._tblHiddenCount = document.getElementById(\"tblHiddenCount\");\n\t\t\tthis._tblSelectedCount = document.getElementById(\"tblSelectedCount\");\n\t\t\tthis._momentaryMessageTimer = null;\n\t\t\tthis._refreshTimer = null;\n\t\t}\n\n\t\t_clearMomentaryMessage() {\n\t\t\ttry {\n\t\t\t\tif (this._momentaryMessageTimer) {\n\t\t\t\t\tclearTimeout(this._momentaryMessageTimer);\n\t\t\t\t\tthis._momentaryMessageTimer = null;\n\t\t\t\t}\n\t\t\t\tthis._divStatusMessage.setVisible(false)\n\t\t\t\tthis._divStatusStats.setVisible(true);\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Displays a status message for a short period of time\n\t\t * @param {string} msg the message to display\n\t\t */\n\t\tshowMomentaryMessage(msg) {\n\t\t\ttry {\n\t\t\t\tthis._divStatusStats.setVisible(false);\n\t\t\t\tthis._spanStatusMessage.innerText = msg;\n\t\t\t\tthis._divStatusMessage.setVisible(true);\n\t\t\t\tthis._momentaryMessageTimer = setTimeout(() => {\n\t\t\t\t\tthis._momentaryMessageTimer = null;\n\t\t\t\t\tthis._clearMomentaryMessage();\n\t\t\t\t}, 4000);\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\trefresh() {\n\t\t\tif (this._refreshTimer)\n\t\t\t\treturn;\n\t\t\tthis._refreshTimer = setTimeout(() => {\n\t\t\t\tthis._refreshTimer = null;\n\t\t\t\tthis._showStats();\n\t\t\t}, 10);\n\t\t}\n\n\t\t_showStats() {\n\t\t\tfunction setStat(element, text, visible) {\n\t\t\t\tvisible = visible == null ? true : visible;\n\t\t\t\tif (element.setVisible(visible))\n\t\t\t\t\telement.querySelector(\".statusText\").innerText = text;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tif (this._refreshTimer) {\n\t\t\t\t\tclearInterval(this._refreshTimer);\n\t\t\t\t\tthis._refreshTimer = null;\n\t\t\t\t}\n\t\t\t\tthis._clearMomentaryMessage();\n\n\t\t\t\tvar variableCount = _variables.data.length;\n\t\t\t\tvar filterCount = _selectOptions.length;\n\t\t\t\tvar hiddenCount = _hiddenVariables.getNumberOfHiddenVariablesInThisViewMode();\n\t\t\t\tvar selectionCount = _selectOptions.getSelectionCount();\n\n\t\t\t\tsetStat(this._tblVariableCount, variableCount);\n\t\t\t\tsetStat(this._tblFilterCount, filterCount, filterCount != variableCount);\n\t\t\t\tsetStat(this._tblHiddenCount, hiddenCount, hiddenCount > 0);\n\t\t\t\tsetStat(this._tblSelectedCount, selectionCount, selectionCount > 1);\n\t\t\t\t// this._tblVariableCount.querySelector(\".statusText\").innerText = variableCount;\n\t\t\t\t// if (this._tblFilterCount.setVisible(filterCount !== variableCount))\n\t\t\t\t// \tthis._tblFilterCount.querySelector(\".statusText\").innerText = filterCount;\n\t\t\t\t// if (this._tblHiddenCount.setVisible(hiddenCount > 0))\n\t\t\t\t// \tthis._tblHiddenCount.querySelector(\".statusText\").innerText = hiddenCount;\n\t\t\t\t// this._tblSelectedCount.querySelector(\".statusText\").innerText = selectionCount;\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t}\n\n\t/**\n\t * @type {StatusLineController}\n\t */\n\tvar _statusLine;\n\n// #endregion\t\t\n\n// #region ======== SplitterHandler =========================\n\tvar SplitterHandler = (function(splitter, leftBox) {\n\t\tvar _splitter = splitter;\n\t\tvar _leftBox = leftBox;\n\t\tvar _isDragging = false;\n\t\tvar _lastPos;\n\t\tvar _changeCallbacks = [];\n\t\t_leftBox.style.flexGrow = 0;\n\n\t\tdocument.addEventListener('mousedown', function (e) {\n\t\t\tif (e.target === _splitter) {\n\t\t\t\t_isDragging = true;\n\t\t\t\t_lastPos = e.clientX;\n\t\t\t}\n\t\t});\n\n\t\tdocument.addEventListener('mousemove', function (e) {\n\t\t\tif (!_isDragging)\n\t\t\t\treturn false;\n\n\t\t\ttry {\n\t\t\t\te.preventDefault();\n\n\t\t\t\tvar amountMoved = e.clientX - _lastPos;\n\t\t\t\t_lastPos = e.clientX;\n\n\t\t\t\t_leftBox.style.width = `${_leftBox.offsetWidth + amountMoved}px`;\n\n\t\t\t\t_changeCallbacks.forEach(callback => callback());\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t});\n\n\t\tdocument.addEventListener('mouseup', function (e) {\n\t\t\t_isDragging = false;\n\t\t});\n\t\n\t\treturn {\n\t\t\taddChangeCallback(callback) {\n\t\t\t\t_changeCallbacks.push(callback);\n\t\t\t},\n\n\t\t\tgetSplitterPosition: function() {\n\t\t\t\treturn _leftBox.style.width;\n\t\t\t},\n\n\t\t\tsetSplitterPosition: function(value) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!value)\n\t\t\t\t\t\treturn;\n\t\t\t\t\tif (!/px;?$/i.test(value))\n\t\t\t\t\t\tvalue += \"px\";\n\t\t\t\t\t_leftBox.style.width = value;\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.log(`Error in setSplitterPosition: ${err.message}`);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t});\n\tvar _splitterHandler = null;\n\n// #endregion\n\n// #region ======== ResizableColumnHandler ==================\n\n\tvar ResizableColumnHandler = (function(th, handle) {\n\t\tvar _th = th;\n\t\tvar _handle = handle;\n\t\tvar _startingMouseX;\n\t\tvar _startingWidth;\n\t\tvar _minWidth = 0;\n\t\tvar _currWidth = 0;\n\n\t\t// NOTE: There's more initialization code below these handlers.\n\n\t\tconst mouseDownHandler = (e) => {\n\t\t\ttry {\n\t\t\t\tif (e.target !== _handle)\n\t\t\t\t\treturn;\n\t\n\t\t\t\t_th.dataset.resizing = true;\n\t\t\t\t_startingMouseX = e.clientX;\n\t\t\t\tvar computedStyles = window.getComputedStyle(_th);\n\t\t\t\t_startingWidth = parseInt(computedStyles.width);\n\t\t\t\t_minWidth = parseInt(computedStyles[\"min-width\"])\n\t\t\t\tif (_minWidth === 0)\n\t\t\t\t\t_minWidth = 20;\n\t\t\n\t\t\t\tdocument.addEventListener(\"mousemove\", mouseMoveHandler);\n\t\t\t\tdocument.addEventListener(\"mouseup\", mouseUpHandler);\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tconst mouseMoveHandler = (e) => {\n\t\t\ttry {\n\t\t\t\tvar amountMoved = e.clientX - _startingMouseX;\n\t\t\t\tsetWidth(_startingWidth + amountMoved);\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t};\n\n\t\tconst mouseUpHandler = (e) => {\n\t\t\ttry {\n\t\t\t\tdocument.removeEventListener('mousemove', mouseMoveHandler);\n\t\t\t\tdocument.removeEventListener('mouseup', mouseUpHandler);\n\t\t\t\tsetTimeout(() => { delete _th.dataset.resizing; }, 10);\n\n\t\t\t\t_variables.saveKMAppDataVariableValue(\"dictionaryKeyColumnWidth\", `${_currWidth}`);\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t};\n\n\t\tfunction setWidth(width) {\n\t\t\t_currWidth = Math.max(width, _minWidth);\n\t\t\t_th.style.width = `${_currWidth}px`;\n\t\t}\n\t\t\n\t\t_handle.addEventListener(\"mousedown\", mouseDownHandler);\n\n\t\tvar savedWidth = _variables.getKMAppDataVariableValue(\"dictionaryKeyColumnWidth\");\n\t\tif (savedWidth) {\n\t\t\tsetWidth(savedWidth, true)\n\t\t}\n\n\t\treturn {\n\t\t}\n\t});\n\n// #endregion\n\n// #region ======== ModifierKeys ============================\n\tclass ModifierKeys {\n\t\tconstructor(event) {\n\t\t\tthis._altKey = event.altKey;\n\t\t\tthis._cmdKey = event.metaKey;\n\t\t\tthis._ctrlKey = event.ctrlKey;\n\t\t\tthis._shiftKey = event.shiftKey;\n\t\t}\n\n\t\tget altKey() { return this._altKey; }\n\t\tget cmdKey() { return this._cmdKey; }\n\t\tget ctrlKey() { return this._ctrlKey; }\n\t\tget shiftKey() { return this._shiftKey; }\n\n\t\tget noModifiers() {return !this._shiftKey && !this._ctrlKey && !this._altKey && !this._cmdKey}\n\n\t\tget altKeyOnly() {return !this._shiftKey && !this._ctrlKey && this._altKey && !this._cmdKey}\n\t\tget cmdKeyOnly() {return !this._shiftKey && !this._ctrlKey && !this._altKey && this._cmdKey}\n\t\tget ctrlKeyOnly() {return !this._shiftKey && this._ctrlKey && !this._altKey && !this._cmdKey}\n\t\tget shiftCmdKeysOnly() {return this._shiftKey && !this._ctrlKey && !this._altKey && this._cmdKey}\n\t\tget shiftKeyOnly() {return this._shiftKey && !this._ctrlKey && !this._altKey && !this._cmdKey}\n\n\t\ttoString() { return `altKey: ${this._altKey}, cmdKey: ${this._cmdKey}, ctrlKey: ${this._ctrlKey}, shiftKey: ${this._shiftKey}`; }\n\t}\n// #endregion\n\n// #region ======== documentOnKeyDown =======================\n\n\t// I swear there has to be a better way to implement keyboard\n\t// shortcuts, and there may be, but this works.\n\t//\n\t// The thing I really don't like about it is the fact that the testing\n\t// of keys is separated so far from the tooltips - meaning you have to\n\t// synchronize changes in multiple places.\n\t//\n\t// I could have come up with a way to have it all in one class, but\n\t// it started to reek of over-ennineering.\n\tfunction documentOnKeyDown(event) {\n\n\t\ttry {\n\t\t\tif (_miscStateController.uiBusy)\n\t\t\t\treturn false;\n\n\t\t\tvar dialogShowing = _modalDialogController.isShowing;\n\t\t\tvar inInputField = document.activeElement === _txtValue \n\t\t\t\t|| document.activeElement === _inpSearchFilter\n\t\t\t\t|| _dictionaryCellEditAdapter.isAttached();\n\n\t\t\tvar modifierKeys = new ModifierKeys(event);\n\n\t\t\tif (modifierKeys.noModifiers) {\n\t\t\t\tswitch (event.which) {\n\t\t\t\t\tcase 8:  // delete\n\t\t\t\t\tcase 46: // forward-delete\n\t\t\t\t\t\tif (_btnDeleteVariables.isEnabled() && !inInputField) {\n\t\t\t\t\t\t\tsetTimeout(btnDeleteVariablesClicked,10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase 9: // tab\n\t\t\t\t\t\tif (_editMode && inInputField) {\n\t\t\t\t\t\t\tlet text = _isShowingJsonData ? \"  \" : \"\\t\";\n\t\t\t\t\t\t\tsetTimeout(() => { _internalTasksMacro.insertText(text); }, 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t} if (_dictionaryCellEditAdapter.isAttached()) {\n\t\t\t\t\t\t\tsetTimeout(() => _dictionaryHelper.saveCellEdit(\"right\"), 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t} else if (dialogShowing) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase 13: // return\n\t\t\t\t\t\tif (_modalDialogController.isShowing) {\n\t\t\t\t\t\t\tsetTimeout(() => _modalDialogController.close(\"ok\"), 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t} else if (document.activeElement === _selVariables) {\n\t\t\t\t\t\t\tlet selectedVariable = _selectOptions.getSelectedVariable();\n\t\t\t\t\t\t\tif (selectedVariable && !selectedVariable.isDictionary)\n\t\t\t\t\t\t\t\tsetTimeout(btnEditClicked, 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t} else if (document.activeElement === _inpSearchFilter) {\n\t\t\t\t\t\t\tsetSelectIndexAsync(0);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t} else if (_dictionaryCellEditAdapter.isAttached()) {\n\t\t\t\t\t\t\tsetTimeout(_dictionaryHelper.saveCellEdit, 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase 27: // escape\n\t\t\t\t\t\tif (_modalDialogController.isShowing) {\n\t\t\t\t\t\t\tsetTimeout(() => _modalDialogController.close(\"cancel\"), 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t} else if (_editMode) {\n\t\t\t\t\t\t\tsetTimeout(btnEditCancelClicked,10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t} else if (document.activeElement === _inpSearchFilter) {\n\t\t\t\t\t\t\tif (_inpSearchFilter.value) {\n\t\t\t\t\t\t\t\t_inpSearchFilter.value = \"\";\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t} if (_userOptions.escapeInEmptyFilterClosesPrompt) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t} else if (_dictionaryCellEditAdapter.isAttached()) {\n\t\t\t\t\t\t\tsetTimeout(() => _dictionaryCellEditAdapter.detach(true), 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase 38: // up arrow\n\t\t\t\t\t\tif  (document.activeElement === _selVariables && _selectOptions.selectedIndex === 0 && _inpSearchFilter.isEnabled()) {\n\t\t\t\t\t\t\tsetTimeout(() => _inpSearchFilter.focus(), 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t} else if (_dictionaryCellEditAdapter.isAttached()) {\n\t\t\t\t\t\t\tsetTimeout(() => _dictionaryHelper.saveCellEdit(\"up\"), 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase 40: // down arrow\n\t\t\t\t\t\tif (document.activeElement === _inpSearchFilter) {\n\t\t\t\t\t\t\tif (_selVariables.options.length > 0) {\n\t\t\t\t\t\t\t\tif (_selectOptions.selectedIndex < 0)\n\t\t\t\t\t\t\t\t\tsetSelectIndexAsync(0);\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tsetTimeout(() => _selVariables.focus(), 10);\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (_dictionaryCellEditAdapter.isAttached()) {\n\t\t\t\t\t\t\tsetTimeout(() => _dictionaryHelper.saveCellEdit(\"down\"), 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase 107: // numeric keypad +\n\t\t\t\t\tcase 187: // unshifted +/=\n\t\t\t\t\t\tif (_btnAddVariable.isEnabled() && !inInputField) {\n\t\t\t\t\t\t\tsetTimeout(btnAddVariableClicked, 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (modifierKeys.shiftKeyOnly) {\n\t\t\t\tswitch (event.which) {\n\t\t\t\t\tcase 9: // tab\n\t\t\t\t\t\tif (_dictionaryCellEditAdapter.isAttached()) {\n\t\t\t\t\t\t\tsetTimeout(() => _dictionaryHelper.saveCellEdit(\"left\"), 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase 187: // shifted +/=\n\t\t\t\t\t\tif (_btnAddVariable.isEnabled() && !inInputField) {\n\t\t\t\t\t\t\tsetTimeout(btnAddVariableClicked, 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// if (modifierKeys.altKeyOnly) {\n\t\t\t// \tswitch (event.which) {\n\t\t\t// \t\tcase 13: // Enter\n\t\t\t// \t\t\tif (_dictionaryCellEditAdapter.isAttachedTo(document.activeElement)) {\n\t\t\t// \t\t\t\tsetTimeout(() => { insertText(\"\\n\"); }, 10);\n\t\t\t// \t\t\t\treturn false;\n\t\t\t// \t\t\t}\n\t\t\t// \t\t\treturn true;\n\t\t\t// \t\tdefault:\n\t\t\t// \t\t\treturn true;\n\t\t\t// \t}\n\t\t\t// }\n\n\t\t\tif (modifierKeys.cmdKeyOnly) {\n\t\t\t\tswitch (event.which) {\n\t\t\t\t\tcase 13: // Enter\n\t\t\t\t\t\tif (_btnEditOK.isEnabled() && _editMode) {\n\t\t\t\t\t\t\tsetTimeout(btnEditOKClicked,10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase 67:  // C\n\t\t\t\t\t\tif (_btnCopyNames.isEnabled() && !inInputField) {\n\t\t\t\t\t\t\tsetTimeout(btnCopyNamesClicked, 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase 75:  // K\n\t\t\t\t\t\tif (_btnSearchKM.isEnabled() && !inInputField) {\n\t\t\t\t\t\t\tsetTimeout(btnSearchKMClicked, 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase 78: // N\n\t\t\t\t\t\tif (document.activeElement === _selVariables) {\n\t\t\t\t\t\t\tlet selectedVariable = _selectOptions.getSelectedVariable();\n\t\t\t\t\t\t\tif (selectedVariable)\n\t\t\t\t\t\t\t\tsetTimeout(btnRenameVariableClicked, 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase 83: // S\n\t\t\t\t\t\tconsole.log(83);\n\t\t\t\t\t\tif (document.activeElement !== _inpSearchFilter && _inpSearchFilter.isEnabled()) {\n\t\t\t\t\t\t\tsetTimeout(() => _inpSearchFilter.focus(), 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase 90: // Z\n\t\t\t\t\t\tif (_btnUndo.isEnabled() && !inInputField) {\n\t\t\t\t\t\t\tsetTimeout(btnUndoClicked(), 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (modifierKeys.shiftCmdKeysOnly) {\n\t\t\t\tswitch (event.which) {\n\t\t\t\t\tcase 67: // C\n\t\t\t\t\tif (_btnCopyVariables.isEnabled() && !inInputField) {\n\t\t\t\t\t\t\tsetTimeout(btnCopyVariablesClicked, 10);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase 90: // Z \n\t\t\t\t\t\tif (_btnRedo.isEnabled() && !inInputField) {\n\t\t\t\t\t\t\t\tsetTimeout(btnRedoClicked(), 10);\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn true;;\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tErrorHandler.handle(e);\n\t\t}\n\t}\n// #endregion\n\n// #region ======== InternalTasksMacro ======================\n\t\t\n\tclass InternalTasksMacro {\n\t\tconstructor() {\n\t\t\tthis._macroUUID = null;\n\t\t\tthis._macroName = null;\n\t\t}\n\n\t\t_executeTask(triggerParam) {\n\t\t\ttry {\n\t\t\t\tif (!this._macroUUID)\n\t\t\t\t\tthrow new Error(`_executeTask can't be called before initialize`);\n\t\t\t\twindow.KeyboardMaestro.Trigger(this._macroUUID, JSON.stringify(triggerParam, null, 2));\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tcopyToClipboard(text) {\n\t\t\tthis._executeTask({\n\t\t\t\taction: \"copyToClipboard\",\n\t\t\t\ttext: text\n\t\t\t});\n\t\t}\n\n\t\tdeleteTempHtmlFile() {\n\t\t\tconsole.log(`Deleting temp html file`);\n\t\t\tthis._executeTask({\n\t\t\t\taction: \"deleteTempHtmlFile\"\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Verifies that the InternalTasksMacro is enabled, and if it isn't,\n\t\t * a message is displayed and the prompt is closed. Otherwise, it deletes\n\t\t * the temp html file, if needed. Note that this does some asynchronous\n\t\t * stuff, but the UI will be disabled during the process.\n\t\t */\n\t\tinitialize() {\n\t\t\tvar timedOut = false;\n\t\t\tvar timer;\n\t\t\tvar self = this;\n\n\t\t\tfunction makeInitializationErrorObject(message) {\n\t\t\t\tvar result = new Error(message);\n\t\t\t\tresult.isInitializationError = true;\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tfunction handlePingResponse() {\n\t\t\t\ttry {\n\t\t\t\t\tconsole.log(`Got pingBack event`);\n\t\t\t\t\tif (timedOut) {\n\t\t\t\t\t\tconsole.log(`Aborting because of timeout`);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\tif (_parameters.deleteTempHtmlFile == \"1\") \n\t\t\t\t\t\tself.deleteTempHtmlFile();\n\n\t\t\t\t\t_miscStateController.uiBusy = false;\n\t\t\t\t\tif (_userOptions.focusFilterOnStartup || _selectOptions.length === 0)\n\t\t\t\t\t\t_inpSearchFilter.focus();\n\t\t\t\t\telse\n\t\t\t\t\t\t_selVariables.focus();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction handleTimeout() {\n\t\t\t\ttry {\n\t\t\t\t\ttimedOut = true;\n\t\t\t\t\tlet macroGroupName = `<font size=\"3\"><b>${escape(_macroGroupName)}</b></font>`;\n\t\t\t\t\tlet macroName = `<font size=\"3\"><b>${escape(self._macroName)}</b></font>`;\n\t\t\t\t\tthrow makeInitializationErrorObject(\n\t\t\t\t\t\t`Make sure the macro group<br/>`\n\t\t\t\t\t\t+ `${macroGroupName}<br/>`\n\t\t\t\t\t\t+ `is enabled, and the macro<br/>`\n\t\t\t\t\t\t+ `<strong>${macroName}</strong><br/>`\n\t\t\t\t\t\t+ `is enabled.<br/><br/>`\n\t\t\t\t\t\t+ `Timed out waiting for a response from the macro <strong>${macroName}</strong>`);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tif (e.isInitializationError) {\n\t\t\t\t\t\t_modalDialogController.showMessageAndAbort(e.message, true);\n\t\t\t\t\t\tsetTimeout(() => _miscStateController.uiBusy = false, 100);\n\t\t\t\t\t} else\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tthis._macroUUID = _parameters.internalTasksMacroUUID;\n\t\t\t\tif (!this._macroUUID)\n\t\t\t\t\tthrow makeInitializationErrorObject(`Missing internalTasksMacroUUID.`);\n\t\t\t\tthis._macroName = window.KeyboardMaestro.ProcessTokens(`%MacroNameForUUID%${this._macroUUID}%`);\n\t\t\t\tif (this._macroName === \"Not Found\")\n\t\t\t\t\tthrow makeInitializationErrorObject(`Could not find Internal Tasks Macro for UUID ${this._macroUUID}`);\n\n\t\t\t\t_miscStateController.uiBusy = true;\n\t\t\t\tthis._executeTask({\n\t\t\t\t\taction: \"ping\",\n\t\t\t\t\tcustomHTMLPromptID: _kmwindowid\n\t\t\t\t});\n\n\t\t\t\tdocument.addEventListener(\"pingBack\", () => handlePingResponse(), {once: true});\n\t\t\t\ttimer = setTimeout(() => handleTimeout(), 2000);\n\t\t\t} catch (e) {\n\t\t\t\tif (e.isInitializationError)\n\t\t\t\t\t_modalDialogController.showMessageAndAbort(e.message);\n\t\t\t\telse\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tinsertText(text) {\n\t\t\tthis._executeTask({\n\t\t\t\taction: \"insertText\",\n\t\t\t\ttext: text\n\t\t\t});\n\t\t}\n\n\t\tpingBack() {\n\t\t\tconsole.log(`pingBack() called`);\n\t\t\tdocument.dispatchEvent(new Event(\"pingBack\"));\n\t\t}\n\n\t\treloadData(globalVariableNames, dictionaryNames) {\n\t\t\tthis._executeTask( {\n\t\t\t\taction: \"reloadData\",\n\t\t\t\tparameters: {\n\t\t\t\t\tcustomHTMLPromptID: _kmwindowid,\n\t\t\t\t\tgetAllGlobalVariableNames: globalVariableNames,\n\t\t\t\t\tgetAllDictionaryNames: dictionaryNames\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tsearchKM(name) {\n\t\t\tthis._executeTask({\n\t\t\t\taction: \"searchKM\",\n\t\t\t\tname: name,\n\t\t\t\tsearchAllMacros: _isAsync ? \"1\" : \"0\"\n\t\t\t});\n\t\t}\n\n\t\tsetDictionaryValue(name, value) {\n\t\t\tthis._executeTask({\n\t\t\t\taction: \"setDictionaryValue\",\n\t\t\t\tname: name,\n\t\t\t\tvalue: value\n\t\t\t});\n\t\t}\n\n\t}\n\tconst _internalTasksMacro = new InternalTasksMacro();\n\n// #endregion\n\n// #region ======== UserOptions =============================\n\n\tclass UserOptions {\n\t\tconstructor() {\n\t\t\tthis._escapeInEmptyFilterClosesPrompt = true;\n\t\t\tthis._fixedFont = false;\n\t\t\tthis._focusFilterOnStartup = true;\n\t\t\tthis._fontSize = null;\n\t\t\tthis._jsonVariableDisplayMode = false;\n\t\t\tthis._sortBySizeSelectsFirstVariable = false;\n\t\t\tthis._wordWrap = true;\n\t\t\tthis._load();\n\t\t}\n\n\t\t_load() {\n\t\t\ttry {\n\t\t\t\tvar oldFontSize = _variables.getKMAppDataVariableValue(\"_fontSize\");\n\t\t\t\tvar options = _variables.getKMAppDataVariableValue(\"userOptions\");\n\t\t\t\tif (options) {\n\t\t\t\t\tthis._escapeInEmptyFilterClosesPrompt = options.escapeInEmptyFilterClosesPrompt !== false;\n\t\t\t\t\tthis._fixedFont = options.fixedFont == true;\n\t\t\t\t\tthis._focusFilterOnStartup = options.focusFilterOnStartup !== false;\n\t\t\t\t\tthis._fontSize = oldFontSize || options.fontSize || null;\n\t\t\t\t\tthis._jsonVariableDisplayMode = options.jsonVariableDisplayMode == true;\n\t\t\t\t\tthis._sortBySizeSelectsFirstVariable = options.sortBySizeSelectsFirstVariable == true;\n\t\t\t\t\tthis._wordWrap = options.wordWrap !== false;\n\t\t\t\t}\n\t\t\t\tif (oldFontSize) {\n\t\t\t\t\t_variables.saveKMAppDataVariableValue(\"_fontSize\", null);\n\t\t\t\t\tthis._save();\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\t_save() {\n\t\t\tvar options = {};\n\t\t\tif (!this.escapeInEmptyFilterClosesPrompt) options.escapeInEmptyFilterClosesPrompt = false;\n\t\t\tif (this._fixedFont) options.fixedFont = true;\n\t\t\tif (!this.focusFilterOnStartup) options.focusFilterOnStartup = false;\n\t\t\tif (this._fontSize != null) options.fontSize = this._fontSize;\n\t\t\tif (this._jsonVariableDisplayMode) options.jsonVariableDisplayMode = true;\n\t\t\tif (this._sortBySizeSelectsFirstVariable) options.sortBySizeSelectsFirstVariable = true;\n\t\t\tif (!this._wordWrap) options.wordWrap = false;\n\t\t\t_variables.saveKMAppDataVariableValue(\"userOptions\", options);\n\t\t}\n\n\t\tget escapeInEmptyFilterClosesPrompt() { return this._escapeInEmptyFilterClosesPrompt; }\n\t\tset escapeInEmptyFilterClosesPrompt(value) {\n\t\t\tthis._escapeInEmptyFilterClosesPrompt = value;\n\t\t\tthis._save();\n\t\t}\n\n\t\tget fixedFont() { return this._fixedFont; }\n\t\tset fixedFont(value) {\n\t\t\tthis._fixedFont = value;\n\t\t\tthis._save();\n\t\t}\n\n\t\tget focusFilterOnStartup() { return this._focusFilterOnStartup; }\n\t\tset focusFilterOnStartup(value) {\n\t\t\tthis._focusFilterOnStartup = value;\n\t\t\tthis._save();\n\t\t}\n\n\t\t/**\n\t\t * The Font Size, which can be a number or null.\n\t\t */\n\t\tget fontSize() { return this._fontSize; }\n\t\tset fontSize(value) {\n\t\t\tthis._fontSize = value;\n\t\t\tthis._save();\n\t\t}\n\n\t\tget jsonVariableDisplayModeMode() { return this._jsonVariableDisplayMode; }\n\t\tset jsonVariableDisplayModeMode(value) {\n\t\t\tthis._jsonVariableDisplayMode = value;\n\t\t\tthis._save();\n\t\t}\n\n\t\tget sortBySizeSelectsFirstVariable() { return this._sortBySizeSelectsFirstVariable; }\n\t\tset sortBySizeSelectsFirstVariable(value) {\n\t\t\tthis._sortBySizeSelectsFirstVariable = value;\n\t\t\tthis._save();\n\t\t}\n\n\t\tget wordWrap() { return this._wordWrap; }\n\t\tset wordWrap(value) {\n\t\t\tthis._wordWrap = value;\n\t\t\tthis._save();\n\t\t}\n\t}\n\n\t/**\n\t * @type UserOptions\n\t */\n\tvar _userOptions;\n\n// #endregion\t\t\n\n// #region ======== UI Stuff ================================\n\n\t// #region ======== Elements Variables & initControls ===\n\t\tvar _btnAddVariable;\n\t\tvar _btnCancel;\n\t\tvar _btnCode;\n\t\tvar _btnCopyNames;\n\t\tvar _btnCopyVariables;\n\t\tvar _btnDeleteVariables;\n\t\tvar _btnEdit;\n\t\tvar _btnEditCancel;\n\t\tvar _btnEditOK;\n\t\tvar _btnHelp;\n\t\tvar _btnHiddenVariables_toggleVariables;\n\t\tvar _btnHiddenVariables_toggleViewMode\n\t\tvar _btnJson;\n\t\tvar _btnOK;\n\t\tvar _btnRedo;\n\t\tvar _btnReload;\n\t\tvar _btnRenameVariable;\n\t\tvar _btnSearchKM;\n\t\tvar _btnSort;\n\t\tvar _btnUndo;\n\t\tvar _btnWordWrap;\n\t\tvar _divDictionary;\n\t\tvar _divSelVariables;\n\t\tvar _divUIBusy;\n\t\tvar _divVariables;\n\t\tvar _divVariableToolButtons;\n\t\tvar _imgHiddenVariables_toggleViewMode_all;\n\t\tvar _imgHiddenVariables_toggleViewMode_hide;\n\t\tvar _imgHiddenVariables_toggleViewMode_only;\n\t\tvar\t_imgHiddenVariables_toggleVariables_hide;\n\t\tvar _imgHiddenVariables_toggleVariables_unhide;\n\t\tvar _infoHiddenVariables_warning;\n\t\tvar _infoHiddenVariables_warningText;\n\t\tvar _inpSearchFilter;\n\t\tvar _optionsMenu;\n\t\tvar _selVariables;\n\t\tvar _spanStatusLine;\n\t\tvar _txtValue;\n\n\t\tvar _editMode = false;\n\t\tvar _sortBySize = false;\n\t\tvar _undoList = [];\n\n\t\tfunction initControls() {\n\t\t\ttry {\n\t\t\t\t_undoRedoStack = new UndoRedoStack();\n\t\t\t\t_userOptions = new UserOptions();\n\n\t\t\t\t_btnAddVariable = _tooltipFadeInAnimator.attach(\"btnAddVariable\");\n\t\t\t\t_btnCancel = document.getElementById(\"btnCancel\");\n\t\t\t\t_btnCode = _tooltipFadeInAnimator.attach(\"btnCode\");\n\t\t\t\t_btnCopyNames = _tooltipFadeInAnimator.attach(\"btnCopyNames\");\n\t\t\t\t_btnCopyVariables = _tooltipFadeInAnimator.attach(\"btnCopyVariables\");\n\t\t\t\t_btnDeleteVariables = _tooltipFadeInAnimator.attach(\"btnDeleteVariables\");\n\t\t\t\t_btnEdit = _tooltipFadeInAnimator.attach(\"btnEdit\");\n\t\t\t\t_btnEditCancel = _tooltipFadeInAnimator.attach(\"btnEditCancel\");\n\t\t\t\t_btnEditOK = _tooltipFadeInAnimator.attach(\"btnEditOK\");\n\t\t\t\t_btnHelp = _tooltipFadeInAnimator.attach(\"btnHelp\");\n\t\t\t\t_btnHiddenVariables_toggleVariables = _tooltipFadeInAnimator.attach(\"btnHiddenVariables_toggleVariables\");\n\t\t\t\t_btnHiddenVariables_toggleViewMode = _tooltipFadeInAnimator.attach(\"btnHiddenVariables_toggleViewMode\");\n\t\t\t\t_btnJson = _tooltipFadeInAnimator.attach(\"btnJson\");\n\t\t\t\t_btnOK = document.getElementById(\"btnOK\");\n\t\t\t\t_btnRedo = _tooltipFadeInAnimator.attach(\"btnRedo\");\n\t\t\t\t_btnReload = document.getElementById(\"btnReload\")\n\t\t\t\t_btnRenameVariable = _tooltipFadeInAnimator.attach(\"btnRenameVariable\");\n\t\t\t\t_btnSearchKM = _tooltipFadeInAnimator.attach(\"btnSearchKM\");\n\t\t\t\t_btnSort = _tooltipFadeInAnimator.attach(\"btnSort\");\n\t\t\t\t_btnUndo = _tooltipFadeInAnimator.attach(\"btnUndo\");\n\t\t\t\t_btnWordWrap = _tooltipFadeInAnimator.attach(\"btnWordWrap\");\n\t\t\t\t_divDictionary = document.getElementById(\"divDictionary\");\n\t\t\t\t_divSelVariables = document.getElementById(\"divSelVariables\");\n\t\t\t\t_divUIBusy = document.getElementById(\"divUIBusy\");\n\t\t\t\t_divVariables = document.getElementById(\"divVariables\");\n\t\t\t\t_divVariableToolButtons = document.getElementById(\"divVariableToolButtons\");\n\t\t\t\t_imgHiddenVariables_toggleViewMode_all = document.getElementById(\"imgHiddenVariables_toggleViewMode_all\");\n\t\t\t\t_imgHiddenVariables_toggleViewMode_hide = document.getElementById(\"imgHiddenVariables_toggleViewMode_hide\");\n\t\t\t\t_imgHiddenVariables_toggleViewMode_only = document.getElementById(\"imgHiddenVariables_toggleViewMode_only\");\n\t\t\t\t_imgHiddenVariables_toggleVariables_hide = document.getElementById(\"imgHiddenVariables_toggleVariables_hide\");\n\t\t\t\t_imgHiddenVariables_toggleVariables_unhide = document.getElementById(\"imgHiddenVariables_toggleVariables_unhide\");;\n\n\t\t\t\t_infoHiddenVariables_warning = document.getElementById(\"infoHiddenVariables_warning\");\n\t\t\t\t_infoHiddenVariables_warningText = document.getElementById(\"infoHiddenVariables_warningText\");\n\t\t\t\t_inpSearchFilter = document.getElementById(\"inpSearchFilter\");\n\t\t\t\t_optionsMenu = document.getElementById(\"optionsMenu\");\n\t\t\t\t_selVariables = document.getElementById(\"selVariables\");\n\t\t\t\t_spanStatusLine = document.getElementById(\"spanStatusLine\");\n\t\t\t\t_txtValue = document.getElementById(\"txtValue\");\n\n\t\t\t\t_variableSortMode.setSortBySize(false, false);\n\n\t\t\t\t_fontSizeController = new FontSizeController(document.body, 10, 20);\n\t\t\t\t_miscStateController.load();\n\n\t\t\t\tif (_isAsync) {\n\t\t\t\t\t_btnOK.text = \"Done\";\n\t\t\t\t\t_btnCancel.setVisible(false);\n\t\t\t\t}\n\n\t\t\t\tif (_btnReload.setVisible(_showReloadButton && !_variables.getIsEmpty())) {\n\t\t\t\t\tif (_isAsync && _showingLocalVariables && !_showingGlobalVariables && !_showingDictionaries)\n\t\t\t\t\t\t_btnReload.toggleClass(\"pseudoDisabled\", true);\n\t\t\t\t}\n\n\t\t\t\tdocument.onkeydown = documentOnKeyDown;\n\n\t\t\t\t_statusLine = new StatusLineController();\n\n\t\t\t\twindow.addEventListener(\"resize\", () => {\n\t\t\t\t\tdivVariablesResized();\n\t\t\t\t});\n\n\t\t\t\t_splitterHandler.addChangeCallback(divVariablesResized);\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tfunction divVariablesResized() {\n\t\t\tadjustWrapableTooltipAignment();\n\t\t\tadjustSelVariablesHeight();\n\t\t}\n\n\t\tfunction adjustSelVariablesHeight() {\n\t\t\tvar height = document.getElementById(\"divSelVariables\").clientHeight;\n\t\t\t_selVariables.setAttribute(\"style\", `height:${height - 4}px;`);\n\t\t}\n\t// #endregion\n\n\t// #region ======== VariableController ==================\n\n\t\t/**\n\t\t * @typedef {(Object | string)} VariableValue\n\t\t */\n\n\t\t/**\n\t\t * @typedef {Object} Variable\n\t\t * @property {string} name\n\t\t * @property {VariableValue} value\n\t\t * @property {bool} [isLocalVariable]\n\t\t * @property {string} [jsonValue]\n\t\t */\n\n\t\t/**\n\t\t * @typedef {Object} DictionaryVariable\n\t\t * @property {string} name\n\t\t * @property {string} dictionaryName\n\t\t * @property {{key: string, value: string}} value\n\t\t * @property {bool} isDictionary\n\t\t * @property {string} [jsonValue]\n\t\t */\n\n\t\tclass VariableController {\n\t\t\tconstructor() {\n\t\t\t\tthis._data = [];\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * @returns {Variable[]} variables storage.\n\t\t\t */\n\t\t\tget data() { return this._data; }\n\t\t\tset data(value) { this._data = value;}\n\t\t\tgetIsEmpty() { return this._data.length === 0 }\n\n\t\t\t/**\n\t\t\t * Saves the variable's value to KM. Adds it to _data. If the variable\n\t\t\t * is NOT currently hidden, adds an option for it.\n\t\t\t * @param {Variable} variable\n\t\t\t * @param {{saveUndo: bool}} [options]\n\t\t\t */\n\t\t\taddVariable(variable, options) {\n\t\t\t\ttry {\n\t\t\t\t\toptions = validateOptions(options, [\"saveUndo\"]);\n\t\t\t\t\tthis.saveKMVariableValue(variable, variable.value);\n\t\t\t\t\tthis._data.push(variable);\n\t\t\t\t\tif (options.saveUndo)\n\t\t\t\t\t\t_undoRedoStack.addVariableAddedAction(variable);\n\t\t\t\t\tif (_hiddenVariables.getVariableIsHiddenInThisViewMode(variable.name))\n\t\t\t\t\t\treturn new NoOptionResult();\n\t\t\t\t\treturn _selectOptions.addOption(variable);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Saves the changed variable to KM, optionally: adds to Undo, updates jsonValue, update Option display name\n\t\t\t * @param {Variable} variable\n\t\t\t * @param {VariableValue} newValue The new value\n\t\t\t * @param {{saveUndo: bool, undoDictionaryAction: UndoRedoDictionaryAction, dontSetupJsonValue: bool, noOptionElement: bool}} [options]\n\t\t\t */\n\t\t\tchangeVariable(variable, newValue, options) {\n\t\t\t\ttry {\n\t\t\t\t\toptions = validateOptions(options, [\"saveUndo\", \"undoDictionaryAction\", \"dontSetupJsonValue\", \"noOptionElement\"]);\n\t\t\t\t\tif (options.saveUndo)\n\t\t\t\t\t\t_undoRedoStack.addValueChangedAction(variable, newValue, options.undoDictionaryAction);\n\t\t\t\t\tthis.saveKMVariableValue(variable, newValue);\n\t\t\t\t\tvariable.value = newValue;\n\t\t\t\t\t\t\n\t\t\t\t\tif (!options.dontSetupJsonValue)\n\t\t\t\t\t\t_variables.setupJsonValue(variable);\n\n\t\t\t\t\tif (options.noOptionElement || _hiddenVariables.getVariableIsHiddenInThisViewMode(variable.name))\n\t\t\t\t\t\treturn new NoOptionResult();\n\n\t\t\t\t\tvar option = _selectOptions.getOptionByVariableName(variable.name);\n\t\t\t\t\toption.text = _variables.getDisplayName(variable);\n\t\t\t\t\treturn new OptionUpdatedResult(option);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Creates a new Variable object. Does NOT add it to _data. If you don't specify a value, \n\t\t\t * gets the existing value from KM, if any.\n\t\t\t * @param {string} name the variable's name\n\t\t\t * @param {VariableValue} [value] if undefined, gets the existing value from KM, if any.\n\t\t\t * @returns {Variable}\n\t\t\t */\n\t\t\tcreateVariable(name, value) {\n\t\t\t\tif (value === undefined)\n\t\t\t\t\tvalue = this.getKMVariableValue(name);\n\t\t\t\tvar result = {\n\t\t\t\t\tname: name,\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tisLocalVariable: this.isLocalVariableName(name)\n\t\t\t\t};\n\t\t\t\tthis.setupJsonValue(result);\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Creates a new Dictionary Variable object. Does NOT add it to _data. Gets the existing value from KM, if any.\n\t\t\t * @param {string} name \n\t\t\t * @param {VariableValue} [value] if undefined, gets the existing value from KM, if any.\n\t\t\t * @returns {DictionaryVariable}\n\t\t\t */\n\t\t\tcreateDictionaryVariable(name, value) {\n\t\t\t\tif (!value)\n\t\t\t\t\tvalue = this.getKMDictionaryVariableValue(name);\n\t\t\t\tvar result = this.createVariable(`${name} (Dictionary)`, value);\n\t\t\t\tresult.dictionaryName = name;\n\t\t\t\tresult.isDictionary = true;\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Deletes a variable from KM, removes it from _data, removes the Option if any, and optionally adds to undo.\n\t\t\t * @param {Variable} variable\n\t\t\t * @param {{saveUndo: bool, undoGroupNumber: number}} [options]\n\t\t\t */\n\t\t\tdeleteVariable(variable, options) {\n\t\t\t\ttry {\n\t\t\t\t\tvar isHidden = _hiddenVariables.getVariableIsHidden(variable.name);\n\t\t\t\t\toptions = validateOptions(options, [\"saveUndo\", \"undoGroupNumber\"]);\n\t\t\t\t\tif (options.saveUndo)\n\t\t\t\t\t\t_undoRedoStack.addVariableDeletedAction(variable, isHidden, options.undoGroupNumber);\n\t\t\t\t\tif (variable.isDictionary)\n\t\t\t\t\t\tthis.saveKMVariableValue(variable, {});\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.saveKMVariableValue(variable, \"%Delete%\");\n\t\t\t\t\tif (isHidden)\n\t\t\t\t\t\t_hiddenVariables.setVariableIsHidden(variable.name, false);\n\t\t\t\t\tvar variableIndex = this.getVariableByName(variable.name).index;\n\t\t\t\t\tthis._data.splice(variableIndex, 1);\n\t\t\t\t\treturn _selectOptions.deleteOption(variable);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Gets the name of the variable or dictionary,\n\t\t\t * @param {Variable} variable \n\t\t\t * @returns {string}\n\t\t\t */\n\t\t\tgetActualVariableName(variable) {\n\t\t\t\treturn variable.isDictionary ? variable.dictionaryName : variable.name;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Gets the variable's display name, based on current sortMode and \"hidden\" status\n\t\t\t * @param {Variable} variable \n\t\t\t * @returns {string}\n\t\t\t */\n\t\t\tgetDisplayName(variable) {\n\t\t\t\tvar result = _variableSortMode.sortBySize ? `(${this.getVariableSize(variable)}) ${variable.name}` : variable.name;\n\t\t\t\tif (_hiddenVariables.getVariableIsHidden(variable.name))\n\t\t\t\t\tresult = ` ${result}`;\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Gets data stored in the \"Additional Data\" of the WindowBoundsController\n\t\t\t * @param {string} name the name of the \"variable\"\n\t\t\t * @returns {string | object} the value, or an empty string. Use JSON.parse() on the result, if needed.\n\t\t\t */\n\t\t\tgetKMAppDataVariableValue(name) {\n\t\t\t\treturn _appStateDataController.getAdditionalData(name) || \"\";\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Gets the dictionary's value from KM.\n\t\t\t * @param {string} dictionaryName \n\t\t\t * @returns {{key: string, value: string}} the value, as an object literal\n\t\t\t */\n\t\t\tgetKMDictionaryVariableValue(dictionaryName) {\n\t\t\t\treturn JSON.parse(window.KeyboardMaestro.ProcessTokens(`%JSONFromDictionary%${dictionaryName}%`));\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * Gets the value of the variable from KM, or document.kmvar if _isAsync and it's a local variable.\n\t\t\t * @param {string} name \n\t\t\t * @returns {string}\n\t\t\t */\n\t\t\tgetKMVariableValue(name) {\n\t\t\t\tif (_isAsync && this.isLocalVariableName(name))\n\t\t\t\t\treturn document.kmvar[name] || \"\";\n\t\t\t\treturn window.KeyboardMaestro.GetVariable(name);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Gets the variable for the specified name\n\t\t\t * @param {string} name \n\t\t\t * @param {{isDictionary: bool, caseInsensitive: bool, returnNullIfNotFound: bool}} [options]\n\t\t\t * @returns {{variable: Variable, index: number}}\n\t\t\t */\n\t\t\tgetVariableByName(name, options) {\n\t\t\t\toptions = validateOptions(options, [\"isDictionary\", \"caseInsensitive\", \"returnNullIfNotFound\"]);\n\t\t\t\tif (options.caseInsensitive)\n\t\t\t\t\tname = name.toLowerCase();\n\t\t\t\tfor (let i = 0; i < this._data.length; i++) {\n\t\t\t\t\tconst variable = this._data[i];\n\n\t\t\t\t\tlet varName = variable.name;\n\t\t\t\t\tif (options.isDictionary) {\n\t\t\t\t\t\tif (!variable.isDictionary)\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\tvarName = variable.dictionaryName;\n\t\t\t\t\t}\n\t\t\t\t\tif (options.caseInsensitive)\n\t\t\t\t\t\tvarName = varName.toLowerCase();\n\t\t\t\t\tif (varName === name) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tvariable: variable,\n\t\t\t\t\t\t\tindex: i\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (options.returnNullIfNotFound)\n\t\t\t\t\treturn null;\n\t\t\t\tthrow new Error(`Logic Error: Could not find variable named \"${name}\"`);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Calculates the size of the variable's content\n\t\t\t * @param {Variable} variable \n\t\t\t * @returns {number}\n\t\t\t */\n\t\t\tgetVariableSize(variable) {\n\t\t\t\tif (variable.isDictionary)\n\t\t\t\t\treturn variable.jsonValue.length;\n\t\t\t\treturn variable.value.length;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Returns true if the dictionary variable is empty.\n\t\t\t * @param {Variable} variable \n\t\t\t * @returns {bool}\n\t\t\t */\n\t\t\tisDictionaryEmpty(variable) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!variable.isDictionary)\n\t\t\t\t\t\tthrow new Error(`Variable \"${variable.name}\" is not a Dictionary`)\n\t\t\t\t\treturn Object.keys(variable.value).length === 0;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Is this a Local or Instance variable name?\n\t\t\t * @param {string} name \n\t\t\t * @returns {bool}\n\t\t\t */\n\t\t\tisLocalVariableName(name) {\n\t\t\t\treturn /^instance|^local/i.test(name);\n\t\t\t}\n\t\t\n\t\t\t/**\n\t\t\t * Is the specified string a valid KM variable name?\n\t\t\t * @param {string} name \n\t\t\t * @returns {bool}\n\t\t\t */\n\t\t\tisValidVariableName(name) {\n\t\t\t\treturn /^[a-z][a-z0-9 _]*$/i.test(name);\n\t\t\t}\n\n\t\t\tisVariableEmpty(variable) {\n\t\t\t\tif (variable.isDictionary)\n\t\t\t\t\treturn this.isDictionaryEmpty(variable);\n\t\t\t\treturn variable.value == null || variable.value == \"\";\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Renames the variable by calling deleteVariable and addVariable, and optionally adds to undo.\n\t\t\t * @param {Variable} variable the existing variable\n\t\t\t * @param {string} newName  the new name\n\t\t\t * @param {{saveUndo: boolean}} [options]\n\t\t\t * @returns \n\t\t\t */\n\t\t\trenameVariable(variable, newName, options) {\n\t\t\t\ttry {\n\t\t\t\t\toptions = validateOptions(options, [\"saveUndo\"]);\n\t\t\t\t\tvar wasHidden = _hiddenVariables.getVariableIsHidden(variable.name);\n\t\t\t\t\tthis.deleteVariable(variable);\n\t\t\t\t\tvar newVariable = variable.isDictionary ? \n\t\t\t\t\t\tthis.createDictionaryVariable(newName, variable.value.clone()) : \n\t\t\t\t\t\tthis.createVariable(newName, variable.value);\n\t\t\t\t\tif (options.saveUndo)\n\t\t\t\t\t\t_undoRedoStack.addVariableRenamedAction(variable, newVariable);\n\t\t\t\t\tif (wasHidden)\n\t\t\t\t\t\t_hiddenVariables.setVariableIsHidden(newName, true);\n\t\t\t\t\treturn this.addVariable(newVariable);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Saves data stored in the \"Additional Data\" of the WindowBoundsController\n\t\t\t * @param {string} name the name of the \"variable\"\n\t\t\t * @param {string | object} value the value.\n\t\t\t */\n\t\t\tsaveKMAppDataVariableValue(name, value) {\n\t\t\t\t_appStateDataController.setAdditionalData(name, value);\n\t\t\t\t_appStateDataController.save();\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Saves the variable's value to KM\n\t\t\t * @param {Variable} variable \n\t\t\t * @param {VariableValue} newValue \n\t\t\t */\n\t\t\tsaveKMVariableValue(variable, newValue) {\n\t\t\t\ttry {\n\t\t\t\t\tif (variable.isDictionary) {\n\t\t\t\t\t\t_internalTasksMacro.setDictionaryValue(variable.dictionaryName, JSON.stringify(newValue, null, 2));\n\t\t\t\t\t\tif (_saveKMVariableValue_logging)\n\t\t\t\t\t\t\tconsole.log(`Saved Dictionary`, triggerParam);\n\t\t\t\t\t} else {\n\t\t\t\t\t\twindow.KeyboardMaestro.SetVariable(variable.name, newValue);\n\t\t\t\t\t\tif (_saveKMVariableValue_logging)\n\t\t\t\t\t\t\tconsole.log(`Saved Variable \"${variable.name}\":\\n${newValue}`);\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Sets the variable's jsonValue\n\t\t\t * @param {Variable} variable \n\t\t\t */\n\t\t\tsetupJsonValue(variable) {\n\n\t\t\t\tfunction isString(value) {\n\t\t\t\t\treturn typeof value === 'string' || value.value instanceof String;\n\t\t\t\t}\n\t\n\t\t\t\tvariable.jsonValue = null;\n\t\t\t\tif (!variable || !variable.value)\n\t\t\t\t\treturn;\n\t\n\t\t\t\tif (!isString(variable.value)) {\n\t\t\t\t\tvariable.jsonValue = JSON.stringify(variable.value, null, 2);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tif (/^[\\[{]/.test(variable.value)) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvariable.jsonValue = JSON.stringify(JSON.parse(variable.value), null, 2);\n\t\t\t\t\t} catch {\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t}\n\t\tconst _variables = new VariableController();\n\t// #endregion\n\n\t// #region ======== MiscStateController ======================\n\t\t\t\n\t\tclass MiscStateController {\n\t\t\tconstructor() {\n\t\t\t\tthis._fixedFont = false;\n\t\t\t\tthis._jsonDictionaryDisplayMode = false;\n\t\t\t\tthis._jsonVariableDisplayMode = false;\n\t\t\t\tthis._uiBusy = false;\n\t\t\t\tthis._wordWrap = true;\n\t\t\t\tthis._loading = false;\n\t\t\t}\n\n\t\t\tload() {\n\t\t\t\ttry {\n\t\t\t\t\tthis._loading = true;\n\t\t\t\t\tthis.fixedFont = _userOptions.fixedFont;\n\t\t\t\t\tthis.jsonVariableDisplayMode = _userOptions.jsonVariableDisplayModeMode;\n\t\t\t\t\tthis.wordWrap = _userOptions.wordWrap;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t} finally {\n\t\t\t\t\tthis._loading = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tget fixedFont() { return this._fixedFont; }\n\t\t\tset fixedFont(value) {\n\t\t\t\ttry {\n\t\t\t\t\tthis._fixedFont = value;\n\t\t\t\t\tif (!this._loading) {\n\t\t\t\t\t\t_userOptions.fixedFont = this._fixedFont;\n\t\t\t\t\t\tshowCurrentlySelectedValue();\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tget jsonDictionaryDisplayMode() { return this._jsonDictionaryDisplayMode; }\n\t\t\tset jsonDictionaryDisplayMode(value) {\n\t\t\t\ttry {\n\t\t\t\t\tthis._jsonDictionaryDisplayMode = value;\n\t\t\t\t\tif (!this._loading)\n\t\t\t\t\t\tshowCurrentlySelectedValue();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tget jsonVariableDisplayMode() { return this._jsonVariableDisplayMode; }\n\t\t\tset jsonVariableDisplayMode(value) {\n\t\t\t\ttry {\n\t\t\t\t\tthis._jsonVariableDisplayMode = value;\n\t\t\t\t\tif (!this._loading) {\n\t\t\t\t\t\t_userOptions.jsonVariableDisplayModeMode = this._jsonVariableDisplayMode;\n\t\t\t\t\t\tshowCurrentlySelectedValue();\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tget uiBusy() { return this._uiBusy; }\n\t\t\tset uiBusy(value) {\n\t\t\t\tthis._uiBusy = value;\n\t\t\t\t_divUIBusy.setVisible(this._uiBusy);\n\t\t\t\t_divUIBusy.swapClasses(\"divUIBusyVisible\", \"divUIBusyHidden\", this._uiBusy);\n\t\t\t}\n\n\t\t\tget wordWrap() { return this._wordWrap; }\n\t\t\tset wordWrap(value) {\n\t\t\t\ttry {\n\t\t\t\t\tthis._wordWrap = value;\n\t\t\t\t\tif (!this._loading) {\n\t\t\t\t\t\t_userOptions.wordWrap = this._wordWrap;\n\t\t\t\t\t\tshowCurrentlySelectedValue();\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconst _miscStateController = new MiscStateController();\n\n\t// #endregion\n\n\t// #region ======== SelectOptionController ==================\n\n\t\t// #region ======== Result Classes (for Intellisense) ===\n\t\t\tclass BaseOptionResult {\n\t\t\t\tconstructor(resultType) {\n\t\t\t\t\tthis.resultType = resultType;\n\t\t\t\t}\n\t\t\n\t\t\t\t_getPropertyValue(propertyName) {\n\t\t\t\t\tvar result = this[`_${propertyName}`];\n\t\t\t\t\tif (result === undefined)\n\t\t\t\t\t\tthrow new Error(`AccessError: ${this.resultType} doesn't have an ${propertyName}`);\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\n\t\t\t\t_hasPropertyValue(propertyName) {\n\t\t\t\t\treturn this[`_${propertyName}`] !== undefined;\n\t\t\t\t}\n\t\t\n\t\t\t\t/**\n\t\t\t\t * @returns {HTMLOptionElement}\n\t\t\t\t */\n\t\t\t\tget option() { return this._getPropertyValue(\"option\"); }\n\t\t\t\tget hasOption() { return this._hasPropertyValue(\"option\"); }\n\t\t\t\t\n\t\t\t\tget addedOption() { return this._getPropertyValue(\"addedOption\"); }\n\t\t\t\tget hasAddedOption() { return this._hasPropertyValue(\"addedOption\"); }\n\t\t\n\t\t\t\tget deletedOptionIndex() { return this._getPropertyValue(\"deletedOptionIndex\"); }\n\t\t\t\tget hasDeletedOptionIndex() { return this._hasPropertyValue(\"deletedOptionIndex\"); }\n\t\t\n\t\t\t\tget updatedOption() { return this._getPropertyValue(\"updatedOption\"); }\n\t\t\t\tget hasUpdatedOption() { return this._hasPropertyValue(\"updatedOption\"); }\n\t\t\t}\n\t\t\tclass OptionAddedResult extends BaseOptionResult {\n\t\t\t\tconstructor(option) {\n\t\t\t\t\tsuper(\"OptionAddedResult\");\n\t\t\t\t\tthis._option = option;\n\t\t\t\t\tthis._addedOption = option;\n\t\t\t\t}\n\t\t\t}\n\t\t\tclass OptionDeletedIndexResult extends BaseOptionResult {\n\t\t\t\tconstructor(index) { \n\t\t\t\t\tsuper(\"OptionDeletedIndexResult\");\n\t\t\t\t\tthis._deletedOptionIndex = index;\n\t\t\t\t}\n\t\t\t}\n\t\t\tclass OptionUpdatedResult extends BaseOptionResult {\n\t\t\t\tconstructor(option) {\n\t\t\t\t\tsuper(\"OptionUpdatedResult\");\n\t\t\t\t\tthis._option = option;\n\t\t\t\t\tthis._updatedOption = option; \n\t\t\t\t}\n\t\t\t}\n\t\t\tclass NoOptionResult extends BaseOptionResult {\n\t\t\t\tconstructor() {\n\t\t\t\t\tsuper(\"NoOptionResult\");\n\t\t\t\t\tthis._noOption = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t// #endregion\n\n\t\tclass SelectOptionController {\n\t\t\tconstructor() {}\n\n\t\t\t_changed() {\n\t\t\t\t_statusLine.refresh();\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Creates a new Option, adds it to _selVariables\n\t\t\t * @param {Variable} variable \n\t\t\t */\n\t\t\taddOption(variable) {\n\t\t\t\tvar option = this.makeOptionElement(variable);\n\t\t\t\tvar index = this.getOptionInsertIndex(variable);\n\t\t\t\t_selVariables.add(option, index);\n\t\t\t\tthis._changed();\n\t\t\t\treturn new OptionAddedResult(option);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Deletes the Option for the variable, if any\n\t\t\t * @param {Variable} variable \n\t\t\t */\n\t\t\tdeleteOption(variable) {\n\t\t\t\tvar option = this.getOptionByVariableName(variable.name, false);\n\t\t\t\tif (!option)\n\t\t\t\t\treturn new NoOptionResult();\n\t\t\t\tvar optionIndex = option.index;\n\t\t\t\toption.remove();\n\t\t\t\tthis._changed();\n\t\t\t\treturn new OptionDeletedIndexResult(optionIndex);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Finds and selects the Option for the specified variable.\n\t\t\t * If the variable is not currently selected, it will be selected.\n\t\t\t * If the variable is not available because of a filter, the filter will be cleared.\n\t\t\t * If the variable is hidden by the ViewMode, the ViewMode will be changed to \"all\".\n\t\t\t * @param {Variable} variable\n\t\t\t * @param {{dontThrowErrorIfNotFound: bool}} [options]\n\t\t\t * @returns {{optionWasAlreadySelected: bool, notFound: boolean}} \n\t\t\t */\n\t\t\tfindAndSelectOptionForVariable(variableName, options) {\n\n\t\t\t\tfunction findAndSelectOption(self) {\n\t\t\t\t\tvar option = self.getOptionByVariableName(variableName, false);\n\t\t\t\t\tif (option) {\n\t\t\t\t\t\tself.selectedIndex = option.index;\n\t\t\t\t\t\tshowCurrentlySelectedValue();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\n\t\t\t\ttry {\n\t\t\t\t\toptions = validateOptions(options, [\"dontThrowErrorIfNotFound\"]);\n\t\t\t\t\tvar selection = this.getSelection();\n\t\t\t\t\tif (selection && selection.variable.name === variableName)\n\t\t\t\t\t\treturn {optionWasAlreadySelected: true};\n\t\t\t\t\tif (findAndSelectOption(this))\n\t\t\t\t\t\treturn {optionWasAlreadySelected: false};\n\t\t\t\t\tif (clearSearchFilter() && findAndSelectOption(this))\n\t\t\t\t\t\treturn {optionWasAlreadySelected: false};\n\t\t\t\t\tif (_hiddenVariables.resetViewMode()) {\n\t\t\t\t\t\tif (findAndSelectOption(this))\n\t\t\t\t\t\t\treturn {optionWasAlreadySelected: false};\n\t\t\t\t\t}\n\t\t\t\t\tif (options.dontThrowErrorIfNotFound)\n\t\t\t\t\t\treturn { notFound: true };\n\t\t\t\t\tthrow new Error(`Can't find option for variable \"${variableName}\"`);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Finds the option for the specified variable name\n\t\t\t * @param {string} name the name to find.\n\t\t\t * @param {bool} [throwErrorIfNotFound] default true. Throw Error if not found.\n\t\t\t * @returns {HTMLOptionElement | null} the option for the specified variable name, or null unless error is thrown\n\t\t\t */\n\t\t\tgetOptionByVariableName(name, throwErrorIfNotFound) {\n\t\t\t\tthrowErrorIfNotFound = throwErrorIfNotFound != null ? throwErrorIfNotFound : true;\n\t\t\t\tvar result = Array.from(_selVariables.options).find(o => o.value === name);\n\t\t\t\tif (result)\n\t\t\t\t\treturn result;\n\t\t\t\tif (throwErrorIfNotFound)\n\t\t\t\t\tthrow new Error(`Logic Error: Could not find Option for variable named \"${name}\"`);\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Returns the index for where to insert this option, based on the current sort mode.\n\t\t\t * @param {Variable} variable \n\t\t\t * @returns {number}\n\t\t\t */\n\t\t\tgetOptionInsertIndex(variable) {\n\t\t\t\ttry {\n\t\t\t\t\tvar compare = _variableSortMode.getSortCompareFunction();\n\t\t\t\t\tfor (let i = 0; i < _selVariables.options.length; i++) {\n\t\t\t\t\t\tconst o = _selVariables.options[i];\n\t\t\t\t\t\tvar selVariable = _variables.getVariableByName(o.value).variable;\n\t\t\t\t\t\tif (compare(variable, selVariable) < 0)\n\t\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t\treturn _selVariables.options.length;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * Gets the variable for the SelectOption that is currently selected, if there is only one, otherwise null\n\t\t\t * @returns {Variable|null} selected variable, or null\n\t\t\t */\n\t\t\tgetSelectedVariable() {\n\t\t\t\tvar result = this.getSelection();\n\t\t\t\treturn result != null ? result.variable : null;\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * Gets information for the current selection, if there is only 1, else null\n\t\t\t * @returns {{option: HTMLOptionElement, variable: Variable, variableIndex: number}}\n\t\t\t */\n\t\t\tgetSelection() {\n\t\t\t\tvar options = _selVariables.selectedOptions;\n\t\t\t\tif (options.length !== 1)\n\t\t\t\t\treturn null;\n\t\t\t\tvar option = options[0];\n\t\t\t\tvar variableInfo = _variables.getVariableByName(option.value);\n\t\t\t\treturn {\n\t\t\t\t\toption: option,\n\t\t\t\t\tvariable: variableInfo.variable,\n\t\t\t\t\tvariableIndex: variableInfo.index\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Returns the number of variables currently selected.\n\t\t\t * @returns {number}\n\t\t\t */\n\t\t\tgetSelectionCount() { return _selVariables.selectedOptions.length; }\n\n\t\t\t/**\n\t\t\t * Gets information for all the current selections, or an empty array if none\n\t\t\t * @returns { {offScreenItemsCount: number, selections: {option: HTMLOptionElement, variable: Variable, index: number}[]}}\n\t\t\t */\n\t\t\tgetSelections() {\n\t\t\t\tfunction isElementInViewport (ele, container) {\n\t\t\t\t\tvar rect = ele.getBoundingClientRect();\n\t\t\t\t\tconst eleTop = rect.top;\n\t\t\t\t\tconst eleBottom = eleTop + rect.height;\n\t\t\t\t\tconst containerTop = container.offsetTop;\n\t\t\t\t\tconst containerBottom = containerTop + container.clientHeight;\n\t\t\t\t\treturn eleTop >= containerTop && eleBottom-4 <= containerBottom;\n\t\t\t\t}\n\t\t\n\t\t\t\tvar options = _selVariables.selectedOptions;\n\n\t\t\t\tvar result = {\n\t\t\t\t\toffScreenItemsCount: 0,\n\t\t\t\t\tselections: []\n\t\t\t\t};\n\t\t\t\tfor (let i = 0; i < options.length; i++) {\n\t\t\t\t\tconst option = options[i];\n\t\t\t\t\tif (!isElementInViewport(option, _selVariables))\n\t\t\t\t\t\tresult.offScreenItemsCount++;\n\t\t\t\t\tvar variableInfo = _variables.getVariableByName(option.value);\n\t\t\t\t\tresult.selections.push({\n\t\t\t\t\t\toption: option,\n\t\t\t\t\t\tvariable: variableInfo.variable,\n\t\t\t\t\t\tvariableIndex: variableInfo.index\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Returns the number of _selVariables options.\n\t\t\t * @returns {number}\n\t\t\t */\n\t\t\tget length() { return _selVariables.options.length; }\n\n\t\t\t/**\n\t\t\t * Creates a new option element for the specified variable. Does NOT add it to the collection.\n\t\t\t * @param {Variable} variable the variable\n\t\t\t * @returns {HTMLOptionElement}\n\t\t\t */\n\t\t\tmakeOptionElement(variable) {\n\t\t\t\tvar option = document.createElement(\"option\");\n\t\t\t\toption.text = _variables.getDisplayName(variable);\n\t\t\t\toption.value = variable.name;\n\t\t\t\tif (_hiddenVariables.viewMode === HiddenVariablesViewMode.all && _hiddenVariables.getVariableIsHidden(option.value))\n\t\t\t\t\toption.dataset.hiddenVariable = true;\n\t\t\t\treturn option;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Sets an option's \"selected\" to true or false\n\t\t\t * @param {HTMLOptionElement} option the option\n\t\t\t * @param {bool} select whether to select it or not\n\t\t\t */\n\t\t\tsetOptionIsSelected(option, select) {\n\t\t\t\toption.selected = select;\n\t\t\t\tthis._changed();\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Selects the option at this index, calls showCurrentlySelectedValue(), sets focus\n\t\t\t * @param {number} index \n\t\t\t */\n\t\t\tsetSelectedIndexAndRefresh(index) {\n\t\t\t\tthis.selectedIndex = index;\n\t\t\t\tshowCurrentlySelectedValue();\n\t\t\t\t_selVariables.focus();\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Gets the index of the currently-selected option, or -1 if none.\n\t\t\t * @returns {number}\n\t\t\t */\n\t\t\tget selectedIndex() { return _selVariables.selectedIndex; }\n\n\t\t\t/**\n\t\t\t * Sets the currently-selected index, which unselects everthing else.\n\t\t\t * Does NOT call \"showCurrentlySelectedValue\".\n\t\t\t * If the value is out of range (too large), it will be adjusted down\n\t\t\t * so as to select the last item, if any, or -1.\n\t\t\t * Setting this to -1 will cause everything to be unselected, and nothing gets selected.\n\t\t\t * @param {number} value\n\t\t\t */\n\t\t\tset selectedIndex(value) {\n\t\t\t\tif (value == null)\n\t\t\t\t\tvalue = -1;\n\t\t\t\t_selVariables.selectedIndex = Math.min(value, _selVariables.options.length - 1);\n\t\t\t\tthis._changed();\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * If the Option for this Variable is visible in this ViewMode,\n\t\t\t * then it is replaced with a refreshed version.\n\t\t\t * @param {Variable} variable \n\t\t\t */\n\t\t\tupdateOption(variable) {\n\t\t\t\tif (_hiddenVariables.getVariableIsHiddenInThisViewMode(variable.name))\n\t\t\t\t\treturn new NoOptionResult();\n\t\t\t\tvar option = this.getOptionByVariableName(variable.name);\n\t\t\t\tvar optionIndex = option.index;\n\t\t\t\tvar newOption = this.makeOptionElement(variable);\n\t\t\t\t_selVariables.add(newOption, optionIndex);\n\t\t\t\toption.remove();\n\t\t\t\tthis._changed();\n\t\t\t\treturn new OptionUpdatedResult(newOption);\n\t\t\t}\n\t\t}\n\t\t\n\t\tvar _selectOptions = new SelectOptionController();\n\t// #endregion\n\n\t// #region ======== VariableSortMode ========================\n\n\t\tclass VariableSortMode {\n\t\t\tconstructor() {\n\t\t\t\tthis._sortBySize = false;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * True if sort by size, false if sort by name.\n\t\t\t * @returns {bool}\n\t\t\t */\n\t\t\tget sortBySize() { return this._sortBySize; }\n\n\t\t\t/**\n\t\t\t * Sets sortBySize, changes the _btnSort glyph, and optionally refreshes _selVariables.\n\t\t\t * @param {bool} value \n\t\t\t * @param {bool} refresh whether to refresh\n\t\t\t */\n\t\t\tsetSortBySize(value, refresh) {\n\t\t\t\ttry {\n\t\t\t\t\tthis._sortBySize = value;\n\t\t\t\t\tvar selectedVariable = _selectOptions.getSelectedVariable();\n\t\t\t\t\t_btnSort.dataset.sortByName = !this._sortBySize;\n\t\t\t\t\tdocument.getElementById(\"btnSortTooltipText\").textContent = `Sorted by ${this._sortBySize ? \"Size\" : \"Name\"}`;\n\t\t\t\t\tif (refresh) {\n\t\t\t\t\t\tfillSelect();\n\t\t\t\t\t\tif (this._sortBySize && _userOptions.sortBySizeSelectsFirstVariable)\n\t\t\t\t\t\t\tsetSelectIndexAsync(0);\n\t\t\t\t\t\telse if (selectedVariable)\n\t\t\t\t\t\t\tsetSelectIndexAsync(_selectOptions.getOptionByVariableName(selectedVariable.name).index);\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tstatic sortCompareVariableNames(v1, v2) {\n\t\t\t\tvar s1 = v1.name.toLowerCase();\n\t\t\t\tvar s2 = v2.name.toLowerCase();\n\t\t\t\treturn s1 < s2 ? -1 : s1 > s2 ? 1 : 0;\n\t\t\t}\n\n\t\t\tstatic sortCompareVariableSizes(v1, v2) {\n\t\t\t\tvar v1Size = _variables.getVariableSize(v1);\n\t\t\t\tvar v2Size = _variables.getVariableSize(v2);\n\t\t\t\tvar result = v2Size < v1Size ? -1 : v2Size > v1Size ? 1 : 0;\n\t\t\t\tif (result !== 0)\n\t\t\t\t\treturn result;\n\t\t\t\treturn VariableSortMode.sortCompareVariableNames(v1, v2);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * @callback SortCompareFunction\n\t\t\t * @param value1\n\t\t\t * @param value2\n\t\t\t * @returns {number} -1, 0, or 1\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * Gets the sort compare function for the current sort mode.\n\t\t\t * @returns {SortCompareFunction}\n\t\t\t */\n\t\t\tgetSortCompareFunction() {\n\t\t\t\treturn this._sortBySize ? VariableSortMode.sortCompareVariableSizes : VariableSortMode.sortCompareVariableNames;\n\t\t\t}\n\t\t}\n\n\t\tconst _variableSortMode = new VariableSortMode();\n\t// #endregion\n\n\t// #region ======== Undo/Redo Stuff =========================\n\n\t\t// #region ======== Undo/Redo Types & Classes ===============\n\t\t\t\t\t\n\t\t\t/**\n\t\t\t * @readonly\n\t\t\t * @enum {string}\n\t\t\t */\n\t\t\tconst UndoRedoActionType = {\n\t\t\t\tadded: \"added\",\n\t\t\t\tchanged: \"changed\",\n\t\t\t\tdeleted: \"deleted\",\n\t\t\t\thidden: \"hidden\",\n\t\t\t\trenamed: \"renamed\",\n\t\t\t\tunhidden: \"unhidden\"\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * @readonly\n\t\t\t * @enum {string}\n\t\t\t */\n\t\t\tconst UndoRedoDictionaryActionType = {\n\t\t\t\tkeyAdded: \"keyAdded\",\n\t\t\t\tkeyChanged: \"keyChanged\",\n\t\t\t\tkeyDeleted: \"keyDeleted\",\n\t\t\t\tvalueChanged: \"valueChanged\"\n\t\t\t}\n\n\t\t\tfunction UndoRedoDictionaryKeyAddedAction(keyName) {\n\t\t\t\treturn {\n\t\t\t\t\tactionType: UndoRedoDictionaryActionType.keyAdded,\n\t\t\t\t\tkeyName: keyName\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tfunction UndoRedoDictionaryKeyChangedAction(keyName, newKeyName) {\n\t\t\t\treturn {\n\t\t\t\t\tactionType: UndoRedoDictionaryActionType.keyChanged,\n\t\t\t\t\tkeyName: keyName,\n\t\t\t\t\tnewKeyName: newKeyName\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tfunction UndoRedoDictionaryKeyDeletedAction(keyName, value) {\n\t\t\t\treturn {\n\t\t\t\t\tactionType: UndoRedoDictionaryActionType.keyDeleted,\n\t\t\t\t\tkeyName: keyName,\n\t\t\t\t\tvalue: value\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tfunction UndoRedoDictionaryValueChangedAction(keyName, value, newValue) {\n\t\t\t\treturn {\n\t\t\t\t\tactionType: UndoRedoDictionaryActionType.valueChanged,\n\t\t\t\t\tkeyName: keyName,\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tnewValue: newValue\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * @typedef {Object} VariableAddedAction\n\t\t\t * @property {UndoRedoActionType} actionType\n\t\t\t * @property {Variable} variable\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * @typedef {Object} VariableChangedAction\n\t\t\t * @property {UndoRedoActionType} actionType\n\t\t\t * @property {Variable} variable\n\t\t\t * @property {VariableValue} newValue\n\t\t\t * @property {UndoRedoDictionaryKeyAddedAction | UndoRedoDictionaryKeyChangedAction | UndoRedoDictionaryKeyDeletedAction | UndoRedoDictionaryValueChangedAction} [dictionaryAction]\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * @typedef {Object} VariableDeletedAction\n\t\t\t * @property {UndoRedoActionType} actionType\n\t\t\t * @property {Variable} variable\n\t\t\t * @property {bool} wasHidden\n\t\t\t * @property {number} groupNumber\n\t\t\t */\n\t\t\t\t\n\t\t\t/**\n\t\t\t * @typedef {Object} VariableHiddenAction\n\t\t\t * @property {UndoRedoActionType} actionType\n\t\t\t * @property {string} hiddenVariableName\n\t\t\t * @property {number} groupNumber\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * @typedef {Object} VariableRenamedAction\n\t\t\t * @property {UndoRedoActionType} actionType\n\t\t\t * @property {Variable} variable\n\t\t\t * @property {Variable} newVariable\n\t\t\t */\n\t\t// #endregion\n\n\t\tclass UndoRedoStack {\n\t\t\tconstructor() {\n\t\t\t\tthis._undoStack = [];\n\t\t\t\tthis._redoStack = [];\n\t\t\t\tthis._groupNumber = 1;\n\t\t\t}\n\n\t\t\t_getActionTypeDescription(action) {\n\t\t\t\tvar suffix = action.groupNumber ? \"s\" : \"\";\n\t\t\t\tswitch (action.actionType) {\n\t\t\t\t\tcase UndoRedoActionType.added:\n\t\t\t\t\t\treturn `Add Variable`;\n\t\t\t\t\tcase UndoRedoActionType.changed:\n\t\t\t\t\t\tif (action.dictionaryAction) {\n\t\t\t\t\t\t\tswitch (action.dictionaryAction.actionType) {\n\t\t\t\t\t\t\t\tcase UndoRedoDictionaryActionType.keyAdded:\n\t\t\t\t\t\t\t\t\treturn \"Add Dictionary Key\";\n\t\t\t\t\t\t\t\tcase UndoRedoDictionaryActionType.keyChanged:\n\t\t\t\t\t\t\t\t\treturn \"Change Dictionary Key\";\n\t\t\t\t\t\t\t\tcase UndoRedoDictionaryActionType.keyDeleted:\n\t\t\t\t\t\t\t\t\treturn \"Delete Dictionary Key\";\n\t\t\t\t\t\t\t\tcase UndoRedoDictionaryActionType.valueChanged:\n\t\t\t\t\t\t\t\t\treturn \"Change Dictionary Value\";\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tthrow new Error(`Unexpected undo dictionary action type \"${action.dictionaryAction.actionType}\"`);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn `Edit Variable`;\n\t\t\t\t\tcase UndoRedoActionType.deleted:\n\t\t\t\t\t\treturn `Delete Variable${suffix}`;\n\t\t\t\t\tcase UndoRedoActionType.hidden:\n\t\t\t\t\t\treturn `Hide Variable${suffix}`;\n\t\t\t\t\tcase UndoRedoActionType.renamed:\n\t\t\t\t\t\treturn `Rename Variable${suffix}`;\n\t\t\t\t\tcase UndoRedoActionType.unhidden:\n\t\t\t\t\t\treturn `UnHide Variable${suffix}`;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthrow new Error(`Unexpected undo action type \"${action.actionType}\"`);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t_logAction(functionName, action) {\n\t\t\t\tif (!_undoRedoStack_logging)\n\t\t\t\t\treturn;\n\t\t\t\tif (_undoRedoStack_logging === \"summary\")\n\t\t\t\t\tconsole.log(\"UndoRedoStack\", functionName, action);\n\t\t\t\telse\n\t\t\t\t\tconsole.log(\"UndoRedoStack\", functionName, action, this._undoStack, this._redoStack);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Logs the contents of the UndoStack and the RedoStack.\n\t\t\t */\n\t\t\tlogContents() {\n\t\t\t\tconsole.log(\"UndoRedoStack Stacks\", this._undoStack, this._redoStack);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Records when a variable is added\n\t\t\t * @param {Variable} variable the variable being added\n\t\t\t */\n\t\t\taddVariableAddedAction(variable) {\n\t\t\t\tthis._redoStack = [];\n\t\t\t\tvar action = {\n\t\t\t\t\tactionType: UndoRedoActionType.added,\n\t\t\t\t\tvariable: variable.clone(),\n\t\t\t\t}\n\t\t\t\tthis._undoStack.push(action);\n\t\t\t\tthis._logAction(fname(), action);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Records when a variable is changed\n\t\t\t * @param {Variable} variable the variable being affected\n\t\t\t * @param {VariableValue} newValue the value that's about to be applied\n\t\t\t * @param {UndoRedoDictionaryKeyAddedAction | UndoRedoDictionaryKeyChangedAction | UndoRedoDictionaryKeyDeletedAction | UndoRedoDictionaryValueChangedAction} [dictionaryAction] info about how a dictionary was changed\n\t\t\t */\n\t\t\taddValueChangedAction(variable, newValue, dictionaryAction) {\n\t\t\t\tthis._redoStack = [];\n\t\t\t\tvar action = {\n\t\t\t\t\tactionType: UndoRedoActionType.changed,\n\t\t\t\t\tvariable: variable.clone(),\n\t\t\t\t\tnewValue: newValue,\n\t\t\t\t\tdictionaryAction: dictionaryAction\n\t\t\t\t}\n\t\t\t\tthis._undoStack.push(action);\n\t\t\t\tthis._logAction(fname(), action);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Records when a variable is deleted\n\t\t\t * @param {Variable} variable the variable being deleted\n\t\t\t * @param {bool} wasHidden whether the variable was hidden or not\n\t\t\t * @param {number} [groupNumber] the group number, if any\n\t\t\t */\n\t\t\taddVariableDeletedAction(variable, wasHidden, groupNumber) {\n\t\t\t\tthis._redoStack = [];\n\t\t\t\tvar action = {\n\t\t\t\t\tactionType: UndoRedoActionType.deleted,\n\t\t\t\t\tvariable: variable.clone(),\n\t\t\t\t\twasHidden: wasHidden,\n\t\t\t\t\tgroupNumber: groupNumber\n\t\t\t\t}\n\t\t\t\tthis._undoStack.push(action);\n\t\t\t\tthis._logAction(fname(), action);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Records when a variable is hidden\n\t\t\t * @param {string} hiddenVariableName the name of the variable that is being hidden\n\t\t\t * @param {bool} hidden whether the variable was hidden, or unhidden\n\t\t\t * @param {number} [groupNumber] the group number, if any\n\t\t\t */\n\t\t\taddVariableHiddenAction(hiddenVariableName, hidden, groupNumber) {\n\t\t\t\tthis._redoStack = [];\n\t\t\t\tvar action = {\n\t\t\t\t\tactionType: hidden ? UndoRedoActionType.hidden : UndoRedoActionType.unhidden,\n\t\t\t\t\thiddenVariableName: hiddenVariableName,\n\t\t\t\t\tgroupNumber: groupNumber\n\t\t\t\t};\n\t\t\t\tthis._undoStack.push(action);\n\t\t\t\tthis._logAction(fname(), action);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Records when a variable is renamed\n\t\t\t * @param {Variable} variable the variable being affected\n\t\t\t * @param {Variable} newVariable the renamed variable\n\t\t\t */\n\t\t\taddVariableRenamedAction(variable, newVariable) {\n\t\t\t\tthis._redoStack = [];\n\t\t\t\tvar action = {\n\t\t\t\t\tactionType: UndoRedoActionType.renamed,\n\t\t\t\t\tvariable: variable.clone(),\n\t\t\t\t\tnewVariable: newVariable.clone()\n\t\t\t\t}\n\t\t\t\tthis._undoStack.push(action);\n\t\t\t\tthis._logAction(fname(), action);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Clears the Undo and Redo Stacks\n\t\t\t */\n\t\t\tclear() {\n\t\t\t\tthis._undoStack = [];\n\t\t\t\tthis._redoStack = [];\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Returns the next GroupNumber. Use this when doing something\n\t\t\t * to multiple variables at a time.\n\t\t\t * @returns {number} the next group number\n\t\t\t */\n\t\t\tgetNextGroupNumber() {\n\t\t\t\treturn this._groupNumber++;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Returns the Undo Tooltip Text\n\t\t\t * @returns {string}\n\t\t\t */\n\t\t\tgetUndoTooltip() {\n\t\t\t\tif (this._undoStack.length === 0)\n\t\t\t\t\treturn \"Undo\";\n\n\t\t\t\tvar undoAction = this._undoStack[this._undoStack.length-1];\n\t\t\t\treturn `Undo ${this._getActionTypeDescription(undoAction)}`;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Returns the Redo Tooltip Text\n\t\t\t * @returns {string}\n\t\t\t */\n\t\t\t getRedoTooltip() {\n\t\t\t\tif (this._redoStack.length === 0)\n\t\t\t\t\treturn \"Redo\";\n\n\t\t\t\tvar redoAction = this._redoStack[this._redoStack.length-1];\n\t\t\t\treturn `Redo ${this._getActionTypeDescription(redoAction)}`;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Returns true if the undo stack is empty.\n\t\t\t * @returns {bool}\n\t\t\t */\n\t\t\tundoStackIsEmpty() {\n\t\t\t\treturn this._undoStack.length === 0;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Returns true if the redo stack is empty.\n\t\t\t * @returns {bool}\n\t\t\t */\n\t\t\t redoStackIsEmpty() {\n\t\t\t\treturn this._redoStack.length === 0;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Pops the last Action from the Undo Stack, puts it on the Redo Stack, and returns it.\n\t\t\t * @returns {VariableAddedAction | VariableChangedAction | VariableDeletedAction | VariableHiddenAction | VariableRenamedAction}\n\t\t\t */\n\t\t\tpopUndoStack() {\n\t\t\t\tif (this._undoStack.length === 0)\n\t\t\t\t\tthrow new Error(`popUndoStack() called when the stack was empty`);\n\t\t\t\tvar undoItem = this._undoStack.pop();\n\t\t\t\tvar redoItem = undoItem.clone();\n\t\t\t\tthis._redoStack.push(redoItem);\n\t\t\t\treturn undoItem;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Pops the last Undo Action and returns it, if it's for the specified groupNumber.\n\t\t\t * If groupNumber is null, this always returns null.\n\t\t\t * @param {number} [groupNumber ]\n\t\t\t * @returns {VariableAddedAction | VariableChangedAction | VariableDeletedAction | VariableHiddenAction | VariableRenamedAction}\n\t\t\t */\n\t\t\tpopNextUndoInGroup(groupNumber) {\n\t\t\t\tif (!groupNumber)\n\t\t\t\t\treturn null;\n\t\t\t\tif (this._undoStack.length === 0)\n\t\t\t\t\treturn null;\n\t\t\t\tif (this._undoStack[this._undoStack.length - 1].groupNumber !== groupNumber)\n\t\t\t\t\treturn null;\n\t\t\t\treturn this.popUndoStack();\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Pops the last Action from the Redo Stack, puts it on the Undo Stack, and returns it.\n\t\t\t * @returns {VariableAddedAction | VariableChangedAction | VariableDeletedAction | VariableHiddenAction | VariableRenamedAction}\n\t\t\t */\n\t\t\t popRedoStack() {\n\t\t\t\tif (this._redoStack.length === 0)\n\t\t\t\t\tthrow new Error(`popRedoStack() called when the stack was empty`);\n\t\t\t\tvar redoItem = this._redoStack.pop();\n\t\t\t\tvar undoItem = redoItem.clone();\n\t\t\t\tthis._undoStack.push(undoItem);\n\t\t\t\treturn redoItem;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Pops the last Redo Action and returns it, if it's for the specified groupNumber.\n\t\t\t * If groupNumber is null, this always returns null.\n\t\t\t * @param {number} [groupNumber]\n\t\t\t * @returns {VariableAddedAction | VariableChangedAction | VariableDeletedAction | VariableHiddenAction | VariableRenamedAction}\n\t\t\t */\n\t\t\t popNextRedoInGroup(groupNumber) {\n\t\t\t\tif (!groupNumber)\n\t\t\t\t\treturn null;\n\t\t\t\tif (this._redoStack.length === 0)\n\t\t\t\t\treturn null;\n\t\t\t\tif (this._redoStack[this._redoStack.length - 1].groupNumber !== groupNumber)\n\t\t\t\t\treturn null;\n\t\t\t\treturn this.popRedoStack();\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * @type {UndoRedoStack}\n\t\t */\n\t\tvar _undoRedoStack;\n\n\t\tfunction showOffScreenSelectedItemsWarning() {\n\t\t\tvar msgs = [];\n\t\t\tif (_selectOptions.getSelections().offScreenItemsCount > 0)\n\t\t\t\tmsgs.push(\"Some selections are scrolled out of view.\");\n\t\t\tif (msgs.length > 0)\n\t\t\t\t_floatingWarning.show(msgs.join(\"\\n\"));\n\t\t}\n\n\t\tfunction btnRedoClicked() {\n\n\t\t\t/**\n\t\t\t * Redoes a Variable Add\n\t\t\t * @param {VariableAddedAction} action \n\t\t\t */\n\t\t\tfunction redoAdded(action) {\n\t\t\t\ttry {\n\t\t\t\t\tclearSearchFilter();\n\t\t\t\t\t_hiddenVariables.resetViewMode();\n\t\t\t\t\tvar result = _variables.addVariable(action.variable);\n\t\t\t\t\tif (!result.hasOption)\n\t\t\t\t\t\tthrow new Error(`Couldn't find the Option after addVariable`);\n\n\t\t\t\t\t_selectOptions.selectedIndex = result.option.index;\n\t\t\t\t\tshowCurrentlySelectedValue();\n\t\t\t\t\t_selVariables.focus();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Redoes a Variable Change\n\t\t\t * @param {VariableChangedAction} action \n\t\t\t */\n\t\t\tfunction redoChange(action) {\n\n\t\t\t\tfunction redoDictionaryKeyAdded() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t_dictionaryHelper.addKeyAndRowForUndelete(action.dictionaryAction.keyName, action.dictionaryAction.value);\n\t\t\t\t\t\tenableControls();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction redoDictionaryChange() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar variable = _variables.getVariableByName(action.variable.name).variable;\n\t\n\t\t\t\t\t\tvar dictAction = action.dictionaryAction;\n\t\t\t\t\t\tvar dictActionType = dictAction.actionType;\n\t\n\t\t\t\t\t\tvar findOptions = {};\n\t\t\t\t\t\tswitch (dictActionType) {\n\t\t\t\t\t\t\tcase UndoRedoDictionaryActionType.keyChanged:\n\t\t\t\t\t\t\t\tfindOptions.highlightKeyCell = true;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase UndoRedoDictionaryActionType.valueChanged:\n\t\t\t\t\t\t\t\tfindOptions.highlightValueCell = true;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar findResult = _dictionaryHelper.findAndSelectKeyCell(action.variable.name, dictAction.keyName, findOptions);\n\t\n\t\t\t\t\t\t// We have to do this After the row was selected, or the grid won't contain the current values.\n\t\t\t\t\t\t_variables.changeVariable(variable, action.newValue, {noOptionElement: true});\n\t\n\t\t\t\t\t\tvar keyCell = findResult.cell;\n\t\t\t\t\t\tif (findResult.optionWasAlreadySelected) {\n\t\t\t\t\t\t\t// Since the option was already selected, we need to update the controls,\n\t\t\t\t\t\t\t// so the Undo/Redo buttons reflect their new status.\n\t\t\t\t\t\t\tenableControls();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tswitch (dictActionType) {\n\t\t\t\t\t\t\tcase UndoRedoDictionaryActionType.keyDeleted:\n\t\t\t\t\t\t\t\t_dictionaryHelper.deleteKeyAndRowAsync(keyCell);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase UndoRedoDictionaryActionType.keyChanged:\n\t\t\t\t\t\t\t\tkeyCell.value = dictAction.newKeyName;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase UndoRedoDictionaryActionType.valueChanged:\n\t\t\t\t\t\t\t\t_dictionaryHelper.getRowValueCellContentElement(keyCell.row).innerText = dictAction.newValue;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tthrow new Error(`Unexpected DictionaryActionType: \"${dictActionType}\"`);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\t_selectOptions.findAndSelectOptionForVariable(action.variable.name);\n\n\t\t\t\t\tif (action.dictionaryAction) {\n\t\t\t\t\t\tif (action.dictionaryAction.actionType === UndoRedoDictionaryActionType.keyAdded)\n\t\t\t\t\t\t\tredoDictionaryKeyAdded();\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tredoDictionaryChange();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar variable = _variables.getVariableByName(action.variable.name).variable;\n\t\t\t\t\tvar result = _variables.changeVariable(variable, action.newValue);\n\t\t\t\t\tif (result.hasUpdatedOption)\n\t\t\t\t\t\t_selectOptions.setSelectedIndexAndRefresh(result.updatedOption.index);\n\t\t\t\t\telse\n\t\t\t\t\t\tenableControls();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Redoes a Variable Delete\n\t\t\t * @param {VariableDeletedAction} action \n\t\t\t * @returns {bool} returns true if any of the affected variables\n\t\t\t * are hidden due to the current ViewMode.\n\t\t\t */\n\t\t\tfunction redoDelete(action) {\n\t\t\t\ttry {\n\t\t\t\t\tclearSearchFilter();\n\t\t\t\t\t_hiddenVariables.resetViewMode();\n\t\t\t\t\tvar optionIndex = null;\n\t\t\t\t\tdo {\n\t\t\t\t\t\tif (_hiddenVariables.getVariableIsHidden(action.variable.name))\n\t\t\t\t\t\t\t_hiddenVariables.setVariableIsHidden(action.variable.name, false);\n\t\t\t\t\t\tvar result = _variables.deleteVariable(action.variable);\n\t\t\t\t\t\tif (result.hasDeletedOptionIndex) {\n\t\t\t\t\t\t\tif (optionIndex == null)\n\t\t\t\t\t\t\t\toptionIndex = result.deletedOptionIndex;\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\toptionIndex = Math.min(optionIndex, result.deletedOptionIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t\taction = _undoRedoStack.popNextRedoInGroup(action.groupNumber);\n\t\t\t\t\t} while (action != null);\n\t\n\t\t\t\t\tif (optionIndex != null)\n\t\t\t\t\t\t_selectOptions.setSelectedIndexAndRefresh(optionIndex);\n\t\t\t\t\telse {\n\t\t\t\t\t\tshowCurrentlySelectedValue();\n\t\t\t\t\t\t_selVariables.focus();\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Redoes the Hide or Unhide action\n\t\t\t * @param {VariableHiddenAction} action\n\t\t\t * @param {bool} hide \n\t\t\t * @returns {bool} returns true if any of the affected variables\n\t\t\t * are hidden due to the current ViewMode.\n\t\t\t */\n\t\t\tfunction redoHide(action, hide) {\n\t\t\t\ttry {\n\t\t\t\t\tclearSearchFilter();\n\t\t\t\t\t_hiddenVariables.resetViewMode();\n\t\t\t\t\t_selectOptions.selectedIndex = -1;\n\t\t\t\t\tdo {\n\t\t\t\t\t\tvar variable = _variables.getVariableByName(action.hiddenVariableName).variable;\n\t\n\t\t\t\t\t\tvar result = hideVariable(variable, hide, {throwErrorIfOptionNotFound: true});\n\t\t\t\t\t\t_selectOptions.setOptionIsSelected(result.option, true);\n\t\n\t\t\t\t\t\taction = _undoRedoStack.popNextRedoInGroup(action.groupNumber);\n\t\t\t\t\t} while (action != null);\n\t\n\t\t\t\t\tshowCurrentlySelectedValue();\n\t\t\t\t\t_selVariables.focus();\n\t\t\t\t\tshowOffScreenSelectedItemsWarning();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Redoes the Rename action\n\t\t\t * @param {VariableRenamedAction} action \n\t\t\t */\n\t\t\t function redoRename(action) {\n\t\t\t\ttry {\n\t\t\t\t\t_selectOptions.findAndSelectOptionForVariable(action.variable.name);\n\t\t\t\t\t_variables.renameVariable(action.variable, _variables.getActualVariableName(action.newVariable));\n\t\t\t\t\t_selectOptions.findAndSelectOptionForVariable(action.action.newVariable.name);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tif (_undoRedoStack.redoStackIsEmpty()) {\n\t\t\t\t\tconsole.log(`redoStackIsEmpty()`);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tclearSearchFilter();\n\t\t\t\t_hiddenVariables.resetViewMode();\n\t\t\t\tvar action = _undoRedoStack.popRedoStack();\n\t\t\t\tswitch (action.actionType) {\n\t\t\t\t\tcase UndoRedoActionType.added:\n\t\t\t\t\t\tredoAdded(action);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase UndoRedoActionType.changed:\n\t\t\t\t\t\tredoChange(action);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase UndoRedoActionType.deleted:\n\t\t\t\t\t\tredoDelete(action);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase UndoRedoActionType.hidden:\n\t\t\t\t\t\tredoHide(action, true);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase UndoRedoActionType.renamed:\n\t\t\t\t\t\tredoRename(action);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase UndoRedoActionType.unhidden:\n\t\t\t\t\t\tredoHide(action, false);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthrow new Error(`Logic error: Unknown Redo Action Type: \"${action.actionType}\"`);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tfunction btnUndoClicked() {\n\n\t\t\t/**\n\t\t\t * Undoes the Added action\n\t\t\t * @param {VariableAddedAction} action \n\t\t\t */\n\t\t\tfunction undoAdd(action) {\n\t\t\t\ttry {\n\t\t\t\t\t_selectOptions.findAndSelectOptionForVariable(action.variable.name);\n\t\t\t\t\tif (_hiddenVariables.getVariableIsHidden(action.variable.name))\n\t\t\t\t\t\t_hiddenVariables.setVariableIsHidden(action.variable.name, false);\n\t\t\t\t\tvar optionIndex = null;\n\t\t\t\t\tvar result = _variables.deleteVariable(action.variable);\n\t\t\t\t\tif (result.hasDeletedOptionIndex) {\n\t\t\t\t\t\tif (optionIndex == null)\n\t\t\t\t\t\t\toptionIndex = result.deletedOptionIndex;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\toptionIndex = Math.min(optionIndex, result.deletedOptionIndex);\n\t\t\t\t\t}\n\t\t\t\t\tif (optionIndex != null)\n\t\t\t\t\t\t_selectOptions.setSelectedIndexAndRefresh(optionIndex);\n\t\t\t\t\telse\n\t\t\t\t\t\tshowCurrentlySelectedValue();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Undoes the Changed action\n\t\t\t * @param {VariableChangedAction} action \n\t\t\t */\n\t\t\tfunction undoChange(action) {\n\n\t\t\t\tfunction undoDictionaryKeyDeleted() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t_dictionaryHelper.addKeyAndRowForUndelete(action.dictionaryAction.keyName, action.dictionaryAction.value);\n\n\t\t\t\t\t\t// Make sure the Undo/Redo butttons get updated properly\n\t\t\t\t\t\tenableControls();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction undoDictionaryChange() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar variable = _variables.getVariableByName(action.variable.name).variable;\n\t\n\t\t\t\t\t\tvar dictAction = action.dictionaryAction;\n\t\t\t\t\t\tvar dictActionType = dictAction.actionType;\n\t\n\t\t\t\t\t\tvar findKeyName = dictActionType === UndoRedoDictionaryActionType.keyChanged ? dictAction.newKeyName : dictAction.keyName;\n\n\t\t\t\t\t\tvar findOptions = {};\n\t\t\t\t\t\tswitch (dictActionType) {\n\t\t\t\t\t\t\tcase UndoRedoDictionaryActionType.keyChanged:\n\t\t\t\t\t\t\t\tfindOptions.highlightKeyCell = true;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase UndoRedoDictionaryActionType.valueChanged:\n\t\t\t\t\t\t\t\tfindOptions.highlightValueCell = true;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar findResult = _dictionaryHelper.findAndSelectKeyCell(action.variable.name, findKeyName, findOptions);\n\t\n\t\t\t\t\t\t// We have to do this After the row was selected, or the grid won't contain the current values.\n\t\t\t\t\t\t_variables.changeVariable(variable, action.variable.value, {noOptionElement: true});\n\t\n\t\t\t\t\t\tvar keyCell = findResult.cell;\n\t\t\t\t\t\tif (findResult.optionWasAlreadySelected) {\n\t\t\t\t\t\t\t// Since the option was already selected, we need to update the controls,\n\t\t\t\t\t\t\t// so the Undo/Redo buttons reflect their new status.\n\t\t\t\t\t\t\tenableControls();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tswitch (dictActionType) {\n\t\t\t\t\t\t\tcase UndoRedoDictionaryActionType.keyAdded:\n\t\t\t\t\t\t\t\t_dictionaryHelper.deleteKeyAndRowAsync(keyCell);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase UndoRedoDictionaryActionType.keyChanged:\n\t\t\t\t\t\t\t\tkeyCell.value = dictAction.keyName;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase UndoRedoDictionaryActionType.valueChanged:\n\t\t\t\t\t\t\t\t_dictionaryHelper.getRowValueCellContentElement(keyCell.row).innerText = dictAction.value;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tthrow new Error(`Unexpected DictionaryActionType: \"${dictActionType}\"`);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\t_selectOptions.findAndSelectOptionForVariable(action.variable.name);\n\n\t\t\t\t\tif (action.dictionaryAction) {\n\t\t\t\t\t\tif (action.dictionaryAction.actionType === UndoRedoDictionaryActionType.keyDeleted)\n\t\t\t\t\t\t\tundoDictionaryKeyDeleted();\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tundoDictionaryChange();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar variable = _variables.getVariableByName(action.variable.name).variable;\n\t\t\t\t\tvar result = _variables.changeVariable(variable, action.variable.value);\n\t\t\t\t\tif (result.hasUpdatedOption)\n\t\t\t\t\t\t_selectOptions.setSelectedIndexAndRefresh(result.updatedOption.index);\n\t\t\t\t\telse\n\t\t\t\t\t\tenableControls();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Undoes the Delete action(s)\n\t\t\t * @param {VariableDeletedAction} action \n\t\t\t * @returns {bool} returns true if any of the affected variables\n\t\t\t * are hidden due to the current ViewMode.\n\t\t\t */\n\t\t\tfunction undoDelete(action) {\n\t\t\t\ttry {\n\t\t\t\t\tclearSearchFilter();\n\t\t\t\t\t_hiddenVariables.resetViewMode();\n\t\t\t\t\t_selectOptions.selectedIndex = -1;\n\t\t\t\t\tdo {\n\t\t\t\t\t\tif (action.wasHidden)\n\t\t\t\t\t\t\t_hiddenVariables.setVariableIsHidden(action.variable.name, true);\n\t\t\t\t\t\tvar result = _variables.addVariable(action.variable);\n\t\t\t\t\t\tif (!result.hasOption)\n\t\t\t\t\t\t\tthrow new Error(`Couldn't find the Option after addVariable`);\n\t\t\t\t\t\tif (_selectOptions.selectedIndex < 0)\n\t\t\t\t\t\t\t_selectOptions.selectedIndex = result.option.index;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\t_selectOptions.setOptionIsSelected(result.option, true);\n\t\n\t\t\t\t\t\taction = _undoRedoStack.popNextUndoInGroup(action.groupNumber);\n\t\t\t\t\t} while (action != null);\n\t\n\t\t\t\t\tshowCurrentlySelectedValue();\n\t\t\t\t\t_selVariables.focus();\n\t\t\t\t\tshowOffScreenSelectedItemsWarning();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * @param {VariableHiddenAction} action\n\t\t\t * @param {bool} hide \n\t\t\t * @returns {bool} returns true if any of the affected variables\n\t\t\t * are hidden due to the current ViewMode.\n\t\t\t */\n\t\t\tfunction undoHide(action, hide) {\n\t\t\t\ttry {\n\t\t\t\t\tclearSearchFilter();\n\t\t\t\t\t_hiddenVariables.resetViewMode();\n\t\t\t\t\t_selectOptions.selectedIndex = -1;\n\t\t\t\t\tdo {\n\t\t\t\t\t\tvar variable = _variables.getVariableByName(action.hiddenVariableName).variable;\n\t\n\t\t\t\t\t\tvar result = hideVariable(variable, !hide, {throwErrorIfOptionNotFound: true});\n\t\t\t\t\t\tif (_selectOptions.selectedIndex < 0)\n\t\t\t\t\t\t\t_selectOptions.selectedIndex = result.option.index;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\t_selectOptions.setOptionIsSelected(result.option, true);\n\t\n\t\t\t\t\t\taction = _undoRedoStack.popNextUndoInGroup(action.groupNumber);\n\t\t\t\t\t} while (action != null);\n\t\n\t\t\t\t\tshowCurrentlySelectedValue();\n\t\t\t\t\t_selVariables.focus();\n\t\t\t\t\tshowOffScreenSelectedItemsWarning();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Undoes the Rename action\n\t\t\t * @param {VariableRenamedAction} action \n\t\t\t */\n\t\t\tfunction undoRename(action) {\n\t\t\t\ttry {\n\t\t\t\t\t_selectOptions.findAndSelectOptionForVariable(action.newVariable.name);\n\t\t\t\t\tvar result = _variables.renameVariable(action.newVariable, _variables.getActualVariableName(action.variable));\n\t\t\t\t\tif (result.hasOption)\n\t\t\t\t\t\t_selectOptions.setSelectedIndexAndRefresh(result.option.index);\n\t\t\t\t\telse\n\t\t\t\t\t\t_selectOptions.findAndSelectOptionForVariable(action.variable.name);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tif (_undoRedoStack.undoStackIsEmpty())\n\t\t\t\t\treturn;\n\n\t\t\t\tvar action = _undoRedoStack.popUndoStack();\n\t\t\t\tswitch (action.actionType) {\n\t\t\t\t\tcase UndoRedoActionType.added:\n\t\t\t\t\t\tundoAdd(action);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase UndoRedoActionType.changed:\n\t\t\t\t\t\tundoChange(action);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase UndoRedoActionType.deleted:\n\t\t\t\t\t\tundoDelete(action);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase UndoRedoActionType.hidden:\n\t\t\t\t\t\tundoHide(action, true);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase UndoRedoActionType.renamed:\n\t\t\t\t\t\tundoRename(action);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase UndoRedoActionType.unhidden:\n\t\t\t\t\t\tundoHide(action, false);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthrow new Error(`Logic error: Unknown Undo Action Type: \"${action.actionType}\"`);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t// #endregion\n\n\t// #region ======== HiddenVariables stuff ===================\n\n\t\t/**\n\t\t * @readonly\n\t\t * @enum {string}\n\t\t */\n\t\tconst HiddenVariablesViewMode = {\n\t\t\tall: \"all\",\n\t\t\thide: \"hide\",\n\t\t\tonly: \"only\",\n\t\t\tvalues: []\n\t\t};\n\t\tHiddenVariablesViewMode.values = Object.keys(HiddenVariablesViewMode).filter(v => v !== \"values\");\n\n\t\tclass HiddenVariablesController {\n\t\t\tconstructor() {\n\t\t\t\tthis._enabled = false;\n\t\t\t\tthis._name = \"hiddenVariables\";\n\t\t\t\tthis._value = [];\n\t\t\t}\n\n\t\t\tloadContent() {\n\t\t\t\ttry {\n\t\t\t\t\tthis._value = _variables.getKMAppDataVariableValue(this._name) || [];\n\t\t\t\t\tthis._viewMode = HiddenVariablesViewMode.hide;\n\t\t\t\t\tthis._enabled = true;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdisable() {\n\t\t\t\tthis._enabled = false;\n\t\t\t}\n\n\t\t\tget enabled() { return this._enabled; }\n\t\t\tset enabled(value) { \n\t\t\t\tif (value == this._enabled)\n\t\t\t\t\treturn;\n\t\t\t\tthis._enabled = value == true;\n\t\t\t\tif (value)\n\t\t\t\t\tthis.loadContent();\n\t\t\t}\n\n\t\t\t// // Members to mimic a \"Variable\" object\n\t\t\t// get isHiddenVariables() { return true; }\n\t\t\t// get name() { return this._name }\n\t\t\t// get value() { return this._value; }\n\t\t\t// set value(value) { this._value = value; }\n\n\t\t\t// Other Members\n\t\t\tgetSelectedVariablesToggleShouldHide(selections) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!this.enabled)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tif (selections === undefined)\n\t\t\t\t\t\tselections = _selectOptions.getSelections().selections;\n\t\t\t\t\tif (!selections || selections.length === 0)\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\tvar hidden = selections.find(sel => {\n\t\t\t\t\t\treturn this.getVariableIsHidden(sel.variable.name);\n\t\t\t\t\t});\n\t\t\t\t\treturn hidden == null;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tareAnyVariablesHiddenInThisViewMode() {\n\t\t\t\ttry {\n\t\t\t\t\tif (!this._enabled || this._viewMode != HiddenVariablesViewMode.hide)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\treturn _variables.data.find(variable => this.getVariableIsHidden(variable.name)) != null;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tgetNumberOfHiddenVariablesInThisViewMode() {\n\t\t\t\tif (!this._enabled || this._viewMode != HiddenVariablesViewMode.hide)\n\t\t\t\t\treturn 0;\n\t\t\t\treturn _variables.data.filter(variable => this.getVariableIsHidden(variable.name)).length;\n\t\t\t}\n\n\t\t\tgetVariableIsHiddenInThisViewMode(name) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!this._enabled)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tswitch (this._viewMode) {\n\t\t\t\t\t\tcase HiddenVariablesViewMode.hide:\n\t\t\t\t\t\t\treturn this.getVariableIsHidden(name);\n\t\t\t\t\t\tcase HiddenVariablesViewMode.only:\n\t\t\t\t\t\t\treturn !this.getVariableIsHidden(name);\n\t\t\t\t\t\tcase HiddenVariablesViewMode.all:\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tthrow new Error(`Unexpected viewMode: \"${this._viewMode}\"`);\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tgetVariableIsHidden(name) { \n\t\t\t\tif (!this._enabled)\n\t\t\t\t\treturn false;\n\t\t\t\treturn this._value.indexOf(name) >= 0;\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Saves the content to KM, but there's no need to call this yourself -\n\t\t\t * it's called automatically when needed.\n\t\t\t */\n\t\t\tsaveContent() {\n\t\t\t\ttry {\n\t\t\t\t\tif (this.enabled)\n\t\t\t\t\t\t_variables.saveKMAppDataVariableValue(this._name, this._value);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Hides/unhides a variable. Result is stored to KM immediately.\n\t\t\t * @param {string} name \n\t\t\t * @param {bool} hidden\n\t\t\t * @returns \n\t\t\t */\n\t\t\tsetVariableIsHidden(name, hidden) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!this._enabled)\n\t\t\t\t\t\treturn;\n\t\t\t\t\tif (hidden)\n\t\t\t\t\t\tthis._value.push(name);\n\t\t\t\t\telse {\n\t\t\t\t\t\tlet i = this._value.indexOf(name);\n\t\t\t\t\t\tif (i < 0)\n\t\t\t\t\t\t\tthrow new Error(`Could not find variable \"${variable.name}\" in setVariableIsHidden`)\n\t\t\t\t\t\tthis._value.splice(i, 1);\n\t\t\t\t\t}\n\t\t\t\t\tthis.saveContent();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Gets the viewMode.\n\t\t\t * @type {HiddenVariablesViewMode} \n\t\t\t */\n\t\t\tget viewMode() { return this._enabled ? this._viewMode : HiddenVariablesViewMode.all; }\n\n\t\t\t/**\n\t\t\t * Sets viweMode to HiddenVariablesViewMode.all. If the view mode was changed, fillSelect() is called.\n\t\t\t * @returns {bool} true if the viewMode changed, false if it didn't.\n\t\t\t */\n\t\t\tresetViewMode() {\n\t\t\t\treturn this.setViewMode(HiddenVariablesViewMode.all);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Sets the viewMode. If the view mode was changed, fillSelect() is called.\n\t\t\t * @param {HiddenVariablesViewMode} mode \n\t\t\t * @returns {bool} true if the viewMode changed, false if it didn't.\n\t\t\t */\n\t\t\tsetViewMode(mode, log) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!this._enabled)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tif (HiddenVariablesViewMode.values.indexOf(mode) < 0)\n\t\t\t\t\t\tthrow new Error(`Invalid viewMode \"${mode}\"`);\n\t\t\t\t\tif (mode === this._viewMode)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tthis._viewMode = mode;\n\t\t\t\t\tfillSelect();\n\t\t\t\t\treturn true;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttoggleViewMode() {\n\t\t\t\ttry {\n\t\t\t\t\tif (!this._enabled)\n\t\t\t\t\t\treturn;\n\t\t\t\t\tvar i = HiddenVariablesViewMode.values.indexOf(this._viewMode);\n\t\t\t\t\tif (i < 0)\n\t\t\t\t\t\tthrow new Error(`Unknown viewMode: \"${this.viewMode}\"`);\n\t\t\t\t\ti += 1;\n\t\t\t\t\tif (i >= HiddenVariablesViewMode.values.length)\n\t\t\t\t\t\ti = 0;\n\t\t\t\t\tthis.setViewMode(HiddenVariablesViewMode.values[i]);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tvar _hiddenVariables = new HiddenVariablesController();\n\n\t\t/**\n\t\t * @param {Variable} variable\n\t\t * @param {bool} hide True to hide, false to un-hide\n\t\t * @param {{saveUndo: bool, undoGroupNumber: number, throwErrorIfOptionNotFound: bool}} [options]\n\t\t */\n\t\tfunction hideVariable(variable, hide, options) {\n\t\t\ttry {\n\t\t\t\toptions = validateOptions(options, [\"saveUndo\", \"undoGroupNumber\", \"throwErrorIfOptionNotFound\"]);\n\n\t\t\t\t_hiddenVariables.setVariableIsHidden(variable.name, hide);\n\t\t\t\tif (options.saveUndo)\n\t\t\t\t\t_undoRedoStack.addVariableHiddenAction(variable.name, hide, options.undoGroupNumber);\n\n\t\t\t\tif (_hiddenVariables.getVariableIsHiddenInThisViewMode(variable.name))\n\t\t\t\t\treturn _selectOptions.deleteOption(variable, options.refreshSelection);\n\t\t\t\tif (_selectOptions.getOptionByVariableName(variable.name, options.throwErrorIfOptionNotFound === true))\n\t\t\t\t\treturn _selectOptions.updateOption(variable);\n\t\t\t\treturn _selectOptions.addOption(variable, options.refreshSelection);\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tfunction btnHiddenVariables_toggleVariablesClicked() {\n\t\t\ttry {\n\t\t\t\tvar selections = _selectOptions.getSelections().selections;\n\t\t\t\tif (selections.length === 0)\n\t\t\t\t\treturn;\n\t\t\t\tselections = selections.sort((s1, s2) => {\n\t\t\t\t\treturn s1.option.index < s2.option.index ? -1 : s1.option.index > s2.option.index ? 1 : 0;\n\t\t\t\t});\n\n\t\t\t\tvar undoGroupNumber = selections.length > 1 ? _undoRedoStack.getNextGroupNumber() : null;\n\n\t\t\t\t_selectOptions.selectedIndex = -1;\n\t\t\t\tvar hide = _hiddenVariables.getSelectedVariablesToggleShouldHide(selections);\n\t\t\t\tvar optionWasSelected = false;\n\t\t\t\tvar deletedIndex = null;\n\t\t\t\tselections.forEach(selection => {\n\t\t\t\t\tif (hide != _hiddenVariables.getVariableIsHidden(selection.variable.name)) {\n\t\t\t\t\t\tvar result = hideVariable(selection.variable, hide, { saveUndo: true, undoGroupNumber: undoGroupNumber });\n\t\t\t\t\t\tif (result.hasOption) {\n\t\t\t\t\t\t\tif (!optionWasSelected) {\n\t\t\t\t\t\t\t\t_selectOptions.selectedIndex = result.option.index;\n\t\t\t\t\t\t\t\toptionWasSelected = true;\n\t\t\t\t\t\t\t} else\n\t\t\t\t\t\t\t\t_selectOptions.setOptionIsSelected(result.option, true);\n\t\t\t\t\t\t} else if (result.hasDeletedOptionIndex)\n\t\t\t\t\t\t\tdeletedIndex = Math.max(deletedIndex, result.deletedOptionIndex);\n\t\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (optionWasSelected) {\n\t\t\t\t\tshowCurrentlySelectedValue();\n\t\t\t\t\t_selVariables.focus();\n\t\t\t\t} else\n\t\t\t\t\t_selectOptions.setSelectedIndexAndRefresh(deletedIndex);\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tfunction btnHiddenVariables_toggleViewModeClicked() {\n\t\t\t_hiddenVariables.toggleViewMode();\n\t\t}\n\n\t// #endregion\n\n\t// #region ======== FontController ==========================\n\t\tclass FontSizeController {\n\t\t\tconstructor(element, minFontSize, maxFontSize) {\n\t\t\t\tthis._element = element;\n\t\t\t\tthis._minFontSize = minFontSize;\n\t\t\t\tthis._maxFontSize = maxFontSize;\n\t\t\t\tthis._defaultFontSize = this.getFontSize();\n\t\t\t\tthis._variableName = `${this._element.id}_fontSize`;\n\t\t\t\tthis._load();\n\t\t\t}\n\n\t\t\t_load() {\n\t\t\t\tvar fontSize = _userOptions.fontSize;\n\t\t\t\tif (fontSize)\n\t\t\t\t\tthis.setFontSize(fontSize);\n\t\t\t}\n\n\t\t\t_save() {\n\t\t\t\tvar fontSize = this.getFontSize();\n\t\t\t\t_userOptions.fontSize = fontSize === this._defaultFontSize ? null : fontSize;\n\t\t\t}\n\n\t\t\tcanDecreaseFontSize() { return this.getFontSize() > this._minFontSize; }\n\t\t\tcanIncreaseFontSize() { return this.getFontSize() < this._maxFontSize; }\n\n\t\t\tgetFontSize() { \n\t\t\t\ttry {\n\t\t\t\t\tvar fontSize = this._element.style.fontSize;\n\t\t\t\t\tif (!fontSize)\n\t\t\t\t\t\tfontSize = window.getComputedStyle(this._element).getPropertyValue(\"font-size\");\n\t\t\t\t\tfontSize = /\\d+/.exec(window.getComputedStyle(this._element).getPropertyValue(\"font-size\"));\n\t\t\t\t\tif (!fontSize || fontSize.length != 1)\n\t\t\t\t\t\tthrow new Error(`Could not extract the font size from the string \"${fontSize}\"`);\n\t\t\t\t\treturn parseInt(fontSize[0]);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetFontSize(value) {\n\t\t\t\tvar fontSize = Math.max(Math.min(value, this._maxFontSize), this._minFontSize);\n\t\t\t\tconsole.log(`value: ${value}, fontSize: ${fontSize}, _minFontSize: ${this._minFontSize}, _maxFontSize: ${this._maxFontSize}`);\n\t\t\t\tthis._element.style.fontSize = `${fontSize}px`;\n\t\t\t\tthis._save();\n\t\t\t}\n\n\t\t\tresetFontSize() {\n\t\t\t\tthis.setFontSize(this._defaultFontSize);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * @type FontSizeController\n\t\t */\n\t\tvar _fontSizeController = null;\n\t// #endregion\t\t\n\n\t// #region ======== Misc Click Handlers =====================\n\t\tfunction btnAddVariableClicked() {\n\n\t\t\tfunction validateVariableName(data) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!data.text)\n\t\t\t\t\t\treturn \"Name is required, or click Cancel or press Escape\"\n\t\t\t\t\tif (!_variables.isValidVariableName(data.text))\n\t\t\t\t\t\treturn \"Not a valid variable name\";\n\t\t\t\t\tif (_variables.getVariableByName(data.text, {isDictionary: data.checked, caseInsensitive: true, returnNullIfNotFound: true}))\n\t\t\t\t\t\treturn `This ${data.checked ? \"dictionary\" : \"variable\"} already exists`;\n\t\t\t\t\tif (_isAsync && _variables.isLocalVariableName(data.text))\n\t\t\t\t\t\treturn \"You can't add Local or Instance variables when the Inspector is being shown Asynchronously.\"\n\t\t\t\t\treturn null;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction handleResult(data) {\n\t\t\t\ttry {\n\t\t\t\t\tif (data.canceled)\n\t\t\t\t\t\treturn;\n\t\n\t\t\t\t\tclearSearchFilter();\n\t\t\t\t\tvar variable = data.checked ? _variables.createDictionaryVariable(data.text) : _variables.createVariable(data.text);\n\t\t\t\t\tvar options = {\n\t\t\t\t\t\tsaveUndo: _variables.isVariableEmpty(variable)\n\t\t\t\t\t}\n\t\t\t\t\tvar result = _variables.addVariable(variable, options);\n\t\t\t\t\tif (result.hasOption)\n\t\t\t\t\t\t_selectOptions.setSelectedIndexAndRefresh(result.option.index);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t_modalDialogController.showEditBoxDialog(\"Add a New Variable\", {checkboxLabel: \"Dictionary\"}, validateVariableName, handleResult);\n\t\t}\n\n\t\tfunction btnCodeClicked() {\n\t\t\t_miscStateController.fixedFont = !_miscStateController.fixedFont;\n\t\t}\n\n\t\tfunction btnCopyNamesClicked() {\n\t\t\ttry {\n\t\t\t\tvar selections = _selectOptions.getSelections().selections;\n\t\t\t\tif (selections.length === 0)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar names = selections.map(s => _variables.getActualVariableName(s.variable)).join(\"\\n\");\n\t\t\t\t_internalTasksMacro.copyToClipboard(names);\n\t\t\t\t_statusLine.showMomentaryMessage(\"Variable Name(s) copied to the clipboard\");\n\t\t\t\t_selVariables.focus();\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tfunction btnCopyVariablesClicked() {\n\t\t\ttry {\n\t\t\t\tvar selections = _selectOptions.getSelections().selections;\n\t\t\t\tif (selections.length === 0)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar values = selections.map(s => {\n\t\t\t\t\tvar result = [];\n\t\t\t\t\tresult.push(`${_variables.getActualVariableName(s.variable)}:`);\n\t\t\t\t\tif (s.variable.isDictionary)\n\t\t\t\t\t\tresult.push(JSON.stringify(s.variable.value));\n\t\t\t\t\telse\n\t\t\t\t\t\tresult.push(s.variable.value);\n\t\t\t\t\treturn result.join(\" \");\n\t\t\t\t}).join(\"\\n\");\n\t\t\t\t_internalTasksMacro.copyToClipboard(values);\n\t\t\t\t_statusLine.showMomentaryMessage(\"Variable(s) copied to the clipboard\");\n\t\t\t\t_selVariables.focus();\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tfunction btnDeleteVariablesClicked() {\n\t\t\ttry {\n\t\t\t\tvar selections = _selectOptions.getSelections().selections;\n\t\t\t\tif (selections.length === 0)\n\t\t\t\t\treturn;\n\t\t\t\tselections = selections.sort((s1, s2) => {\n\t\t\t\t\treturn s1.option.index < s2.option.index ? 1 : s1.option.index > s2.option.index ? -1 : 0;\n\t\t\t\t});\n\n\t\t\t\tvar undoGroupNumber = selections.length > 1 ? _undoRedoStack.getNextGroupNumber() : null;\n\n\t\t\t\tvar optionIndexToSelect = null;\n\t\t\t\tselections.forEach(selection => {\n\t\t\t\t\tvar result = _variables.deleteVariable(selection.variable, { saveUndo: true, undoGroupNumber: undoGroupNumber });\n\t\t\t\t\tif (result.hasDeletedOptionIndex) {\n\t\t\t\t\t\tif (optionIndexToSelect == null)\n\t\t\t\t\t\t\toptionIndexToSelect = result.deletedOptionIndex;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\toptionIndexToSelect = Math.min(optionIndexToSelect, result.deletedOptionIndex);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t_selectOptions.setSelectedIndexAndRefresh(optionIndexToSelect);\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tfunction btnEditClicked() {\n\t\t\ttry {\n\t\t\t\tvar selectedVariable = _selectOptions.getSelectedVariable();\n\t\t\t\tif (!selectedVariable)\n\t\t\t\t\treturn;\n\n\t\t\t\tif (isLocalVariableCantEdit(selectedVariable)) {\n\t\t\t\t\t_modalDialogController.showInfoDialog(\"You can't edit Local or Instance variables when the Inspector is being shown Asynchronously.\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (_selectOptions.getSelectedVariable())\n\t\t\t\t\tsetEditMode(true);\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tfunction btnEditOKClicked() {\n\t\t\ttry {\n\t\t\t\tvar text = _txtValue.value;\n\t\t\t\tif (text && _isShowingJsonData) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tJSON.parse(text);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t_modalDialogController.showInfoDialog(e.message);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tsetEditMode(false);\n\t\t\t\tvar selection = _selectOptions.getSelection();\n\t\t\t\tif (!selection)\n\t\t\t\t\treturn;\n\t\t\t\t_variables.changeVariable(selection.variable, _txtValue.value, {saveUndo: true});\n\t\t\t\tshowCurrentlySelectedValue();\n\t\t\t\t_selVariables.focus();\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tfunction btnEditCancelClicked() {\n\t\t\ttry {\n\t\t\t\t_txtValue.value = _selectOptions.getSelectedVariable().value;\n\t\t\t\tsetEditMode(false);\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tfunction btnHelpClicked() {\n\t\t\t_modalDialogController.showDictionaryHelp();\n\t\t}\n\n\t\tfunction btnJsonClicked() {\n\t\t\ttry {\n\t\t\t\tvar selectedVariable = _selectOptions.getSelectedVariable();\n\t\t\t\tif (!selectedVariable || !selectedVariable.jsonValue)\n\t\t\t\t\treturn;\n\n\t\t\t\tif (selectedVariable.isDictionary)\n\t\t\t\t\t_miscStateController.jsonDictionaryDisplayMode = !_miscStateController.jsonDictionaryDisplayMode;\n\t\t\t\telse\n\t\t\t\t\t_miscStateController.jsonVariableDisplayMode = !_miscStateController.jsonVariableDisplayMode;\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tfunction btnRenameVariableClicked() {\n\n\t\t\tfunction validateRenameName(data, variable) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!data.text)\n\t\t\t\t\t\treturn \"Name is required, or click Cancel or press Escape\"\n\t\t\t\t\tif (data.text.toLowerCase() === variable.name.toLowerCase())\n\t\t\t\t\t\treturn null;\n\t\n\t\t\t\t\tconst vord = variable.isDictionary ? \"dictionary\" : \"variable\";\n\t\n\t\t\t\t\tif (!_variables.isValidVariableName(data.text))\n\t\t\t\t\t\treturn `Not a valid ${vord} name`;\n\t\t\t\t\tif (_variables.getVariableByName(data.text, {isDictionary: variable.isDictionary, caseInsensitive: true, returnNullIfNotFound: true}))\n\t\t\t\t\t\treturn `This ${vord} already exists`;\n\t\n\t\t\t\t\tif (variable.isDictionary) {\n\t\t\t\t\t\tlet dict = _variables.createDictionaryVariable(data.text);\n\t\t\t\t\t\tif (!_variables.isDictionaryEmpty(dict))\n\t\t\t\t\t\t\treturn `This dictionary already exists (it's not in the list right now, but it exists in KM)`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet v = _variables.createVariable(data.text);\n\t\t\t\t\t\tif (v.value)\n\t\t\t\t\t\t\treturn `This variable already exists (it's not in the list right now, but it exists in KM)`;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif ((variable.isLocalVariable === true) !== (_variables.isLocalVariableName(data.text) === true))\n\t\t\t\t\t\treturn `You can't switch between Local/Instance Variables and Global Variables`;\n\t\t\t\t\treturn null;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction handleResult(data, variable) {\n\t\t\t\ttry {\n\t\t\t\t\tif (data.canceled)\n\t\t\t\t\t\treturn;\n\t\t\t\t\tif (data.text.toLowerCase() === variable.name.toLowerCase())\n\t\t\t\t\t\treturn null;\n\t\n\t\t\t\t\tclearSearchFilter();\n\t\t\t\t\tvar result = _variables.renameVariable(variable, data.text, {saveUndo: true});\n\t\t\t\t\tif (result.hasOption)\n\t\t\t\t\t\t_selectOptions.setSelectedIndexAndRefresh(result.option.index);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tvar variable = _selectOptions.getSelectedVariable();\n\t\t\t\tif (!variable)\n\t\t\t\t\treturn;\n\t\t\t\tif (_isAsync && variable.isLocalVariable) {\n\t\t\t\t\t_modalDialogController.showInfoDialog(\"You can't rename Local or Instance variables when the Inspector is being shown Asynchronously.\")\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t_modalDialogController.showEditBoxDialog(\n\t\t\t\t\t`Rename ${variable.isDictionary ? \"Dictionary\" : \"Variable\"}`,\n\t\t\t\t\t{initialValue: _variables.getActualVariableName(variable)}, \n\t\t\t\t\t(data) => validateRenameName(data, variable), \n\t\t\t\t\t(data) => handleResult(data, variable));\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tfunction btnSearchKMClicked() {\n\t\t\ttry {\n\t\t\t\tvar variable = _selectOptions.getSelectedVariable();\n\t\t\t\tif (!variable)\n\t\t\t\t\treturn;\n\t\t\t\t_internalTasksMacro.searchKM(_variables.getActualVariableName(variable));\n\t\t\t\t_selVariables.focus();\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tfunction btnSortClicked() {\n\t\t\t_variableSortMode.setSortBySize(!_variableSortMode.sortBySize, true);\n\t\t}\n\n\t\tfunction btnWordWrapClicked() {\n\t\t\t_miscStateController.wordWrap = !_miscStateController.wordWrap;\n\t\t}\n\t\t\n\t\tfunction openConsoleClicked() {\n\t\t\tif (_openConsoleMacroUUID)\n\t\t\t\twindow.KeyboardMaestro.Trigger(_openConsoleMacroUUID);\n\t\t}\n\n\t\tfunction optionsMenuClicled() {\n\n\t\t\tfunction loadLocalVariables() {\n\t\t\t\ttry {\n\t\t\t\t\tObject.keys(document.kmvar).forEach(name => {\n\t\t\t\t\t\tif (_variables.isLocalVariableName(name)) {\n\t\t\t\t\t\t\tvar value = _variables.getKMVariableValue(name);\n\t\t\t\t\t\t\tvar variable = _variables.getVariableByName(name, {returnNullIfNotFound: true});\n\t\t\t\t\t\t\tif (variable) {\n\t\t\t\t\t\t\t\tvariable.value = value;\n\t\t\t\t\t\t\t\t_variables.setupJsonValue(variable);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvariable = _variables.createVariable(name);\n\t\t\t\t\t\t\t\t_variables._data.push(variable);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tfillSelect();\n\t\t\t\t\tsetTimeout(() => _statusLine.showMomentaryMessage(\"Local Variables have been loaded/reloaded\"), 100);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction optionsDialogDone(result) {\n\t\t\t\ttry {\n\t\t\t\t\tswitch (result) {\n\t\t\t\t\t\tcase \"loadLocalVariables\":\n\t\t\t\t\t\t\t_undoRedoStack.clear();\n\t\t\t\t\t\t\tloadLocalVariables();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"loadGlobalVariables\":\n\t\t\t\t\t\t\t_undoRedoStack.clear();\n\t\t\t\t\t\t\t_internalTasksMacro.reloadData(true, false);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"loadDictionaries\":\n\t\t\t\t\t\t\t_undoRedoStack.clear();\n\t\t\t\t\t\t\t_internalTasksMacro.reloadData(false, true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"toggleHiddenVariables\":\n\t\t\t\t\t\t\t_undoRedoStack.clear();\n\t\t\t\t\t\t\t_hiddenVariables.enabled = !_hiddenVariables.enabled;\n\t\t\t\t\t\t\tfillSelect();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t_inpSearchFilter.focus();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\t_modalDialogController.showOptions((result) => optionsDialogDone(result));\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tfunction selVariablesDblClicked() {\n\t\t\tif (_btnEdit.isEnabled() && _btnEdit.isVisible())\n\t\t\t\tbtnEditClicked();\n\t\t}\n\t// #endregion\n\n\t// #region ======== Misc Functions ==========================\n\n\t\tfunction clearTextSelection(){\n\t\t\ttry {\n\t\t\t\t// if (window.getSelection) {\n\t\t\t\t// \tvar sel = window.getSelection();\n\t\t\t\t// \tif (sel && sel.removeAllRanges)\n\t\t\t\t// \t\tsel.removeAllRanges();\n\t\t\t\t// } else \n\t\t\t\tif (document.selection)\n\t\t\t\t\tdocument.selection.empty();\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tfunction escape(s) {\n\t\t\tlet lookup = {\n\t\t\t\t'&': \"&amp;\",\n\t\t\t\t'\"': \"&quot;\",\n\t\t\t\t'\\'': \"&apos;\",\n\t\t\t\t'<': \"&lt;\",\n\t\t\t\t'>': \"&gt;\"\n\t\t\t};\n\t\t\treturn s.replace( /[&\"'<>]/g, c => lookup[c] );\n\t\t}\n\n\t\tfunction isLocalVariableCantEdit(variable) {\n\t\t\tif (!_isAsync || !variable)\n\t\t\t\treturn false;\n\t\t\treturn variable.isLocalVariable;\n\t\t}\n\n\t\tfunction setEditMode(value) {\n\t\t\ttry {\n\t\t\t\t_editMode = value;\n\t\t\t\tenableControls();\n\t\t\t\tif (value) {\n\t\t\t\t\t_txtValue.focus();\n\t\t\t\t\t_txtValue.select();\n\t\t\t\t} else {\n\t\t\t\t\tclearTextSelection();\n\t\t\t\t\t_selVariables.focus();\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\n\t\tfunction setSelectIndexAsync(index) {\n\t\t\tif (_selVariables.options.length <= 0)\n\t\t\t\treturn;\n\t\t\tsetTimeout(() => {\n\t\t\t\t_selectOptions.selectedIndex = index;\n\t\t\t\tshowCurrentlySelectedValue();\n\t\t\t\t_selVariables.focus();\n\t\t\t}, 10);\n\t\t}\n\t\n\t\tfunction validateOptions(options, validOptions) {\n\t\t\ttry {\n\t\t\t\tif (options == null)\n\t\t\t\t\treturn {};\n\t\t\t\tObject.keys(options).forEach(key => {\n\t\t\t\t\tif (validOptions.indexOf(key) < 0)\n\t\t\t\t\t\tthrow new Error(`Invalid Option: \"${key}\"`);\n\t\t\t\t});\n\t\t\t\treturn options;\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\t\n\t// #endregion\t\t\t\n\n\t// #region ======== Dictionary Stuff ========================\n\n\t\t// #region ======== DictionarySortMode ======================\n\t\t\tclass DictionarySortMode {\n\t\t\t\tconstructor() {\n\t\t\t\t\tthis.keyColumnType =\"key\";\n\t\t\t\t\tthis.valueColumnType = \"value\";\n\t\t\t\t\tthis.sortByKeyAscending = \"sortByKeyAscending\";\n\t\t\t\t\tthis.sortByKeyDescending = \"sortByKeyDescending\";\n\t\t\t\t\tthis.sortByValueAscending = \"sortByValueAscending\";\n\t\t\t\t\tthis.sortByValueDescending = \"sortByValueDescending\";\n\t\t\t\t\tthis.currSortMode = this.sortByKeyAscending;\n\t\t\t\t\tthis.sortByKeyModes = [this.sortByKeyAscending, this.sortByKeyDescending];\n\t\t\t\t\tthis.sortByValueModes = [this.sortByValueAscending, this.sortByValueDescending];\n\t\t\t\t\tthis.sortModes = { [this.keyColumnType]: this.sortByKeyModes, [this.valueColumnType]: this.sortByValueModes};\n\t\t\t\t\tthis.sortCodes = [\"\", \"\"];\n\t\t\t\t}\n\n\t\t\t\tgetSortCode(columnType) {\n\t\t\t\t\tvar i = this.sortModes[columnType].indexOf(this.currSortMode);\n\t\t\t\t\treturn i < 0 ? \"\" : this.sortCodes[i];\n\t\t\t\t}\n\t\n\t\t\t\t/**\n\t\t\t\t * Compares two row/key combinations based on the current sort mode.\n\t\t\t\t * @param {{key: string, value: string}} a \n\t\t\t\t * @param {{key: string, value: string}} b \n\t\t\t\t * @returns \n\t\t\t\t */\n\t\t\t\tsortCompare(a, b) {\n\n\t\t\t\t\tfunction stringSortCompare(a1, b1, a2, b2) {\n\t\t\t\t\t\treturn a1 < b1 ? -1 : a1 > b1 ? 1 : a2 < b2 ? -1 : a2 > b2 ? 1 : 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tswitch (_dictionarySortMode.currSortMode) {\n\t\t\t\t\t\tcase _dictionarySortMode.sortByKeyAscending:\n\t\t\t\t\t\t\treturn stringSortCompare(a.key, b.key, a.value, b.value);\n\t\t\t\t\t\tcase _dictionarySortMode.sortByKeyDescending:\n\t\t\t\t\t\t\treturn stringSortCompare(b.key, a.key, a.value, b.value);\n\t\t\t\t\t\tcase _dictionarySortMode.sortByValueAscending:\n\t\t\t\t\t\t\treturn stringSortCompare(a.value, b.value, a.key, b.key);\n\t\t\t\t\t\tcase _dictionarySortMode.sortByValueDescending:\n\t\t\t\t\t\t\treturn stringSortCompare(b.value, a.value, a.key, b.key);\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tthrow new Error(`Uknown Dictionary SortMode \"${_dictionarySortMode.currSortMode}\"`);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\ttoggleSortCode(columnType) {\n\t\t\t\t\tvar sortModes = this.sortModes[columnType];\n\t\t\t\t\tvar i = sortModes.indexOf(this.currSortMode) + 1;\n\t\t\t\t\tif (i >= sortModes.length)\n\t\t\t\t\t\ti = 0;\n\t\t\t\t\tthis.currSortMode = sortModes[i];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * @type DictionarySortMode\n\t\t\t */\n\t\t\tconst _dictionarySortMode = new DictionarySortMode();\n\t\t// #endregion\n\n\t\t// #region ======== DictionaryCellNavigator =================\n\t\t\tclass DictionaryCellNavigator {\n\t\t\t\tconstructor(cell) {\n\t\t\t\t\tthis._cell = cell;\n\t\t\t\t\tthis._colIndex = Array.prototype.indexOf.call(this._cell.parentElement.children, this._cell);\n\t\t\t\t}\n\n\t\t\t\tgetCellAbove() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar prevRow = this._cell.parentElement.previousElementSibling;\n\t\t\t\t\t\treturn prevRow ? prevRow.children[this._colIndex] : null;\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tgetCellBelow() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar nextRow = this._cell.parentElement.nextElementSibling;\n\t\t\t\t\t\tif (!nextRow)\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\tvar dictCellBelow = new DictionaryCell(nextRow.children[this._colIndex]);\n\t\t\t\t\t\tif (!dictCellBelow.isNewRow || !dictCellBelow.isValueCell || dictCellBelow.rowKey)\n\t\t\t\t\t\t\treturn dictCellBelow.cell;\n\t\t\t\t\t\treturn _dictionaryHelper.getRowKeyCellElement(nextRow);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tgetCellLeft() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar prevCell = this._cell.previousElementSibling;\n\t\t\t\t\t\twhile (prevCell && !prevCell.hasClass(\"dictCell\")) {\n\t\t\t\t\t\t\tprevCell = prevCell.previousElementSibling;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (prevCell)\n\t\t\t\t\t\t\treturn prevCell;\n\n\t\t\t\t\t\tvar prevRow = this._cell.parentElement.previousElementSibling;\n\t\t\t\t\t\tif (!prevRow)\n\t\t\t\t\t\t\treturn null;\n\n\t\t\t\t\t\tvar result = prevRow.lastChild;\n\t\t\t\t\t\tif (!result.hasClass(\"dictCell\"))\n\t\t\t\t\t\t\tthrow new Error(`Expected last cell to have the class \"dictCell\"`);\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tgetCellRight() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar nextCell = this._cell.nextElementSibling;\n\t\t\t\t\t\tif (nextCell) {\n\t\t\t\t\t\t\tif (!nextCell.hasClass(\"dictCell\"))\n\t\t\t\t\t\t\t\tthrow new Error(`Expected next cell to have the class \"dictCell\"`);\n\t\t\t\t\t\t\treturn nextCell;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar nextRow = this._cell.parentElement.nextElementSibling;\n\t\t\t\t\t\tif (!nextRow)\n\t\t\t\t\t\t\treturn null;\n\n\t\t\t\t\t\tvar cell = nextRow.firstChild;\n\t\t\t\t\t\twhile (cell && !cell.hasClass(\"dictCell\")) {\n\t\t\t\t\t\t\tcell = cell.nextElementSibling;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!cell)\n\t\t\t\t\t\t\tthrow new Error(`Didn't find any cells with the class \"dictCell\" in the row`);\n\t\t\t\t\t\treturn cell;\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t// #endregion\n\n\t\t// #region ======== DictionaryCell ==========================\n\t\t\tclass DictionaryCell {\n\t\t\t\tconstructor(cellOrContentElement) {\n\t\t\t\t\tif (cellOrContentElement.hasClass(\"dictCellContent\")) {\n\t\t\t\t\t\tthis._contentElement = cellOrContentElement;\n\t\t\t\t\t\tthis._cell = this._contentElement.parentElement;\n\t\t\t\t\t} else if (cellOrContentElement.hasClass(\"dictCell\")) {\n\t\t\t\t\t\tthis._cell = cellOrContentElement;\n\t\t\t\t\t\tthis._contentElement = this._cell.querySelector(\".dictCellContent\");\n\t\t\t\t\t} else if (cellOrContentElement.hasClass(\"trashCan\")) {\n\t\t\t\t\t\tthis._contentElement = cellOrContentElement.parentElement;\n\t\t\t\t\t\tthis._cell = this._contentElement.parentElement;\n\t\t\t\t\t} else\n\t\t\t\t\t\tthrow new Error(`Element isn't a Dictionary Cell`);\n\n\t\t\t\t\tthis._isKeyCell = this._cell.hasClass(\"dictKeyCell\");\n\t\t\t\t\tthis._isValueCell = this._cell.hasClass(\"dictValueCell\");\n\t\t\t\t\tthis._isDeleteButtonCell = this._cell.hasClass(\"dictDeleteCell\");\n\n\t\t\t\t\tthis._row = this._cell.parentElement;\n\t\t\t\t\tthis._rowKeyCellContentElement = _dictionaryHelper.getRowKeyCellContentElement(this._row);\n\t\t\t\t\tthis._rowValueCellContentElement = _dictionaryHelper.getRowValueCellContentElement(this._row);\n\t\t\t\t\tthis._isNewRow = _dictionaryHelper.getIsNewRow(this._row);\n\t\t\t\t}\n\n\t\t\t\tget cell() { return this._cell; }\n\t\t\t\tget contentElement() { return this._contentElement; }\n\t\t\t\tget value() { \n\t\t\t\t\tif (this._isDeleteButtonCell)\n\t\t\t\t\t\treturn \"\";\n\t\t\t\t\treturn this._contentElement.innerText.trimEnd(); \n\t\t\t\t}\n\t\t\t\tset value(value) {\n\t\t\t\t\tif (this._isDeleteButtonCell)\n\t\t\t\t\t\treturn;\n\t\t\t\t\tif (!value)\n\t\t\t\t\t\tthis._contentElement.innerHTML = \"&nbsp;\";\n\t\t\t\t\telse\n\t\t\t\t\t\tthis._contentElement.innerText = value;\n\t\t\t\t}\n\t\t\t\tget isDictionaryCell() { return true; }\n\t\t\t\tget isKeyCell() { return this._isKeyCell; }\n\t\t\t\tget isValueCell() { return this._isValueCell; }\n\t\t\t\tget isDeleteButtonCell() { return this._isDeleteButtonCell; }\n\t\t\t\tget isNewRow() { return DictionaryCell.isNewRow(this._row); }\n\t\t\t\tget row() { return this._row; }\n\t\t\t\tget rowKey() { return this._rowKeyCellContentElement.innerText.trimEnd(); }\n\t\t\t\tget rowValue() { return this._rowValueCellContentElement.innerText.trimEnd(); }\n\t\t\t\tget isNewRow() { return this._isNewRow; }\n\n\t\t\t\tanimateForDelete(duration, callback) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar elements = this._row.querySelectorAll(\".dictCellContent\");\n\t\t\t\t\t\telements.forEach(ele => {\n\t\t\t\t\t\t\tvar trashCan = ele.querySelector(\".trashCan\");\n\t\t\t\t\t\t\tif (trashCan) {\n\t\t\t\t\t\t\t\ttrashCan.setVisible(false);\n\t\t\t\t\t\t\t\t// ele.animate([\n\t\t\t\t\t\t\t\t// \t{ transform: \"scale(1) translateY(0)\" },\n\t\t\t\t\t\t\t\t// \t{ transform: \"scale(0.1) translateY(-15px)\" },\n\t\t\t\t\t\t\t\t// ], {\n\t\t\t\t\t\t\t\t// \tduration: duration\n\t\t\t\t\t\t\t\t// });\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tele.style.fontSize = \"1px\";\n\t\t\t\t\t\t\t\tele.animate([\n\t\t\t\t\t\t\t\t\t{ fontSize: _fontSizeController.getFontSize()+\"px\" },\n\t\t\t\t\t\t\t\t\t{ fontSize: \"1px\" },\n\t\t\t\t\t\t\t\t], {\n\t\t\t\t\t\t\t\t\tduration: duration\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (callback)\n\t\t\t\t\t\t\tsetTimeout(() => callback(this), duration+10);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tanimateForUndelete(duration, callback) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlet elements = this._row.querySelectorAll(\".dictCellContent\");\n\t\t\t\t\t\tvar fontSize = _fontSizeController.getFontSize() + \"px\";\n\t\t\t\t\t\telements.forEach(ele => {\n\t\t\t\t\t\t\tlet trashCan = ele.querySelector(\".trashCan\");\n\t\t\t\t\t\t\tif (trashCan) {\n\t\t\t\t\t\t\t\ttrashCan.setVisible(false);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tele.style.fontSize = fontSize;\n\t\t\t\t\t\t\t\tele.animate([\n\t\t\t\t\t\t\t\t\t{ fontSize: \"1px\" },\n\t\t\t\t\t\t\t\t\t{ fontSize: fontSize }\n\t\t\t\t\t\t\t\t], {\n\t\t\t\t\t\t\t\t\tduration: duration\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tlet elements = this._row.querySelectorAll(\".dictCellContent\");\n\t\t\t\t\t\t\telements.forEach(ele => {\n\t\t\t\t\t\t\t\tlet trashCan = ele.querySelector(\".trashCan\");\n\t\t\t\t\t\t\t\tif (trashCan) {\n\t\t\t\t\t\t\t\t\ttrashCan.setVisible(true);\n\t\t\t\t\t\t\t\t\tele.animate([\n\t\t\t\t\t\t\t\t\t\t{ opacity: 0 },\n\t\t\t\t\t\t\t\t\t\t{ opacity: 1 },\n\t\t\t\t\t\t\t\t\t], {\n\t\t\t\t\t\t\t\t\t\tduration: 200\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} else\n\t\t\t\t\t\t\t\t\tele.style.fontSize = \"1em\";\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (callback)\n\t\t\t\t\t\t\t\tcallback(this);\n\t\t\t\t\t\t}, duration+10);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tsetErrorMessage(errorMessage) {\n\t\t\t\t\tvar errorMessageElement = this._cell.querySelector(\".dictCellError\");\n\t\t\t\t\tif (!errorMessage) {\n\t\t\t\t\t\tif (errorMessageElement)\n\t\t\t\t\t\t\terrorMessageElement.remove();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!errorMessageElement) {\n\t\t\t\t\t\t\terrorMessageElement = document.createElement(\"div\");\n\t\t\t\t\t\t\terrorMessageElement.className = \"dictCellError\";\n\t\t\t\t\t\t\tthis._cell.appendChild(errorMessageElement);\n\t\t\t\t\t\t}\n\t\t\t\t\t\terrorMessageElement.innerText = errorMessage;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tget cellType() { return this._isKeyCell ? \"Key\" : this._isValueCell ? \"Value\" : this._isDeleteButtonCell ? \"DeleteButton\" : \"unknown\"; }\n\t\t\t\ttoString() { \n\t\t\t\t\treturn [\n\t\t\t\t\t\t`${this.cellType} Cell`,\n\t\t\t\t\t\t`Value: \"${this.value}\"`,\n\t\t\t\t\t\t`RowKey: \"${this.rowKey}\"`,\n\t\t\t\t\t\t`RowValue: \"${this.rowValue}\"`\n\t\t\t\t\t].join(\"; \");\n\t\t\t\t}\t\t\t\t\t\n\t\t\t}\n\t\t// #endregion\n\n\t\t// #region ======== DictionaryCellEditAdapter ===============\n\t\t\tvar DictionaryCellEditAdapter = (function() {\n\t\t\t\tvar _variable = null;\n\t\t\t\tvar _cell = null;\n\t\t\t\tvar _originalValue;\n\n\t\t\t\tfunction _attach(variable, cell) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (_isAttached())\n\t\t\t\t\t\t\tthrow new Error(`EditAdapter is already attached`);\n\n\t\t\t\t\t\t_variable = variable;\n\n\t\t\t\t\t\t_cell = new DictionaryCell(cell);\n\t\t\t\t\t\t_originalValue = _cell.value;\n\n\t\t\t\t\t\t_cell.contentElement.contentEditable = \"true\";\n\t\t\t\t\t\t_cell.contentElement.toggleClass(\"dictCellEdit\", true);\n\t\t\t\t\t\t_cell.contentElement.addEventListener(\"blur\", _contentElementBlur);\n\n\t\t\t\t\t\tdisableDictDelete(true);\n\n\t\t\t\t\t\t// position the cursor\n\t\t\t\t\t\tconst selection = document.getSelection();\n\t\t\t\t\t\tconst range = document.createRange();\n\t\t\t\t\t\tselection.removeAllRanges();\n\t\t\t\t\t\trange.selectNodeContents(_cell.contentElement);\n\t\t\t\t\t\trange.collapse(false);\n\t\t\t\t\t\tselection.addRange(range);\n\n\t\t\t\t\t\tenableControls();\n\t\t\t\t\t\t_cell.contentElement.focus();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction _contentElementBlur(event) {\n\t\t\t\t\t_validateAndSave();\n\t\t\t\t}\n\n\t\t\t\tfunction disableDictDelete(disable) {\n\t\t\t\t\tvar row = _dictionaryHelper.getFirstRowElement();\n\t\t\t\t\twhile (row && !_dictionaryHelper.getIsNewRow(row)) {\n\t\t\t\t\t\t_dictionaryHelper.getRowTrashCanElement(row).swapClasses(\"trashCanDisabled\", \"trashCanEnabled\", disable);\n\t\t\t\t\t\trow = row.nextElementSibling;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction _detach(resetValue) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (!_isAttached())\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t_setErrorMessage(null);\n\t\t\t\t\t\t_cell.contentElement.contentEditable = \"false\";\n\t\t\t\t\t\t_cell.contentElement.toggleClass(\"dictCellEdit\", false);\n\t\t\t\t\t\t_cell.contentElement.removeEventListener(\"blur\", _contentElementBlur);\n\t\t\t\t\t\tif (resetValue)\n\t\t\t\t\t\t\t_cell.value = _originalValue;\n\t\t\t\t\t\t\n\t\t\t\t\t\tdisableDictDelete(false);\n\n\t\t\t\t\t\t_cell = null;\n\t\t\t\t\t\t_variable = null;\n\t\t\t\t\t\tenableControls();\n\t\t\t\t\t\t_selVariables.focus();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction _isAttached() {\n\t\t\t\t\treturn _cell != null;\n\t\t\t\t}\n\n\t\t\t\tfunction _setErrorMessage(errorMessage) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (!_isAttached()) {\n\t\t\t\t\t\t\tif (errorMessage)\n\t\t\t\t\t\t\t\tthrow new Error(`Cell Edit Adaptor isn't Attached`);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_cell.setErrorMessage(errorMessage);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction _validateAndSave() {\n\n\t\t\t\t\tfunction makeValidationError(message) {\n\t\t\t\t\t\tvar error = new Error(message);\n\t\t\t\t\t\terror.isValidationError = true;\n\t\t\t\t\t\treturn error;\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction validate(newValue) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (!_cell.isKeyCell)\n\t\t\t\t\t\t\t\treturn true;\n\n\t\t\t\t\t\t\tif (!newValue)\n\t\t\t\t\t\t\t\tthrow makeValidationError(\"Key is required\");\n\n\t\t\t\t\t\t\tif (_variable.value[newValue] != null)\n\t\t\t\t\t\t\t\tthrow makeValidationError(\"Duplicate key\");\n\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tif (e.isValidationError) {\n\t\t\t\t\t\t\t\t_setErrorMessage(e.message);\n\t\t\t\t\t\t\t\tsetTimeout(() => _cell.contentElement.focus(), 10);\n\t\t\t\t\t\t\t} else\n\t\t\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (!_isAttached())\n\t\t\t\t\t\t\tthrow new Error(`Cell Edit Adaptor isn't Attached`);\n\n\t\t\t\t\t\tvar newValue = _cell.value.trim();\n\t\t\t\t\t\tif (newValue !== _originalValue) {\n\t\t\t\t\t\t\tif (!validate(newValue))\n\t\t\t\t\t\t\t\treturn false;\n\n\t\t\t\t\t\t\tvar undoDictionaryAction = null;\n\t\t\t\t\t\t\tvar newDictionaryContent = _variable.value.clone();\n\t\t\t\t\t\t\tif (_cell.isKeyCell) {\n\t\t\t\t\t\t\t\tvar value = _originalValue ? _variable.value[_originalValue] : \"\";\n\t\t\t\t\t\t\t\tif (_originalValue) {\n\t\t\t\t\t\t\t\t\tdelete newDictionaryContent[_originalValue];\n\t\t\t\t\t\t\t\t\tundoDictionaryAction = new UndoRedoDictionaryKeyChangedAction(_originalValue, newValue);\n\t\t\t\t\t\t\t\t} else\n\t\t\t\t\t\t\t\t\tundoDictionaryAction = new UndoRedoDictionaryKeyAddedAction(newValue);\n\t\t\t\t\t\t\t\tnewDictionaryContent[newValue] = value;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tundoDictionaryAction = new UndoRedoDictionaryValueChangedAction(_cell.rowKey, newDictionaryContent[_cell.rowKey], newValue);\n\t\t\t\t\t\t\t\tnewDictionaryContent[_cell.rowKey] = newValue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t_variables.changeVariable(_variable, newDictionaryContent, { saveUndo: true, undoDictionaryAction: undoDictionaryAction });\n\n\t\t\t\t\t\t\t// This is necessary in case the new value is empty, because if it is,\n\t\t\t\t\t\t\t// we need to set innerHTML to &nbsp;\n\t\t\t\t\t\t\t_cell.value = newValue;\n\n\t\t\t\t\t\t\tif (_cell.isNewRow) {\n\t\t\t\t\t\t\t\t_dictionaryHelper.getRowTrashCanElement(_cell.row).swapClasses(\"trashCanEnabled\", \"trashCanDisabled\", true);\n\t\t\t\t\t\t\t\t_dictionaryBuilder.addNewDictionaryRow();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_detach();\n\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn {\n\t\t\t\t\tattach: function(variable, cell) {\n\t\t\t\t\t\treturn _attach(variable, cell);\n\t\t\t\t\t},\n\n\t\t\t\t\tdetach: function(resetValue) {\n\t\t\t\t\t\t_detach(resetValue);\n\t\t\t\t\t},\n\n\t\t\t\t\tgetCell: function() {\n\t\t\t\t\t\treturn _cell;\n\t\t\t\t\t},\n\n\t\t\t\t\tisAttached: function () {\n\t\t\t\t\t\treturn _isAttached();\n\t\t\t\t\t},\n\n\t\t\t\t\tisAttachedTo(cell) {\n\t\t\t\t\t\treturn cell === _cell;\n\t\t\t\t\t},\n\t\t\t\t\t\n\t\t\t\t\tsetErrorMessage: function(errorMessage) {\n\t\t\t\t\t\t_setErrorMessage(errorMessage);\n\t\t\t\t\t},\n\n\t\t\t\t\tvalidateAndSave: function() {\n\t\t\t\t\t\treturn _validateAndSave();\n\t\t\t\t\t}\n\n\t\t\t\t};\n\t\t\t})\n\t\t\tvar _dictionaryCellEditAdapter = new DictionaryCellEditAdapter();\n\t\t// #endregion\n\n\t\t// #region ======== DictionaryBuilder =======================\n\t\t\tclass DictionaryBuilder {\n\t\t\t\tconstructor () {\n\t\t\t\t\tthis._buildNumber = 0;\n\t\t\t\t}\n\n\t\t\t\t_dictCellDoubleClick(event) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (_dictionaryCellEditAdapter.isAttached())\n\t\t\t\t\t\t\treturn;\n\t\t\n\t\t\t\t\t\tvar cell = new DictionaryCell(event.target);\n\t\t\t\t\t\tif (cell.isNewRow && cell.isValueCell && !cell.rowKey) {\n\t\t\t\t\t\t\tsetTimeout(() => { _modalDialogController.showInfoDialog(\"You have to enter the Key first.\"); }, 10)\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_dictionaryCellEditAdapter.attach(_selectOptions.getSelectedVariable(), event.target);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\t_addDictionaryColumnHeader(tr, text, columnType) {\n\t\t\t\t\tvar th = document.createElement(\"th\");\n\t\t\t\t\ttr.appendChild(th);\n\t\t\t\t\tif (text) {\n\t\t\t\t\t\tth.dataset.columnType = columnType;\n\t\t\t\t\t\tvar sortCode = _dictionarySortMode.getSortCode(columnType);\n\t\t\t\t\t\tvar textNode = document.createTextNode(`${text} ${sortCode}`)\n\t\t\t\t\t\tth.appendChild(textNode);\n\t\t\t\t\t\tif (columnType === _dictionarySortMode.keyColumnType) {\n\t\t\t\t\t\t\tlet span = document.createElement(\"span\");\n\t\t\t\t\t\t\tspan.className = \"resize-handle\";\n\t\t\t\t\t\t\tspan.innerHTML = \"&nbsp;\"\n\t\t\t\t\t\t\tth.appendChild(span);\n\t\t\t\t\t\t\tnew ResizableColumnHandler(th, span);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tth.addEventListener(\"click\", (event) => {\n\t\t\t\t\t\t\tif (event.target !== th || th.dataset.resizing)\n\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t_dictionarySortMode.toggleSortCode(event.target.dataset.columnType);\n\t\t\t\t\t\t\tshowCurrentlySelectedValue();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn th;\n\t\t\t\t}\n\t\t\n\t\t\t\t/**\n\t\t\t\t * Makes a Dictionary Cell\n\t\t\t\t * @param {HTMLTableRowElement} tr \n\t\t\t\t * @param {{cellValue: string, isDeleteCell: bool, disableTrashCan: bool}} options \n\t\t\t\t * @returns \n\t\t\t\t */\n\t\t\t\t_addDictionaryCell(tr, options) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\toptions = validateOptions(options, [\"cellValue\", \"isDeleteCell\", \"disableTrashCan\"]);\n\t\t\n\t\t\t\t\t\tvar cell = tr.insertCell(-1);\n\t\t\t\t\t\tcell.className = options.isDeleteCell ? \"dictDeleteCell\" : \"dictCell\";\n\t\t\t\t\t\tvar div = document.createElement(\"div\");\n\t\t\t\t\t\tdiv.className = \"dictCellContent\";\n\t\t\t\t\t\tcell.appendChild(div);\n\t\t\t\t\t\tif (options.isDeleteCell) {\n\t\t\t\t\t\t\tdiv.toggleClass(\"dictDeleteCellContent\", true);\n\t\t\t\t\t\t\tvar a = document.createElement(\"a\");\n\t\t\t\t\t\t\ta.href = \"#\";\n\t\t\t\t\t\t\ta.className = \"trashCan\";\n\t\t\t\t\t\t\ta.swapClasses(\"trashCanDisabled\", \"trashCanEnabled\", options.disableTrashCan == true);\n\t\t\t\t\t\t\ta.onclick = (event) => {\n\t\t\t\t\t\t\t\tvar cell = new DictionaryCell(event.target);\n\t\t\t\t\t\t\t\t_dictionaryHelper.deleteKeyAndRowAsync(cell, {saveUndo: true});\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tdiv.appendChild(a, -1);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (!options.cellValue)\n\t\t\t\t\t\t\t\tdiv.innerHTML = \"&nbsp;\"\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tdiv.innerText = options.cellValue;\n\t\t\t\t\t\t\tcell.ondblclick = (event) => { \n\t\t\t\t\t\t\t\t_dictionaryHelper.editCell(event.target);\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t};\n\t\t\t\t\n\t\t\t\t\t\t\t// This prevents the text being selected on a double-click.\n\t\t\t\t\t\t\tdiv.addEventListener('mousedown', function (event) {\n\t\t\t\t\t\t\t\tif (!_dictionaryCellEditAdapter.isAttached() && event.detail > 1) {\n\t\t\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, false);\n\t\t\t\t\t\t}\n\t\t\t\n\t\t\t\t\t\treturn cell;\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\n\t\t\t\taddDictionaryRow(tbody, index, key, value, disableTrashCan) {\n\t\t\t\t\tvar tr = tbody.insertRow(index);\n\t\t\t\t\ttr.className = \"selectableRow\";\n\n\t\t\t\t\tif (_dictionaryBuild_logging)\n\t\t\t\t\t\ttr.dataset.buildNumber = `${this._buildNumber}`;\n\t\t\n\t\t\t\t\tvar cell = this._addDictionaryCell(tr, {isDeleteCell: true, disableTrashCan: disableTrashCan});\n\t\t\n\t\t\t\t\tcell = this._addDictionaryCell(tr, {cellValue: key});\n\t\t\t\t\tcell.toggleClass(\"dictKeyCell\", true);\n\t\t\n\t\t\t\t\tcell = this._addDictionaryCell(tr, {cellValue: value});\n\t\t\t\t\tcell.toggleClass(\"dictValueCell\", true);\n\t\t\n\t\t\t\t\treturn tr;\n\t\t\t\t}\n\t\t\n\t\t\t\taddNewDictionaryRow() {\n\t\t\t\t\tvar tbody = document.querySelector(\".tblDictionary tbody\");\n\t\t\t\t\tthis.addDictionaryRow(tbody, -1, \"\", \"\", true);\n\t\t\t\t}\n\n\t\t\t\tbuild(variable) {\n\t\t\t\t\tif (_dictionaryBuild_logging) {\n\t\t\t\t\t\tthis._buildNumber += 1;\n\t\t\t\t\t\tconsole.log(`Building Table - Build Number: ${this._buildNumber}`); // \\nStack Trace:\\n${getStackTrace()}`);\n\t\t\t\t\t}\n\t\t\t\t\tvar dictionary = variable.value;\n\t\t\t\t\t_txtValue.setVisible(false);\n\t\t\t\t\t_divDictionary.setVisible(true);\n\t\t\t\t\tvar table = document.createElement(\"table\");\n\t\t\t\t\ttable.className = \"tblDictionary\"\n\t\n\t\t\t\t\tvar thead = table.createTHead();\n\t\t\t\t\tvar tr = thead.insertRow(-1);\n\t\n\t\t\t\t\tvar th = this._addDictionaryColumnHeader(tr, \"\", \"\");\n\t\t\t\t\tth = this._addDictionaryColumnHeader(tr, \"Key\", _dictionarySortMode.keyColumnType);\n\t\t\t\t\tth = this._addDictionaryColumnHeader(tr, \"Value\", _dictionarySortMode.valueColumnType);\n\t\n\t\t\t\t\tvar tbody = table.createTBody();\n\t\t\t\t\tObject.keys(dictionary).map(k => { return { key: k, value: dictionary[k] }; })\n\t\t\t\t\t\t.sort((a, b) => _dictionarySortMode.sortCompare(a, b))\n\t\t\t\t\t\t.forEach(item => {\n\t\t\t\t\t\t\tthis.addDictionaryRow(tbody, -1, item.key, item.value);\n\t\t\t\t\t\t});\n\t\t\t\t\tthis.addDictionaryRow(tbody, -1, \"\", \"\", true);\n\t\n\t\t\t\t\t_divDictionary.innerHTML = \"\";\n\t\t\t\t\t_divDictionary.appendChild(table);\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst _dictionaryBuilder = new DictionaryBuilder();\n\t\t// #endregion\n\n\t\t// #region ======== DictionaryHelper ========================\n\t\t\tclass DictionaryHelper {\n\t\t\t\tconstructor() {}\n\n\t\t\t\tgetRowKeyCellElement(rowElement) { return rowElement.querySelector(\".dictKeyCell\"); }\n\t\t\t\tgetRowKeyCellContentElement(rowElement) { return rowElement.querySelector(\".dictKeyCell .dictCellContent\"); }\n\t\t\t\tgetRowKey(rowElement) { return this.getRowKeyCellContentElement(rowElement).innerText; }\n\t\t\t\tgetRowValueCellElement(rowElement) { return rowElement.querySelector(\".dictValueCell\"); }\n\t\t\t\tgetRowValueCellContentElement(rowElement) { return rowElement.querySelector(\".dictValueCell .dictCellContent\"); }\n\t\t\t\tgetRowValue(rowElement) { return this,this.getRowValueCellContentElement(rowElement).innerText; }\n\t\t\t\tgetRowTrashCanElement(rowElement) { return rowElement.querySelector(\".trashCan\"); }\n\t\t\t\tgetIsNewRow(rowElement) { return rowElement.nextElementSibling == null; }\n\t\t\t\tgetFirstRowElement() { return _divDictionary.querySelector(\"tbody\").firstChild; }\n\t\t\t\tgetTableBodyElement()  { return _divDictionary.querySelector(\"tbody\"); }\n\n\t\t\t\t/**\n\t\t\t\t * Adds a new row to the table, adds the key and value to the variable's value,\n\t\t\t\t * and saves the variable changes. This uses setTimeout() to finish the action, so don't\n\t\t\t\t * assume it's complete when the call returns. This does NOT save an Undo action, because\n\t\t\t\t * this is only ever called from Undo/Redo.\n\t\t\t\t * @param {string} key \n\t\t\t\t * @param {string} value \n\t\t\t\t */\n\t\t\t\taddKeyAndRowForUndelete(key, value) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar variable = _selectOptions.getSelection().variable;\n\t\t\t\t\t\tvar newDictionaryContent = variable.value.clone();\n\t\t\t\t\t\tnewDictionaryContent[key] = value;\n\t\t\t\t\t\t_variables.changeVariable(variable, newDictionaryContent, { noOptionElement: true });\n\t\t\t\t\t\tvar index = this.getInsertBeforeRowIndex(key, value);\n\t\t\t\t\t\tvar body = this.getTableBodyElement();\n\t\t\t\t\t\tvar row = _dictionaryBuilder.addDictionaryRow(body, index, key, value);\n\t\t\t\t\t\trow.scrollIntoViewIfNeeded();\n\t\t\t\t\t\tvar cell = new DictionaryCell(this.getRowKeyCellElement(row));\n\t\t\t\t\t\t_momentaryClassController.apply(cell.row, \"selectedRow\", 1500);\n\t\t\t\t\t\tcell.animateForUndelete(300);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/**\n\t\t\t\t * Deletes the table row for the specified cell, deletes the key in the variable's value,\n\t\t\t\t * and saves the variable changes. This uses setTimeout() to finish the action, so don't\n\t\t\t\t * assume it's complete when the call returns.\n\t\t\t\t * @param {DictionaryCell} cell any cell in the row\n\t\t\t\t * @param {{saveUndo: bool}} [options]\n\t\t\t\t */\n\t\t\t\tdeleteKeyAndRowAsync(cell, options) {\n\n\t\t\t\t\tfunction finishDelete(cell) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar variable = _selectOptions.getSelectedVariable();\n\t\t\t\t\t\t\tvar newDictionaryContent = variable.value.clone();\n\t\t\t\t\t\t\tvar undoDictionaryAction = new UndoRedoDictionaryKeyDeletedAction(cell.rowKey, cell.rowValue);\n\t\t\t\t\t\t\tdelete newDictionaryContent[cell.rowKey];\n\t\t\t\t\t\t\t_variables.changeVariable(variable, newDictionaryContent, { saveUndo: options.saveUndo, undoDictionaryAction: undoDictionaryAction});\n\t\t\t\t\t\t\tcell.row.remove();\n\t\t\t\t\t\t\tenableControls();\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\n\t\t\t\t\ttry {\n\t\t\t\t\t\toptions = validateOptions(options, [\"saveUndo\"]);\n\t\t\t\t\t\tcell.animateForDelete(300, finishDelete);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/**\n\t\t\t\t * @param {DictionaryCell | HTMLElement} cell \n\t\t\t\t */\n\t\t\t\teditCell(cell) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (_dictionaryCellEditAdapter.isAttached())\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\tif (!cell.isDictionaryCell)\n\t\t\t\t\t\t\tcell = new DictionaryCell(cell);\n\t\t\t\t\t\tif (cell.isNewRow && cell.isValueCell && !cell.rowKey) {\n\t\t\t\t\t\t\tsetTimeout(() => { _modalDialogController.showInfoDialog(\"You have to enter the Key first.\"); }, 10)\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_dictionaryCellEditAdapter.attach(_selectOptions.getSelectedVariable(), cell.cell);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/**\n\t\t\t\t * Finds and selects the Dictionary Option for the specified variable, and returns\n\t\t\t\t * a DictionaryCell for the Key cell for specified rowKey. If the dictionary is not\n\t\t\t\t * currently selected, it will be selected. If the dictionary is not available because\n\t\t\t\t * of a filter, the filter will be cleared.\n\t\t\t\t * @param {string} variableName\n\t\t\t\t * @param {string} keyName\n\t\t\t\t * @param {{highlightRow: bool, highlightKeyCell: bool, highlightValueCell: bool, returnNullIfKeyNotFound: bool}} [options]\n\t\t\t\t * @returns {{cell: DictionaryCell, optionWasAlreadySelected: bool}}\n\t\t\t\t */\n\t\t\t\tfindAndSelectKeyCell(variableName, keyName, options) {\n\n\t\t\t\t\tfunction findTheKeyCell(self) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar row = self.getFirstRowElement();\n\t\t\t\t\t\t\twhile (row) {\n\t\t\t\t\t\t\t\tif (!self.getIsNewRow(row)) {\n\t\t\t\t\t\t\t\t\tif (self.getRowKey(row) === keyName)\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trow = row.nextElementSibling;\n\t\t\t\t\t\t\t}\n\t\t\t\n\t\t\t\t\t\t\tif (!row) {\n\t\t\t\t\t\t\t\tif (options.returnNullIfKeyNotFound)\n\t\t\t\t\t\t\t\t\treturn self;\n\t\t\t\t\t\t\t\tthrow new Error(`Can't find row for keyName \"${keyName}\"`);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\trow.scrollIntoViewIfNeeded();\n\t\t\t\t\t\t\treturn new DictionaryCell(self.getRowKeyCellElement(row));\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\toptions = validateOptions(options, [\"highlightRow\", \"highlightKeyCell\", \"highlightValueCell\", \"returnNullIfKeyNotFound\"]);\n\t\t\t\t\t\tvar alreadySelected = _selectOptions.findAndSelectOptionForVariable(variableName).optionWasAlreadySelected === true;\n\t\t\t\t\t\tvar cell = findTheKeyCell(this);\n\t\t\t\t\t\tif (cell) {\n\t\t\t\t\t\t\tif (options.highlightRow)\n\t\t\t\t\t\t\t\t_momentaryClassController.apply(cell.row, \"selectedRow\", 1500);\n\t\t\t\t\t\t\telse if (options.highlightKeyCell)\n\t\t\t\t\t\t\t\t_momentaryClassController.apply(this.getRowKeyCellElement(cell.row), \"selectedCell\", 1500);\n\t\t\t\t\t\t\telse if (options.highlightValueCell)\n\t\t\t\t\t\t\t\t_momentaryClassController.apply(this.getRowValueCellElement(cell.row), \"selectedCell\", 1500);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tcell: cell,\n\t\t\t\t\t\t\toptionWasAlreadySelected: alreadySelected\n\t\t\t\t\t\t};\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/**\n\t\t\t\t * Returns the index of the table row for use in tbody.insertRow(), to insert the\n\t\t\t\t * row in the property sort position based on the specified key/value combination.\n\t\t\t\t * @param {string} key \n\t\t\t\t * @param {string} value \n\t\t\t\t * @returns {HTMLTableRowElement}\n\t\t\t\t */\n\t\t\t\tgetInsertBeforeRowIndex(key, value) {\n\t\t\t\t\tvar keyAndValue = { key: key, value: value };\n\t\t\t\t\tvar body = this.getTableBodyElement();\n\t\t\t\t\tfor (let i = 0; i < body.children.length; i++) {\n\t\t\t\t\t\tconst row = body.children[i];\n\t\t\t\t\t\tif (this.getIsNewRow(row))\n\t\t\t\t\t\t\treturn i;\n\t\t\t\t\t\tif (_dictionarySortMode.sortCompare(keyAndValue, {key: this.getRowKey(row), value: this.getRowValue(row)}) < 0)\n\t\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\n\t\t\t\tsaveCellEdit(nextCellDirection) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar cell = _dictionaryCellEditAdapter.getCell().cell;\n\t\t\t\t\t\tif (!_dictionaryCellEditAdapter.validateAndSave() || !nextCellDirection)\n\t\t\t\t\t\t\treturn;\n\t\t\n\t\t\t\t\t\tvar nav = new DictionaryCellNavigator(cell);\n\t\t\t\t\t\tvar nextCell = null;\n\t\t\t\t\t\tswitch (nextCellDirection) {\n\t\t\t\t\t\t\tcase \"left\":\n\t\t\t\t\t\t\t\tnextCell = nav.getCellLeft();\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"right\":\n\t\t\t\t\t\t\t\tnextCell = nav.getCellRight();\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"up\":\n\t\t\t\t\t\t\t\tnextCell = nav.getCellAbove();\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"down\":\n\t\t\t\t\t\t\t\tnextCell = nav.getCellBelow();\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tthrow new Error(`Unknown nextCellDirection: \"${nextCellDirection}\"`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (nextCell) {\n\t\t\t\t\t\t\t_dictionaryCellEditAdapter.attach(_selectOptions.getSelectedVariable(), nextCell);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tErrorHandler.handle(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst _dictionaryHelper = new DictionaryHelper();\n\t\t// #endregion\t\t\n\t\n\t// #endregion\n\n\t// #region ======== Enable Controls =========================\n\t\tfunction adjustWrapableTooltipAignment() {\n\t\t\tvar lastFirstLineButton = null;\n\t\t\tvar button = _divVariableToolButtons.firstElementChild;\n\t\t\twhile (button != null) {\n\t\t\t\tif (button.isVisible()) {\n\t\t\t\t\tif (button.hasClass(\"btnToolSeparator\"))\n\t\t\t\t\t\tbutton.toggleClass(\"invisible\", false);\n\t\t\t\t\tif (lastFirstLineButton == null)\n\t\t\t\t\t\tlastFirstLineButton = button;\n\t\t\t\t\telse if (button.offsetTop < lastFirstLineButton.offsetTop + 20 && button.offsetLeft > lastFirstLineButton.offsetLeft)\n\t\t\t\t\t\tlastFirstLineButton = button;\n\t\t\t\t\tvar tooltipText = button.querySelector(\".tooltipText\");\n\t\t\t\t\tif (tooltipText)\n\t\t\t\t\t\ttooltipText.swapClasses(\"tooltipTextRight\", \"tooltipTextCenter\", button.offsetLeft < 40);\n\t\t\t\t}\n\t\t\t\tbutton = button.nextElementSibling;\n\t\t\t}\n\n\t\t\tif (lastFirstLineButton && lastFirstLineButton.hasClass(\"btnToolSeparator\"))\n\t\t\t\tlastFirstLineButton.toggleClass(\"invisible\", true);\n\t\t}\n\n\t\tfunction enableControls() {\n\n\t\t\tfunction setTooltipText(element, text) {\n\t\t\t\tvar tooltiptextElement = element.getElementsByClassName(\"tooltipText\");\n\t\t\t\tif (tooltiptextElement.length !== 1)\n\t\t\t\t\tthrow new Error(`${element} must have one and only one tooltipText element`);\n\t\t\t\ttooltiptextElement = tooltiptextElement[0];\n\t\t\t\tvar existingText = tooltiptextElement.textContent;\n\t\t\t\tvar matches = /( -.*)/.exec(existingText);\n\t\t\t\tvar hotkeyText = (matches && matches.length) > 0 ? matches[0] : \"\";\n\t\t\t\ttooltiptextElement.innerText = `${text}${hotkeyText}`\n\t\t\t}\n\n\t\t\tfunction enableToolButton(btn, enabled, visible, down) {\n\t\t\t\tvisible = visible == null || btn.setVisible(visible);\n\t\t\t\tif (!visible)\n\t\t\t\t\tenabled = false;\n\t\t\t\telse if (enabled == null)\n\t\t\t\t\tenabled = true;\n\t\t\t\tbtn.toggleClass(\"disabled\", !enabled);\n\t\t\t\tbtn.toggleClass(\"btnToolHover\", enabled);\n\t\t\t\tif (down != null)\n\t\t\t\t\tbtn.setButtonDown(down);\n\t\t\t}\n\n\t\t\tfunction enableRegularButtons(btn, enable) {\n\t\t\t\tbtn.toggleClass(\"disabled\", !enable);\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tvar selections = _selectOptions.getSelections().selections;\n\t\t\t\tvar selectedVariable = selections.length === 1 ? selections[0].variable : null;\n\t\t\t\tvar isDictionaryShowing = selectedVariable != null && _divDictionary.isVisible();\n\t\t\t\tvar isDictionary = selectedVariable != null && selectedVariable.isDictionary;\n\t\t\t\tvar editingDicionary = _dictionaryCellEditAdapter.isAttached();\n\t\t\t\tvar dialogShowing = _modalDialogController.isShowing;\n\n\t\t\t\tenableToolButton(_btnAddVariable, !_editMode && !editingDicionary && !dialogShowing);\n\t\t\t\tenableToolButton(_btnCode, selectedVariable != null && !dialogShowing, !isDictionaryShowing, _miscStateController.fixedFont);\n\t\t\t\tenableToolButton(_btnCopyNames, selections.length > 0 && !_editMode && !editingDicionary && !dialogShowing);\n\t\t\t\tenableToolButton(_btnCopyVariables, selections.length > 0 && !_editMode && !editingDicionary && !dialogShowing);\n\t\t\t\tenableToolButton(_btnDeleteVariables, selections.length > 0 && !_editMode && !editingDicionary && !dialogShowing);\n\t\t\t\tenableToolButton(_btnRenameVariable, selectedVariable != null && !_editMode && !editingDicionary && !dialogShowing);\n\n\t\t\t\t_btnEdit.toggleClass(\"pseudoDisabled\", false);\n\t\t\t\tenableToolButton(_btnEdit, selectedVariable != null && !dialogShowing, !_editMode && !isDictionary);\n\t\t\t\tif (_btnEdit.isVisible() && _btnEdit.isEnabled() && isLocalVariableCantEdit(selectedVariable))\n\t\t\t\t\t_btnEdit.toggleClass(\"pseudoDisabled\", true);\n\n\t\t\t\tenableToolButton(_btnEditCancel, null, _editMode);\n\t\t\t\tenableToolButton(_btnEditOK, null, _editMode);\n\t\t\t\tenableToolButton(_btnHelp, !dialogShowing, isDictionaryShowing);\n\n\t\t\t\tvar clickHidesVariable = _hiddenVariables.getSelectedVariablesToggleShouldHide();\n\t\t\t\tenableToolButton(_btnHiddenVariables_toggleVariables, selections.length > 0 && !_editMode && !editingDicionary && !dialogShowing, _hiddenVariables.enabled);\n\t\t\t\tif (_imgHiddenVariables_toggleVariables_hide.setVisible(clickHidesVariable)) {\n\t\t\t\t\t_imgHiddenVariables_toggleVariables_unhide.setVisible(false);\n\t\t\t\t\tsetTooltipText(_btnHiddenVariables_toggleVariables, \"Hide selected variable(s)\");\n\t\t\t\t} else {\n\t\t\t\t\t_imgHiddenVariables_toggleVariables_unhide.setVisible(true);\n\t\t\t\t\tsetTooltipText(_btnHiddenVariables_toggleVariables, \"Unhide selected variable(s)\");\n\t\t\t\t}\n\n\t\t\t\tenableToolButton(_btnHiddenVariables_toggleViewMode, !_editMode && !editingDicionary && !dialogShowing, _hiddenVariables.enabled);\n\t\t\t\tif (_btnHiddenVariables_toggleViewMode.isVisible()) {\n\t\t\t\t\tif (_imgHiddenVariables_toggleViewMode_all.setVisible(_hiddenVariables.viewMode === HiddenVariablesViewMode.all)) {\n\t\t\t\t\t\tsetTooltipText(_btnHiddenVariables_toggleViewMode, \"Showing All Variables\");\n\t\t\t\t\t\t_infoHiddenVariables_warning.setVisible(false);\n\t\t\t\t\t}\n\t\t\t\t\tif (_imgHiddenVariables_toggleViewMode_hide.setVisible(_hiddenVariables.viewMode === HiddenVariablesViewMode.hide)) {\n\t\t\t\t\t\tsetTooltipText(_btnHiddenVariables_toggleViewMode, `Showing \"Visible\" Variables Only`);\n\t\t\t\t\t\tif (_infoHiddenVariables_warning.setVisible(_hiddenVariables.areAnyVariablesHiddenInThisViewMode()))\n\t\t\t\t\t\t\t_infoHiddenVariables_warningText.innerText = \"Some variables are hidden\";\n\t\t\t\t\t\t}\n\t\t\t\t\tif (_imgHiddenVariables_toggleViewMode_only.setVisible(_hiddenVariables.viewMode === HiddenVariablesViewMode.only)) {\n\t\t\t\t\t\tsetTooltipText(_btnHiddenVariables_toggleViewMode, \"Showing Hidden Variables only\");\n\t\t\t\t\t\t_infoHiddenVariables_warning.setVisible(true);\n\t\t\t\t\t\tif (selections.length > 0)\n\t\t\t\t\t\t\t_infoHiddenVariables_warningText.innerText = \"Showing Hidden Variables Only\";\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\t_infoHiddenVariables_warningText.innerText = \"No Hidden Variables\";\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t_infoHiddenVariables_warning.setVisible(false);\n\t\t\t\t}\n\n\t\t\t\tenableToolButton(_btnJson, null, selectedVariable != null && selectedVariable.jsonValue != null && !_editMode && !editingDicionary && !dialogShowing, _isShowingJsonData);\n\t\t\t\tenableToolButton(_btnSearchKM, selectedVariable != null && !_editMode && !editingDicionary && !dialogShowing);\n\t\t\t\tenableToolButton(_btnSort, !_editMode && !editingDicionary && !dialogShowing, null, _variableSortMode.sortBySize);\n\t\t\t\tenableToolButton(_btnWordWrap, selectedVariable != null && !dialogShowing, !isDictionaryShowing, _miscStateController.wordWrap);\n\n\t\t\t\tenableToolButton(_btnRedo, !_undoRedoStack.redoStackIsEmpty() && !_editMode && !editingDicionary && !dialogShowing);\n\t\t\t\tsetTooltipText(_btnRedo, _undoRedoStack.getRedoTooltip());\n\n\t\t\t\tenableToolButton(_btnUndo, !_undoRedoStack.undoStackIsEmpty() && !_editMode && !editingDicionary && !dialogShowing);\n\t\t\t\tsetTooltipText(_btnUndo, _undoRedoStack.getUndoTooltip());\n\n\t\t\t\tenableRegularButtons(_btnCancel, !_editMode && !editingDicionary && !dialogShowing);\n\t\t\t\tenableRegularButtons(_btnOK, !_editMode && !editingDicionary && !dialogShowing);\n\t\t\t\tenableRegularButtons(_btnReload, !_editMode && !editingDicionary && !dialogShowing);\n\n\t\t\t\t_optionsMenu.toggleClass(\"optionsMenuDisabled\", _editMode || editingDicionary || dialogShowing);\n\n\t\t\t\tadjustWrapableTooltipAignment();\n\n\t\t\t\tvar firstVisibleButton = true;\n\t\t\t\tvar button = document.getElementById(\"divValueToolButtons\").lastElementChild;\n\t\t\t\twhile (button != null && button.hasClass(\"btnToolRight\")) {\n\t\t\t\t\tif (button.isVisible()) {\n\t\t\t\t\t\tvar tooltipText = button.querySelector(\".tooltipText\");\n\t\t\t\t\t\tif (tooltipText)\n\t\t\t\t\t\t\ttooltipText.swapClasses(\"tooltipTextLeft\", \"tooltipTextCenter\", firstVisibleButton);\n\t\t\t\t\t\tfirstVisibleButton = false;\n\t\t\t\t\t}\n\t\t\t\t\tbutton = button.previousElementSibling;\n\t\t\t\t}\n\n\t\t\t\t_inpSearchFilter.setEnabled(!_editMode && !editingDicionary && !dialogShowing);\n\t\t\t\t_selVariables.setEnabled(!_editMode && !editingDicionary && !dialogShowing);\n\t\t\t\tif (_editMode)\n\t\t\t\t\t_txtValue.removeAttribute(\"readonly\");\n\t\t\t\telse\n\t\t\t\t\t_txtValue.setAttribute(\"readonly\", true);\n\n\t\t\t\tadjustSelVariablesHeight();\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\t// #endregion\n\n\t// #region ======== showCurrentlySelectedValue ==============\n\t\tvar _isShowingJsonData = false;\n\t\tfunction showCurrentlySelectedValue() {\n\n\t\t\tfunction showTextValue(value) {\n\t\t\t\t_txtValue.toggleClass(\"fixedFont\", _miscStateController.fixedFont);\n\t\t\t\t_txtValue.wrap = _miscStateController.wordWrap ? \"soft\" : \"off\";\n\t\t\t\t_txtValue.setVisible(true);\n\t\t\t\t_divDictionary.setVisible(false);\n\t\t\t\t_txtValue.value = value;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\t_isShowingJsonData = false;\n\t\t\t\tvar selectedVariable = _selectOptions.getSelectedVariable();\n\t\t\t\tif (!selectedVariable) {\n\t\t\t\t\tshowTextValue(\"\")\n\t\t\t\t} else if (selectedVariable.jsonValue != null\n\t\t\t\t\t&& (\n\t\t\t\t\t\t(selectedVariable.isDictionary && _miscStateController.jsonDictionaryDisplayMode)\n\t\t\t\t\t\t|| (!selectedVariable.isDictionary && _miscStateController.jsonVariableDisplayMode)\n\t\t\t\t\t\t)\n\t\t\t\t\t) {\n\t\t\t\t\t_isShowingJsonData = true;\n\t\t\t\t\tshowTextValue(selectedVariable.jsonValue);\n\t\t\t\t} else if (selectedVariable.isDictionary) {\n\t\t\t\t\t_dictionaryBuilder.build(selectedVariable);\n\t\t\t\t} else {\n\t\t\t\t\tshowTextValue(selectedVariable.value);\n\t\t\t\t}\n\n\t\t\t\t_statusLine.refresh();\n\t\t\t\tenableControls();\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t}\n\t\t}\n\t// #endregion\n\t\n\t// #region ======== Filtering Stuff =========================\n\t\tconst FilterModes = {\n\t\t\tcontains: \"contains\",\n\t\t\tletters: \"letters\",\n\t\t\tgroups: \"groups\"\n\t\t};\n\t\n\t\t/**\n\t\t * @param {bool} [callFillSelect] Default is true. If the filter is\n\t\t * changed, should \"fillSelect()\" get called?\n\t\t * @returns true if the filter was changed, false if not.\n\t\t */\n\t\tfunction clearSearchFilter(callFillSelect) {\n\t\t\tif (_inpSearchFilter.value) {\n\t\t\t\t_inpSearchFilter.value = \"\";\n\t\t\t\tif (callFillSelect !== false)\n\t\t\t\t\tfillSelect();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\tfunction filterVariables(variables, filterText, filterMode) {\n\n\t\t\tfunction matchesFilter_ContainsMode(target) {\n\t\t\t\treturn target.toLowerCase().indexOf(filterText) >= 0;\n\t\t\t}\n\n\t\t\tfunction matchesFilter_LettersMode(target) {\n\t\t\t\ttarget = target.toLowerCase();\n\t\t\t\tvar index = 0;\n\t\t\t\tfor (let i = 0; i < filterText.length; i++) {\n\t\t\t\t\tindex = target.indexOf(filterText.charAt(i), index);\n\t\t\t\t\tif (index < 0)\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tvar filterGroups = null;\n\t\t\tfunction matchesFilter_GroupsMode(target) {\n\t\t\t\tif (!filterGroups)\n\t\t\t\t\tfilterGroups = filterText.trim().split(/\\s*/);\n\t\t\t\ttarget = target.toLowerCase();\n\t\t\t\tfor (let i = 0; i < filterGroups.length; i++) {\n\t\t\t\t\tif (target.indexOf(filterGroups[i]) < 0) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (!filterText)\n\t\t\t\treturn variables;\n\n\t\t\tfilterText = filterText.toLowerCase();\n\t\t\tvar filterProc;\n\t\t\tswitch (filterMode) {\n\t\t\t\tcase FilterModes.contains:\n\t\t\t\t\tfilterProc = matchesFilter_ContainsMode;\n\t\t\t\t\tbreak;\n\t\t\t\tcase FilterModes.letters:\n\t\t\t\t\tfilterProc = matchesFilter_LettersMode;\n\t\t\t\t\tbreak;\n\t\t\t\tcase FilterModes.groups:\n\t\t\t\t\tfilterProc = matchesFilter_GroupsMode;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error(`Unknown FilterMode \"${filterMode}\"`);\n\t\t\t}\n\n\t\t\treturn variables.filter(v => {\n\t\t\t\treturn filterProc(v.name);\n\t\t\t});\n\t\t}\n\t\t\n\t\tfunction inpSearchFilterKeyUp() {\n\t\t\tfillSelect();\n\t\t}\n\n\t// #endregion\n\n\t// #region ======== fillSelect Stuff ========================\n\t\tvar _lastFilterText = \"\";\n\t\tfunction fillSelect() {\n\t\t\ttry {\n\t\t\t\t_dictionaryCellEditAdapter.detach();\n\t\t\t\t_floatingWarning.hide(true);\n\n\t\t\t\tvar filterText = _inpSearchFilter.value;\n\t\t\t\tvar reSelectVariableName = null;\n\t\t\t\tif (!filterText && _lastFilterText) {\n\t\t\t\t\tlet sel = _selectOptions.getSelectedVariable();\n\t\t\t\t\treSelectVariableName = sel ? sel.name : null;\n\t\t\t\t}\n\t\t\t\t_lastFilterText = filterText;\n\n\t\t\t\tdocument.querySelectorAll('#selVariables option').forEach(o => o.remove());\n\t\t\t\tvar list = _variables.data.sort(_variableSortMode.getSortCompareFunction());\n\t\t\t\tif (filterText)\n\t\t\t\t\tlist = filterVariables(list, filterText, _filterMode);\n\t\t\t\tif (_hiddenVariables.viewMode != HiddenVariablesViewMode.all)\n\t\t\t\t\tlist = list.filter(variable => !_hiddenVariables.getVariableIsHiddenInThisViewMode(variable.name));\n\n\t\t\t\tlist.forEach(variable => {\n\t\t\t\t\t_selVariables.add(_selectOptions.makeOptionElement(variable));\n\t\t\t\t});\n\n\t\t\t\tif (!_variables.getIsEmpty()) {\n\t\t\t\t\tlet selIndex = 0;\n\t\t\t\t\tif (reSelectVariableName) {\n\t\t\t\t\t\tlet option = _selectOptions.getOptionByVariableName(reSelectVariableName, false);\n\t\t\t\t\t\tif (option)\n\t\t\t\t\t\t\tselIndex = option.index;\n\t\t\t\t\t}\n\t\t\t\t\t_selectOptions.selectedIndex = selIndex;\n\t\t\t\t\tif (document.activeElement !== _inpSearchFilter)\n\t\t\t\t\t\t_selVariables.focus();\n\t\t\t\t}\n\t\t\t\tshowCurrentlySelectedValue();\n\n\t\t\t\tif (_loadErrorMessages && _loadErrorMessages.length > 0) {\n\t\t\t\t\tvar msgs = _loadErrorMessages.join(\"\\n\");\n\t\t\t\t\t_loadErrorMessages = null;\n\t\t\t\t\t_modalDialogController.showInfoDialog(msgs);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tErrorHandler.handle(e);\n\t\t\t} \n\t\t}\n\t// #endregion\n\n// #endregion\n\n// #region ======== Logging flags ===========================\n\tvar _saveKMVariableValue_logging = false;\n\tvar _undoRedoStack_logging = \"\"; // \"summary\", \"detail\"\n\tvar _dictionaryBuild_logging = false;\n\tvar _logNumber = 1;\n// #endregion\n\n// #region ======== Main Body Logic =========================\n\n\tvar _parameters;\n\tvar _isAsync;\n\tvar _showReloadButton;\n\tvar _openConsoleMacroUUID;\n\tvar _filterMode;\n\tvar _loadErrorMessages = [];\n\tvar _macroGroupName;\n\tvar _showingGlobalVariables = false;\n\tvar _showingAllGlobalVariables = false;\n\tvar _showingLocalVariables = false;\n\tvar _showingDictionaries = false;\n\tvar _showingAllDictionaries = false;\n\tvar _kmwindowid;\n\n\tfunction splitVariableNames(names) {\n\t\treturn names.split(/,|\\n/gm).map(n => n.trim());\n\t}\n\n\tfunction tryParseJson(jsonString, description, required) {\n\t\tif (!jsonString) {\n\t\t\tif (required)\n\t\t\t\tthrow new Error(`${description} is required`);\n\t\t\treturn null;\n\t\t}\n\t\ttry {\n\t\t\treturn JSON.parse(jsonString);\n\t\t} catch (e) {\n\t\t\tthrow new Error(`Error parsing \"${description}\": ${e.message}\\nValue:\\n${jsonString}`);\n\t\t}\n\t}\n\n\t// NOTE: This can get called from KM, using an \"Execute Javascript in Custom HTML Prompt\" action.\n\t// It can also be called internally.\n\tfunction reloadData(dataString) {\n\n\t\tfunction reloadAllGlobalVariables(allGlobalVariableNames) {\n\t\t\t_variables.data = _variables.data.filter(variable => {\n\t\t\t\treturn variable.isDictionary || variable.isLocalVariable;\n\t\t\t});\n\t\t\tvar variableNames = splitVariableNames(allGlobalVariableNames).removeDups();\n\t\t\tvariableNames.forEach(name => {\n\t\t\t\t_variables.data.push(_variables.createVariable(name));\n\t\t\t});\n\t\t}\n\n\t\tfunction reloadExistingGlobalVariables() {\n\t\t\tfor (let i = 0; i < _variables.data.length; i++) {\n\t\t\t\tconst variable = _variables.data[i];\n\t\t\t\tif (!variable.isDictionary && !variable.isLocalVariable)\n\t\t\t\t\t_variables.data[i] = _variables.createVariable(variable.name)\n\t\t\t}\n\t\t}\n\n\t\tfunction reloadLocalVariables() {\n\t\t\tfor (let i = 0; i < _variables.data.length; i++) {\n\t\t\t\tconst variable = _variables.data[i];\n\t\t\t\tif (variable.isLocalVariable)\n\t\t\t\t\t_variables.data[i] = _variables.createVariable(variable.name);\n\t\t\t}\n\t\t}\n\n\t\tfunction reloadAllDictionaries(allDictionaryNames) {\n\t\t\t_variables.data = _variables.data.filter(variable => {\n\t\t\t\treturn !variable.isDictionary;\n\t\t\t});\n\t\t\tvar variableNames = splitVariableNames(allDictionaryNames).removeDups();\n\t\t\tvariableNames.forEach(name => {\n\t\t\t\t_variables.data.push(_variables.createDictionaryVariable(name));\n\t\t\t});\n\t\t}\n\n\t\tfunction reloadExistingDictionaries() {\n\t\t\tfor (let i = 0; i < _variables.data.length; i++) {\n\t\t\t\tconst variable = _variables.data[i];\n\t\t\t\tif (variable.isDictionary)\n\t\t\t\t\t_variables.data[i] = _variables.createDictionaryVariable(variable.dictionaryName);\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\tconsole.log(`reloadData`);\n\t\t\t_undoRedoStack.clear();\n\n\t\t\tvar parameters = tryParseJson(dataString, \"reloadData dataString\", true);\n\n\t\t\tif (parameters.allGlobalVariableNames)\n\t\t\t\treloadAllGlobalVariables(parameters.allGlobalVariableNames);\n\t\t\telse\n\t\t\t\treloadExistingGlobalVariables();\n\n\t\t\tif (!_isAsync)\n\t\t\t\treloadLocalVariables();\n\n\t\t\tif (parameters.allDictionaryNames)\n\t\t\t\treloadAllDictionaries(parameters.allDictionaryNames);\n\t\t\telse\n\t\t\t\treloadExistingDictionaries();\n\n\t\t\tfillSelect();\n\t\t\tsetSelectIndexAsync(0);\n\t\t\tsetTimeout(() => _statusLine.showMomentaryMessage(\"Data has been loaded/reloaded\"), 100);\n\t\t} catch (e) {\n\t\t\tErrorHandler.handle(e);\n\t\t}\n\t}\n\n\tfunction loadData() {\n\n\t\tfunction parseFilterMode(filterMode) {\n\t\t\tvar result = filterMode.toLowerCase();\n\t\t\tvar validFilterModes = Object.keys(FilterModes);\n\t\t\tif (validFilterModes.indexOf(result) < 0) {\n\t\t\t\t_loadErrorMessages.push(`Invalid searchFilterMode \"${filterMode}\". Valid values are \"${validFilterModes.join('\" | \"')}\".`);\n\t\t\t\treturn FilterModes.contains;\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\n\t\ttry {\n\t\t\t_isAsync = _parameters.isAsync == \"1\";\n\t\t\t_macroGroupName = _parameters.macroGroupName;\n\t\t\t_showReloadButton = _parameters.showReloadButton == \"1\";\n\t\t\tif (_parameters.canHideVariables == \"1\")\n\t\t\t\t_hiddenVariables.enabled = true;\n\n\t\t\t_openConsoleMacroUUID = _parameters.openConsoleMacroUUID;\n\t\t\tif (_openConsoleMacroUUID)\n\t\t\t\tdocument.getElementById(\"openConsole\").setVisible(true);\n\n\t\t\t_filterMode = parseFilterMode(_parameters.searchFilterMode);\n\n\t\t\tvar variableNames = [];\n\t\t\tif (_parameters.allGlobalVariableNames) {\n\t\t\t\tvariableNames = splitVariableNames(_parameters.allGlobalVariableNames);\n\t\t\t\t_showingAllGlobalVariables = true;\n\t\t\t}\n\n\t\t\tif (_parameters.variableNames) {\n\t\t\t\tvariableNames = variableNames.concat(splitVariableNames(_parameters.variableNames));\n\t\t\t}\n\n\t\t\tvariableNames = variableNames.removeDups();\n\n\t\t\tif (_parameters.showParameters != \"1\") {\n\t\t\t\tconst viVariableNames = [\n\t\t\t\t\t\"Instance_VipParameters\", \n\t\t\t\t\t\"VIP TESTING Variable Inspector Prompt Path\",\n\t\t\t\t\t\"VIP TESTING Open Console Macro UUID\",\n\t\t\t\t\t\"VIP TESTING Show Parameters\"\n\t\t\t\t];\n\t\t\t\tvariableNames = variableNames.filter(n => viVariableNames.indexOf(n) < 0);\n\t\t\t}\n\n\t\t\tvariableNames.forEach(name => {\n\t\t\t\tif (_variables.isLocalVariableName(name))\n\t\t\t\t\t_showingLocalVariables = true;\n\t\t\t\telse\n\t\t\t\t\t_showingGlobalVariables = true;\n\t\t\t\t_variables.data.push(_variables.createVariable(name));\n\t\t\t});\n\n\t\t\tvar dictionaryNames = null;\n\t\t\tif (_parameters.allDictionaryNames) {\n\t\t\t\t_showingAllDictionaries = true;\n\t\t\t\t_showingDictionaries = true;\n\t\t\t\tdictionaryNames = _parameters.allDictionaryNames;\n\t\t\t} else if (_parameters.dictionaryNames) {\n\t\t\t\tdictionaryNames = _parameters.dictionaryNames;\n\t\t\t\t_showingDictionaries = true;\n\t\t\t}\n\n\t\t\tif (dictionaryNames) {\n\t\t\t\tdictionaryNames = splitVariableNames(dictionaryNames).removeDups();\n\t\t\t\tdictionaryNames.forEach(name => {\n\t\t\t\t\tif (name)\n\t\t\t\t\t\t_variables.data.push(_variables.createDictionaryVariable(name));\n\t\t\t\t});\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tErrorHandler.handle(e);\n\t\t}\n\t}\n\n\tfunction setupUI() {\n\t\ttry {\n\t\t\tloadData();\n\t\t\tinitControls();\n\t\t\tfillSelect();\n\t\t\t_internalTasksMacro.initialize();\n\t\t} catch (e) {\n\t\t\tErrorHandler.handle(e);\n\t\t}\n\t}\n\n\tfunction KMDidShowWindow() {\n\t\ttry {\n\t\t\t_splitterHandler = new SplitterHandler(document.getElementById(\"divSplitter\"), document.getElementById(\"divVariables\"));\n\t\t\tvar splitterPosition = _appStateDataController.getAdditionalData(\"splitterPosition\");\n\t\t\tif (splitterPosition)\n\t\t\t\t_splitterHandler.setSplitterPosition(splitterPosition);\n\t\t\t\n\t\t\tsetTimeout(setupUI, 1);\n\t\t} catch (e) {\n\t\t\tErrorHandler.handle(e);\n\t\t}\n\t}\n\n\tfunction KMWindow() {\n\t\tvar appDataVariableName;\n\t\tconst oldWindowPositionVariableName = \"DND__VipWindowPosition\";\n\n\t\tfunction convertOldWindowPositionVariable() {\n\t\t\tvar oldWindowPosition = window.KeyboardMaestro.GetVariable(oldWindowPositionVariableName);\n\t\t\tif (!oldWindowPosition)\n\t\t\t\treturn;\n\n\t\t\tif (!window.KeyboardMaestro.GetVariable(appDataVariableName))\n\t\t\t\twindow.KeyboardMaestro.SetVariable(appDataVariableName, oldWindowPosition);\n\t\t\twindow.KeyboardMaestro.SetVariable(oldWindowPositionVariableName, \"%Delete%\");;\n\t\t}\n\n\t\ttry {\n\t\t\t_parameters = tryParseJson(document.kmvar.Instance_VipParameters, \"Instance_VipParameters\", true);\n\t\t\tappDataVariableName = _parameters.appDataVariableName || \"DND__VipAppData\";\n\n\t\t\t_kmwindowid = document.body.dataset.kmwindowid;\n\t\t\tdocument.getElementById(\"version\").innerText = `v${_version}`;\n\n\t\t\tconvertOldWindowPositionVariable();\n\t\t\t_appStateDataController = new AppStateDataController(appDataVariableName, true, true, ErrorHandler.log);\n\t\t\t_appStateDataController.registerPreSaveCallback((controller) => {\n\t\t\t\tif (_splitterHandler)\n\t\t\t\t\tcontroller.setAdditionalData(\"splitterPosition\", _splitterHandler.getSplitterPosition());\n\t\t\t});\n\n\t\t\tvar width = 800;\n\t\t\tvar height = 600;\n\n\t\t\treturn _appStateDataController.getKMWindowResult(width, height);\n\t\t} catch (e) {\n\t\t\tErrorHandler.handle(e);\n\t\t}\n\t}\n\n\tfunction saveWindowPosition() {\n\t\t_appStateDataController.save();\n\t}\n\n\tfunction submitWindow(result) {\n\t\tsaveWindowPosition();\n\t\twindow.KeyboardMaestro.Submit(result);\n\t}\n\n\tfunction cancelWindow(result) {\n\t\tsaveWindowPosition();\n\t\twindow.KeyboardMaestro.Cancel(result);\n\t}\n\n\tfunction btnReloadClicked() {\n\n\t\tfunction doReload() {\n\t\t\tif (_showingAllGlobalVariables || _showingAllDictionaries)\n\t\t\t\t_internalTasksMacro.reloadData(_showingAllGlobalVariables, _showingAllDictionaries);\n\t\t\telse\n\t\t\t\treloadData(\"{}\");\n\t\t}\n\n\t\ttry {\n\t\t\tif (!_isAsync || !_showingLocalVariables) {\n\t\t\t\tdoReload();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar msgPart;\n\t\t\tif (_showingGlobalVariables && _showingDictionaries)\n\t\t\t\tmsgPart = \"global variables and dictionaries\";\n\t\t\telse if (_showingGlobalVariables)\n\t\t\t\tmsgPart = \"global variables\";\n\t\t\telse if (_showingDictionaries)\n\t\t\t\tmsgPart = \"dictionaries\";\n\t\t\telse {\n\t\t\t\t_modalDialogController.showInfoDialog(`You can't reload Local/Instance variables, since the Inspector is being shown Asynchronously.`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t_modalDialogController.showOkCancelDialog(\n\t\t\t\t`If you continue, only the ${msgPart} will be reloaded, since the Inspector is being shown Asynchronously.`, \n\t\t\t\tresult => { if (result === \"ok\") doReload(); }\n\t\t\t);\n\t\t} catch (e) {\n\t\t\tErrorHandler.handle(e);\n\t\t}\n\t}\n// #endregion\n\n</script>\n\t</head>\n\n\t<body data-kmwindowid=\"E36A74A0-1E20-4618-AFC8-8B2782D3F671\">\n\t\t<div id=\"divUIBusy\" class=\"divUIBusy divUIBusyHidden hidden\">\n\t\t</div>\n\n\t\t<div id=\"modalDialog\" class=\"modalDialog modalDialogHidden\">\n\t\t\t<div id=\"modalDialogBox\" class=\"modalDialogBox\">\n\t\t\t\t<div id=\"modalDialogBody\" class=\"modalDialogBody\">\n\t\t\t\t\t<table id=\"modalDialogIconTable\" class=\"modalDialogIconTable\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<img id=\"modalDialogInfoIcon\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QATgCdAO018OgxAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5QwcADczerXklQAAA9FJREFUWEedV0tIVGEUPjPjzPh2xCQttbSUMLMsCikUdWGhEfSiF7Rp1yZoUeFCIoN0U9Gqja16UVEhWvRQKwpdSOVIEKYmapqm4iMHx9Gp74x37lzH69z/3gMfd+b+5z/f97/Of66JBO1A7VgsXMuBEmArsB5wSN0n8OwFvgJNQEPdmYRpkdAmLScQZ8HnInAciNTyl9pdeD4AaiDkR6g+KwoAcQQ6VgHngDBB4mA3D17cBCohZFYthqoAkGfC+SmQY5A4uFsrXhyCiKHghmUCQJ4Hp1dAoih5dJiJTm2xk9VMdNfppgnPP7WuA3hZDhFOZeMSAdLIP+kh52A3ymIoI8nqi9vWNUtVH3gLqBqL2AkRv/2t0LxoIA/H47Fe8pRIk0zOceIi5ZBqClLwsl7aX752pfdV/Ofjpcumsc3m5gNT3to9p9V/Bxwu+Z18SyAdtW/4aWi3l6aFUX66jZwDHnrezRtf0/7CI5OXwk/I59wQOVO97pv3QYdFw7cSOGuSMhwfD9EkI/PsSQqjvdl2SnJYaMrlpermGRp1q54ANW0zeJnMo+b0qos8wWai8wWRlLPOLgdejaRckOqmZ11CS8D9ooAyFsC5XdiyHWa6UBpD8dGWZX26x73CcSTHEj4Fwjt/M8gr9sWSxWyit04XfR8I7HheAuf4gl4BuTwD6aK98tOsVPfZhWmeIw8GW3skTu7aPSw89Uq6DBbA16yQ1SLN+m1jjJlWxQaWoQNH0IDFhUxboQIWpi+mXjYvZuN9nyEBvkw4ZUA5Za8JCBgcn9dz/JR0kyzgp14BdvRKSwwI6BwyNnrw9rAALqN0WVGKlezWwEXa1m9YQDsL4BpOl+WlBkbvcnupZVhXGlZyNbKAeoDTorBtkO5+7tA7Mk9e4ey7hII5X5pxI/HN9FCU3YGpVx6/vlHDo7/P3P5jWAMBQgu5K9lCSISy9YwtECoyOpxpo1v7Y6hordClyim0moP4BEilM1evmpYWv/QO2I7seOeYg07ujqKPnW5690toRq6Ds0cWILHy/czVa0iLjViau/KzwslmMdHtpml61KlZDXHsFuCyn0SOJtXtB9HQH0pBf9CF0zvioYq6SXrTLzTyQcQ+Ci45p6uV5blwagC4gFS1E5tslIwipB35v3FAiJjj8MC4LO9QBl3pw4S/CZ4AhVpLItjO084fJnI5vmwJlIHg+Af/S4ErgK4cESSIN8U1oFiNnH1FPk6T4Mcb9DTAZZSIseh7AH+c+nb7SqYpwN8RxStXslw/FgPbAC5klJ/nfKl9AZqBF1KC0xT7Hx6XEIIjsn1kAAAAAElFTkSuQmCC\">\n\t\t\t\t\t\t\t\t<img id=\"modalDialogWarningIcon\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAcCAYAAAAAwr0iAAAABmJLR0QA8wAAAAD215HyAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH5QwcAQMca4xADAAAAzFJREFUSEutVl1IFFEUPrtuRvYDEflQQeRbBgZBUNSTLz33YEVPmSChISgGYqVShIQQZL3Ya0FUGmQ/L1Fv1VPajz9gxZJmVpCos78zu96+c2dmZ5fZde5Mu/DtXu495/u+e+6ZOxuigB+NaCdSOwEduLGZ6HdAKv9pEK8EpgBhYYLn/DMRhYMkIacD2AtcBnqAfUB7QC5/adjpDkCLt5BYzZjgMc/xmj+2ANEQucdlN75AXJgwZnJHcTcApXoKhI8Cq4nbjrhtgud4DTiizugjEsQVwJhWRyKz6DbAc1qtNPEeCNpbpR2BtJlLn3phii8tkxj/QGJsnMTyijmXep47imYfe/MOhfBW4E/sBIlsmsTnCRK12C0yJfbUmEZ4LXZamvgLbPNmVowA2SDvXv9o7rSjwxG3TbSeN9d0VMW6G26q0HueFchqQXSu4gpRpM6kjKxzU2/BVSjX9qNZrslhK3KtDBUrJWJA8kqrRuMtOI03POKuwMhjZz3zE1VADnJf/4c0bhaiBi5n8kFh109OuQ1MTxfGJO/njqIhkAkIbwCisXo0V6yQPJ4gUY0d2ufPY56z7wT+zcbRkMekiVlgo28TSOrj3affup95Fujqcgx0dxePSb/JVaHPlwEI7wYS8XYQZ4uTj446Bp4+Kx7DuczBXMypbALBw7x741sJYlRgBu8C+wh4nF/+/LERzVXhkZIBCNfLxrtTmpQF0rp5GTF4XMoAzzOXdTfUr2kCQRHgk3YQTbS0NikT9/eTGBjwjsvi2tYOSROTQJFbxLKFxTbZeC+9SdnAPJ73hV9qscxpVaGtaBWwuB1YjJ0BoaFGulbZXWvgZG7WYC2XCUwOsUN9Uk18do7ExUskenpJ/JhXy2FuqwpDBQYweQDIJq6rEfHuWvA3zH4KOi+o57EGa7EmmwhjEMLvIO2icGWj0oMig3TDiTXyxl4MUqNG/mG5JbXxdZLLksILxs+ZfsUd0XiWRFMTiSiedT+5rGUdxakQBg/h5nhVnCKhKi//5VkXSVyNVZQF25MIvuaASLIF9VhfHgEvFpGWERXAd67AJgyuAofZiFdymda5a94Bvf8AzsXp/m/GmAgAAAAASUVORK5CYII=\">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td id=\"modalDialogMessage\">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t\t<div id=\"modalDialogDictionaryHelp\">\n\t\t\t\t\t\t<h2>Dictionaries</h2>\n\t\t\t\t\t\t<h3>Editing</h3>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<li>Double-click a cell to start editing it.</li>\n\t\t\t\t\t\t\t<li>Press Escape to cancel the edit, or..</li>\n\t\t\t\t\t\t\t<li>Press Enter to accept the edit.</li>\n\t\t\t\t\t\t\t<li>Press Enter to type a newline character.</li>\n\t\t\t\t\t\t\t<li>To delete a row, click the \"trash can\" icon in the row.</li>\n\t\t\t\t\t\t\t<li>To delete the dictionary, use the trash can tool button above.</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t<h3>Navigation</h3>\n\t\t\t\t\t\t<p>When you're editing a cell, you can move from cell to cell with Up Arrow, Down Arrow, Tab, and Shift Tab.</p>\n\t\t\t\t\t\t<h3>Saving Your Changes</h3>\n\t\t\t\t\t\t<p>Each cell's value is automatically saved whenever you exit the cell, unless you pressed Escape.</p>\n\t\t\t\t\t\t<p>The OK and Cancel buttons on the bottom right dont affect whether your changes are saved or not. They just determine if\n\t\t\t\t\t\tyour macro continues, or is canceled.</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id=\"modalDialogOptions\">\n\t\t\t\t\t\t<h2>Options</h2>\n\t\t\t\t\t\t<div id=\"divOptionsTable\">\n\t\t\t\t\t\t\t<table class=\"tblOptions\">\n\t\t\t\t\t\t\t\t<tr id=\"optionsFontSize\">\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\tFont Size\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td id=\"tdOptionsFontSizeButtons\">\n\t\t\t\t\t\t\t\t\t\t<a id=\"btnOptionsFontSizeIncrease\" class=\"tblOptionsButtonSmall tblOptionsButtonSmallPlus\" href=\"#\">+</a>\n\t\t\t\t\t\t\t\t\t\t&nbsp;\n\t\t\t\t\t\t\t\t\t\t<a id=\"btnOptionsFontSizeDecrease\" class=\"tblOptionsButtonSmall\" href=\"#\">-</a>\n\t\t\t\t\t\t\t\t\t\t&nbsp;\n\t\t\t\t\t\t\t\t\t\t<a id=\"btnOptionsFontSizeReset\" class=\"tblOptionsButtonSmall\" href=\"#\">\n\t\t\t\t\t\t\t\t\t\t\t<svg fill=\"white\" version=\"1.1\" viewBox=\"0 0 95 97.939\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t\t\t\t\t<g transform=\"translate(15,16.469)\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path d=\"m32.5 4.999c-5.405 0-10.444 1.577-14.699 4.282l-5.75-5.75v16.11h16.11l-6.395-6.395c3.18-1.787 6.834-2.82 10.734-2.82 12.171 0 22.073 9.902 22.073 22.074 0 2.899-0.577 5.664-1.599 8.202l4.738 2.762c1.47-3.363 2.288-7.068 2.288-10.964 0-15.164-12.337-27.501-27.5-27.501z\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path d=\"m43.227 51.746c-3.179 1.786-6.826 2.827-10.726 2.827-12.171 0-22.073-9.902-22.073-22.073 0-2.739 0.524-5.35 1.439-7.771l-4.731-2.851c-1.375 3.271-2.136 6.858-2.136 10.622 0 15.164 12.336 27.5 27.5 27.5 5.406 0 10.434-1.584 14.691-4.289l5.758 5.759v-16.112h-16.111z\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr id=\"optionsLocalVariables\">\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\tLocal/Instance Variables\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<a id=\"btnOptionsLoadLocalVariables\" class=\"tblOptionsButton\" href=\"#\">Load All</a>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr id=\"optionsGlobalVariables\">\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\tGlobal Variables\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<a id=\"btnOptionsLoadGlobalVariables\" class=\"tblOptionsButton\" href=\"#\">Load All</a>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr id=\"optionsDictionaries\">\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\tDictionaries\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<a id=\"btnOptionsLoadDictionaries\" class=\"tblOptionsButton\" href=\"#\">Load All</a>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr id=\"optionsHiddenVariables\">\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\tHidden Variables Buttons\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<a id=\"btnOptionsToggleHiddenVariables\" class=\"tblOptionsButton\" href=\"#\">Toggle Visible</a>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr id=\"optionsFocusFilterOnStartup\">\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<label id=\"optionsFocusFilterOnStartupLabel\" for=\"optionsFocusFilterOnStartupCheckbox\">\n\t\t\t\t\t\t\t\t\t\t\tFocus Filter on Startup\n\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<label class=\"switch\">\n\t\t\t\t\t\t\t\t\t\t\t<input id=\"optionsFocusFilterOnStartupCheckbox\" type=\"checkbox\" checked>\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"slider round\"></span>\n\t\t\t\t\t\t\t\t\t\t  </label>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr id=\"optionsSortBySizeSelectsFirstVariable\">\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<label id=\"optionsSortBySizeSelectsFirstVariableLabel\" for=\"optionsSortBySizeSelectsFirstVariableCheckbox\">\n\t\t\t\t\t\t\t\t\t\t\tSort By Size Selects First Variable\n\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<label class=\"switch\">\n\t\t\t\t\t\t\t\t\t\t\t<input id=\"optionsSortBySizeSelectsFirstVariableCheckbox\" type=\"checkbox\" checked>\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"slider round\"></span>\n\t\t\t\t\t\t\t\t\t\t  </label>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t<tr id=\"optionsEscapeInEmptyFilterClosesPrompt\">\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<label id=\"optionsEscapeInEmptyFilterClosesPromptLabel\" for=\"optionsEscapeInEmptyFilterClosesPromptCheckbox\">\n\t\t\t\t\t\t\t\t\t\t\tEsc in Empty Filter Closes Prompt\n\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<label class=\"switch\">\n\t\t\t\t\t\t\t\t\t\t\t<input id=\"optionsEscapeInEmptyFilterClosesPromptCheckbox\" type=\"checkbox\" checked>\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"slider round\"></span>\n\t\t\t\t\t\t\t\t\t\t  </label>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"modalDialogFooter\">\n\t\t\t\t\t<a id=\"modalDialogOkButton\" class=\"dialogBottomButton dialogOkButton\">OK</a>\n\t\t\t\t\t<a id=\"modalDialogCancelButton\" class=\"dialogBottomButton dialogCancelButton\">Cancel</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div id=\"editBoxDialog\" class=\"modalDialog modalDialogHidden\">\n\t\t\t<div class=\"modalDialogBox\">\n\t\t\t\t<div class=\"modalDialogHeader\">\n\t\t\t\t\t<span id=\"editBoxDialogTitle\">Enter Variable Name</span>\n\t\t\t\t\t<hr />\n\t\t\t\t</div>\n\t\t\t\t<div class=\"modalDialogBody\">\n\t\t\t\t\t<table class=\"modalDialogInputTable\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t\t\t\t<input id=\"editBoxDialogInput\"/>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr id=\"editBoxDialogCheckboxRow\">\n\t\t\t\t\t\t\t<td id=\"editBoxDialogCheckboxCell\">\n\t\t\t\t\t\t\t\t<input id=\"editBoxDialogCheckbox\" type=\"checkbox\" >\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<label id=\"editBoxDialogCheckboxLabel\" for=\"editBoxDialogCheckbox\"></label>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"errorMessage\" colspan=\"2\">\n\t\t\t\t\t\t\t\t<span id=\"editBoxDialogErrorMessage\"></span>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"modalDialogFooter\">\n\t\t\t\t\t<a id=\"editBoxDialogOkButton\" class=\"dialogBottomButton dialogOkButton\">OK</a>\n\t\t\t\t\t<a id=\"editBoxDialogCancelButton\" class=\"dialogBottomButton dialogCancelButton\">Cancel</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<a href=\"#\" id=\"optionsMenu\" onclick=\"optionsMenuClicled()\">Options</a>\n\t\t<a href=\"#\" id=\"openConsole\" class=\"hidden\" onclick=\"openConsoleClicked()\">Open Console</a>\n\t\t<span id=\"version\"></span>\n\t\t\n\t\t<div class=\"page\">\n\t\t\t<div id=\"divFloatingWarningContainer\">\n\t\t\t\t<div id=\"divFloatingWarning\" class=\"warning hidden\">\n\t\t\t\t\t<table>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t<td><span class=\"infoText\">Something goes here.</span></td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<a href=\"#\">x</a>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<header>\n\t\t\t\t<div id=\"divHeader\">\n\t\t\t\t\t<img id=\"imgIcon\" src=\"data:image/png;base64,\n\t\t\t\t\t\t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\">\n\t\t\t\t\t<h2 id=\"hHeader\">Variable Inspector</h2>\n\t\t\t\t</div>\n\t\t\t</header>\n\n\t\t\t<div id=\"content\">\n\t\t\t\t<div id=\"divVariables\">\n\t\t\t\t\t<div id=\"divVariableToolButtons\" class=\"divToolButtonsWrap\">\n\t\t\t\t\t\t\n\t\t\t\t\t\t<a href=\"#\" id=\"btnSort\" data-sort-by-name=true class=\"btnTool btnToolLeft btnToolHover tooltip\" onclick=\"btnSortClicked()\">\n\t\t\t\t\t\t\t<span id=\"btnSortTooltipText\" class=\"tooltipText tooltipTextRight\">Sorted by Size</span>\n\t\t\t\t\t\t\t<svg id=\"imgSortByName\" version=\"1.1\" viewBox=\"0 0 185.08 203.59\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t<path id=\"Selection\" d=\"m57.181 76.089h-24c-2.25 0-5.69-0.22-7.61 1.02-4.52 2.93-4.33 19.42-17.39 16.58-10.71-2.32-7.93-13.17-5.19-20.6l15.14-41c2.1-5.74 6.68-19.39 9.53-23.99 7.36-11.85 21.22-9.07 27.03 2.99l5.07 13 10 27 8.98 25c1.03 3.49 2.08 8.48 0.7 11.98-2.65 6.73-12.07 7.66-16.87 2.74-3.44-3.52-4.72-9.99-5.39-14.72zm74 64v-125c0.01-3.44-0.27-6.95 1.74-9.95 4.4-6.58 13.44-6.05 17.09 0.97 1.38 2.65 1.17 6.06 1.17 8.98v125h24c3.24 0.05 6.86-0.03 8.67 3.23 2.76 4.95-3 11.1-5.88 14.77l-25 33c-2.7 3.45-7.03 10.55-11.79 10.55-5 0-9.17-6.95-11.87-10.55l-25-33c-2.7-3.6-8.67-10.02-5.94-14.77 2.12-3.7 7.16-3.22 10.81-3.23h22zm-90-115-11 31h20l-9-31zm4 106h-25c-3.22-0.01-7.05 0.18-9.98-1.31-6.24-3.17-6.36-11.27-1.79-15.18 2.8-2.4 6.29-2.46 9.77-2.51h38c2.94 0 6.18-0.12 8.99 0.85 7.84 2.72 8.54 10.66 4.9 17.15l-15.01 21s-23.88 32-23.88 32h24c3.49 0 9.91-0.32 12.98 0.89 7.67 3.02 7.13 12.75 2.74 16.41-2.92 2.44-7.1 2.65-10.72 2.7h-38c-10.19-0.02-23.18-3.62-17.47-17 1.85-4.33 11.46-16.49 14.84-21l25.63-34z\" fill=\"#060606\" stroke=\"#000\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t<svg id=\"imgSortBySize\" version=\"1.1\" viewBox=\"0 0 177.33 201.97\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t<path id=\"Selection\" d=\"m123.66 139.92v-124c0-3.19-0.18-7.07 1.31-9.96 3.3-6.39 11.43-7.39 16.04-1.82 2.87 3.48 2.64 7.57 2.65 11.78v124h24c3.55 0.07 7.05 0.34 8.73 4.06 2.14 4.73-4.16 11.35-6.86 14.94l-24.24 32c-2.52 3.35-7.06 10.55-11.63 10.55s-9.11-7.2-11.63-10.55l-24.24-32c-2.74-3.65-9.19-10.19-6.91-14.94 2.1-4.39 6.68-4.05 10.78-4.06h22zm-117.96-120.26c5.73-1.41 22.11-0.74 28.96-0.74h54c7.96 0.04 11.84 1.13 12 10 0.2 11.18-1.9 12.98-13 13h-74c-3.65-0.01-7.84 0.33-10.69-2.43-3.01-2.92-3.12-12.94-1.14-16.46 1.19-2.1 1.97-2.27 3.87-3.37zm0 47c5.48-1.35 17.73-0.74 23.96-0.74h44c3.19 0.01 7.09-0.29 9.77 1.74 4.18 3.15 4.59 15.27 0.92 18.83-2.85 2.76-7.04 2.42-10.69 2.43h-60c-3.65-0.01-7.84 0.33-10.69-2.43-3.01-2.92-3.12-12.94-1.14-16.46 1.19-2.1 1.97-2.27 3.87-3.37zm0 47c5.33-1.32 13.28-0.74 18.96-0.74h35c3.19 0.01 7.09-0.29 9.77 1.74 4.18 3.15 4.59 15.27 0.92 18.83-2.85 2.76-7.04 2.42-10.69 2.43h-47c-3.43-0.01-7.04 0.33-9.69-2.31-2.98-2.98-3.14-13.03-1.14-16.58 1.19-2.1 1.97-2.27 3.87-3.37zm1.96 44.79 32-0.53c4.34 0 11.09-0.47 14.89 1.57 5.23 2.81 5.88 15.93 1.54 19.69-2.39 2.07-6.45 1.74-9.43 1.74h-35c-3.16-0.02-7 0.23-9.26-2.43-2.5-2.94-2.45-14.18 0-17.15 1.49-1.81 3.18-2.2 5.26-2.89z\" fill=\"#060606\" stroke=\"#000\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\n\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t<a href=\"#\" id=\"btnHiddenVariables_toggleViewMode\" class=\"btnTool btnToolLeft btnToolHover tooltip\" onclick=\"btnHiddenVariables_toggleViewModeClicked()\">\n\t\t\t\t\t\t\t<span class=\"tooltipText tooltipTextCenter toolTipTextWider\">Showing All Variables</span>\n\t\t\t\t\t\t\t<svg id=\"imgHiddenVariables_toggleViewMode_all\" version=\"1.1\" viewBox=\"0 0 600 600\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n\t\t\t\t\t\t\t\t<defs>\n\t\t\t\t\t\t\t\t\t<linearGradient id=\"linearGradient975\">\n\t\t\t\t\t\t\t\t\t\t<stop stop-color=\"#fff\" stop-opacity=\"0\" offset=\"0\"/>\n\t\t\t\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t\t\t\t\t<linearGradient id=\"linearGradient935\" x1=\"-.51431\" x2=\"600.51\" y1=\"300.11\" y2=\"300.11\" gradientUnits=\"userSpaceOnUse\">\n\t\t\t\t\t\t\t\t\t\t<stop offset=\"0\"/>\n\t\t\t\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t\t\t\t\t<linearGradient id=\"linearGradient977\" x1=\"38.541\" x2=\"254.5\" y1=\"301\" y2=\"301\" gradientUnits=\"userSpaceOnUse\" xlink:href=\"#linearGradient975\"/>\n\t\t\t\t\t\t\t\t\t<linearGradient id=\"linearGradient1001\" x1=\"345.5\" x2=\"561.5\" y1=\"301.02\" y2=\"301.02\" gradientUnits=\"userSpaceOnUse\" xlink:href=\"#linearGradient975\"/>\n\t\t\t\t\t\t\t\t</defs>\n\t\t\t\t\t\t\t\t<g stroke=\"#000\">\n\t\t\t\t\t\t\t\t\t<path id=\"Frame\" d=\"m0 207s22-2.72 22-2.72l33-3.19c33.93-2.32 67.94-2.14 102-2.09 17.91 0.03 61.75 7.99 79 13.67l34 13.32c11.85 2.56 29.59 2.15 42 2.01 25.39-0.3 31.45-8.75 53-15.66 17.11-5.48 60.33-13.31 78-13.34 34.06-0.05 68.07-0.23 102 2.09l33 3.19s22 2.72 22 2.72l-0.83 26c-0.22 2.33 0.04 6.92-0.77 8.79-1.47 3.39-5.2 3.63-9.31 7.42-4.26 3.93-6.8 9.29-8.34 14.79l-4.15 22c-5.1 25.55-12.99 60.95-28.52 82-29.06 39.39-88.69 37.27-131.08 26.37-14.43-3.71-28.9-9.27-41-18.13-23.02-16.85-41.58-54.39-50.33-81.24-4.65-14.25-5.17-34.42-25.67-34.42s-21.02 20.17-25.67 34.42c-8.75 26.85-27.31 64.39-50.33 81.24-12.1 8.86-26.57 14.42-41 18.13-42.28 10.87-100.63 12.99-130.32-25.37-16.13-20.84-24.36-58.24-29.48-84l-3.96-21c-1.46-5.45-4.15-10.92-8.33-14.79-4.11-3.79-7.84-4.03-9.31-7.42-0.81-1.87-0.55-6.46-0.77-8.79l-0.83-26zm114 10.14-14 1.14c-19.11 2.3-40.68 8.84-51.9 25.72-9.48 14.27-7.17 32-5.25 48 2.99 25.09 8.18 43.53 23.8 64 5.6 7.33 9.46 11.85 17.35 16.91 11.71 7.51 30.13 11.92 44 12.09 25.68 0.3 59.08-4.35 81-18.55 24.62-15.94 42.95-55.35 43-84.45v-11c-0.07-5.51-1.19-11.68-2.64-17-4.26-15.6-15.09-23.26-29.36-29.14-22.58-9.31-50.95-7.86-75-7.72h-31zm304 0c-19.74 2.98-40.05 3.95-55.96 18.16-10.52 9.4-14.02 24.09-14.04 37.7v9c0.05 29.08 17.47 65.91 41 83.07 15.63 11.41 50.6 19.7 70 19.93 15.8 0.18 32.23-0.55 47-6.87 22.03-9.43 37.88-32.75 44.97-55.13 3.19-10.04 4.94-20.56 6.18-31 2.06-17.2 4.46-36.54-7.48-51-21.81-26.43-64.63-24-95.67-23.86h-36z\" fill=\"url(#linearGradient935)\"/>\n\t\t\t\t\t\t\t\t\t<path id=\"Right Lens\" d=\"m416 215.21h35c24.11-0.21 57.06-1.72 79 8.57 12.82 6.01 24.35 15.1 28.56 29.22 1.84 6.18 2.47 12.59 2.44 19l-0.91 11c-2.1 28.72-7.47 51.75-25.51 75-6.25 8.04-11.53 13.69-20.58 18.69-17.64 9.74-36.4 10.54-56 10.31-19.29-0.23-53.16-8.31-69-19.22-24.56-16.92-42.95-55.03-43-84.78-0.03-19.02-0.21-37.21 16-50.53 16.22-13.34 34.43-14.27 54-17.26z\" fill=\"url(#linearGradient1001)\"/>\n\t\t\t\t\t\t\t\t\t<path id=\"Left Lens\" d=\"m112 215.21h33c24.81-0.21 53.77-1.78 77 8.07 14.08 5.98 25.16 14.33 29.36 29.72 1.45 5.32 2.57 11.49 2.64 17v13c-0.05 29.71-18.91 69.2-44 85.45-22.87 14.81-56.32 18.86-83 18.55-13.55-0.16-31.41-4.4-43-11.46-8.13-4.95-12.82-10.12-18.58-17.54-16.15-20.81-21.51-39.32-24.57-65-1.96-16.36-4.42-35.44 5.25-50 11.64-17.51 33.04-24.33 52.9-26.72l13-1.07z\" fill=\"url(#linearGradient977)\"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t<svg id=\"imgHiddenVariables_toggleViewMode_hide\" class=\"hidden\" version=\"1.1\" viewBox=\"0 0 600 600\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n\t\t\t\t\t\t\t\t<defs>\n\t\t\t\t\t\t\t\t\t<linearGradient id=\"linearGradient933\">\n\t\t\t\t\t\t\t\t\t\t<stop offset=\"0\"/>\n\t\t\t\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t\t\t\t\t<linearGradient id=\"linearGradient935\" x1=\"-.51431\" x2=\"600.51\" y1=\"300.11\" y2=\"300.11\" gradientUnits=\"userSpaceOnUse\" xlink:href=\"#linearGradient933\"/>\n\t\t\t\t\t\t\t\t\t<linearGradient id=\"linearGradient977\" x1=\"38.541\" x2=\"254.5\" y1=\"301\" y2=\"301\" gradientUnits=\"userSpaceOnUse\" xlink:href=\"#linearGradient933\"/>\n\t\t\t\t\t\t\t\t\t<linearGradient id=\"linearGradient1001\" x1=\"345.5\" x2=\"561.5\" y1=\"301.02\" y2=\"301.02\" gradientUnits=\"userSpaceOnUse\" xlink:href=\"#linearGradient933\"/>\n\t\t\t\t\t\t\t\t</defs>\n\t\t\t\t\t\t\t\t<g stroke=\"#000\">\n\t\t\t\t\t\t\t\t\t<path id=\"Frame\" d=\"m0 207s22-2.72 22-2.72l33-3.19c33.93-2.32 67.94-2.14 102-2.09 17.91 0.03 61.75 7.99 79 13.67l34 13.32c11.85 2.56 29.59 2.15 42 2.01 25.39-0.3 31.45-8.75 53-15.66 17.11-5.48 60.33-13.31 78-13.34 34.06-0.05 68.07-0.23 102 2.09l33 3.19s22 2.72 22 2.72l-0.83 26c-0.22 2.33 0.04 6.92-0.77 8.79-1.47 3.39-5.2 3.63-9.31 7.42-4.26 3.93-6.8 9.29-8.34 14.79l-4.15 22c-5.1 25.55-12.99 60.95-28.52 82-29.06 39.39-88.69 37.27-131.08 26.37-14.43-3.71-28.9-9.27-41-18.13-23.02-16.85-41.58-54.39-50.33-81.24-4.65-14.25-5.17-34.42-25.67-34.42s-21.02 20.17-25.67 34.42c-8.75 26.85-27.31 64.39-50.33 81.24-12.1 8.86-26.57 14.42-41 18.13-42.28 10.87-100.63 12.99-130.32-25.37-16.13-20.84-24.36-58.24-29.48-84l-3.96-21c-1.46-5.45-4.15-10.92-8.33-14.79-4.11-3.79-7.84-4.03-9.31-7.42-0.81-1.87-0.55-6.46-0.77-8.79l-0.83-26zm114 10.14-14 1.14c-19.11 2.3-40.68 8.84-51.9 25.72-9.48 14.27-7.17 32-5.25 48 2.99 25.09 8.18 43.53 23.8 64 5.6 7.33 9.46 11.85 17.35 16.91 11.71 7.51 30.13 11.92 44 12.09 25.68 0.3 59.08-4.35 81-18.55 24.62-15.94 42.95-55.35 43-84.45v-11c-0.07-5.51-1.19-11.68-2.64-17-4.26-15.6-15.09-23.26-29.36-29.14-22.58-9.31-50.95-7.86-75-7.72h-31zm304 0c-19.74 2.98-40.05 3.95-55.96 18.16-10.52 9.4-14.02 24.09-14.04 37.7v9c0.05 29.08 17.47 65.91 41 83.07 15.63 11.41 50.6 19.7 70 19.93 15.8 0.18 32.23-0.55 47-6.87 22.03-9.43 37.88-32.75 44.97-55.13 3.19-10.04 4.94-20.56 6.18-31 2.06-17.2 4.46-36.54-7.48-51-21.81-26.43-64.63-24-95.67-23.86h-36z\" fill=\"url(#linearGradient935)\"/>\n\t\t\t\t\t\t\t\t\t<path id=\"Right Lens\" d=\"m416 215.21h35c24.11-0.21 57.06-1.72 79 8.57 12.82 6.01 24.35 15.1 28.56 29.22 1.84 6.18 2.47 12.59 2.44 19l-0.91 11c-2.1 28.72-7.47 51.75-25.51 75-6.25 8.04-11.53 13.69-20.58 18.69-17.64 9.74-36.4 10.54-56 10.31-19.29-0.23-53.16-8.31-69-19.22-24.56-16.92-42.95-55.03-43-84.78-0.03-19.02-0.21-37.21 16-50.53 16.22-13.34 34.43-14.27 54-17.26z\" fill=\"url(#linearGradient1001)\"/>\n\t\t\t\t\t\t\t\t\t<path id=\"Left Lens\" d=\"m112 215.21h33c24.81-0.21 53.77-1.78 77 8.07 14.08 5.98 25.16 14.33 29.36 29.72 1.45 5.32 2.57 11.49 2.64 17v13c-0.05 29.71-18.91 69.2-44 85.45-22.87 14.81-56.32 18.86-83 18.55-13.55-0.16-31.41-4.4-43-11.46-8.13-4.95-12.82-10.12-18.58-17.54-16.15-20.81-21.51-39.32-24.57-65-1.96-16.36-4.42-35.44 5.25-50 11.64-17.51 33.04-24.33 52.9-26.72l13-1.07z\" fill=\"url(#linearGradient977)\"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t<svg id=\"imgHiddenVariables_toggleViewMode_only\" class=\"hidden\" version=\"1.1\" viewBox=\"0 0 600 600\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n\t\t\t\t\t\t\t\t<defs>\n\t\t\t\t\t\t\t\t\t<linearGradient id=\"linearGradient999\">\n\t\t\t\t\t\t\t\t\t\t<stop stop-color=\"#00dbe8\" offset=\"0\"/>\n\t\t\t\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t\t\t\t\t<linearGradient id=\"linearGradient935\" x1=\"-.51431\" x2=\"600.51\" y1=\"300.11\" y2=\"300.11\" gradientUnits=\"userSpaceOnUse\">\n\t\t\t\t\t\t\t\t\t\t<stop offset=\"0\"/>\n\t\t\t\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t\t\t\t\t<linearGradient id=\"linearGradient977\" x1=\"38.541\" x2=\"254.5\" y1=\"301\" y2=\"301\" gradientUnits=\"userSpaceOnUse\" xlink:href=\"#linearGradient999\"/>\n\t\t\t\t\t\t\t\t\t<linearGradient id=\"linearGradient1001\" x1=\"345.5\" x2=\"561.5\" y1=\"301.02\" y2=\"301.02\" gradientUnits=\"userSpaceOnUse\" xlink:href=\"#linearGradient999\"/>\n\t\t\t\t\t\t\t\t</defs>\n\t\t\t\t\t\t\t\t<g stroke=\"#000\">\n\t\t\t\t\t\t\t\t\t<path id=\"Frame\" d=\"m0 207s22-2.72 22-2.72l33-3.19c33.93-2.32 67.94-2.14 102-2.09 17.91 0.03 61.75 7.99 79 13.67l34 13.32c11.85 2.56 29.59 2.15 42 2.01 25.39-0.3 31.45-8.75 53-15.66 17.11-5.48 60.33-13.31 78-13.34 34.06-0.05 68.07-0.23 102 2.09l33 3.19s22 2.72 22 2.72l-0.83 26c-0.22 2.33 0.04 6.92-0.77 8.79-1.47 3.39-5.2 3.63-9.31 7.42-4.26 3.93-6.8 9.29-8.34 14.79l-4.15 22c-5.1 25.55-12.99 60.95-28.52 82-29.06 39.39-88.69 37.27-131.08 26.37-14.43-3.71-28.9-9.27-41-18.13-23.02-16.85-41.58-54.39-50.33-81.24-4.65-14.25-5.17-34.42-25.67-34.42s-21.02 20.17-25.67 34.42c-8.75 26.85-27.31 64.39-50.33 81.24-12.1 8.86-26.57 14.42-41 18.13-42.28 10.87-100.63 12.99-130.32-25.37-16.13-20.84-24.36-58.24-29.48-84l-3.96-21c-1.46-5.45-4.15-10.92-8.33-14.79-4.11-3.79-7.84-4.03-9.31-7.42-0.81-1.87-0.55-6.46-0.77-8.79l-0.83-26zm114 10.14-14 1.14c-19.11 2.3-40.68 8.84-51.9 25.72-9.48 14.27-7.17 32-5.25 48 2.99 25.09 8.18 43.53 23.8 64 5.6 7.33 9.46 11.85 17.35 16.91 11.71 7.51 30.13 11.92 44 12.09 25.68 0.3 59.08-4.35 81-18.55 24.62-15.94 42.95-55.35 43-84.45v-11c-0.07-5.51-1.19-11.68-2.64-17-4.26-15.6-15.09-23.26-29.36-29.14-22.58-9.31-50.95-7.86-75-7.72h-31zm304 0c-19.74 2.98-40.05 3.95-55.96 18.16-10.52 9.4-14.02 24.09-14.04 37.7v9c0.05 29.08 17.47 65.91 41 83.07 15.63 11.41 50.6 19.7 70 19.93 15.8 0.18 32.23-0.55 47-6.87 22.03-9.43 37.88-32.75 44.97-55.13 3.19-10.04 4.94-20.56 6.18-31 2.06-17.2 4.46-36.54-7.48-51-21.81-26.43-64.63-24-95.67-23.86h-36z\" fill=\"url(#linearGradient935)\"/>\n\t\t\t\t\t\t\t\t\t<path id=\"Right Lens\" d=\"m416 215.21h35c24.11-0.21 57.06-1.72 79 8.57 12.82 6.01 24.35 15.1 28.56 29.22 1.84 6.18 2.47 12.59 2.44 19l-0.91 11c-2.1 28.72-7.47 51.75-25.51 75-6.25 8.04-11.53 13.69-20.58 18.69-17.64 9.74-36.4 10.54-56 10.31-19.29-0.23-53.16-8.31-69-19.22-24.56-16.92-42.95-55.03-43-84.78-0.03-19.02-0.21-37.21 16-50.53 16.22-13.34 34.43-14.27 54-17.26z\" fill=\"url(#linearGradient1001)\"/>\n\t\t\t\t\t\t\t\t\t<path id=\"Left Lens\" d=\"m112 215.21h33c24.81-0.21 53.77-1.78 77 8.07 14.08 5.98 25.16 14.33 29.36 29.72 1.45 5.32 2.57 11.49 2.64 17v13c-0.05 29.71-18.91 69.2-44 85.45-22.87 14.81-56.32 18.86-83 18.55-13.55-0.16-31.41-4.4-43-11.46-8.13-4.95-12.82-10.12-18.58-17.54-16.15-20.81-21.51-39.32-24.57-65-1.96-16.36-4.42-35.44 5.25-50 11.64-17.51 33.04-24.33 52.9-26.72l13-1.07z\" fill=\"url(#linearGradient977)\"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t<span class=\"btnToolSeparator\">\n\t\t\t\t\t\t\t<svg version=\"1.1\" viewBox=\"0 0 5.6319 58.704\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t<g transform=\"translate(-99.219,-27.292)\">\n\t\t\t\t\t\t\t\t\t<path d=\"m101.86 29.938 0.34021 53.412\" fill=\"none\" stroke-linecap=\"round\" stroke-width=\"5.2917\"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</span>\n\n\t\t\t\t\t\t<a href=\"#\" id=\"btnCopyNames\" class=\"btnTool btnToolHover btnToolLeft tooltip\" onclick=\"btnCopyNamesClicked()\">\n\t\t\t\t\t\t\t<span class=\"tooltipText tooltipTextCenter\">Copy Variable Name(s) - C</span>\n\t\t\t\t\t\t\t<svg fill='none' stroke='#0E1A27' stroke-width='8' stroke-dashoffset='0' stroke-dasharray='0' stroke-linecap='round' stroke-linejoin='round' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect x=\"15\" y=\"10\" width=\"70\" height=\"80\"/> <rect x=\"30\" y=\"5\" width=\"40\" height=\"15\"/> </svg>\n\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t<a href=\"#\" id=\"btnCopyVariables\" class=\"btnTool btnToolHover btnToolLeft tooltip\" onclick=\"btnCopyVariablesClicked()\">\n\t\t\t\t\t\t\t<span class=\"tooltipText tooltipTextCenter\">Copy Variable(s) Contents - C</span>\n\t\t\t\t\t\t\t<svg fill='none' stroke='#0E1A27' stroke-width='8' stroke-dashoffset='0' stroke-dasharray='0' stroke-linecap='round' stroke-linejoin='round' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect x=\"15\" y=\"10\" width=\"70\" height=\"80\"/> <rect x=\"30\" y=\"5\" width=\"40\" height=\"15\"/> <circle cx=\"30\" cy=\"50\" r=\"1\"/> <circle cx=\"30\" cy=\"70\" r=\"1\"/> <line x1=\"45\" y1=\"50\" x2=\"70\" y2=\"50\" /> <line x1=\"45\" y1=\"70\" x2=\"70\" y2=\"70\" /></svg>\n\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t<a href=\"#\" id=\"btnSearchKM\" class=\"btnTool btnToolLeft btnToolHover tooltip\" onclick=\"btnSearchKMClicked()\">\n\t\t\t\t\t\t\t<span class=\"tooltipText tooltipTextCenter\">Search KM for Variable - K</span>\n\t\t\t\t\t\t\t<svg version=\"1.1\" viewBox=\"0 0 468 462\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t<path id=\"Command\" d=\"m147 186h-50c-18.93-0.03-36.09-6.36-51-17.89-11.77-9.1-22.27-22.32-27.99-36.11-5.3-12.79-7.5-27.29-6.18-41 0.57-5.94 0.59-9.96 2.07-16 6.22-25.5 26.72-49.66 51.1-59.55 18.34-7.43 42-8.63 61-3.01 34.23 10.13 61.94 43.31 62 79.56v52h84v-52c0.02-11.4 2.72-22.78 7.76-33 10.77-21.86 29.94-38.81 53.24-46.25 31.67-10.13 70.3-0.94 92.42 24.26 6.6 7.52 10.12 11.86 14.41 20.99 4.3 9.14 7.57 18.84 8.14 29l0.85 10c0 9.3-2.2 22.17-5.18 31-5 14.87-15.84 28.61-27.64 38.7-14.33 12.27-34.18 19.27-53 19.3h-50v83h34c28.02 0 47.4 0.96 70 20.3 6.07 5.19 11.46 11.2 16.09 17.7 9.91 13.89 13.83 27.22 15 44 0.22 3.14 0.83 4.71 0.59 8-0.58 7.7-1.01 15.53-3.11 23-7.61 27.1-26.49 47.86-52.57 58.4-7.99 3.22-18.37 5.5-27 5.6-15.31 0.18-26.53-0.58-41-6.45-28.47-11.54-52.85-43.27-53-74.55v-46c-0.15-8.15-2.78-7.99-10-8h-55c-4.07 0-15.65-1.17-17.98 2.31-1.23 1.85-1.02 5.5-1.02 7.69v44c-0.2 42.38-41.19 80.51-83 81-20.4 0.23-36.58-2.24-54-13.89-43.67-29.2-52.9-90.57-19.54-131.11 10.82-13.15 27.91-24.87 44.54-29.1 18.2-4.63 51.1-2.9 71-2.9v-83zm0-42v-42c-0.02-10.05-1.59-20.4-7.09-29-4.64-7.26-10.25-12.72-17.91-16.74-8.92-4.67-14.1-5.37-24-5.26-39.14 0.46-57.8 46.31-34.33 76 4.48 5.67 8.92 9.02 15.33 12.24 7.7 3.88 12.46 4.75 21 4.76h47zm166 0h47c8.54-0.01 13.3-0.88 21-4.76 6.41-3.22 10.85-6.57 15.33-12.24 16.92-21.42 13.24-52.02-9.33-67.96-7.12-5.02-15.27-7.93-24-8.04-10.38-0.12-15.58 0.33-25 5.26-7.66 4.02-13.27 9.48-17.91 16.74-5.5 8.6-7.07 18.95-7.09 29v42zm-122.69 42.6c-2.6 2.19-2.24 3.02-2.31 6.4v25 44c0.14 7.49 2.26 6.99 9 7h56c3.48 0 15.99 0.92 17.98-1.6 1.25-1.59 1.02-5.41 1.02-7.4v-55c0-3.48 0.92-15.99-1.6-17.98-1.59-1.25-5.41-1.02-7.4-1.02h-48c-5.8 0-19.85-0.57-24.69 0.6zm-43.31 124.4h-46c-8.65 0.01-16.41 1.52-24 5.88-5.86 3.36-10.69 7.76-14.76 13.12-5.58 7.34-8.84 16.77-9.2 26-1.47 37.48 40.63 60.97 71.96 41.12 6.48-4.1 10.79-8.68 14.91-15.12 5.5-8.6 7.07-18.95 7.09-29v-42zm166 0v42c0.02 10.05 1.59 20.4 7.09 29 4.12 6.44 8.43 11.02 14.91 15.12 31.27 19.81 73.43-3.69 71.96-41.12-0.36-9.23-3.62-18.66-9.2-26-4.07-5.36-8.9-9.76-14.76-13.12-7.59-4.36-15.35-5.87-24-5.88h-46z\" fill=\"#060606\" stroke=\"#000\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t<span class=\"btnToolSeparator\">\n\t\t\t\t\t\t\t<svg version=\"1.1\" viewBox=\"0 0 5.6319 58.704\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t<g transform=\"translate(-99.219,-27.292)\">\n\t\t\t\t\t\t\t\t\t<path d=\"m101.86 29.938 0.34021 53.412\" fill=\"none\" stroke-linecap=\"round\" stroke-width=\"5.2917\"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</span>\n\n\t\t\t\t\t\t<a href=\"#\" id=\"btnAddVariable\" class=\"btnTool btnToolHover btnToolLeft tooltip\" onclick=\"btnAddVariableClicked()\">\n\t\t\t\t\t\t\t<span class=\"tooltipText tooltipTextCenter\">Add New Variable - +/=</span>\n\t\t\t\t\t\t\t<svg id=\"imgAddVariable\" version=\"1.1\" viewBox=\"0 0 127.35 127.35\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t<g transform=\"translate(-35.666 -33.115)\" fill=\"none\" stroke=\"#007f00\" stroke-linecap=\"round\" stroke-width=\"31.75\">\n\t\t\t\t\t\t\t\t\t<path d=\"m99.34 48.99v95.598\"/>\n\t\t\t\t\t\t\t\t\t<path d=\"m147.14 96.789h-95.598\"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t<a href=\"#\" id=\"btnRenameVariable\" class=\"btnTool btnToolHover btnToolLeft tooltip\" onclick=\"btnRenameVariableClicked()\">\n\t\t\t\t\t\t\t<span class=\"tooltipText tooltipTextCenter\">Rename Variable - N</span>\n\t\t\t\t\t\t\t<svg version=\"1.1\" viewBox=\"0 0 588.6 524.37\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t<path id=\"Selection\" d=\"m394.3 38.716c8.87-1.45 20.06 1.37 28 5.45 2.87 1.47 9.77 6.99 12 7.03 2.18 0.04 9.24-5.31 12-6.75 13.2-6.88 41.19-12.9 39.96 10.74-0.82 15.67-15.13 12.57-22.96 16.19-10.17 4.69-12.98 12.42-13 22.81v336c0.02 10.39 2.83 18.12 13 22.81 7.83 3.62 22.14 0.52 22.96 16.19 1.23 23.64-26.76 17.62-39.96 10.74-2.76-1.44-9.82-6.79-12-6.75-2.3 0.05-8.37 5.04-11 6.5-11.07 6.13-37.15 12.73-40.78-5.49-0.2-1.64-0.27-4.33 0-6 1.33-15.35 15.59-10.76 24.78-16.22 10.01-5.96 11.98-15.03 12-25.78v-212-118c-0.14-11.47-4.46-21.49-16-25.61-6.68-2.39-12.26-0.29-17.61-6.5-6.8-7.88-4.26-21.51 8.61-25.36zm-4 373.47h-202-101c-27.21-0.32-48.96-24.28-49-51v-198c0.04-28.26 22.73-50.96 51-51h301v300zm89-300h21c27.73 0.13 49.96 23.56 50 51v198c-0.04 26.71-21.82 50.68-49 51h-22v-300zm-228 120v-40c0-6.43 0.68-15.16-1.97-21-4.12-9.07-16.82-10.9-23.5-3.67-3.72 4.03-3.52 7.59-3.53 12.67v127 39c0.27 19.8 26.07 20.03 28 2l19 9.3c11.36 4.06 18.28 3.83 30 3.7 6.81-0.08 13.66-2.03 20-4.42 32.75-12.37 51.74-48.64 43.76-82.58-7.63-32.47-34.75-54.05-67.76-55.26-16.75-0.61-30.07 4.19-44 13.26zm-84 112c0.01 4.11-0.25 7.29 2.15 10.91 4.6 6.94 15.49 8.32 21.64 2.7 4.29-3.93 5.14-10.11 5.21-15.61v-103c-0.01-6.46-0.08-13.02-5.11-17.79-7.67-7.27-20.01-4.51-23.24 5.79-0.71 2.25-0.63 4.67-0.65 7-10.26-3.24-16.38-9.8-33-10-13.09-0.15-20.88 0.56-33 6.32-37.93 18.02-47.72 68.74-21.54 100.68 12.22 14.91 27.88 21.49 46.54 23.72 7.95 0.95 21.61-1.84 29-4.95l12-5.77zm117-95.54c14.63-2.02 29.2 0.58 39.83 11.63 19.96 20.75 13.56 56.66-12.83 68.6-7.86 3.55-12.67 3.4-21 3.31-18.41-0.22-34.51-14.1-38.33-32-0.89-4.14-0.72-8.76-0.67-13 0.06-4.57 0.53-7.66 2.09-12 5.19-14.47 16.11-23.24 30.91-26.54zm-162 5.01c8.02-1.12 16.6-0.89 24 2.66 19.9 9.54 26.78 35.58 14.4 53.87-6.25 9.23-14.7 13.5-25.4 15.39-5.35 0.94-7.77 0.53-13-0.6-13.39-2.89-24.58-13.2-27.48-26.79-0.67-3.14-0.55-7.71-0.52-11 0.12-9.74 3.81-18.16 11.04-24.82 4.72-4.34 10.76-7.24 16.96-8.71z\" stroke=\"#000\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t<a href=\"#\" id=\"btnDeleteVariables\" class=\"btnTool btnToolHover btnToolLeft tooltip\" onclick=\"btnDeleteVariablesClicked()\">\n\t\t\t\t\t\t\t<span class=\"tooltipText tooltipTextCenter\">Delete Variable(s) -  or </span>\n\t\t\t\t\t\t\t<svg id=\"imgDeleteVariables\" version=\"1.1\" viewBox=\"0 0 13 15\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t<path d=\"m4 5.5a0.5 0.5 0 0 1 0.5 0.5v6a0.5 0.5 0 0 1-1 0v-6a0.5 0.5 0 0 1 0.5-0.5zm2.5 0a0.5 0.5 0 0 1 0.5 0.5v6a0.5 0.5 0 0 1-1 0v-6a0.5 0.5 0 0 1 0.5-0.5zm3 0.5a0.5 0.5 0 0 0-1 0v6a0.5 0.5 0 0 0 1 0z\" fill=\"#060606\"/>\n\t\t\t\t\t\t\t\t<path d=\"m13 3a1 1 0 0 1-1 1h-0.5v9a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-9h-0.5a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h3.5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zm-10.382 1-0.118 0.059v8.941a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-8.941l-0.118-0.059zm-1.618-1v-1h11v1z\" fill=\"#060606\" fill-rule=\"evenodd\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t<a href=\"#\" id=\"btnHiddenVariables_toggleVariables\" class=\"btnTool btnToolLeft btnToolHover tooltip\" onclick=\"btnHiddenVariables_toggleVariablesClicked()\">\n\t\t\t\t\t\t\t<span class=\"tooltipText tooltipTextCenter\">Hide Selected Variable(s)</span>\n\t\t\t\t\t\t\t<svg id=\"imgHiddenVariables_toggleVariables_hide\" fill=\"currentColor\" version=\"1.1\" viewBox=\"0 0 16 12.708\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t<g transform=\"matrix(-1,0,0,1,16,0)\" fill=\"#000\">\n\t\t\t\t\t\t\t\t\t<path d=\"m3.1693 12.723 11.199-11.141-1.4651-1.5233-11.374 11.068z\"/>\n\t\t\t\t\t\t\t\t\t<path d=\"m5.525 6.708 2.829-2.83a2.5 2.5 0 0 0-2.829 2.829z\"/>\n\t\t\t\t\t\t\t\t\t<path d=\"m10.475 6a2.5 2.5 0 0 1-2.829 2.829l2.83-2.829z\"/>\n\t\t\t\t\t\t\t\t\t<path d=\"m10.79 1.442a7.028 7.028 0 0 0-2.79-0.588c-5 0-8 5.5-8 5.5s0.939 1.721 2.641 3.238l2.062-2.062a3.5 3.5 0 0 1 4.474-4.474l1.613-1.613z\"/>\n\t\t\t\t\t\t\t\t\t<path d=\"m5.21 11.266 1.614-1.615a3.5 3.5 0 0 0 4.474-4.474l2.06-2.06c1.704 1.515 2.642 3.237 2.642 3.237s-3 5.5-8 5.5a7.029 7.029 0 0 1-2.79-0.588z\"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t<svg id=\"imgHiddenVariables_toggleVariables_unhide\" version=\"1.1\" viewBox=\"0 0 257.94 180.3\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t<path id=\"Pupil\" d=\"m124.93 60.731c32.55-4.07 45.84 37.24 21 54.34-4.16 2.86-8.08 4.01-13 4.78-24.12 3.77-41.66-22.29-30.6-43.56 4.98-9.57 12.41-13.65 22.6-15.56z\" opacity=\".5068\" stroke=\"#000\"/>\n\t\t\t\t\t\t\t\t<path id=\"Eye\" d=\"m118.93 10.711c39.6-4.82 79.03 16 105.99 43.58 6.35 6.5 11.97 13.71 17.38 21 1.87 2.52 5.33 6.86 5.6 10 0.26 3.16-2.57 7.34-4.17 10-4.9 8.11-10.48 15.74-16.55 23-26.27 31.4-59.44 52.49-101.25 52-37.63-0.44-71.7-26.78-95.13-54-5.51-6.4-10.78-13.01-15.53-20-1.44-2.13-4.61-6.63-5.14-9-0.84-3.79 2.04-7.11 4.1-10 4.07-5.73 10.83-14 15.71-19 27.78-28.46 49.59-41.86 88.99-47.58zm4 29.87c-10.16 1.68-17.93 4.3-26 11.03-31.61 26.38-19.81 78.67 21 87.47 5.55 1.2 11.34 1.66 17 0.92 42.59-5.54 59.22-57.56 28-86.62-5-4.65-10.57-7.97-17-10.23-7.62-2.67-15-3.33-23-2.57z\" fill=\"#fff\" stroke=\"#000\" stroke-width=\"20\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t<span class=\"btnToolSeparator\">\n\t\t\t\t\t\t\t<svg version=\"1.1\" viewBox=\"0 0 5.6319 58.704\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t<g transform=\"translate(-99.219,-27.292)\">\n\t\t\t\t\t\t\t\t\t<path d=\"m101.86 29.938 0.34021 53.412\" fill=\"none\" stroke-linecap=\"round\" stroke-width=\"5.2917\"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</span>\n\n\t\t\t\t\t\t<a href=\"#\" id=\"btnUndo\" class=\"btnTool btnToolLeft tooltip\" onclick=\"btnUndoClicked()\">\n\t\t\t\t\t\t\t<span class=\"tooltipText tooltipTextCenter\">Undo - Z</span>\n\t\t\t\t\t\t\t<svg id=\"imgUndo\" version=\"1.1\" viewBox=\"0 0 433.11 417.95\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t<path d=\"m60.5 80.452c9.23-15.81 33.56-35.39 49-45.67 70.98-47.23 166.66-45.46 236 4.1 42.09 30.07 72.06 74.87 82.79 125.57 4.66 21.99 4.46 35.89 4.21 58-0.35 29.5-13.32 67.87-28.4 93-17.57 29.29-41.27 54.08-70.6 71.8-34.44 20.8-69.92 30.2-110 30.2v-65c26.52 0 51.24-6.72 74-20.45 20.4-12.3 36.25-28.5 48.95-48.55 37.76-59.63 23.68-136.93-28.95-182.71-45.91-39.94-110.27-46.28-163-16.14-12.04 6.89-27.97 18.63-36 29.85l17 8.85 37 21.15v2l-41 23.58-78 44.84-34 19.73s-19 9.85-19 9.85v-198l23 12.15 37 21.85z\" fill=\"#060606\" stroke=\"#000\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t<a href=\"#\" id=\"btnRedo\" class=\"btnTool btnToolLeft tooltip\" onclick=\"btnRedoClicked()\">\n\t\t\t\t\t\t\t<span class=\"tooltipText tooltipTextCenter\">Redo - Z</span>\n\t\t\t\t\t\t\t<svg id=\"imgRedo\" version=\"1.1\" viewBox=\"0 0 433.11 417.95\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t<path d=\"m372.61 80.452c-9.23-15.81-33.56-35.39-49-45.67-70.98-47.23-166.66-45.46-236 4.1-42.09 30.07-72.06 74.87-82.79 125.57-4.66 21.99-4.46 35.89-4.21 58 0.35 29.5 13.32 67.87 28.4 93 17.57 29.29 41.27 54.08 70.6 71.8 34.44 20.8 69.92 30.2 110 30.2v-65c-26.52 0-51.24-6.72-74-20.45-20.4-12.3-36.25-28.5-48.95-48.55-37.76-59.63-23.68-136.93 28.95-182.71 45.91-39.94 110.27-46.28 163-16.14 12.04 6.89 27.97 18.63 36 29.85l-17 8.85-37 21.15v2l41 23.58 78 44.84 34 19.73s19 9.85 19 9.85v-198l-23 12.15-37 21.85z\" fill=\"#060606\" stroke=\"#000\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</a>\n\n\t\t\t\t\t</div>\n\t\t\t\t\t<input id=\"inpSearchFilter\" placeholder=\"Search - S. Also try  and \" autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" onkeyup=\"inpSearchFilterKeyUp()\"/>\n\t\t\t\t\t<div id=\"infoHiddenVariables_warning\" class=\"warning hidden\">\n\t\t\t\t\t\t<span class=\"infoBoxIcon\"></span>\n\t\t\t\t\t\t<span id=\"infoHiddenVariables_warningText\">Some variables are hidden.</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id=\"divSelVariables\">\n\t\t\t\t\t\t<select id=\"selVariables\" multiple size=\"2\" ondblclick=\"selVariablesDblClicked()\" onchange=\"showCurrentlySelectedValue()\"></select>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id=\"divStatusLine\" class=\"statusLine\">\n\t\t\t\t\t\t<div id=\"divStatusMessage\" class=\"statusPanel popup-in-center hidden\">\n\t\t\t\t\t\t\t<span id=\"spanStatusMessage\" class=\"statusPanelLabel\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div id=\"divStatusStats\" class=\"statusPanelContainer\">\n\t\t\t\t\t\t\t<table id=\"tblVariableCount\" title=\"Total number of variables\">\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<svg class=\"statusCountSVG\" fill=\"none\" version=\"1.1\" viewBox=\"0 0 19.871 18\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t\t\t\t<path d=\"m2.871 1c-1.1976 2.4099-1.871 5.1263-1.871 8 0 2.8737 0.67341 5.5901 1.871 8m14.129 0c1.1976-2.4099 1.871-5.1263 1.871-8 0-2.8737-0.6734-5.5901-1.871-8m-10 5h1.2457c0.4465 0 0.8389 0.29598 0.9615 0.72528l1.5856 5.5494c0.1226 0.4293 0.515 0.7253 0.9615 0.7253h1.2457m1-7h-0.0801c-0.5839 0-1.1386 0.25513-1.5185 0.69842l-4.8028 5.6032c-0.37996 0.4433-0.93466 0.6984-1.5185 0.6984h-0.08013\"\n\t\t\t\t\t\t\t\t\t\t\tstroke=\"#0000ff\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"/>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t   </td>\n\t\t\t\t\t\t\t\t\t<td class=\"statusText\">\n\t\t\t\t\t\t\t\t\t\t12\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t<table id=\"tblFilterCount\" class=\"hidden\" title=\"Number of filtered variables\">\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<svg class=\"statusFilterSVG\" fill=\"currentColor\" version=\"1.1\" viewBox=\"0 0 14.002 14.999\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t\t\t\t<path d=\"m0.50079 1.0008a0.5 0.5 0 0 1 0.5-0.5h12a0.5 0.5 0 0 1 0.5 0.5v2a0.5 0.5 0 0 1-0.128 0.334l-4.372 4.858v4.808a0.5 0.5 0 0 1-0.342 0.474l-3 1a0.5 0.5 0 0 1-0.658-0.474v-5.808l-4.372-4.858a0.5 0.5 0 0 1-0.128-0.334zm1 0.5v1.308l4.372 4.858a0.5 0.5 0 0 1 0.128 0.334v5.306l2-0.666v-4.64a0.5 0.5 0 0 1 0.128-0.334l4.372-4.858v-1.308z\" fill=\"none\" stroke=\"#00f\" stroke-width=\"1.0016\"/>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td class=\"statusText\">\n\t\t\t\t\t\t\t\t\t\t12345\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t<table id=\"tblHiddenCount\" class=\"hidden\" title=\"Number of hidden variables\">\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<svg class=\"statusHiddenSVG\" fill=\"currentColor\" version=\"1.1\" viewBox=\"0 0 16 12.708\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t\t\t\t<g transform=\"matrix(1,0,0,-1,0,12.708)\" fill=\"#00f\">\n\t\t\t\t\t\t\t\t\t\t\t <path d=\"m2.354 12.708 12-12-0.708-0.708-12 12z\"/>\n\t\t\t\t\t\t\t\t\t\t\t <path d=\"m5.525 6.708 2.829-2.83a2.5 2.5 0 0 0-2.829 2.829z\"/>\n\t\t\t\t\t\t\t\t\t\t\t <path d=\"m10.475 6a2.5 2.5 0 0 1-2.829 2.829l2.83-2.829z\"/>\n\t\t\t\t\t\t\t\t\t\t\t <path d=\"m10.79 1.442a7.028 7.028 0 0 0-2.79-0.588c-5 0-8 5.5-8 5.5s0.939 1.721 2.641 3.238l2.062-2.062a3.5 3.5 0 0 1 4.474-4.474l1.613-1.613z\"/>\n\t\t\t\t\t\t\t\t\t\t\t <path d=\"m5.21 11.266 1.614-1.615a3.5 3.5 0 0 0 4.474-4.474l2.06-2.06c1.704 1.515 2.642 3.237 2.642 3.237s-3 5.5-8 5.5a7.029 7.029 0 0 1-2.79-0.588z\"/>\n\t\t\t\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td class=\"statusText\">\n\t\t\t\t\t\t\t\t\t\t12345\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t<table id=\"tblSelectedCount\" class=\"hidden\" title=\"Number of selected variables\">\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<svg class=\"statusSelectedSVG\" version=\"1.1\" viewBox=\"0 0 169.08 163.37\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t\t\t\t<g transform=\"translate(-33.485 -29.853)\">\n\t\t\t\t\t\t\t\t\t\t\t <rect x=\"64.548\" y=\"143.73\" width=\"119.68\" height=\"25.442\" fill=\"#00f\" stroke=\"#00f\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"10.003\"/>\n\t\t\t\t\t\t\t\t\t\t\t <rect x=\"64.548\" y=\"52.083\" width=\"119.68\" height=\"25.442\" fill=\"#00f\" stroke=\"#00f\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"10.003\"/>\n\t\t\t\t\t\t\t\t\t\t\t <g fill=\"none\" stroke=\"#000\">\n\t\t\t\t\t\t\t\t\t\t\t  <g stroke-linecap=\"round\">\n\t\t\t\t\t\t\t\t\t\t\t   <path d=\"m75.984 64.385h98.357\" stroke-width=\"9.1038\"/>\n\t\t\t\t\t\t\t\t\t\t\t   <path d=\"m76.94 111.12h97.401\" stroke-width=\"9.0594\"/>\n\t\t\t\t\t\t\t\t\t\t\t   <path d=\"m77.658 156.81h96.683\" stroke-width=\"9.026\"/>\n\t\t\t\t\t\t\t\t\t\t\t  </g>\n\t\t\t\t\t\t\t\t\t\t\t  <rect x=\"49.247\" y=\"32.353\" width=\"150.82\" height=\"158.37\" ry=\"8.0481\" stroke-linecap=\"square\" stroke-miterlimit=\"1\" stroke-width=\"4.7937\"/>\n\t\t\t\t\t\t\t\t\t\t\t </g>\n\t\t\t\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t\t\t\t   </svg>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td class=\"statusText\" class=\"hidden\">\n\t\t\t\t\t\t\t\t\t\t12345\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div id=\"divSplitter\" class=\"splitter\"></div>\n\t\t\t\t<div id=\"divValue\">\n\t\t\t\t\t<div id=\"divValueToolButtons\" class=\"divToolButtons\">\n\t\t\t\t\t\t<a href=\"#\" id=\"btnJson\" class=\"btnTool btnToolHover btnToolLeft tooltip hidden\" onclick=\"btnJsonClicked()\">\n\t\t\t\t\t\t\t<span class=\"tooltipText tooltipTextCenter\">Toggle Pretty <br/> JSON View</span>\n\t\t\t\t\t\t\t<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAdCAYAAAC9pNwMAAACi3pUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHja7ZdbzhshDIXfWUWXgG/YLIfhInUHXX4Pk2T+W1Spl5dKGTSBeMyx8QejJM0f31f6hou8clLzKLWUjEurVm4YRH675r2vOa89Vtx0t9HlRenDg8eI0N7Zl9+fMiyCXm5fr3iyheSdULl6emYn+2SXKzx/yCjKFZnf212uEG+p3O+1RiysOW1vbVpQn3Jf1GOJ5wiOBwoj57SC5rgNYz9bRYvcck+keeSeD7ROlZgkL1Ia1GjRPPtOHSkqT3b0zJ3ltIU4V+6ShUSTqCgtdqkyJISl8xSBla9c6Ixbz3CdAoEHwZMJYoQZZ0uPwd+2p0Jr9V0iOovpZ62QF/PGQLuKsj/hBSC0HvvIzgI/2ucLYCGi8NplDiyw5eMmcRi97S1JJ2iBo6HX22QfdwGUCLENyZCAQC4kRoWyMzsR6hjg05A5S1I+gIDMeCBLVpECOME7NuY4nb5sfDPjCAGESREHmioNrFRNS1LXwB5qJqZmVswtrForUrRYKcXLPovNxdXNi7uHV28hoWFRwiOiRkuVq+CsWi3Va9RaW0PQBuWG2S0aDAcfcuhhRzn8iKMerWP7dO3WS/cevfaWBg8ZOmyU4SNGHW3SxFaaOm2W6TNmnW1hqy1ZumyV5StWXe2idlJNH5h9JfdranSnBmDpZKZwelCD2f0hQft1YpsZiLESiPsmgA3Nm1kOUuVNLm1muTJOhTGytA1n0CYGgjqJbdHF7o3cF24J5/5PufF7cmmj+xfk0kb3hNxXbk+ojf1+7/scZrzY9jHcRc2C4weHGY0DHvx7ffrdCS+hl9BL6CX0EnoJvYT+D6GFHw/4E5h+AimLWgSnSkFBAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5QwNDyshjIK/RwAAAIhJREFUSEvtks0KgDAMg6fs/V9Z6aFSykoCWg8jnkb/0nx1DH0iIAIisAuBq9vIQQjEJWJ9Xs5zFre35xmNZw1vysOruDXGXOxb0jsJx7GE3R7WTSAckVkpHMgaQcJZzO/Hzi/rEOq2vxs5rlDn+GdnaHPq7BHq17esBqyE2922udFgERCBXwncNsQUEEFahJIAAAAASUVORK5CYII=\" />\n\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t<a href=\"#\" id=\"btnEdit\" class=\"btnTool btnToolHover btnToolLeft tooltip\" onclick=\"btnEditClicked()\">\n\t\t\t\t\t\t\t<span class=\"tooltipText tooltipTextCenter\">Edit Variable - </span>\n\t\t\t\t\t\t\t<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH4AwXEjoDcazL2AAAAtlJREFUSMftlktIVFEYx//n3nNH78yYXGcqJ/Nm4KLXylZFGRGaJSrZy0XQIggisullm4gSW0WvTWUbE7LCRw8XGlJTESFUGG1ykRUzppXFPJrxzjj38bUxokVqo0WL+cPZHM73/fh//29xgLTSSut/UrskoVuW5U6wrodqvnYHOP7Xod4tS9EDZLc5HSMfGvbRaGsjvahaQ9eBkxPVselAa7cvhm2wX04s2enPL1jo3kXfmGETwMnA40tt2Owf+m1/IWWn5YD9bb8cW7Q9UFKxxV1RvY01RjiE9xpi/SHyfw4+n6heSBUqSVxOehCoKFVdgsgZCFi8cgUatDi1dHR8jXNx7YyC95cDNonLpmkOHjt91LWxdD5zxFvR2t6JaDRGI6Ghb3osVpgkGp2xjPdtADIyuN0wTP/xM3UuxeVhCPsANgst3Yzu9gxHnIMPVEtxR5t9XyfsxacK3VsGcInbk7oVOHG2LkdxeRhCPlhWNiJaBvk6miLOsKnqiit6bRLolB3vKQEy7dyuJ61A/fm6HMWVyxC6D8tSENYy6KC3KWwRFlimGW15OjUjk2a8tdiNLBuyxhJWoP7c4V+hozby1jaFdQuqoU8dCgDiZA9e+zXMnjPvxpGjK5arqpOxyEtYpCAUs5HXezXMGFTTMGM3e/9sSSd0XLlKxbI85qipqaruvGeB6SJM5vkBDTEG1cZ+hTocDgBAUVHR9DLeVFxw4crF+tpPIzF0dd9G5ToFp061BwlQXw3KmpGZL4iiKIiiKAAA55wAUF9fnz6trS5bv7o2GBmDKGViXt4iHDh2o0fH3N1Bc+4sSWE50s+4TAAGESUBJACkDq4qzjuUm+uB72EvHj159uDNcPyyyQs+CjAXAjAAjAFIMMYSRGSM3yXHT+qj3lFe+FbTErfefZGbLZ49KjJTBGAxxnQiShLR2LgzA4DJGLMMw6B4PE4DAwPp/0Jaaf0bfQefhjmDiw2RTAAAAABJRU5ErkJggg==\" />\n\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t<a href=\"#\" id=\"btnHelp\" class=\"btnTool btnToolHover tooltip hidden\" onclick=\"btnHelpClicked()\">\n\t\t\t\t\t\t\t<span class=\"tooltipText tooltipTextCenter\">Dictionary Help</span>\n\t\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"black\" class=\"bi bi-question-circle-fill\" viewBox=\"0 0 16 16\">\n\t\t\t\t\t\t\t\t<path d=\"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.496 6.033h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286a.237.237 0 0 0 .241.247zm2.325 6.443c.61 0 1.029-.394 1.029-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94 0 .533.425.927 1.01.927z\" />\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t<a href=\"#\" id=\"btnEditOK\" class=\"btnTool btnToolHover btnToolLeft hidden tooltip\" onclick=\"btnEditOKClicked()\">\n\t\t\t\t\t\t\t<span class=\"tooltipText tooltipTextCenter\">Save Edit - </span>\n\t\t\t\t\t\t\t<svg fill='none' stroke='#00b300' stroke-width='16' stroke-dashoffset='0' stroke-dasharray='0' stroke-linecap='round' stroke-linejoin='round' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><polyline fill=\"none\" points=\"10,60 40,85 85,15 \"/></svg>\n\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t<a href=\"#\" id=\"btnEditCancel\" title=\"Cancel the Edit\" class=\"btnTool btnToolHover btnToolLeft hidden tooltip\" onclick=\"btnEditCancelClicked()\">\n\t\t\t\t\t\t\t<span class=\"tooltipText tooltipTextCenter\">Cancel Edit - esc</span>\n\t\t\t\t\t\t\t<svg fill='none' stroke='red' stroke-width='16' stroke-dashoffset='0' stroke-dasharray='0' stroke-linecap='round' stroke-linejoin='round' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><line x1=\"15\" y1=\"15\" x2=\"85\" y2=\"85\" /> <line x1=\"85\" y1=\"15\" x2=\"15\" y2=\"85\" /></svg>\n\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t<div class=\"btnToolSpacer\">\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<a href=\"#\" id=\"btnCode\" class=\"btnTool btnToolHover btnToolRight tooltip\" onclick=\"btnCodeClicked()\">\n\t\t\t\t\t\t\t<span class=\"tooltipText tooltipTextCenter\">Toggle Fixed Font</span>\n\t\t\t\t\t\t\t<svg version=\"1.1\" viewBox=\"0 0 578.12 578.12\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t<path id=\"Code\" d=\"m329.1 93.673c2.24-0.76 2.47-0.98 4.96-0.96 4.55 0.02 20.55 4.34 23.72 7.36 2.43 2.29 3.29 5.32 2.92 8.58l-8.22 29s-17 59-17 59l-56.56 196s-19.72 68-19.72 68c-1.79 6.33-4.31 20.73-10.18 23.6-3.7 2.17-8.17 0.74-11.96 0-8.36-2.37-21.27-4.03-19.52-15.6l8.81-31s17-59 17-59l54.29-188 20-69c2.35-8.25 4.56-22.86 11.46-27.98zm-161.04 52.56c3.05-0.38 4.13-0.5 7 0.99 3.48 1.81 7.21 5.65 10 8.43 5.2 5.2 12.39 12.1 7.4 20 0 0-26.4 27-26.4 27l-76 76c-1.82 1.82-7.22 6.78-7.8 9-0.81 3.08 2.89 6.06 4.8 8l98 98c2.66 2.66 6.94 6.52 8.26 10 3.26 8.56-4.95 14.72-10.26 20-2.48 2.47-5.72 6.01-9 7.26-6.86 2.61-11.49-1.82-16-6.26l-116-116c-2.58-2.58-7.17-6.66-8.4-10-0.87-2.35-0.65-11.05-0.6-14 0.15-7.82 3.73-9.72 9-15l113-113c4.25-4.25 7.29-8.22 13-10.42zm237 0.13c9.27-1.66 16.05 8.34 22 14.29l110 110c2.41 2.41 6.23 5.82 7.4 9 0.87 2.35 0.65 11.05 0.6 14-0.14999 7.82-3.73 9.72-9 15l-115 115c-3.14 3.13-6.41 7-11 7.77-6.87 1.15-10.6-3.39-15-7.77-5.84-5.81-14.93-12.83-9.26-22l26.26-27 76-76c1.82-1.82 7.22-6.78 7.8-9 0.86-3.26-3.74-6.93-5.8-9l-97-97c-2.57-2.57-7.18-6.68-8.4-10-3.54-9.66 12.71-23.87 20.4-27.29z\" stroke=\"#000\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t<a href=\"#\" id=\"btnWordWrap\" class=\"btnTool btnToolHover btnToolRight btnToolDown tooltip\" onclick=\"btnWordWrapClicked()\">\n\t\t\t\t\t\t\t<span class=\"tooltipText tooltipTextLeft\">Toggle Word Wrap</span>\n\t\t\t\t\t\t\t<svg version=\"1.1\" viewBox=\"0 0 203.12 203.13\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t<path id=\"wrap\" d=\"m12.091 25.85h169v20h-169v-20zm0 57h145c8.65 0.01 18.45 1.82 24.82 8.18 11.81 11.8 11.93 44.07 1.65 56.78-10.2 12.62-33.64 11.04-48.47 11.04v18l-17-11.13-22-17.87 38-28 1 19c8.99 0 22.81 1.56 29.95-4.39 8.38-6.99 7.78-22.57-0.99-28.96-4.46-3.25-13.51-3.64-18.96-3.65h-133v-19zm0 56h66v20h-66v-20z\" stroke=\"#000\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<textarea id=\"txtValue\" autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" readonly></textarea>\n\t\t\t\t\t<div id=\"divDictionary\">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<footer>\n\t\t\t\t<div>\n\t\t\t\t\t<span id=\"spanStatusLine\" class=\"spanFooterLeft\"></span>\n\t\t\t\t\t<a id=\"btnOK\" class=\"okButton\" onclick=\"submitWindow('OK')\">OK</a>\n\t\t\t\t\t<a id=\"btnReload\" class=\"reloadButton hidden\" onclick=\"btnReloadClicked()\">Reload</a>\n\t\t\t\t\t<a id=\"btnCancel\" class=\"cancelButton\" onclick=\"cancelWindow('Cancel')\">Cancel</a>\n\t\t\t\t</div>\n\t\t\t</footer>\n\t\t</div>\n\t</body>\n\n</html>",
									"ActionUID": 217030
								},
								{
									"MacroActionType": "SearchReplace",
									"Search": "E36A74A0-1E20-4618-AFC8-8B2782D3F671",
									"Source": "Variable",
									"IsDisclosed": false,
									"Action": "IgnoreCaseString",
									"ActionUID": 217031,
									"Variable": "Local_HTML",
									"Replace": "%RandomUUID%",
									"Which": "All"
								},
								{
									"MacroActionType": "WriteFile",
									"Append": false,
									"Format2": "PlainText",
									"Format": "PlainText",
									"IsDisclosed": false,
									"Destination": "%JSONValue%Instance_VipParameters.htmlFilePath%",
									"Encoding": "UTF8",
									"ActionUID": 217032,
									"Source": "Variable",
									"Variable": "Local_HTML"
								},
								{
									"MacroActionType": "SetVariableToText",
									"IsDisclosed": false,
									"ProcessingMode": "Nothing",
									"Variable": "Local_HTML",
									"Text": "%Delete%",
									"ActionUID": 218199
								},
								{
									"MacroActionType": "SetJSONValue",
									"IsDisclosed": false,
									"Target": "Instance_VipParameters.deleteTempHtmlFile",
									"Text": "1",
									"ActionUID": 217033
								}
							],
							"TimeOutAbortsMacro": true,
							"ActionColor": "Green",
							"ActionUID": 217028
						}
					],
					"TimeOutAbortsMacro": true,
					"Conditions": {
						"ConditionListMatch": "All",
						"ConditionList": [
							{
								"ConditionType": "Variable",
								"VariableValue": "value",
								"Variable": "VIP TESTING Variable Inspector Prompt Path",
								"VariableConditionType": "IsNotEmpty"
							}
						]
					},
					"ThenActions": [
						{
							"MacroActionType": "Group",
							"ActionName": "Use development HTML file",
							"ActionUID": 217025,
							"IsDisclosed": false,
							"Actions": [
								{
									"MacroActionType": "SetJSONValue",
									"IsDisclosed": false,
									"Target": "Instance_VipParameters.htmlFilePath",
									"Text": "%Variable%VIP TESTING Variable Inspector Prompt Path%",
									"ActionUID": 217027
								}
							],
							"TimeOutAbortsMacro": true,
							"ActionColor": "Green"
						}
					]
				}
			],
			"IsDisclosed": false,
			"TimeOutAbortsMacro": true,
			"ActionUID": 217023
		}
	]
}